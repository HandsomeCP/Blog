<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
  <meta name="theme-color" content="#222">
  <meta name="generator" content="Hexo 4.2.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/safari-pinned-tab.svg" color="#222">
  <link rel="stylesheet" href="/css/main.css">
  <link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="/lib/pace/pace-theme-minimal.min.css">
  <script src="/lib/pace/pace.min.js"></script>
  <script id="hexo-configurations">
    var NexT = window.NexT ||
    {};
    var CONFIG = {
      "hostname": "cuiqingcai.com",
      "root": "/",
      "scheme": "Pisces",
      "version": "7.8.0",
      "exturl": false,
      "sidebar":
      {
        "position": "right",
        "width": 360,
        "display": "post",
        "padding": 18,
        "offset": 12,
        "onmobile": false,
        "widgets": [
          {
            "type": "image",
            "name": "阿布云",
            "enable": true,
            "url": "https://www.abuyun.com/http-proxy/introduce.html",
            "src": "https://qiniu.cuiqingcai.com/88au8.jpg",
            "width": "100%"
      },
          {
            "type": "image",
            "name": "天验",
            "enable": true,
            "url": "https://tutorial.lengyue.video/?coupon=12ef4b1a-a3db-11ea-bb37-0242ac130002_cqx_850",
            "src": "https://qiniu.cuiqingcai.com/bco2a.png",
            "width": "100%"
      },
          {
            "type": "image",
            "name": "华为云",
            "enable": false,
            "url": "https://activity.huaweicloud.com/2020_618_promotion/index.html?bpName=5f9f98a29e2c40b780c1793086f29fe2&bindType=1&salesID=wangyubei",
            "src": "https://qiniu.cuiqingcai.com/y42ik.jpg",
            "width": "100%"
      },
          {
            "type": "image",
            "name": "张小鸡",
            "enable": false,
            "url": "http://www.zxiaoji.com/",
            "src": "https://qiniu.cuiqingcai.com/fm72f.png",
            "width": "100%"
      },
          {
            "type": "image",
            "name": "Luminati",
            "src": "https://qiniu.cuiqingcai.com/ikkq9.jpg",
            "url": "https://luminati-china.io/?affiliate=ref_5fbbaaa9647883f5c6f77095",
            "width": "100%",
            "enable": true
      },
          {
            "type": "tags",
            "name": "标签云",
            "enable": true
      },
          {
            "type": "categories",
            "name": "分类",
            "enable": true
      },
          {
            "type": "friends",
            "name": "友情链接",
            "enable": true
      },
          {
            "type": "hot",
            "name": "猜你喜欢",
            "enable": true
      }]
      },
      "copycode":
      {
        "enable": true,
        "show_result": true,
        "style": "mac"
      },
      "back2top":
      {
        "enable": true,
        "sidebar": false,
        "scrollpercent": true
      },
      "bookmark":
      {
        "enable": false,
        "color": "#222",
        "save": "auto"
      },
      "fancybox": false,
      "mediumzoom": false,
      "lazyload": false,
      "pangu": true,
      "comments":
      {
        "style": "tabs",
        "active": "gitalk",
        "storage": true,
        "lazyload": false,
        "nav": null
      },
      "algolia":
      {
        "hits":
        {
          "per_page": 10
        },
        "labels":
        {
          "input_placeholder": "Search for Posts",
          "hits_empty": "We didn't find any results for the search: ${query}",
          "hits_stats": "${hits} results found in ${time} ms"
        }
      },
      "localsearch":
      {
        "enable": true,
        "trigger": "auto",
        "top_n_per_article": 10,
        "unescape": false,
        "preload": false
      },
      "motion":
      {
        "enable": false,
        "async": false,
        "transition":
        {
          "post_block": "bounceDownIn",
          "post_header": "slideDownIn",
          "post_body": "slideDownIn",
          "coll_header": "slideLeftIn",
          "sidebar": "slideUpIn"
        }
      },
      "path": "search.xml"
    };

  </script>
  <meta name="description" content="崔庆才的个人站点，记录生活的瞬间，分享学习的心得。">
  <meta property="og:type" content="website">
  <meta property="og:title" content="静觅">
  <meta property="og:url" content="https://cuiqingcai.com/page/19/index.html">
  <meta property="og:site_name" content="静觅">
  <meta property="og:description" content="崔庆才的个人站点，记录生活的瞬间，分享学习的心得。">
  <meta property="og:locale" content="zh_CN">
  <meta property="article:author" content="崔庆才">
  <meta property="article:tag" content="崔庆才">
  <meta property="article:tag" content="静觅">
  <meta property="article:tag" content="PHP">
  <meta property="article:tag" content="Java">
  <meta property="article:tag" content="Python">
  <meta property="article:tag" content="Spider">
  <meta property="article:tag" content="爬虫">
  <meta property="article:tag" content="Web">
  <meta property="article:tag" content="Kubernetes">
  <meta property="article:tag" content="深度学习">
  <meta property="article:tag" content="机器学习">
  <meta property="article:tag" content="数据分析">
  <meta property="article:tag" content="网络">
  <meta property="article:tag" content="IT">
  <meta property="article:tag" content="技术">
  <meta property="article:tag" content="博客">
  <meta name="twitter:card" content="summary">
  <link rel="canonical" href="https://cuiqingcai.com/page/19/">
  <script id="page-configurations">
    // https://hexo.io/docs/variables.html
    CONFIG.page = {
      sidebar: "",
      isHome: true,
      isPost: false,
      lang: 'zh-CN'
    };

  </script>
  <title>静觅丨崔庆才的个人站点</title>
  <meta name="google-site-verification" content="p_bIcnvirkFzG2dYKuNDivKD8-STet5W7D-01woA2fc" />
  <noscript>
    <style>
      .use-motion .brand,
      .use-motion .menu-item,
      .sidebar-inner,
      .use-motion .post-block,
      .use-motion .pagination,
      .use-motion .comments,
      .use-motion .post-header,
      .use-motion .post-body,
      .use-motion .collection-header
      {
        opacity: initial;
      }

      .use-motion .site-title,
      .use-motion .site-subtitle
      {
        opacity: initial;
        top: initial;
      }

      .use-motion .logo-line-before i
      {
        left: initial;
      }

      .use-motion .logo-line-after i
      {
        right: initial;
      }

    </style>
  </noscript>
  <link rel="alternate" href="/atom.xml" title="静觅" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container">
    <div class="headband"></div>
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner">
        <div class="site-brand-container">
          <div class="site-nav-toggle">
            <div class="toggle" aria-label="切换导航栏">
              <span class="toggle-line toggle-line-first"></span>
              <span class="toggle-line toggle-line-middle"></span>
              <span class="toggle-line toggle-line-last"></span>
            </div>
          </div>
          <div class="site-meta">
            <a href="/" class="brand" rel="start">
              <span class="logo-line-before"><i></i></span>
              <h1 class="site-title">静觅 <span class="site-subtitle"> 崔庆才的个人站点 </span>
              </h1>
              <span class="logo-line-after"><i></i></span>
            </a>
          </div>
          <div class="site-nav-right">
            <div class="toggle popup-trigger">
              <i class="fa fa-search fa-fw fa-lg"></i>
            </div>
          </div>
        </div>
        <nav class="site-nav">
          <ul id="menu" class="main-menu menu">
            <li class="menu-item menu-item-home">
              <a href="/" rel="section">首页</a>
            </li>
            <li class="menu-item menu-item-archives">
              <a href="/archives/" rel="section">文章列表</a>
            </li>
            <li class="menu-item menu-item-tags">
              <a href="/tags/" rel="section">文章标签</a>
            </li>
            <li class="menu-item menu-item-categories">
              <a href="/categories/" rel="section">文章分类</a>
            </li>
            <li class="menu-item menu-item-about">
              <a href="/about/" rel="section">关于博主</a>
            </li>
            <li class="menu-item menu-item-message">
              <a href="/message/" rel="section">给我留言</a>
            </li>
            <li class="menu-item menu-item-search">
              <a role="button" class="popup-trigger">搜索 </a>
            </li>
          </ul>
        </nav>
        <div class="search-pop-overlay">
          <div class="popup search-popup">
            <div class="search-header">
              <span class="search-icon">
                <i class="fa fa-search"></i>
              </span>
              <div class="search-input-container">
                <input autocomplete="off" autocapitalize="off" placeholder="搜索..." spellcheck="false" type="search" class="search-input">
              </div>
              <span class="popup-btn-close">
                <i class="fa fa-times-circle"></i>
              </span>
            </div>
            <div id="search-result">
              <div id="no-result">
                <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
              </div>
            </div>
          </div>
        </div>
      </div>
    </header>
    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
      <span>0%</span>
    </div>
    <div class="reading-progress-bar"></div>
    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div class="content index posts-expand">
            <div class="carousel">
              <div id="wowslider-container">
                <div class="ws_images">
                  <ul>
                    <li><a target="_blank" href="https://cuiqingcai.com/5052.html"><img title="Python3网络爬虫开发实战教程" src="https://qiniu.cuiqingcai.com/ipy96.jpg" /></a></li>
                    <li><a target="_blank" href="https://t.lagou.com/fRCBRsRCSN6FA"><img title="52讲轻松搞定网络爬虫" src="https://qiniu.cuiqingcai.com/fqq5e.png" /></a></li>
                    <li><a target="_blank" href="https://cuiqingcai.com/4320.html"><img title="Python3网络爬虫开发视频教程" src="https://qiniu.cuiqingcai.com/bjrny.jpg" /></a></li>
                    <li><a target="_blank" href="https://cuiqingcai.com/1052.html"><img title="Python2爬虫学习系列教程" src="https://qiniu.cuiqingcai.com/uyl5v.jpg" /></a></li>
                    <li><a target="_blank" href="https://cuiqingcai.com/5094.html"><img title="爬虫代理哪家强？十大付费代理详细对比评测出炉！" src="https://qiniu.cuiqingcai.com/nifs6.jpg" /></a></li>
                  </ul>
                </div>
                <div class="ws_thumbs">
                  <div>
                    <a target="_blank" href="#"><img src="https://qiniu.cuiqingcai.com/ipy96.jpg" /></a>
                    <a target="_blank" href="#"><img src="https://qiniu.cuiqingcai.com/fqq5e.png" /></a>
                    <a target="_blank" href="#"><img src="https://qiniu.cuiqingcai.com/bjrny.jpg" /></a>
                    <a target="_blank" href="#"><img src="https://qiniu.cuiqingcai.com/uyl5v.jpg" /></a>
                    <a target="_blank" href="#"><img src="https://qiniu.cuiqingcai.com/nifs6.jpg" /></a>
                  </div>
                </div>
                <div class="ws_shadow"></div>
              </div>
            </div>
            <link rel="stylesheet" href="/lib/wowslide/slide.css">
            <script src="/lib/wowslide/jquery.min.js"></script>
            <script src="/lib/wowslide/slider.js"></script>
            <script>
              jQuery("#wowslider-container").wowSlider(
              {
                effect: "cube",
                prev: "",
                next: "",
                duration: 20 * 100,
                delay: 20 * 100,
                width: 716,
                height: 297,
                autoPlay: true,
                playPause: true,
                stopOnHover: false,
                loop: false,
                bullets: 0,
                caption: true,
                captionEffect: "slide",
                controls: true,
                onBeforeStep: 0,
                images: 0
              });

            </script>
            <article itemscope itemtype="http://schema.org/Article" class="post-block index" lang="zh-CN">
              <link itemprop="mainEntityOfPage" href="https://cuiqingcai.com/2956.html">
              <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
                <meta itemprop="image" content="/images/avatar.png">
                <meta itemprop="name" content="崔庆才">
                <meta itemprop="description" content="崔庆才的个人站点，记录生活的瞬间，分享学习的心得。">
              </span>
              <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
                <meta itemprop="name" content="静觅">
              </span>
              <header class="post-header">
                <h2 class="post-title" itemprop="name headline">
                  <a class="label"> Python <i class="label-arrow"></i>
                  </a>
                  <a href="/2956.html" class="post-title-link" itemprop="url">python version 2. required,which was not found in the registry 解决方案</a>
                </h2>
              </header>
              <div class="post-body" itemprop="articleBody">
                <div class="thumb">
                  <img itemprop="contentUrl" class="random">
                </div>
                <div class="excerpt">
                  <p>
                  <p>不能在注册表中识别python2.7 新建一个register.py 文件</p>
                  <figure class="highlight reasonml">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">import sys</span><br><span class="line"> </span><br><span class="line">from _winreg import *</span><br><span class="line"> </span><br><span class="line"># tweak <span class="keyword">as</span> necessary</span><br><span class="line">version = sys.version<span class="literal">[:<span class="number">3</span>]</span></span><br><span class="line">installpath = sys.prefix</span><br><span class="line"> </span><br><span class="line">regpath = <span class="string">"SOFTWARE\\Python\\Pythoncore\\%s\\"</span> % (version)</span><br><span class="line">installkey = <span class="string">"InstallPath"</span></span><br><span class="line">pythonkey = <span class="string">"PythonPath"</span></span><br><span class="line">pythonpath = <span class="string">"%s;%s\\Lib\\;%s\\DLLs\\"</span> % (</span><br><span class="line">    installpath, installpath, installpath</span><br><span class="line">)</span><br><span class="line"> </span><br><span class="line">def <span class="constructor">RegisterPy()</span>:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        reg = <span class="constructor">OpenKey(HKEY_CURRENT_USER, <span class="params">regpath</span>)</span></span><br><span class="line">    except EnvironmentError <span class="keyword">as</span> e:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            reg = <span class="constructor">CreateKey(HKEY_CURRENT_USER, <span class="params">regpath</span>)</span></span><br><span class="line">            <span class="constructor">SetValue(<span class="params">reg</span>, <span class="params">installkey</span>, REG_SZ, <span class="params">installpath</span>)</span></span><br><span class="line">            <span class="constructor">SetValue(<span class="params">reg</span>, <span class="params">pythonkey</span>, REG_SZ, <span class="params">pythonpath</span>)</span></span><br><span class="line">            <span class="constructor">CloseKey(<span class="params">reg</span>)</span></span><br><span class="line">        except:</span><br><span class="line">            print <span class="string">"*** Unable to register!"</span></span><br><span class="line">            return</span><br><span class="line">        print <span class="string">"--- Python"</span>, version, <span class="string">"is now registered!"</span></span><br><span class="line">        return</span><br><span class="line">    <span class="keyword">if</span> (<span class="constructor">QueryValue(<span class="params">reg</span>, <span class="params">installkey</span>)</span><span class="operator"> == </span>installpath <span class="keyword">and</span></span><br><span class="line">        <span class="constructor">QueryValue(<span class="params">reg</span>, <span class="params">pythonkey</span>)</span><span class="operator"> == </span>pythonpath):</span><br><span class="line">        <span class="constructor">CloseKey(<span class="params">reg</span>)</span></span><br><span class="line">        print <span class="string">"=== Python"</span>, version, <span class="string">"is already registered!"</span></span><br><span class="line">        return</span><br><span class="line">    <span class="constructor">CloseKey(<span class="params">reg</span>)</span></span><br><span class="line">    print <span class="string">"*** Unable to register!"</span></span><br><span class="line">    print <span class="string">"*** You probably have another Python installation!"</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> __name__<span class="operator"> == </span><span class="string">"__main__"</span>:</span><br><span class="line">    <span class="constructor">RegisterPy()</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>用Python 运行register.py后就能识别python2.7了 代码来自：<a href="http://tech.valgog.com/2010/01/after-installing-64-bit-windows-7-at.html" target="_blank" rel="noopener">http://tech.valgog.com/2010/01/after-installing-64-bit-windows-7-at.html</a></p>
                  </p>
                </div>
              </div>
              <div class="post-meta">
                <span class="post-meta-item">
                  <span class="post-meta-item-icon">
                    <i class="far fa-user"></i>
                  </span>
                  <span class="post-meta-item-text">作者</span>
                  <span><a href="/authors/huxiao123" class="author" itemprop="url" rel="index">huxiao123</a></span>
                </span>
                <span class="post-meta-item">
                  <span class="post-meta-item-icon">
                    <i class="far fa-calendar"></i>
                  </span>
                  <span class="post-meta-item-text">发表于</span>
                  <time title="创建时间：2016-07-20 17:02:37" itemprop="dateCreated datePublished" datetime="2016-07-20T17:02:37+08:00">2016-07-20</time>
                </span>
                <span id="/2956.html" class="post-meta-item leancloud_visitors" data-flag-title="python version 2. required,which was not found in the registry 解决方案" title="阅读次数">
                  <span class="post-meta-item-icon">
                    <i class="fa fa-eye"></i>
                  </span>
                  <span class="post-meta-item-text">阅读次数：</span>
                  <span class="leancloud-visitors-count"></span>
                </span>
                <span class="post-meta-item" title="本文字数">
                  <span class="post-meta-item-icon">
                    <i class="far fa-file-word"></i>
                  </span>
                  <span class="post-meta-item-text">本文字数：</span>
                  <span>1.1k</span>
                </span>
                <span class="post-meta-item" title="阅读时长">
                  <span class="post-meta-item-icon">
                    <i class="far fa-clock"></i>
                  </span>
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                  <span>1 分钟</span>
                </span>
              </div>
            </article>
            <article itemscope itemtype="http://schema.org/Article" class="post-block index" lang="zh-CN">
              <link itemprop="mainEntityOfPage" href="https://cuiqingcai.com/2906.html">
              <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
                <meta itemprop="image" content="/images/avatar.png">
                <meta itemprop="name" content="崔庆才">
                <meta itemprop="description" content="崔庆才的个人站点，记录生活的瞬间，分享学习的心得。">
              </span>
              <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
                <meta itemprop="name" content="静觅">
              </span>
              <header class="post-header">
                <h2 class="post-title" itemprop="name headline">
                  <a class="label"> JavaScript <i class="label-arrow"></i>
                  </a>
                  <a href="/2906.html" class="post-title-link" itemprop="url">基于ES6利用Gulp编译BootStrap-Sass源码</a>
                </h2>
              </header>
              <div class="post-body" itemprop="articleBody">
                <div class="thumb">
                  <img itemprop="contentUrl" class="random">
                </div>
                <div class="excerpt">
                  <p>
                  <h2 id="BootStrap"><a href="#BootStrap" class="headerlink" title="BootStrap"></a>BootStrap</h2>
                  <p>BootStrap 是一个前端CSS框架，它提供了一些便捷的组件方便我们快速构建前端页面，目前已经到了版本4，版本4是用 Sass 编写的，版本3是由 Less 编写的，后来增加了 Sass 版本。这说明了什么？BootStrap 已经向 Sass靠近了，个人感觉 Sass 比 Less 更为强大，具有更丰富的语法功能。 所以，Sass 将会成为比 Less 更为主流的语言。 目前常用的 BootStrap 版本是3，在官网也提供了相关 Sass 版本的下载。 在此提供官网下载链接和 Sass 项目 GitHub 地址。 <a href="http://v3.bootcss.com/getting-started/#download" target="_blank" rel="noopener">BootStrap</a> <a href="https://github.com/twbs/bootstrap-sass" target="_blank" rel="noopener">BootStrap-Sass</a> 在 BootStrap 的下载版本中，可以看到有三个。一个是编译好的 JS，CSS 文件，可以直接拿来用，方便快捷就可以下载这个来用。第二个是 Less 源码版本，你可以自己定义 Less 文件，在项目基础上继续用 Less 开发，编译成需要的 CSS 文件。第三个是后来新增的 Sass 版本，本节就以它为例来说明利用 Gulp 编译 BootStrap-Sass 的过程，目的一在于熟悉 Gulp 自动化编译 Sass 的流程，目的二在于了解前端自动化的工作原理。</p>
                  <h2 id="Gulp"><a href="#Gulp" class="headerlink" title="Gulp"></a>Gulp</h2>
                  <p>说完 BootStrap，我们再说下 Gulp，基于 Node.js。它干嘛的呢？就是一个前端自动化工具，什么用处？比如它可以编译 Less，Sass 生成到指定目录文件为 CSS，生成对应 map 文件，可以生成 JavaScript 的 map 文件，自动更新 html 中的 JS，CSS 引用路径，合并多个 JS，CSS 文件为统一整体，最小化压缩 JS，CSS 文件等等，最终目的呢？自动化替代重复劳动，提高效率。 说到 Gulp，就不得不提到它的竞争对手 Grunt，它具有和 Gulp 几乎一样的功能，然而 Grunt 有几个缺点，比如插件职责不明确，产生大量临时文件，语法繁琐等等。相比之下，Gulp插件职责明确，基于流式，不会产生临时文件，语法简单。冲着这几点，果断选择 Gulp。 利用 Gulp，我们就可以在项目中定义一个 gulpfile.babel.js 里面写入需要执行的任务，命令行执行 gulp 命令就可以完成自动化，一些重复的无聊的工作就不要你来做了。 <a href="http://www.gulpjs.com.cn/" target="_blank" rel="noopener">Gulp中文网</a></p>
                  <h2 id="ES6"><a href="#ES6" class="headerlink" title="ES6"></a>ES6</h2>
                  <p>说完 Gulp，然后就属 ES6 了，它是 ECMAScript 6 的简称，是 JavaScript 的一个新的版本类型，由于是 2015年发布的，所以也可以叫它 ES2015。我们之前编的 JavaScript 大多数是基于ES5或之前的版本，在 ES6 的基础上增加了许多新的语法特性，比如 Class，let，const 等等。 在 ES5 中，Gulp 的执行文件叫做 gulpfile.js，到了 ES6中，它就叫做 gulpfile.babel.js 了，多了一个 badel，那 babel 又是什么？ 关于 ES6 的新特性预览可以看 <a href="http://es6.ruanyifeng.com/" target="_blank" rel="noopener">ES6</a></p>
                  <h2 id="Babel"><a href="#Babel" class="headerlink" title="Babel"></a>Babel</h2>
                  <p>Babel 其实是一个 JavaScript 编译器，支持 ES6，你可以用新型的 ES6 语法来编写你的 JavaScript，Babel 会为你生成对应的 ES5 的 JavaScript。乍看之下并没有什么关系，所以在这里你可以把 babel 看作 ES6 的代名词，在 Gulp 中，新型的 ES6 语法的 JavaScript 的 gulpfile 名字命名为 gulpfile.babel.js。 <a href="http://babeljs.cn/" target="_blank" rel="noopener">Babel</a></p>
                  <h2 id="NPM"><a href="#NPM" class="headerlink" title="NPM"></a>NPM</h2>
                  <p>有一点 Node.js 基础的想必都知道这一个东西吧，Node Package Manager，Node.js 包管理器，利用它你可以安装 Node.js 的相关包，其中包括 Gulp。可以全局安装，加个 -g 参数，可以局部安装，需要路径下有个 package.json。 NPM怎样安装？安装了 Node.js 就好了。 <a href="https://nodejs.org" target="_blank" rel="noopener">Node.js</a> 如果觉得速度慢，可以安装 CNPM，镜像源来源非国外，是淘宝的一个镜像源，速度快。 <a href="https://npm.taobao.org/" target="_blank" rel="noopener">CMPM</a></p>
                  <h2 id="Bower"><a href="#Bower" class="headerlink" title="Bower"></a>Bower</h2>
                  <p>在这里还需要用到一个工具 bower，类似 NPM，算是前端的一些组件管理工具，一些前端库比如 jquery，bootstrap 等等都可以用 bower 这个工具来下载，需要在根目录下建立一个 bower.json 和 .bowerrc 文件。利用 bower 我们就可以方便地管理前端的工具包了，不用我们去手动下载复制粘贴之类的。</p>
                  <h2 id="WebStorm"><a href="#WebStorm" class="headerlink" title="WebStorm"></a>WebStorm</h2>
                  <p>在这再安利一个 IDE 吧，WebStorm，JetBrains公司出的一款强大又良心的编写前端的 IDE，支持各种插件，具有强大的语法提示，支持 JsHint 等代码检查，集成了终端，Git 等等强大的工具，Web 开发不二选择，推荐最新版本。 <a href="https://www.jetbrains.com/webstorm/" target="_blank" rel="noopener">WebStorm</a></p>
                  <h2 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h2>
                  <p>扯完以上东西（其实还有好多没有扯完），让我们进入正题吧，正题是什么？哦没错，那就是</p>
                  <blockquote>
                    <p>基于 ES6 语法使用 Gulp 编写 gulpfile.babel.js 来编译 BootStrap-Sass 源码。</p>
                  </blockquote>
                  <p>下面是一些准备工作，没有做好的小伙伴请按照步骤一一完成。</p>
                  <h3 id="安装-Node-js-和-NPM"><a href="#安装-Node-js-和-NPM" class="headerlink" title="安装 Node.js 和 NPM"></a>安装 Node.js 和 NPM</h3>
                  <p>从 Node 的官网下载 Node 并安装，安装流程不详细说明，安装完成之后 NPM 随之就会安装成功。 命令行下输入 npm 检查一下是否可以正常运行。</p>
                  <h3 id="安装-Gulp"><a href="#安装-Gulp" class="headerlink" title="安装 Gulp"></a>安装 Gulp</h3>
                  <figure class="highlight cmake">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">npm <span class="keyword">install</span> -g gulp</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>加入 -g 参数是全局安装，安装完成之后你可以在任意位置使用命令。</p>
                  <h3 id="安装-Bower"><a href="#安装-Bower" class="headerlink" title="安装 Bower"></a>安装 Bower</h3>
                  <figure class="highlight cmake">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">npm <span class="keyword">install</span> -g bower</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>依然是全局安装 bower。</p>
                  <h3 id="下载-BootStrap-Sass"><a href="#下载-BootStrap-Sass" class="headerlink" title="下载 BootStrap-Sass"></a>下载 BootStrap-Sass</h3>
                  <p>可直接进入 <a href="http://v3.bootcss.com/getting-started/#download" target="_blank" rel="noopener">BootStrap</a> 页面点击第三个下载 Sass 源码。 也可以用 Git 将 <a href="https://github.com/twbs/bootstrap-sass" target="_blank" rel="noopener">BootStrap-Sass</a> 的项目 clone 下来。</p>
                  <h3 id="安装-WebStorm"><a href="#安装-WebStorm" class="headerlink" title="安装 WebStorm"></a>安装 WebStorm</h3>
                  <p>推荐使用 WebStorm，可以开启 JsHint 等检测工具，具有强大的代码提示功能，不过不使用也没关系。 在你的 IDE 打开下载的项目，</p>
                  <h3 id="新建-gulpfile-babel-js"><a href="#新建-gulpfile-babel-js" class="headerlink" title="新建 gulpfile.babel.js"></a>新建 gulpfile.babel.js</h3>
                  <p>gulpfile.babel.js 是基于 ES6 的 Gulp 处理文件，新建它，稍后所有的工作都在这里完成。</p>
                  <h3 id="新建-babelrc"><a href="#新建-babelrc" class="headerlink" title="新建 .babelrc"></a>新建 .babelrc</h3>
                  <p>新建 .babelrc 文件，内容</p>
                  <figure class="highlight json">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"presets"</span>: [</span><br><span class="line">    <span class="string">"es2015"</span></span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>这是指定 gulp 使用最新标准的 JavaScript 进行编译。</p>
                  <h3 id="新建-bowerrc"><a href="#新建-bowerrc" class="headerlink" title="新建 .bowerrc"></a>新建 .bowerrc</h3>
                  <p>新建 .bowerrc 文件，这是 bower 的配置文件，可以指定路径等相关配置，内容为</p>
                  <figure class="highlight json">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"directory"</span>: <span class="string">"bower_components"</span></span><br><span class="line">&#125;</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>这是指定 bower 工具下载前端组件时会默认下载到这个文件夹中。</p>
                  <h3 id="修改-bower-json"><a href="#修改-bower-json" class="headerlink" title="修改 bower.json"></a>修改 bower.json</h3>
                  <p>可以精简 bower.json 文件，比如修改名称，删去 main，ignore 配置等。 比如精简成</p>
                  <figure class="highlight json">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"name"</span>: <span class="string">"bootstrap-sass-demo"</span>,</span><br><span class="line">  <span class="attr">"authors"</span>: [</span><br><span class="line">    <span class="string">"Germey"</span></span><br><span class="line">  ],</span><br><span class="line">  <span class="attr">"description"</span>: <span class="string">"bootstrap-sass is a Sass-powered version of Bootstrap, ready to drop right into your Sass powered applications."</span>,</span><br><span class="line">  <span class="attr">"moduleType"</span>: <span class="string">"globals"</span>,</span><br><span class="line">  <span class="attr">"keywords"</span>: [</span><br><span class="line">    <span class="string">"twbs"</span>,</span><br><span class="line">    <span class="string">"bootstrap"</span>,</span><br><span class="line">    <span class="string">"sass"</span></span><br><span class="line">  ],</span><br><span class="line">  <span class="attr">"license"</span>: <span class="string">"MIT"</span>,</span><br><span class="line">  <span class="attr">"dependencies"</span>: &#123;</span><br><span class="line">    <span class="attr">"jquery"</span>: <span class="string">"&gt;= 1.9.0"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>修改 package.json 在进行 Gulp 配置文件编写之前，首先需要引入一些 Node.js 开发包，比如 babel，gulp，wiredep等等。 修改 devDependencies 为</p>
                  <figure class="highlight 1c">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="string">"devDependencies"</span>: &#123;</span><br><span class="line">    <span class="string">"babel-core"</span>: <span class="string">"^6.4.0"</span>,</span><br><span class="line">    <span class="string">"babel-preset-es2015"</span>: <span class="string">"^6.3.13"</span>,</span><br><span class="line">    <span class="string">"babel-register"</span>: <span class="string">"^6.9.0"</span>,</span><br><span class="line">    <span class="string">"browser-sync"</span>: <span class="string">"^2.2.1"</span>,</span><br><span class="line">    <span class="string">"del"</span>: <span class="string">"^1.1.1"</span>,</span><br><span class="line">    <span class="string">"gulp"</span>: <span class="string">"^3.9.1"</span>,</span><br><span class="line">    <span class="string">"gulp-autoprefixer"</span>: <span class="string">"^3.0.1"</span>,</span><br><span class="line">    <span class="string">"gulp-babel"</span>: <span class="string">"^6.1.1"</span>,</span><br><span class="line">    <span class="string">"gulp-cache"</span>: <span class="string">"^0.2.8"</span>,</span><br><span class="line">    <span class="string">"gulp-cssnano"</span>: <span class="string">"^2.0.0"</span>,</span><br><span class="line">    <span class="string">"gulp-eslint"</span>: <span class="string">"^0.13.2"</span>,</span><br><span class="line">    <span class="string">"gulp-htmlmin"</span>: <span class="string">"^1.3.0"</span>,</span><br><span class="line">    <span class="string">"gulp-if"</span>: <span class="string">"^1.2.5"</span>,</span><br><span class="line">    <span class="string">"gulp-imagemin"</span>: <span class="string">"^2.2.1"</span>,</span><br><span class="line">    <span class="string">"gulp-load-plugins"</span>: <span class="string">"^0.10.0"</span>,</span><br><span class="line">    <span class="string">"gulp-plumber"</span>: <span class="string">"^1.0.1"</span>,</span><br><span class="line">    <span class="string">"gulp-sass"</span>: <span class="string">"^2.0.0"</span>,</span><br><span class="line">    <span class="string">"gulp-size"</span>: <span class="string">"^1.2.1"</span>,</span><br><span class="line">    <span class="string">"gulp-sourcemaps"</span>: <span class="string">"^1.5.0"</span>,</span><br><span class="line">    <span class="string">"gulp-uglify"</span>: <span class="string">"^1.1.0"</span>,</span><br><span class="line">    <span class="string">"gulp-useref"</span>: <span class="string">"^3.0.0"</span>,</span><br><span class="line">    <span class="string">"main-bower-files"</span>: <span class="string">"^2.5.0"</span>,</span><br><span class="line">    <span class="string">"wiredep"</span>: <span class="string">"^2.2.2"</span></span><br><span class="line">  &#125;</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>执行</p>
                  <figure class="highlight cmake">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">npm <span class="keyword">install</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>安装所需要的库。 如此一来，所有的准备工作就差不多了。</p>
                  <h2 id="实战"><a href="#实战" class="headerlink" title="实战"></a>实战</h2>
                  <h3 id="引入类库"><a href="#引入类库" class="headerlink" title="引入类库"></a>引入类库</h3>
                  <p>首先引入一些必须的类库</p>
                  <figure class="highlight python">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">import</span> gulp <span class="keyword">from</span> <span class="string">'gulp'</span>;</span><br><span class="line"><span class="keyword">import</span> gulpLoadPlugins <span class="keyword">from</span> <span class="string">'gulp-load-plugins'</span>;</span><br><span class="line"><span class="keyword">import</span> browserSync <span class="keyword">from</span> <span class="string">'browser-sync'</span></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">del</span> <span class="keyword">from</span> <span class="string">'del'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;stream <span class="keyword">as</span> wiredep&#125; <span class="keyword">from</span> <span class="string">'wiredep'</span>;</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>gulp 自不必多说，是 gulp 必须的核心类库。 gulp-load-plugins 是加载 gulp 插件的类库，我们知道 gulp 插件非常丰富，如果要一个个引入的话，需要写很多很多条 import 语句，引入了这个插件之后，调用时只需要加 点(.) + 插件名称 那就可以使用了。 browser-sync 是浏览器同步工具，如果有代码更新，浏览器会自动刷新更新资源。 del 是删除资源的工具包。 wiredep 是从 bower 同步到 html 中资源引用的插件，bower 中定义了依赖包，有了它，这些包的引用比如 js，css 就可以直接自动生成到 html 文件中。 接着初始化一些变量。</p>
                  <figure class="highlight actionscript">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">const</span> $ = gulpLoadPlugins();</span><br><span class="line"><span class="keyword">const</span> reload = browserSync.reload;</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>将加载插件的插件初始化为 $ 符号，然后初始化 reload 等变量。</p>
                  <h3 id="Sass-编译"><a href="#Sass-编译" class="headerlink" title="Sass 编译"></a>Sass 编译</h3>
                  <p>下载好 Sass 源码之后，打开 assets/stylesheets 目录，可以看到 BootStrap 的 Sass 源代码。不过发现文件名都是 _ 开头的，这种类型的文件是不能被编译生成的，所以新建一个 bootstrap.sass 文件，内容为</p>
                  <figure class="highlight css">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">@import</span> <span class="string">"_bootstrap"</span>;</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>最后生成的目录结构如下</p>
                  <figure class="highlight 1c">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="string">|_____bootstrap-compass.scss</span></span><br><span class="line"><span class="string">|_____bootstrap-mincer.scss</span></span><br><span class="line"><span class="string">|_____bootstrap-sprockets.scss</span></span><br><span class="line"><span class="string">|_____bootstrap.scss</span></span><br><span class="line"><span class="string">|____bootstrap</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>接下来我们只需要编译 bootstrap.scss 即可。 定义一个路径配置</p>
                  <figure class="highlight ebnf">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="attribute">const styles</span> = &#123;</span><br><span class="line">    <span class="string">'in'</span>: <span class="string">'assets/stylesheets/**/*.scss'</span>,</span><br><span class="line">    <span class="string">'tmp'</span>: <span class="string">'.tmp/css'</span>,</span><br><span class="line">&#125;;</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>包含 in 和 tmp 目录，in 代表 Sass 源文件地址，tmp 代表生成的编译后的 CSS 目录。 接下来最重要的，指定一个 Gulp Task</p>
                  <figure class="highlight less">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="selector-tag">gulp</span><span class="selector-class">.task</span>(<span class="string">'styles'</span>, () =&gt; &#123;</span><br><span class="line">    <span class="selector-tag">return</span> <span class="selector-tag">gulp</span><span class="selector-class">.src</span>(styles.in)</span><br><span class="line">        <span class="selector-class">.pipe</span>($.plumber())</span><br><span class="line">        <span class="selector-class">.pipe</span>($.sourcemaps.init())</span><br><span class="line">        <span class="selector-class">.pipe</span>($.sass.sync(&#123;</span><br><span class="line">            <span class="attribute">outputStyle</span>: <span class="string">'expanded'</span>,</span><br><span class="line">            <span class="attribute">precision</span>: <span class="number">10</span>,</span><br><span class="line">            <span class="attribute">includePaths</span>: [<span class="string">'.'</span>]</span><br><span class="line">        &#125;).on(<span class="string">'error'</span>, $.sass.logError))</span><br><span class="line">        <span class="selector-class">.pipe</span>($.autoprefixer(&#123;<span class="attribute">browsers</span>: [<span class="string">'&gt; 1%'</span>, <span class="string">'last 2 versions'</span>, <span class="string">'Firefox ESR'</span>]&#125;))</span><br><span class="line">        <span class="selector-class">.pipe</span>($.sourcemaps.write())</span><br><span class="line">        <span class="selector-class">.pipe</span>(gulp.dest(styles.tmp))</span><br><span class="line">        <span class="selector-class">.pipe</span>(reload(&#123;<span class="attribute">stream</span>: true&#125;));</span><br><span class="line">&#125;);</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>task 是 gulp 的一个核心方法，定义了 styles 这个 task 之后，就可以执行</p>
                  <figure class="highlight ebnf">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="attribute">gulp styles</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>就可以完成以上定义的任务。 首先利用 gulp.src 引入了需要编译的 Sass 文件，然后利用一系列 pipe 流式管道来指定一系列处理任务。 plumber 是一个错误处理插件，当出现错误时，不会立即卡主，而是进入 plumber，防止程序运行终止。 sourcemaps 是用来生成映射文件的一个插件，map 文件记录了从 Sass 编译成 CSS 的过程中，每一行的 Sass 代码对应哪一行的 CSS 代码。 sass 是核心的编译 Sass 的插件，指定了输出格式 expanded，precision 指定了当输出十进制数字时，使用多少位的精度，然后指定了路径和错误日志。 autoprefixer 是一个以友好方式处理浏览器前缀的插件，比如一些 CSS 的定义会出现 -webkit- 等等，此插件是用来处理浏览器前缀的。</p>
                  <blockquote>
                    <p>Autoprefixer默认将支持主流浏览器最近2个版本，这点类似Google。不过你可以在自己的项目中通过名称或者模式进行选择： 主流浏览器最近2个版本用“last 2 versions”； 全球统计有超过1%的使用率使用“&gt;1%”; 仅新版本用“ff&gt;20”或”ff&gt;=20”. 然后Autoprefixer计算哪些前缀是需要的，哪些是已经过期的。</p>
                  </blockquote>
                  <p>dest 是输出编译后的文件，指定输出路径。 reload 是同步浏览器资源的方法。 定义好如上内容之后，命令行输入</p>
                  <figure class="highlight ebnf">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="attribute">gulp styles</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>就会发现出现了 .tmp 目录，里面有 css/bootstrap.css</p>
                  <h3 id="JavaScript-处理"><a href="#JavaScript-处理" class="headerlink" title="JavaScript 处理"></a>JavaScript 处理</h3>
                  <p>同理，定义一个 task，用来处理 JavaScript</p>
                  <figure class="highlight less">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="selector-tag">gulp</span><span class="selector-class">.task</span>(<span class="string">'scripts'</span>, () =&gt; &#123;</span><br><span class="line">    <span class="selector-tag">return</span> <span class="selector-tag">gulp</span><span class="selector-class">.src</span>(scripts.in)</span><br><span class="line">        <span class="selector-class">.pipe</span>($.plumber())</span><br><span class="line">        <span class="selector-class">.pipe</span>($.sourcemaps.init())</span><br><span class="line">        <span class="selector-class">.pipe</span>($.babel())</span><br><span class="line">        <span class="selector-class">.pipe</span>($.sourcemaps.write(<span class="string">'.'</span>))</span><br><span class="line">        <span class="selector-class">.pipe</span>(gulp.dest(scripts.tmp))</span><br><span class="line">        <span class="selector-class">.pipe</span>(reload(&#123;<span class="attribute">stream</span>: true&#125;));</span><br><span class="line">&#125;);</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>相比之下，此处多了一个 babel 插件。 babel 是基于 ES6 标准的一个 JavaScript 插件，它可以对 ES6 版本的代码进行转换，转换成 ES5 标准，避免出现出现 ES6 不兼容问题。 在此处还需要 scripts 的路径定义</p>
                  <figure class="highlight ebnf">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="attribute">const scripts</span> = &#123;</span><br><span class="line">    <span class="string">'in'</span>: <span class="string">'assets/javascripts/**/*.js'</span>,</span><br><span class="line">    <span class="string">'tmp'</span>: <span class="string">'.tmp/js'</span>,</span><br><span class="line">    <span class="string">'out'</span>: <span class="string">'dist/js'</span></span><br><span class="line">&#125;;</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>定义完成之后，执行</p>
                  <figure class="highlight ebnf">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="attribute">gulp scripts</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>就可以完成 JavaScript 的转换。 另外还有一个专门负责代码风格转换的 task，使用了 eslint 这个插件</p>
                  <figure class="highlight roboconf">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">const lint = &#123;</span><br><span class="line">    '<span class="attribute">in'</span>: 'assets/javascripts/**/*<span class="variable">.js</span>'</span><br><span class="line">&#125;;</span><br><span class="line"><span class="attribute">gulp.task('lint', () =&gt; &#123;</span></span><br><span class="line"><span class="attribute">    return gulp.src(lint.in)</span></span><br><span class="line"><span class="attribute">        .pipe(reload(&#123;stream</span>: true, once: true&#125;))</span><br><span class="line">        <span class="variable">.pipe</span>($<span class="variable">.eslint</span><span class="variable">.format</span>())</span><br><span class="line">        <span class="variable">.pipe</span>($<span class="variable">.if</span>(!browserSync<span class="variable">.active</span>, $<span class="variable">.eslint</span><span class="variable">.failAfterError</span>()));</span><br><span class="line">&#125;);</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>执行</p>
                  <figure class="highlight ebnf">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="attribute">gulp lint</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>之后，就可以进行代码风格的标准化。</p>
                  <h3 id="HTML处理"><a href="#HTML处理" class="headerlink" title="HTML处理"></a>HTML处理</h3>
                  <p>我们可以发现，在前面的输出路径都是 .tmp 临时目录，后面还会有一个目录是 dist 目录，试想一下，如果我们编译了 BootStrap 而在 HTML 中没有引用，那编译来还有必要吗？ 所以说，.tmp 作为临时目录，它可以存放被编译后的文件，但是不一定会被引用。被真正引用的文件才是真正有用的文件，我们将它放到 dist 目录。 所以接下来的 HTML 处理就是检查一下有哪些 CSS 和 JS 被引用了，可以将它们合并，然后将新的文件放到 dist 并更新它的引用路径。</p>
                  <figure class="highlight typescript">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">const</span> html = &#123;</span><br><span class="line">    <span class="string">'in'</span>: <span class="string">'assets/*.html'</span>,</span><br><span class="line">    <span class="string">'out'</span>: <span class="string">'dist'</span></span><br><span class="line">&#125;;</span><br><span class="line">gulp.task(<span class="string">'html'</span>, [<span class="string">'styles'</span>, <span class="string">'scripts'</span>], <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> gulp.src(html.in)</span><br><span class="line">        .pipe($.useref(&#123;searchPath: [<span class="string">'.tmp'</span>, <span class="string">'assets'</span>, <span class="string">'.'</span>]&#125;))</span><br><span class="line">        .pipe($.<span class="keyword">if</span>(<span class="string">'*.js'</span>, $.uglify()))</span><br><span class="line">        .pipe($.<span class="keyword">if</span>(<span class="string">'*.css'</span>, $.cssnano()))</span><br><span class="line">        .pipe($.<span class="keyword">if</span>(<span class="string">'*.html'</span>, $.htmlmin(&#123;collapseWhitespace: <span class="literal">true</span>&#125;)))</span><br><span class="line">        .pipe(gulp.dest(html.out));</span><br><span class="line">&#125;);</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>在这里定义了一个 task 叫做 html，第二个参数是 styles 和 scripts 组成的数组，意思是在执行这个 task 之前，首先要执行这两个任务。 在处理时用到了 useref 这个插件，它可以检测 HTML 中引用的 CSS 和 JS，可以执行合并和压缩，然后更新新的路径。 这个插件的作用如上所述。 比如 HTML 当前内容是这样的</p>
                  <figure class="highlight xml">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Welcome<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- bower:css --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- endbower --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- build:css css/combined.css --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">"../.tmp/css/bootstrap.css"</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- endbuild --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h4</span>&gt;</span>Hello This is a Gulp Sass Demo Configured by Germey.<span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- bower:js --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- endbower --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- build:js js/combined.js --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"javascripts/bootstrap.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"javascripts/bootstrap-sprockets.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- endbuild --&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>可以看到</p>
                  <figure class="highlight xml">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="comment">&lt;!-- build:css css/combined.css --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">href</span>=<span class="string">"../.tmp/css/bootstrap.css"</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- endbuild --&gt;</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>这里引用了 .tmp 目录下的 bootstrap.css，然后在外面用注释的形式定义了构建的路径和文件名。 那么执行这个任务之后，它便会将当前引用的 .tmp 目录下的 bootstrap.css 处理并输出为 combined.css，然后新生成的 HTML 文件的引用路径也相应改为 combined.css JS 也是同理</p>
                  <figure class="highlight xml">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="comment">&lt;!-- build:js js/combined.js --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"javascripts/bootstrap.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"javascripts/bootstrap-sprockets.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- endbuild --&gt;</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>在此处是将两个文件处理合并为 combined.js 执行</p>
                  <figure class="highlight ebnf">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="attribute">gulp html</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>后，会新生成一个 HTML 文件到 dist 目录，内容为</p>
                  <figure class="highlight xml">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Welcome<span class="tag">&lt;/<span class="name">title</span>&gt;</span><span class="comment">&lt;!-- bower:css --&gt;</span><span class="comment">&lt;!-- endbower --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">href</span>=<span class="string">"css/combined.css"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span><span class="tag">&lt;<span class="name">h4</span>&gt;</span>Hello This is a Gulp Sass Demo Configured by Germey.<span class="tag">&lt;/<span class="name">h4</span>&gt;</span><span class="tag">&lt;/<span class="name">body</span>&gt;</span><span class="comment">&lt;!-- bower:js --&gt;</span><span class="comment">&lt;!-- endbower --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"js/combined.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>dist 的目录结构为</p>
                  <figure class="highlight gherkin">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">|<span class="string">____css</span></span><br><span class="line">|<span class="string"> </span>|<span class="string">____combined.css</span></span><br><span class="line">|<span class="string">____index.html</span></span><br><span class="line">|____js</span><br><span class="line">|<span class="string"> </span>|<span class="string">____combined.js</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>以上为利用 useref 插件进行 HTML 处理的过程。</p>
                  <h3 id="图片压缩处理"><a href="#图片压缩处理" class="headerlink" title="图片压缩处理"></a>图片压缩处理</h3>
                  <p>接下来是对图片字体及其他格式文件的处理。 图片的主要处理是进行压缩</p>
                  <figure class="highlight typescript">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">const</span> images = &#123;</span><br><span class="line">    <span class="string">'in'</span>: <span class="string">'assets/images/**/*'</span>,</span><br><span class="line">    <span class="string">'out'</span>: <span class="string">'dist/images'</span></span><br><span class="line">&#125;;</span><br><span class="line">gulp.task(<span class="string">'images'</span>, <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> gulp.src(images.in)</span><br><span class="line">        .pipe($.imagemin(&#123;</span><br><span class="line">            progressive: <span class="literal">true</span>,</span><br><span class="line">            interlaced: <span class="literal">true</span>,</span><br><span class="line">            svgoPlugins: [&#123;cleanupIDs: <span class="literal">false</span>&#125;]</span><br><span class="line">        &#125;))</span><br><span class="line">        .pipe(gulp.dest(images.out));</span><br><span class="line">&#125;);</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>定义好了 images 的输入和输出路径之后，定义 images 这个 task，在这里使用了 imagemin 这个插件 imagemin 插件是用来压缩图片的插件，处理后图片的占用空间会变小。 执行</p>
                  <figure class="highlight ebnf">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="attribute">gulp images</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>即可完成对图片的压缩</p>
                  <h3 id="字体处理"><a href="#字体处理" class="headerlink" title="字体处理"></a>字体处理</h3>
                  <p>字体的处理，筛选出某些特定格式的字体，输出到指定目录</p>
                  <figure class="highlight php">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">const</span> fonts = &#123;</span><br><span class="line">    <span class="string">'in'</span>: [<span class="string">'assets/fonts/bootstrap/*'</span>],</span><br><span class="line">    <span class="string">'tmp'</span>: <span class="string">'.tmp/fonts'</span>,</span><br><span class="line">    <span class="string">'out'</span>: <span class="string">'dist/fonts'</span></span><br><span class="line">&#125;;</span><br><span class="line">gulp.task(<span class="string">'fonts'</span>, () =&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> gulp.src(<span class="keyword">require</span>(<span class="string">'main-bower-files'</span>)(<span class="string">'**/*.&#123;eot,svg,ttf,woff,woff2&#125;'</span>, <span class="function"><span class="keyword">function</span><span class="params">(err)</span> </span>&#123;</span><br><span class="line">    &#125;)</span><br><span class="line">        .concat(fonts.in))</span><br><span class="line">        .pipe(gulp.dest(fonts.tmp))</span><br><span class="line">        .pipe(gulp.dest(fonts.out));</span><br><span class="line">&#125;);</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>执行</p>
                  <figure class="highlight ebnf">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="attribute">gulp fonts</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>即可完成字体的处理</p>
                  <h3 id="额外文件处理"><a href="#额外文件处理" class="headerlink" title="额外文件处理"></a>额外文件处理</h3>
                  <p>在项目中还存在非 HTML 的文件，比如 视频，音频，PHP等。这些做一下统一判断然后归档即可。</p>
                  <figure class="highlight coffeescript">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">const extras = &#123;</span><br><span class="line">    <span class="string">'in'</span>: [</span><br><span class="line">        <span class="string">'assets/*.*'</span>,</span><br><span class="line">        <span class="string">'!assets/*.html'</span></span><br><span class="line">    ],</span><br><span class="line">    <span class="string">'out'</span>: <span class="string">'dist'</span></span><br><span class="line">&#125;;</span><br><span class="line">gulp.task(<span class="string">'extras'</span>, <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> gulp.src(extras.<span class="keyword">in</span>, &#123;</span><br><span class="line">        dot: <span class="literal">true</span></span><br><span class="line">    &#125;).pipe(gulp.dest(extras.out));</span><br><span class="line">&#125;);</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>其中 in 指定了在 asset 目录中除 html 后缀的文件，此处进行读入筛选，然后输出到指定路径即可。 执行</p>
                  <figure class="highlight ebnf">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="attribute">gulp extras</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>即可完成额外文件的处理</p>
                  <h3 id="文件依赖处理"><a href="#文件依赖处理" class="headerlink" title="文件依赖处理"></a>文件依赖处理</h3>
                  <p>设想一个情景，一个项目需要很多很多依赖库，我们在 bower.json 中定义好了所有的依赖，使用 bower 将他们下载了下来，如果我们需要在 HTML 中引用他们，如果我们还是手动地添加一个个引用那是不是太麻烦了？ 没错，这个操作同样可以自动化操作，借助 wiredep 插件即可。</p>
                  <figure class="highlight typescript">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">const</span> wire = &#123;</span><br><span class="line">    <span class="string">'in'</span>: <span class="string">'assets/*.html'</span>,</span><br><span class="line">    <span class="string">'out'</span>: <span class="string">'dist'</span></span><br><span class="line">&#125;;</span><br><span class="line">gulp.task(<span class="string">'wiredep'</span>, <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    gulp.src(wire.in)</span><br><span class="line">        .pipe(wiredep(&#123;</span><br><span class="line">            ignorePath: <span class="regexp">/^(\.\.\/)*\.\./</span></span><br><span class="line">        &#125;))</span><br><span class="line">        .pipe($.useref(&#123;searchPath: [<span class="string">'.tmp'</span>, <span class="string">'assets'</span>, <span class="string">'.'</span>]&#125;))</span><br><span class="line">        .pipe($.<span class="keyword">if</span>(<span class="string">'*.js'</span>, $.uglify()))</span><br><span class="line">        .pipe($.<span class="keyword">if</span>(<span class="string">'*.css'</span>, $.cssnano()))</span><br><span class="line">        .pipe(gulp.dest(wire.out));</span><br><span class="line">&#125;);</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>在这里使用了 wiredep 插件。 在 HTML中定义如下内容</p>
                  <figure class="highlight xml">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="comment">&lt;!-- bower:js --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- endbower --&gt;</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>执行</p>
                  <figure class="highlight ebnf">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="attribute">gulp wiredep</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>之后，便会自动更新 bower.json 中所有依赖库的引用，在这里以 JS 为例子。 当前在 bower.json 中定义了</p>
                  <figure class="highlight 1c">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="string">"dependencies"</span>: &#123;</span><br><span class="line">    <span class="string">"jquery"</span>: <span class="string">"&gt;= 1.9.0"</span></span><br><span class="line">  &#125;</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>执行完毕之后，HTML中便有了</p>
                  <figure class="highlight xml">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="comment">&lt;!-- bower:js --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"/bower_components/jquery/dist/jquery.js"</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- endbower --&gt;</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>路径会随之更新。</p>
                  <h3 id="服务器"><a href="#服务器" class="headerlink" title="服务器"></a>服务器</h3>
                  <p>最后是一个 serve 的 task 在本地搭建一个服务器来测试，同时监听文件的变动随时更新资源文件。</p>
                  <figure class="highlight pgsql">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">const serve = &#123;</span><br><span class="line">    <span class="string">'baseDir'</span>: [<span class="string">'.tmp'</span>, <span class="string">'assets'</span>],</span><br><span class="line">    <span class="string">'baseDirDist'</span>: [<span class="string">'dist'</span>],</span><br><span class="line">    <span class="string">'routes'</span>: &#123;</span><br><span class="line">        <span class="string">'/bower_components'</span>: <span class="string">'bower_components'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">'port'</span>: <span class="number">9000</span></span><br><span class="line">&#125;;</span><br><span class="line">gulp.task(<span class="string">'serve'</span>, [<span class="string">'styles'</span>, <span class="string">'scripts'</span>, <span class="string">'fonts'</span>, <span class="string">'wiredep'</span>], () =&gt; &#123;</span><br><span class="line">    browserSync(&#123;</span><br><span class="line">        <span class="keyword">notify</span>: <span class="keyword">false</span>,</span><br><span class="line">        port: serve.port,</span><br><span class="line">        <span class="keyword">server</span>: &#123;</span><br><span class="line">            baseDir: serve.baseDir,</span><br><span class="line">            routes: serve.routes</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    gulp.watch([</span><br><span class="line">        html.<span class="keyword">out</span>, scripts.tmp, scripts.<span class="keyword">out</span>, images.<span class="keyword">out</span>, fonts.tmp, fonts.<span class="keyword">out</span></span><br><span class="line">    ]).<span class="keyword">on</span>(<span class="string">'change'</span>, reload);</span><br><span class="line">    gulp.watch(styles.<span class="keyword">in</span>, [<span class="string">'styles'</span>]);</span><br><span class="line">    gulp.watch(scripts.<span class="keyword">in</span>, [<span class="string">'scripts'</span>]);</span><br><span class="line">    gulp.watch(fonts.<span class="keyword">in</span>, [<span class="string">'fonts'</span>]);</span><br><span class="line">    gulp.watch(<span class="string">'bower.json'</span>, [<span class="string">'wiredep'</span>, <span class="string">'fonts'</span>]);</span><br><span class="line">&#125;);</span><br><span class="line">gulp.task(<span class="string">'serve:dist'</span>, () =&gt; &#123;</span><br><span class="line">    browserSync(&#123;</span><br><span class="line">        <span class="keyword">notify</span>: <span class="keyword">false</span>,</span><br><span class="line">        port: serve.port,</span><br><span class="line">        <span class="keyword">server</span>: &#123;</span><br><span class="line">            baseDir: serve.baseDirDist</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;);</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>上述 serve 首先要执行 styles, scripts, fonts, wiredep 的操作，然后在 9000 端口上运行。 同时利用 watch 方法监听文件的变动，随时更新。</p>
                  <h3 id="删除和一键构建"><a href="#删除和一键构建" class="headerlink" title="删除和一键构建"></a>删除和一键构建</h3>
                  <p>最后还有清理构建文件和一键构建的功能。 清理 task 叫做 clean。</p>
                  <figure class="highlight gradle">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">gulp.<span class="keyword">task</span>(<span class="string">'clean'</span>, del.bind(<span class="keyword">null</span>, [<span class="string">'.tmp'</span>, <span class="string">'dist'</span>]));</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>即将 .tmp 和 dist 目录进行清理。 一键构建就是执行其他所有操作，将所有操作汇总。</p>
                  <figure class="highlight coffeescript">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">const build = &#123;</span><br><span class="line">    <span class="string">'in'</span>: <span class="string">'dist/**/*'</span></span><br><span class="line">&#125;;</span><br><span class="line">gulp.task(<span class="string">'build'</span>, [<span class="string">'lint'</span>, <span class="string">'html'</span>, <span class="string">'images'</span>, <span class="string">'fonts'</span>, <span class="string">'extras'</span>], <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> gulp.src(build.<span class="keyword">in</span>).pipe($.size(&#123;title: <span class="string">'build'</span>, gzip: <span class="literal">true</span>&#125;));</span><br><span class="line">&#125;);</span><br><span class="line">gulp.task(<span class="string">'default'</span>, [<span class="string">'clean'</span>], <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    gulp.start(<span class="string">'build'</span>);</span><br><span class="line">&#125;);</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>最后执行了一个总的压缩汇总，</p>
                  <h2 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h2>
                  <p>以上便是利用 Gulp 编译 Bootstrap-Sass 的全部过程。 整个项目的代码如下 <a href="https://github.com/Germey/GulpBootStrapSass" target="_blank" rel="noopener">GulpBootstrapSass</a> 如果有问题，欢迎留言交流，希望对大家有帮助！</p>
                  </p>
                </div>
              </div>
              <div class="post-meta">
                <span class="post-meta-item">
                  <span class="post-meta-item-icon">
                    <i class="far fa-user"></i>
                  </span>
                  <span class="post-meta-item-text">作者</span>
                  <span><a href="/authors/崔庆才" class="author" itemprop="url" rel="index">崔庆才</a></span>
                </span>
                <span class="post-meta-item">
                  <span class="post-meta-item-icon">
                    <i class="far fa-calendar"></i>
                  </span>
                  <span class="post-meta-item-text">发表于</span>
                  <time title="创建时间：2016-07-04 00:23:02" itemprop="dateCreated datePublished" datetime="2016-07-04T00:23:02+08:00">2016-07-04</time>
                </span>
                <span id="/2906.html" class="post-meta-item leancloud_visitors" data-flag-title="基于ES6利用Gulp编译BootStrap-Sass源码" title="阅读次数">
                  <span class="post-meta-item-icon">
                    <i class="fa fa-eye"></i>
                  </span>
                  <span class="post-meta-item-text">阅读次数：</span>
                  <span class="leancloud-visitors-count"></span>
                </span>
                <span class="post-meta-item" title="本文字数">
                  <span class="post-meta-item-icon">
                    <i class="far fa-file-word"></i>
                  </span>
                  <span class="post-meta-item-text">本文字数：</span>
                  <span>12k</span>
                </span>
                <span class="post-meta-item" title="阅读时长">
                  <span class="post-meta-item-icon">
                    <i class="far fa-clock"></i>
                  </span>
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                  <span>11 分钟</span>
                </span>
              </div>
            </article>
            <article itemscope itemtype="http://schema.org/Article" class="post-block index" lang="zh-CN">
              <link itemprop="mainEntityOfPage" href="https://cuiqingcai.com/2852.html">
              <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
                <meta itemprop="image" content="/images/avatar.png">
                <meta itemprop="name" content="崔庆才">
                <meta itemprop="description" content="崔庆才的个人站点，记录生活的瞬间，分享学习的心得。">
              </span>
              <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
                <meta itemprop="name" content="静觅">
              </span>
              <header class="post-header">
                <h2 class="post-title" itemprop="name headline">
                  <a class="label"> Python <i class="label-arrow"></i>
                  </a>
                  <a href="/2852.html" class="post-title-link" itemprop="url">Python爬虫实战八之利用Selenium抓取淘宝匿名旺旺</a>
                </h2>
              </header>
              <div class="post-body" itemprop="articleBody">
                <div class="thumb">
                  <img itemprop="contentUrl" class="random">
                </div>
                <div class="excerpt">
                  <p>
                  <h2 id="更新"><a href="#更新" class="headerlink" title="更新"></a>更新</h2>
                  <p>其实本文的初衷是为了获取淘宝的非匿名旺旺，在淘宝详情页的最下方有相关评论，含有非匿名旺旺号，快一年了淘宝都没有修复这个。 可就在今天，淘宝把所有的账号设置成了匿名显示，SO，获取非匿名旺旺号已经不可能了。那本节就带大家抓取匿名旺旺号熟悉一下Selenium吧。</p>
                  <p>2016/7/1</p>
                  <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2>
                  <p>嗯，淘宝，它一直是个难搞的家伙。 而且买家在买宝贝的时候大多数都是匿名评论的，大家都知道非匿名评论是非常有用的，比如对于大数据分析，分析某个宝贝的购买用户星级状况等等。 现在已经不能获取非匿名了，此句已没有意义了。 对于抓淘宝，相信尝试过的童鞋都能体会到抓取它到艰辛，最简单的方法莫过于模拟浏览器了，本节我们就讲解一下利用 Selenium 抓取淘宝评论的方法。 项目提供了如下功能：</p>
                  <ul>
                    <li>输入淘宝关键字采集淘宝链接并写入到文件</li>
                    <li>从文件读取链接，执行评论采集</li>
                    <li>将评论和旺旺号保存到Excel中</li>
                    <li>记录当前采集链接索引，保存进度</li>
                  </ul>
                  <h2 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h2>
                  <p>在开始本节之前 你需要了解一些基础知识，我们需要用到 Selenium 这个东西，详情请看 <a href="http://cuiqingcai.com/2599.html">Selenium用法</a> 我们首先讲解一下你需要做怎样的配置。 首先你需要安装 Python，版本是2.7 然后需要安装的 Python 类库。</p>
                  <figure class="highlight armasm">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="symbol">pip</span> install pyquery <span class="keyword">selenium </span>twisted requests xlrd xlwt xlutils</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>安装浏览器 Chrome，安装浏览器 Chrome，安装浏览器Chrome。 然后下载ChromeDriver，ChromeDriver是驱动浏览器的工具，需要把它配置到环境变量里。 有的童鞋说，为什么不用 PhantomJS，因为为了防止淘宝禁掉我们，需要登录淘宝账号，登录过程可能会出现奇奇怪怪得验证码，滚动条，手机验证，如果用 PhantomJS 的话不方便操作，所以在这里我们就使用 Chrome 了。 <a href="http://chromedriver.storage.googleapis.com/index.html?path=2.7/" target="_blank" rel="noopener">ChromeDriver</a> 上面是 ChromeDriver 的下载地址，谷歌都上得了，这个不在话下吧，这是最官方的版本，其他链接请自行搜索。 找到对应平台的 ChromeDriver，解压后将可执行文件配置到环境变量里，配置到环境变量里，配置到环境变量里！重要的话说三遍。</p>
                  <h2 id="流程简述"><a href="#流程简述" class="headerlink" title="流程简述"></a>流程简述</h2>
                  <p>首先我们拿一个例子来演示一下全过程。 随意打开天猫一个链接 <a href="https://world.tmall.com/item/45262540681.htm?spm=a220m.1000858.1000725.110.r7oyq2&amp;id=45262540681&amp;skuId=85225485607&amp;areaId=320700&amp;cat_id=50025145&amp;rn=6f644caecfa85abefea71e2dc48ac6ae&amp;user_id=2148264599&amp;is_b=1" target="_blank" rel="noopener">示例链接</a> 我们首先观察一下评论，可以发现所有的评论都是匿名的。即使这个用户不是匿名评论的，那也会显示匿名，淘宝这保密做的挺好。 <a href="http://qiniu.cuiqingcai.com/wp-content/uploads/2016/06/QQ20160630-1@2x.png" target="_blank" rel="noopener"><img src="http://qiniu.cuiqingcai.com/wp-content/uploads/2016/06/QQ20160630-1@2x-825x1024.png" alt="QQ20160630-1@2x"></a> 心机的淘宝啊，那我们如果想获取一些旺旺号该咋办？ 接下来我们返回宝贝详情页面，然后一直下拉下拉，拉到最最后，可以看到有个“看了又看”板块。 <a href="http://qiniu.cuiqingcai.com/wp-content/uploads/2016/06/QQ20160630-0@2x.png" target="_blank" rel="noopener"><img src="http://qiniu.cuiqingcai.com/wp-content/uploads/2016/06/QQ20160630-0@2x-765x1024.png" alt="QQ20160630-0@2x"></a> 有没有！！发现了新大陆，这是什么？这是此宝贝相关宝贝以及它的一些评论。 看到了有非匿名用户了，哈哈哈，淘宝加密了评论，推荐部分却没有加密。 嗯，就从这里，我们把它们的旺旺号都抓下来，顺便把评论和购买的宝贝抓下来。 现在已经全部改成了匿名，上述话已经无意义了。 那么抓取完之后，保存到哪里呢？为了便于管理和统计，在这里保存到 Excel 中，那么就需要用到 xlrd, xlwt, xlutils 等库。 嗯，动机就是这样。</p>
                  <h2 id="实战爬取"><a href="#实战爬取" class="headerlink" title="实战爬取"></a>实战爬取</h2>
                  <h3 id="抓取过程"><a href="#抓取过程" class="headerlink" title="抓取过程"></a>抓取过程</h3>
                  <p>首先我们观察这个链接，在最初的时候，其实网页并没有加载最下方的“看了又看”内容的，慢慢往下滑动网页，滑到最下方之后，才发现看了又看页面才慢慢加载出来。 很明显，这个地方使用了Ajax，由于我们用的是 Selenium，所以这里我们不能直接来模拟 Ajax 的 Request，需要我们来模拟真实的用户操作。 所以我们要模拟的就是，在网页部分加载出来之后，模拟浏览器滑动到下方，使“看了又看”内容显示出来，然后获取网页源代码，解析之即可。 那么在这里就出现了两个至关重要的点，一个是判断网页框架大体加载出来，另一个是模拟滑动直到最下方的内容加载出来。 首先，我们解决第一个问题，怎样判断网页框架大体加载出来。我们可以用网页中的某个元素的出现与否来判断。 比如 <a href="http://qiniu.cuiqingcai.com/wp-content/uploads/2016/06/QQ20160630-2@2x.png" target="_blank" rel="noopener"><img src="http://qiniu.cuiqingcai.com/wp-content/uploads/2016/06/QQ20160630-2@2x-1024x254.png" alt="QQ20160630-2@2x"></a> 这一部分是否加载出来。 审查一下代码，ID叫做 J_TabBarBox，好，那就用它来作为网页初步加载成功的标志。 在 Selenium 中，我们用显式等待的方法来判断该元素是否已经加载成功。</p>
                  <figure class="highlight python">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    driver.get(url)</span><br><span class="line">    WebDriverWait(driver, timeout).until(</span><br><span class="line">        EC.presence_of_element_located((By.ID, <span class="string">"J_TabBarBox"</span>))</span><br><span class="line">    )</span><br><span class="line"><span class="keyword">except</span> TimeoutException:</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"><span class="keyword">if</span> is_recommends_appear(driver, max_scroll_time):</span><br><span class="line">    <span class="keyword">print</span> <span class="string">u'已经成功加载出下方橱窗推荐宝贝信息'</span></span><br><span class="line">    <span class="keyword">return</span> driver.page_source</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>接下来我们需要模拟下拉浏览器，不妨直接下拉到底部，再从底部向上拉，可能需要下拉多次，所以在这里定义了一个下拉次数，那么判断“看了又看”正文内容是否出现依然可以用显式等待的方法。 浏览器审查元素发现它的选择器是 #J_TjWaterfall li <a href="http://qiniu.cuiqingcai.com/wp-content/uploads/2016/06/QQ20160630-3@2x.png" target="_blank" rel="noopener"><img src="http://qiniu.cuiqingcai.com/wp-content/uploads/2016/06/QQ20160630-3@2x-1024x771.png" alt="QQ20160630-3@2x"></a> 那么可以用如下方法来判断是否加载成功</p>
                  <figure class="highlight python">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    driver.find_element_by_css_selector(<span class="string">'#J_TjWaterfall li'</span>)</span><br><span class="line"><span class="keyword">except</span> NoSuchElementException:</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"><span class="keyword">return</span> <span class="literal">True</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>下拉过程可以用执行 JavaScript 的方法实现。</p>
                  <figure class="highlight sqf">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">js = <span class="string">"window.scrollTo(0,document.body.scrollHeight-"</span> + <span class="built_in">str</span>(<span class="built_in">count</span> * <span class="built_in">count</span>* <span class="number">200</span>) + <span class="string">")"</span></span><br><span class="line"><span class="built_in">driver</span>.execute_script(js)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>其中 count 是下拉的次数，经过测试之后，每次拉动距离和 count 是平方关系比较科学，具体不再描述，当然你可以改成自己想要的数值。 嗯，加载出来之后，就可以用</p>
                  <figure class="highlight css">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="selector-tag">driver</span><span class="selector-class">.page_source</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>来获取网页源代码了 用 pyquery 解析即可。</p>
                  <figure class="highlight sqf">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">doc = pq(html)</span><br><span class="line"><span class="built_in">items</span> = doc(<span class="string">'#J_TjWaterfall &gt; li'</span>)</span><br><span class="line">print u<span class="string">'分析得到下方宝贝中的用户评论:'</span></span><br><span class="line"><span class="keyword">for</span> item <span class="built_in">in</span> <span class="built_in">items</span>.<span class="built_in">items</span>():</span><br><span class="line">    url = item.<span class="built_in">find</span>(<span class="string">'a'</span>).attr(<span class="string">'href'</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">not</span> url.startswith(<span class="string">'http'</span>):</span><br><span class="line">        url = <span class="string">'https:'</span> + url</span><br><span class="line">    comments_info = []</span><br><span class="line">    comments = item.<span class="built_in">find</span>(<span class="string">'p'</span>).<span class="built_in">items</span>()</span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">comment</span> <span class="built_in">in</span> comments:</span><br><span class="line">        comment_user = <span class="built_in">comment</span>.<span class="built_in">find</span>(<span class="string">'b'</span>).remove().<span class="built_in">text</span>()</span><br><span class="line">        comment_content = <span class="built_in">comment</span>.<span class="built_in">text</span>()</span><br><span class="line">        anonymous_str = config.ANONYMOUS_STR</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">not</span> anonymous_str <span class="built_in">in</span> comment_user:   ＃此句本来用来判断是否匿名，现淘宝已修复该漏洞，只能抓取全部匿名的了</span><br><span class="line">            comments_info.<span class="built_in">append</span>((comment_content, comment_user))</span><br><span class="line">    info.<span class="built_in">append</span>(&#123;<span class="string">'url'</span>: url, <span class="string">'comments_info'</span>: comments_info&#125;)</span><br><span class="line">return info</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>然后保存到 Excel 中。 运行结果截图 <a href="http://qiniu.cuiqingcai.com/wp-content/uploads/2016/06/QQ20160630-7@2x.png" target="_blank" rel="noopener"><img src="http://qiniu.cuiqingcai.com/wp-content/uploads/2016/06/QQ20160630-7@2x-1024x644.png" alt="QQ20160630-7@2x"></a> 可以发现，另外提供了先登陆后爬取的功能，然后保存了爬取进度。</p>
                  <h3 id="采集链接"><a href="#采集链接" class="headerlink" title="采集链接"></a>采集链接</h3>
                  <p>刚才我们测试的链接是哪里来的？我们不能一个个去找吧？所以，在这里又提供了一个采集链接的过程，将采集的链接保存到文本，然后抓取的时候从文本读取一个个链接即可。 所以在这里我们模拟搜索的过程，关键字让用户输入，将搜索的链接采集下来。 在此 Selenium 模拟了输入文字，点击按钮和翻页的功能。 <a href="http://qiniu.cuiqingcai.com/wp-content/uploads/2016/06/QQ20160630-4@2x.png" target="_blank" rel="noopener"><img src="http://qiniu.cuiqingcai.com/wp-content/uploads/2016/06/QQ20160630-4@2x-1024x789.png" alt="QQ20160630-4@2x"></a> 核心代码如下 下面的方法模拟了加载出搜索框之后输入文字点击回车的过程，将网页的结果返回。</p>
                  <figure class="highlight python">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_results</span><span class="params">(keyword)</span>:</span></span><br><span class="line">    driver = config.DRIVER</span><br><span class="line">    link = config.SEARCH_LINK</span><br><span class="line">    driver.get(link)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        WebDriverWait(driver, config.TIMEOUT).until(</span><br><span class="line">            EC.presence_of_element_located((By.ID, <span class="string">"mq"</span>))</span><br><span class="line">        )</span><br><span class="line">    <span class="keyword">except</span> TimeoutException:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">u'加载页面失败'</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        element = driver.find_element_by_css_selector(<span class="string">'#mq'</span>)</span><br><span class="line">        <span class="keyword">print</span> <span class="string">u'成功找到了搜索框'</span></span><br><span class="line">        keyword = keyword.decode(<span class="string">'utf-8'</span>, <span class="string">'ignore'</span>)</span><br><span class="line">        <span class="keyword">print</span> keyword</span><br><span class="line">        <span class="keyword">print</span> <span class="string">u'输入关键字'</span>, keyword</span><br><span class="line">        <span class="keyword">for</span> word <span class="keyword">in</span> keyword:</span><br><span class="line">            <span class="keyword">print</span> word</span><br><span class="line">            element.send_keys(word)</span><br><span class="line">        element.send_keys(Keys.ENTER)</span><br><span class="line">    <span class="keyword">except</span> NoSuchElementException:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">u'没有找到搜索框'</span></span><br><span class="line">    <span class="keyword">print</span> <span class="string">u'正在查询该关键字'</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        WebDriverWait(driver, config.TIMEOUT).until(</span><br><span class="line">            EC.presence_of_element_located((By.CSS_SELECTOR, <span class="string">"#J_ItemList div.productImg-wrap"</span>))</span><br><span class="line">        )</span><br><span class="line">    <span class="keyword">except</span> TimeoutException:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">u'查询失败'</span></span><br><span class="line">    html = driver.page_source</span><br><span class="line">    <span class="keyword">return</span> html</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>下面的方法模拟了翻页的过程，到指定的翻页数目为止</p>
                  <figure class="highlight python">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_more_link</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">print</span> <span class="string">u'正在采集下一页的宝贝链接'</span></span><br><span class="line">    driver = config.DRIVER</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        js = <span class="string">"window.scrollTo(0,document.body.scrollHeight)"</span></span><br><span class="line">        driver.execute_script(js)</span><br><span class="line">    <span class="keyword">except</span> WebDriverException:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">u'页面下拉失败'</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        next = driver.find_element_by_css_selector(<span class="string">'#content b.ui-page-num &gt; a.ui-page-next'</span>)</span><br><span class="line">        next.click()</span><br><span class="line">    <span class="keyword">except</span> NoSuchElementException:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">u'找到了翻页按钮'</span></span><br><span class="line">    driver.implicitly_wait(<span class="number">5</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        WebDriverWait(driver, config.TIMEOUT).until(</span><br><span class="line">            EC.presence_of_element_located((By.CSS_SELECTOR, <span class="string">"#J_ItemList div.productImg-wrap"</span>))</span><br><span class="line">        )</span><br><span class="line">    <span class="keyword">except</span> TimeoutException:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">u'查询失败'</span></span><br><span class="line">    html = driver.page_source</span><br><span class="line">    parse_html(html)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>运行结果截图 <a href="http://qiniu.cuiqingcai.com/wp-content/uploads/2016/06/QQ20160630-5@2x.png" target="_blank" rel="noopener"><img src="http://qiniu.cuiqingcai.com/wp-content/uploads/2016/06/QQ20160630-5@2x-608x1024.png" alt="QQ20160630-5@2x"></a> 采集到到内容保存到 urls.txt 中 <a href="http://qiniu.cuiqingcai.com/wp-content/uploads/2016/06/QQ20160630-6@2x.png" target="_blank" rel="noopener"><img src="http://qiniu.cuiqingcai.com/wp-content/uploads/2016/06/QQ20160630-6@2x-1024x484.png" alt="QQ20160630-6@2x"></a> 嗯，这下采集链接和爬取链接都有了。</p>
                  <h2 id="代码放送"><a href="#代码放送" class="headerlink" title="代码放送"></a>代码放送</h2>
                  <p>扯了这么多，许多童鞋已经蠢蠢欲动了，大声告诉我你们想要的是什么？ 哦没错！代码！ 嗯在这呢！ <a href="https://github.com/Germey/TaobaoUser" target="_blank" rel="noopener">代码</a></p>
                  <h2 id="附加扯淡"><a href="#附加扯淡" class="headerlink" title="附加扯淡"></a>附加扯淡</h2>
                  <p>嗯想说一句，在这里还提供了一些可配置项，比如翻页最大次数，超时时间，下拉次数，登录链接等等。 都可以在 config.py 中配置。</p>
                  <blockquote>
                    <ul>
                      <li>URLS_FILE</li>
                    </ul>
                    <p>保存链接单的文件</p>
                    <ul>
                      <li>OUT_FILE</li>
                    </ul>
                    <p>输出文本EXCEL路径</p>
                    <ul>
                      <li>COUNT_TXT</li>
                    </ul>
                    <p>计数文件</p>
                    <ul>
                      <li>DRIVER</li>
                    </ul>
                    <p>浏览器驱动</p>
                    <ul>
                      <li>TIMEOUT</li>
                    </ul>
                    <p>采集超时时间</p>
                    <ul>
                      <li>MAX_SCROLL_TIME</li>
                    </ul>
                    <p>下拉滚动条最大次数</p>
                    <ul>
                      <li>NOW_URL_COUNT</li>
                    </ul>
                    <p>当前采集到第几个链接</p>
                    <ul>
                      <li>LOGIN_URL</li>
                    </ul>
                    <p>登录淘宝的链接</p>
                    <ul>
                      <li>SEARCH_LINK</li>
                    </ul>
                    <p>采集淘宝链接搜索页面</p>
                    <ul>
                      <li>CONTENT</li>
                    </ul>
                    <p>采集链接临时变量</p>
                    <ul>
                      <li>PAGE</li>
                    </ul>
                    <p>采集淘宝链接翻页数目</p>
                    <ul>
                      <li>FILTER_SHOP</li>
                    </ul>
                    <p>是否过滤相同店铺</p>
                    <ul>
                      <li>ANONYMOUS_STR</li>
                    </ul>
                    <p>匿名用户标志，已失效</p>
                  </blockquote>
                  <p>哦，对了，程序怎么用啊？看 README！</p>
                  </p>
                </div>
              </div>
              <div class="post-meta">
                <span class="post-meta-item">
                  <span class="post-meta-item-icon">
                    <i class="far fa-user"></i>
                  </span>
                  <span class="post-meta-item-text">作者</span>
                  <span><a href="/authors/崔庆才" class="author" itemprop="url" rel="index">崔庆才</a></span>
                </span>
                <span class="post-meta-item">
                  <span class="post-meta-item-icon">
                    <i class="far fa-calendar"></i>
                  </span>
                  <span class="post-meta-item-text">发表于</span>
                  <time title="创建时间：2016-06-30 01:06:33" itemprop="dateCreated datePublished" datetime="2016-06-30T01:06:33+08:00">2016-06-30</time>
                </span>
                <span id="/2852.html" class="post-meta-item leancloud_visitors" data-flag-title="Python爬虫实战八之利用Selenium抓取淘宝匿名旺旺" title="阅读次数">
                  <span class="post-meta-item-icon">
                    <i class="fa fa-eye"></i>
                  </span>
                  <span class="post-meta-item-text">阅读次数：</span>
                  <span class="leancloud-visitors-count"></span>
                </span>
                <span class="post-meta-item" title="本文字数">
                  <span class="post-meta-item-icon">
                    <i class="far fa-file-word"></i>
                  </span>
                  <span class="post-meta-item-text">本文字数：</span>
                  <span>5k</span>
                </span>
                <span class="post-meta-item" title="阅读时长">
                  <span class="post-meta-item-icon">
                    <i class="far fa-clock"></i>
                  </span>
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                  <span>5 分钟</span>
                </span>
              </div>
            </article>
            <article itemscope itemtype="http://schema.org/Article" class="post-block index" lang="zh-CN">
              <link itemprop="mainEntityOfPage" href="https://cuiqingcai.com/2817.html">
              <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
                <meta itemprop="image" content="/images/avatar.png">
                <meta itemprop="name" content="崔庆才">
                <meta itemprop="description" content="崔庆才的个人站点，记录生活的瞬间，分享学习的心得。">
              </span>
              <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
                <meta itemprop="name" content="静觅">
              </span>
              <header class="post-header">
                <h2 class="post-title" itemprop="name headline">
                  <a class="label"> Other <i class="label-arrow"></i>
                  </a>
                  <a href="/2817.html" class="post-title-link" itemprop="url">Appium学习笔记</a>
                </h2>
              </header>
              <div class="post-body" itemprop="articleBody">
                <div class="thumb">
                  <img itemprop="contentUrl" class="random">
                </div>
                <div class="excerpt">
                  <p>
                  <p>在网上搜了很多关于Appium的教程，但没有系统完整的教程，在网上找了本关于appium的英文书籍，边学边翻译，同时记录学习心得，与志同道合的人一起交流探讨！ 去除很多繁琐的东西，添加自己实践的东西，一起交流，有写错的或者翻译不对的地方，请各位大神指出来，一起交流进步 第一章 Appium的工作原理 1.iOS端 执行测试脚本，发送HTTP请求给Appium Server , Appium Server发送命令给Apple Instruments, Apple Instruments寻找设备，开始执行脚本；每执行一条语句都会原路返回（执行的结果也就是我们常说的log） 2.Android端 首先Appium仅支持安卓版本17或以上版本!如果需要测试17以前版本，需要使用Selendroid.它的工作原理其实与iOS工作原理一样： 执行测试脚本，发送HTTP请求给Appium Server , Appium Server发送命令给UIAutomator(&gt;=17时){Selendroid（&lt;=17）} ，UIAutomator(&gt;=17时){Selendroid（&lt;=17）} 寻找设备，开始执行脚本；每执行一条语句都会原路返回（执行的结果也就是我们常说的log） 备注：执行脚本想要给Appium发送命令，其中必须有一个翻译器，翻译成Appium能识别的命令（Selenium JSON）,这个工具简单理解就是把咱们写的脚本给转换成appium可以识别的命令。</p>
                  </p>
                </div>
              </div>
              <div class="post-meta">
                <span class="post-meta-item">
                  <span class="post-meta-item-icon">
                    <i class="far fa-user"></i>
                  </span>
                  <span class="post-meta-item-text">作者</span>
                  <span><a href="/authors/路由新定" class="author" itemprop="url" rel="index">路由新定</a></span>
                </span>
                <span class="post-meta-item">
                  <span class="post-meta-item-icon">
                    <i class="far fa-calendar"></i>
                  </span>
                  <span class="post-meta-item-text">发表于</span>
                  <time title="创建时间：2016-06-30 00:10:42" itemprop="dateCreated datePublished" datetime="2016-06-30T00:10:42+08:00">2016-06-30</time>
                </span>
                <span id="/2817.html" class="post-meta-item leancloud_visitors" data-flag-title="Appium学习笔记" title="阅读次数">
                  <span class="post-meta-item-icon">
                    <i class="fa fa-eye"></i>
                  </span>
                  <span class="post-meta-item-text">阅读次数：</span>
                  <span class="leancloud-visitors-count"></span>
                </span>
                <span class="post-meta-item" title="本文字数">
                  <span class="post-meta-item-icon">
                    <i class="far fa-file-word"></i>
                  </span>
                  <span class="post-meta-item-text">本文字数：</span>
                  <span>626</span>
                </span>
                <span class="post-meta-item" title="阅读时长">
                  <span class="post-meta-item-icon">
                    <i class="far fa-clock"></i>
                  </span>
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                  <span>1 分钟</span>
                </span>
              </div>
            </article>
            <article itemscope itemtype="http://schema.org/Article" class="post-block index" lang="zh-CN">
              <link itemprop="mainEntityOfPage" href="https://cuiqingcai.com/2703.html">
              <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
                <meta itemprop="image" content="/images/avatar.png">
                <meta itemprop="name" content="崔庆才">
                <meta itemprop="description" content="崔庆才的个人站点，记录生活的瞬间，分享学习的心得。">
              </span>
              <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
                <meta itemprop="name" content="静觅">
              </span>
              <header class="post-header">
                <h2 class="post-title" itemprop="name headline">
                  <a class="label"> Python <i class="label-arrow"></i>
                  </a>
                  <a href="/2703.html" class="post-title-link" itemprop="url">PySpider HTTP 599: SSL certificate problem错误的解决方法</a>
                </h2>
              </header>
              <div class="post-body" itemprop="articleBody">
                <div class="thumb">
                  <img itemprop="contentUrl" class="random">
                </div>
                <div class="excerpt">
                  <p>
                  <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2>
                  <p>最近发现许多小伙伴在用 PySpider 爬取 https 开头的网站的时候遇到了 HTTP 599: SSL certificate problem: self signed certificate in certificate chain 的错误。 经过一番排查，解决方案总结如下</p>
                  <h2 id="错误原因"><a href="#错误原因" class="headerlink" title="错误原因"></a>错误原因</h2>
                  <p>这个错误会发生在请求 https 开头的网址，SSL 验证错误，证书有误。 报错如下 <a href="http://qiniu.cuiqingcai.com/wp-content/uploads/2016/03/pGIhFsz_png.png" target="_blank" rel="noopener"><img src="http://qiniu.cuiqingcai.com/wp-content/uploads/2016/03/pGIhFsz_png.png" alt="pGIhFsz_png"></a></p>
                  <h2 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h2>
                  <p>最简单的解决方法是： 在 crawl 方法中加入忽略证书验证的参数，validate_cert=False，即</p>
                  <figure class="highlight routeros">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">self.crawl(url, <span class="attribute">callback</span>=method_name, <span class="attribute">validate_cert</span>=<span class="literal">False</span>)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>以上方法基本可以解决问题。 如果出现了</p>
                  <figure class="highlight angelscript">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">[E <span class="number">160329</span> <span class="number">14</span>:<span class="number">00</span>:<span class="number">56</span> base_handler:<span class="number">194</span>] crawl() got unexpected keyword argument: [<span class="string">'validate_cert'</span>]</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>的错误，即无法匹配到 validate_cert 参数，那么则是 PySpider 本身的问题。 目前的最新发行版是 0.3.6（2016/3/29），不过 GitHub 最新版本目前是 0.4.0 可以更新到最新版本，即更新到 master 分支。 因为包还没有发行，所以我们就手动来更新。 <a href="https://github.com/binux/pyspider" target="_blank" rel="noopener">PySpider</a> 可以点击右侧下载 zip 包。 <a href="http://qiniu.cuiqingcai.com/wp-content/uploads/2016/03/QQ20160329-0@2x.png" target="_blank" rel="noopener"><img src="http://qiniu.cuiqingcai.com/wp-content/uploads/2016/03/QQ20160329-0@2x-1024x869.png" alt="QQ20160329-0@2x"></a></p>
                  <h3 id="Mac-OS-X"><a href="#Mac-OS-X" class="headerlink" title="Mac OS X"></a>Mac OS X</h3>
                  <p>以 Mac OS X为例，找到 pyspider 库所在的路径。我的是在</p>
                  <figure class="highlight awk">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="regexp">/Library/</span>Python<span class="regexp">/2.7/</span>site-packages<span class="regexp">/pyspider</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>打开之后发现如下的结构。 <a href="http://qiniu.cuiqingcai.com/wp-content/uploads/2016/03/QQ20160329-1@2x.png" target="_blank" rel="noopener"><img src="http://qiniu.cuiqingcai.com/wp-content/uploads/2016/03/QQ20160329-1@2x-1024x653.png" alt="QQ20160329-1@2x"></a> 把刚才的包下载下来之后，解压缩，打开文件夹，发现目录结构是这样的。 <a href="http://qiniu.cuiqingcai.com/wp-content/uploads/2016/03/QQ20160329-2@2x.png" target="_blank" rel="noopener"><img src="http://qiniu.cuiqingcai.com/wp-content/uploads/2016/03/QQ20160329-2@2x-1024x811.png" alt="QQ20160329-2@2x"></a> 然后进入 pyspider 文件夹，观察一下，发现和我们之前安装的 pyspider 目录结构是一样的，没错，就是它了！ <a href="http://qiniu.cuiqingcai.com/wp-content/uploads/2016/03/QQ20160329-3@2x.png" target="_blank" rel="noopener"><img src="http://qiniu.cuiqingcai.com/wp-content/uploads/2016/03/QQ20160329-3@2x-1024x811.png" alt="QQ20160329-3@2x"></a> 嗯，把所有的文件都更新到 site-packages/pyspider 目录中。 可以手动拖动替换，可以使用命令</p>
                  <figure class="highlight vim">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">cd</span> pyspider</span><br><span class="line">sudo <span class="keyword">python</span> setup.<span class="keyword">py</span> install</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>更新之后，然后重新启动 pyspider 。</p>
                  <figure class="highlight ada">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">pyspider <span class="keyword">all</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>再加入 validate_cert=False 参数，发现就不会出现刚才的问题了。</p>
                  <h3 id="Linux"><a href="#Linux" class="headerlink" title="Linux"></a>Linux</h3>
                  <p>方法同上，pyspider 路径应该在</p>
                  <figure class="highlight crystal">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">/usr/<span class="class"><span class="keyword">lib</span>/<span class="title">python</span>/<span class="title">site</span>-<span class="title">packages</span>/<span class="title">pyspider</span>-0.3.6.<span class="title">egg</span>/<span class="title">pyspider</span></span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>替换一下下载下来的文件。 同样也可以使用命令</p>
                  <figure class="highlight vim">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">cd</span> pyspider</span><br><span class="line">sudo <span class="keyword">python</span> setup.<span class="keyword">py</span> install</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <h3 id="Windows"><a href="#Windows" class="headerlink" title="Windows"></a>Windows</h3>
                  <p>方法同上，pyspider 路径应该在</p>
                  <figure class="highlight stylus">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="function"><span class="title">python</span><span class="params">(python安装目录)</span></span>/Lib/site-packages/pyspider</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>同样替换下载下来的文件即可。 命令同上</p>
                  <figure class="highlight vim">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">cd</span> pyspider</span><br><span class="line">sudo <span class="keyword">python</span> setup.<span class="keyword">py</span> install</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <h2 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h2>
                  <p>通过以上配置，我们解决了 PySpider 的 599 错误以及 validate_cert 参数不匹配的问题。 希望对大家有帮助！</p>
                  </p>
                </div>
              </div>
              <div class="post-meta">
                <span class="post-meta-item">
                  <span class="post-meta-item-icon">
                    <i class="far fa-user"></i>
                  </span>
                  <span class="post-meta-item-text">作者</span>
                  <span><a href="/authors/崔庆才" class="author" itemprop="url" rel="index">崔庆才</a></span>
                </span>
                <span class="post-meta-item">
                  <span class="post-meta-item-icon">
                    <i class="far fa-calendar"></i>
                  </span>
                  <span class="post-meta-item-text">发表于</span>
                  <time title="创建时间：2016-03-29 19:39:58" itemprop="dateCreated datePublished" datetime="2016-03-29T19:39:58+08:00">2016-03-29</time>
                </span>
                <span id="/2703.html" class="post-meta-item leancloud_visitors" data-flag-title="PySpider HTTP 599: SSL certificate problem错误的解决方法" title="阅读次数">
                  <span class="post-meta-item-icon">
                    <i class="fa fa-eye"></i>
                  </span>
                  <span class="post-meta-item-text">阅读次数：</span>
                  <span class="leancloud-visitors-count"></span>
                </span>
                <span class="post-meta-item" title="本文字数">
                  <span class="post-meta-item-icon">
                    <i class="far fa-file-word"></i>
                  </span>
                  <span class="post-meta-item-text">本文字数：</span>
                  <span>1.2k</span>
                </span>
                <span class="post-meta-item" title="阅读时长">
                  <span class="post-meta-item-icon">
                    <i class="far fa-clock"></i>
                  </span>
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                  <span>1 分钟</span>
                </span>
              </div>
            </article>
            <article itemscope itemtype="http://schema.org/Article" class="post-block index" lang="zh-CN">
              <link itemprop="mainEntityOfPage" href="https://cuiqingcai.com/2652.html">
              <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
                <meta itemprop="image" content="/images/avatar.png">
                <meta itemprop="name" content="崔庆才">
                <meta itemprop="description" content="崔庆才的个人站点，记录生活的瞬间，分享学习的心得。">
              </span>
              <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
                <meta itemprop="name" content="静觅">
              </span>
              <header class="post-header">
                <h2 class="post-title" itemprop="name headline">
                  <a class="label"> Python <i class="label-arrow"></i>
                  </a>
                  <a href="/2652.html" class="post-title-link" itemprop="url">Python爬虫进阶四之PySpider的用法</a>
                </h2>
              </header>
              <div class="post-body" itemprop="articleBody">
                <div class="thumb">
                  <img itemprop="contentUrl" class="random">
                </div>
                <div class="excerpt">
                  <p>
                  <h2 id="审时度势"><a href="#审时度势" class="headerlink" title="审时度势"></a>审时度势</h2>
                  <p>PySpider 是一个我个人认为非常方便并且功能强大的爬虫框架，支持多线程爬取、JS动态解析，提供了可操作界面、出错重试、定时爬取等等的功能，使用非常人性化。 本篇内容通过跟我做一个好玩的 PySpider 项目，来理解 PySpider 的运行流程。</p>
                  <h2 id="招兵买马"><a href="#招兵买马" class="headerlink" title="招兵买马"></a>招兵买马</h2>
                  <p>具体的安装过程请查看本节讲述 <a href="http://cuiqingcai.com/2443.html">安装</a> 嗯，安装好了之后就与我大干一番吧。</p>
                  <h2 id="鸿鹄之志"><a href="#鸿鹄之志" class="headerlink" title="鸿鹄之志"></a>鸿鹄之志</h2>
                  <p>我之前写过的一篇文章 <a href="http://cuiqingcai.com/1001.html">抓取淘宝MM照片</a> 由于网页改版，爬取过程中需要的 URL 需要 JS 动态解析生成，所以之前用的 urllib2 不能继续使用了，在这里我们利用 PySpider 重新实现一下。 所以现在我们需要做的是抓取淘宝MM的个人信息和图片存储到本地。</p>
                  <h2 id="审时度势-1"><a href="#审时度势-1" class="headerlink" title="审时度势"></a>审时度势</h2>
                  <p>爬取目标网站：<a href="https://mm.taobao.com/json/request_top_list.htm?page=1" target="_blank" rel="noopener">https://mm.taobao.com/json/request_top_list.htm?page=1</a>，大家打开之后可以看到许多淘宝MM的列表。 列表有多少？ <a href="https://mm.taobao.com/json/request_top_list.htm?page=10000" target="_blank" rel="noopener">https://mm.taobao.com/json/request_top_list.htm?page=10000</a>，第10000页都有，看你想要多少。我什么也不知道。 随机点击一位 MM 的姓名，可以看到她的基本资料。 <a href="http://qiniu.cuiqingcai.com/wp-content/uploads/2016/03/QQ20160326-4@2x.png" target="_blank" rel="noopener"><img src="http://qiniu.cuiqingcai.com/wp-content/uploads/2016/03/QQ20160326-4@2x-1024x750.png" alt="QQ20160326-4@2x"></a> 可以看到图中有一个个性域名，我们复制到浏览器打开。<a href="https://mm.taobao.com/tyy6160" target="_blank" rel="noopener">mm.taobao.com/tyy6160</a> <a href="http://qiniu.cuiqingcai.com/wp-content/uploads/2016/03/QQ20160326-5@2x.png" target="_blank" rel="noopener"><img src="http://qiniu.cuiqingcai.com/wp-content/uploads/2016/03/QQ20160326-5@2x-1024x576.png" alt="QQ20160326-5@2x"></a> 嗯，往下拖，海量的 MM 图片都在这里了，怎么办你懂得，我们要把她们的照片和个人信息都存下来。 <strong>P.S. 注意图中进度条！你猜有多少图片～</strong></p>
                  <h2 id="利剑出鞘"><a href="#利剑出鞘" class="headerlink" title="利剑出鞘"></a>利剑出鞘</h2>
                  <p>安装成功之后，跟我一步步地完成一个网站的抓取，你就会明白 PySpider 的基本用法了。 命令行下执行</p>
                  <figure class="highlight ada">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">pyspider <span class="keyword">all</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>这句命令的意思是，运行 pyspider 并 启动它的所有组件。 <a href="http://qiniu.cuiqingcai.com/wp-content/uploads/2016/03/E6632A0A-9067-4B97-93A2-5DEF23FB4CD8.jpg" target="_blank" rel="noopener"><img src="http://qiniu.cuiqingcai.com/wp-content/uploads/2016/03/E6632A0A-9067-4B97-93A2-5DEF23FB4CD8-1024x658.jpg" alt="E6632A0A-9067-4B97-93A2-5DEF23FB4CD8"></a> 可以发现程序已经正常启动，并在 5000 这个端口运行。</p>
                  <h2 id="一触即发"><a href="#一触即发" class="headerlink" title="一触即发"></a>一触即发</h2>
                  <p>接下来在浏览器中输入 <a href="http://localhost:5000" target="_blank" rel="noopener">http://localhost:5000</a>，可以看到 PySpider 的主界面，点击右下角的 Create，命名为 taobaomm，当然名称你可以随意取，继续点击 Create。 <a href="http://qiniu.cuiqingcai.com/wp-content/uploads/2016/03/QQ20160325-0@2x.png" target="_blank" rel="noopener"><img src="http://qiniu.cuiqingcai.com/wp-content/uploads/2016/03/QQ20160325-0@2x-1024x397.png" alt="QQ20160325-0@2x"></a> 这样我们会进入到一个爬取操作的页面。 <a href="http://qiniu.cuiqingcai.com/wp-content/uploads/2016/03/QQ20160325-1@2x.png" target="_blank" rel="noopener"><img src="http://qiniu.cuiqingcai.com/wp-content/uploads/2016/03/QQ20160325-1@2x-1024x592.png" alt="QQ20160325-1@2x"></a> 整个页面分为两栏，左边是爬取页面预览区域，右边是代码编写区域。下面对区块进行说明： 左侧绿色区域：这个请求对应的 JSON 变量，在 PySpider 中，其实每个请求都有与之对应的 JSON 变量，包括回调函数，方法名，请求链接，请求数据等等。 绿色区域右上角Run：点击右上角的 run 按钮，就会执行这个请求，可以在左边的白色区域出现请求的结果。 左侧 enable css selector helper: 抓取页面之后，点击此按钮，可以方便地获取页面中某个元素的 CSS 选择器。 左侧 web: 即抓取的页面的实时预览图。 左侧 html: 抓取页面的 HTML 代码。 左侧 follows: 如果当前抓取方法中又新建了爬取请求，那么接下来的请求就会出现在 follows 里。 左侧 messages: 爬取过程中输出的一些信息。 右侧代码区域: 你可以在右侧区域书写代码，并点击右上角的 Save 按钮保存。 右侧 WebDAV Mode: 打开调试模式，左侧最大化，便于观察调试。</p>
                  <h2 id="乘胜追击"><a href="#乘胜追击" class="headerlink" title="乘胜追击"></a>乘胜追击</h2>
                  <p>依然是上一节的那个网址，<a href="https://mm.taobao.com/json/request_top_list.htm?page=1" target="_blank" rel="noopener">https://mm.taobao.com/json/request_top_list.htm?page=1</a>，其中 page 参数代表页码。所以我们暂时抓取前 30 页。页码到最后可以随意调整。 首先我们定义基地址，然后定义爬取的页码和总页码。</p>
                  <figure class="highlight ruby">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">from pyspider.libs.base_handler import *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Handler</span>(<span class="title">BaseHandler</span>):</span></span><br><span class="line">    crawl_config = &#123;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(<span class="keyword">self</span>)</span></span><span class="symbol">:</span></span><br><span class="line">        <span class="keyword">self</span>.base_url = <span class="string">'https://mm.taobao.com/json/request_top_list.htm?page='</span></span><br><span class="line">        <span class="keyword">self</span>.page_num = <span class="number">1</span></span><br><span class="line">        <span class="keyword">self</span>.total_num = <span class="number">30</span></span><br><span class="line"></span><br><span class="line">    @every(minutes=<span class="number">24</span> * <span class="number">60</span>)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">on_start</span><span class="params">(<span class="keyword">self</span>)</span></span><span class="symbol">:</span></span><br><span class="line">        <span class="keyword">while</span> <span class="keyword">self</span>.page_num &lt;= <span class="keyword">self</span>.<span class="symbol">total_num:</span></span><br><span class="line">            url = <span class="keyword">self</span>.base_url + str(<span class="keyword">self</span>.page_num)</span><br><span class="line">            print url</span><br><span class="line">            <span class="keyword">self</span>.crawl(url, callback=<span class="keyword">self</span>.index_page)</span><br><span class="line">            <span class="keyword">self</span>.page_num += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    @config(age=<span class="number">10</span> * <span class="number">24</span> * <span class="number">60</span> * <span class="number">60</span>)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">index_page</span><span class="params">(<span class="keyword">self</span>, response)</span></span><span class="symbol">:</span></span><br><span class="line">        <span class="keyword">for</span> each <span class="keyword">in</span> response.doc(<span class="string">'a[href^="http"]'</span>).items()<span class="symbol">:</span></span><br><span class="line">            <span class="keyword">self</span>.crawl(each.attr.href, callback=<span class="keyword">self</span>.detail_page)</span><br><span class="line"></span><br><span class="line">    @config(priority=<span class="number">2</span>)</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">detail_page</span><span class="params">(<span class="keyword">self</span>, response)</span></span><span class="symbol">:</span></span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            <span class="string">"url"</span>: response.url,</span><br><span class="line">            <span class="string">"title"</span>: response.doc(<span class="string">'title'</span>).text(),</span><br><span class="line">        &#125;</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>点击 save 保存代码，然后点击左边的 run，运行代码。 <a href="http://qiniu.cuiqingcai.com/wp-content/uploads/2016/03/QQ20160325-2@2x.png" target="_blank" rel="noopener"><img src="http://qiniu.cuiqingcai.com/wp-content/uploads/2016/03/QQ20160325-2@2x-1024x597.png" alt="QQ20160325-2@2x"></a> 运行后我们会发现 follows 出现了 30 这个数字，说明我们接下来有 30 个新请求，点击可查看所有爬取列表。另外控制台也有输出，将所有要爬取的 URL 打印了出来。 然后我们点击左侧任意一个绿色箭头，可以继续爬取这个页面。例如点击第一个 URL，来爬取这个 URL <a href="http://qiniu.cuiqingcai.com/wp-content/uploads/2016/03/QQ20160325-3@2x.png" target="_blank" rel="noopener"><img src="http://qiniu.cuiqingcai.com/wp-content/uploads/2016/03/QQ20160325-3@2x-1024x347.png" alt="QQ20160325-3@2x"></a> 点击之后，再查看下方的 web 页面，可以预览实时页面，这个页面被我们爬取了下来，并且回调到 index_page 函数来处理，目前 index_page 函数我们还没有处理，所以是继续构件了所有的链接请求。 <a href="http://qiniu.cuiqingcai.com/wp-content/uploads/2016/03/QQ20160325-4@2x.png" target="_blank" rel="noopener"><img src="http://qiniu.cuiqingcai.com/wp-content/uploads/2016/03/QQ20160325-4@2x-949x1024.png" alt="QQ20160325-4@2x"></a> 好，接下来我们怎么办？当然是进入到 MM 到个人页面去爬取了。</p>
                  <h2 id="如火如荼"><a href="#如火如荼" class="headerlink" title="如火如荼"></a>如火如荼</h2>
                  <p>爬取到了 MM 的列表，接下来就要进入到 MM 详情页了，修改 index_page 方法。</p>
                  <figure class="highlight ruby">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index_page</span><span class="params">(<span class="keyword">self</span>, response)</span></span><span class="symbol">:</span></span><br><span class="line">    <span class="keyword">for</span> each <span class="keyword">in</span> response.doc(<span class="string">'.lady-name'</span>).items()<span class="symbol">:</span></span><br><span class="line">        <span class="keyword">self</span>.crawl(each.attr.href, callback=<span class="keyword">self</span>.detail_page)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>其中 response 就是刚才爬取的列表页，response 其实就相当于列表页的 html 代码，利用 doc 函数，其实是调用了 PyQuery，用 CSS 选择器得到每一个MM的链接，然后重新发起新的请求。 比如，我们这里拿到的 each.attr.href 可能是 <a href="http://mm.taobao.com/self/model_card.htm?user_id=687471686" target="_blank" rel="noopener">mm.taobao.com/self/model_card.htm?user_id=687471686</a>，在这里继续调用了 crawl 方法，代表继续抓取这个链接的详情。</p>
                  <figure class="highlight oxygene">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">self</span>.crawl(<span class="keyword">each</span>.attr.href, callback=<span class="keyword">self</span>.detail_page)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>然后回调函数就是 detail_page，爬取的结果会作为 response 变量传过去。detail_page 接到这个变量继续下面的分析。 <a href="http://qiniu.cuiqingcai.com/wp-content/uploads/2016/03/QQ20160325-7@2x.png" target="_blank" rel="noopener"><img src="http://qiniu.cuiqingcai.com/wp-content/uploads/2016/03/QQ20160325-7@2x-1024x620.png" alt="QQ20160325-7@2x"></a> 好，我们继续点击 run 按钮，开始下一个页面的爬取。得到的结果是这样的。 <a href="http://qiniu.cuiqingcai.com/wp-content/uploads/2016/03/QQ20160325-5@2x.png" target="_blank" rel="noopener"><img src="http://qiniu.cuiqingcai.com/wp-content/uploads/2016/03/QQ20160325-5@2x-864x1024.png" alt="QQ20160325-5@2x"></a> 哦，有些页面没有加载出来，这是为什么？ 在之前的文章说过，这个页面比较特殊，右边的页面使用 JS 渲染生成的，而普通的抓取是不能得到 JS 渲染后的页面的，这可麻烦了。 然而，幸运的是，PySpider 提供了动态解析 JS 的机制。 友情提示：可能有的小伙伴不知道 PhantomJS，可以参考 <a href="http://cuiqingcai.com/2599.html">爬虫JS动态解析</a> 因为我们在前面装好了 PhantomJS，所以，这时候就轮到它来出场了。在最开始运行 PySpider 的时候，使用了<code>pyspider all</code>命令，这个命令是把 PySpider 所有的组件启动起来，其中也包括 PhantomJS。 所以我们代码怎么改呢？很简单。</p>
                  <figure class="highlight ruby">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index_page</span><span class="params">(<span class="keyword">self</span>, response)</span></span><span class="symbol">:</span></span><br><span class="line">    <span class="keyword">for</span> each <span class="keyword">in</span> response.doc(<span class="string">'.lady-name'</span>).items()<span class="symbol">:</span></span><br><span class="line">        <span class="keyword">self</span>.crawl(each.attr.href, callback=<span class="keyword">self</span>.detail_page, fetch_type=<span class="string">'js'</span>)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>只是简单地加了一个 fetch_type=’js’，点击绿色的返回箭头，重新运行一下。 可以发现，页面已经被我们成功加载出来了，简直不能更帅！ <a href="http://qiniu.cuiqingcai.com/wp-content/uploads/2016/03/QQ20160325-9@2x.png" target="_blank" rel="noopener"><img src="http://qiniu.cuiqingcai.com/wp-content/uploads/2016/03/QQ20160325-9@2x-1004x1024.png" alt="QQ20160325-9@2x"></a> 看下面的个性域名，所有我们需要的 MM 图片都在那里面了，所以我们需要继续抓取这个页面。</p>
                  <h2 id="胜利在望"><a href="#胜利在望" class="headerlink" title="胜利在望"></a>胜利在望</h2>
                  <p>好，继续修改 detail_page 方法，然后增加一个 domain_page 方法，用来处理每个 MM 的个性域名。</p>
                  <figure class="highlight ruby">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">detail_page</span><span class="params">(<span class="keyword">self</span>, response)</span></span><span class="symbol">:</span></span><br><span class="line">    domain = <span class="string">'https:'</span> + response.doc(<span class="string">'.mm-p-domain-info li &gt; span'</span>).text()</span><br><span class="line">    print domain</span><br><span class="line">    <span class="keyword">self</span>.crawl(domain, callback=<span class="keyword">self</span>.domain_page)</span><br><span class="line">                </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">domain_page</span><span class="params">(<span class="keyword">self</span>, response)</span></span><span class="symbol">:</span></span><br><span class="line">    pass</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>好，继续重新 run，预览一下页面，终于，我们看到了 MM 的所有图片。 <a href="http://qiniu.cuiqingcai.com/wp-content/uploads/2016/03/QQ20160326-0@2x.png" target="_blank" rel="noopener"><img src="http://qiniu.cuiqingcai.com/wp-content/uploads/2016/03/QQ20160326-0@2x-1024x546.png" alt="QQ20160326-0@2x"></a> 嗯，你懂得！</p>
                  <h2 id="只欠东风"><a href="#只欠东风" class="headerlink" title="只欠东风"></a>只欠东风</h2>
                  <p>好，照片都有了，那么我们就偷偷地下载下来吧～ 完善 domain_page 代码，实现保存简介和遍历保存图片的方法。 在这里，PySpider 有一个特点，所有的 request 都会保存到一个队列中，并具有去重和自动重试机制。所以，我们最好的解决方法是，把每张图片的请求都写成一个 request，然后成功后用文件写入即可，这样会避免图片加载不全的问题。 曾经在之前文章写过图片下载和文件夹创建的过程，在这里就不多赘述原理了，直接上写好的工具类，后面会有完整代码。</p>
                  <figure class="highlight ruby">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">import os</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Deal</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(<span class="keyword">self</span>)</span></span><span class="symbol">:</span></span><br><span class="line">        <span class="keyword">self</span>.path = DIR_PATH</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> <span class="keyword">self</span>.path.endswith(<span class="string">'/'</span>)<span class="symbol">:</span></span><br><span class="line">            <span class="keyword">self</span>.path = <span class="keyword">self</span>.path + <span class="string">'/'</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(<span class="keyword">self</span>.path)<span class="symbol">:</span></span><br><span class="line">            os.makedirs(<span class="keyword">self</span>.path)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">mkDir</span><span class="params">(<span class="keyword">self</span>, path)</span></span><span class="symbol">:</span></span><br><span class="line">        path = path.strip()</span><br><span class="line">        dir_path = <span class="keyword">self</span>.path + path</span><br><span class="line">        exists = os.path.exists(dir_path)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> <span class="symbol">exists:</span></span><br><span class="line">            os.makedirs(dir_path)</span><br><span class="line">            <span class="keyword">return</span> dir_path</span><br><span class="line">        <span class="symbol">else:</span></span><br><span class="line">            <span class="keyword">return</span> dir_path</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">saveImg</span><span class="params">(<span class="keyword">self</span>, content, path)</span></span><span class="symbol">:</span></span><br><span class="line">        f = open(path, <span class="string">'wb'</span>)</span><br><span class="line">        f.write(content)</span><br><span class="line">        f.close()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">saveBrief</span><span class="params">(<span class="keyword">self</span>, content, dir_path, name)</span></span><span class="symbol">:</span></span><br><span class="line">        file_name = dir_path + <span class="string">"/"</span> + name + <span class="string">".txt"</span></span><br><span class="line">        f = open(file_name, <span class="string">"w+"</span>)</span><br><span class="line">        f.write(content.encode(<span class="string">'utf-8'</span>))</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">getExtension</span><span class="params">(<span class="keyword">self</span>, url)</span></span><span class="symbol">:</span></span><br><span class="line">        extension = url.split(<span class="string">'.'</span>)[-<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">return</span> extension</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>这里面包含了四个方法。</p>
                  <blockquote>
                    <p>mkDir：创建文件夹，用来创建 MM 名字对应的文件夹。 saveBrief: 保存简介，保存 MM 的文字简介。 saveImg: 传入图片二进制流以及保存路径，存储图片。 getExtension: 获得链接的后缀名，通过图片 URL 获得。</p>
                  </blockquote>
                  <p>然后在 domain_page 中具体实现如下</p>
                  <figure class="highlight ruby">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">domain_page</span><span class="params">(<span class="keyword">self</span>, response)</span></span><span class="symbol">:</span></span><br><span class="line">    name = response.doc(<span class="string">'.mm-p-model-info-left-top dd &gt; a'</span>).text()</span><br><span class="line">    dir_path = <span class="keyword">self</span>.deal.mkDir(name)</span><br><span class="line">    brief = response.doc(<span class="string">'.mm-aixiu-content'</span>).text()</span><br><span class="line">    <span class="keyword">if</span> <span class="symbol">dir_path:</span></span><br><span class="line">        imgs = response.doc(<span class="string">'.mm-aixiu-content img'</span>).items()</span><br><span class="line">        count = <span class="number">1</span></span><br><span class="line">        <span class="keyword">self</span>.deal.saveBrief(brief, dir_path, name)</span><br><span class="line">        <span class="keyword">for</span> img <span class="keyword">in</span> <span class="symbol">imgs:</span></span><br><span class="line">            url = img.attr.src</span><br><span class="line">            <span class="keyword">if</span> <span class="symbol">url:</span></span><br><span class="line">                extension = <span class="keyword">self</span>.deal.getExtension(url)</span><br><span class="line">                file_name = name + str(count) + <span class="string">'.'</span> + extension</span><br><span class="line">                count += <span class="number">1</span></span><br><span class="line">                <span class="keyword">self</span>.crawl(img.attr.src, callback=<span class="keyword">self</span>.save_img,</span><br><span class="line">                           save=&#123;<span class="string">'dir_path'</span>: dir_path, <span class="string">'file_name'</span>: file_name&#125;)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">save_img</span><span class="params">(<span class="keyword">self</span>, response)</span></span><span class="symbol">:</span></span><br><span class="line">    content = response.content</span><br><span class="line">    dir_path = response.save[<span class="string">'dir_path'</span>]</span><br><span class="line">    file_name = response.save[<span class="string">'file_name'</span>]</span><br><span class="line">    file_path = dir_path + <span class="string">'/'</span> + file_name</span><br><span class="line">    <span class="keyword">self</span>.deal.saveImg(content, file_path)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>以上方法首先获取了页面的所有文字，然后调用了 saveBrief 方法存储简介。 然后遍历了 MM 所有的图片，并通过链接获取后缀名，和 MM 的姓名以及自增计数组合成一个新的文件名，调用 saveImg 方法保存图片。</p>
                  <h2 id="炉火纯青"><a href="#炉火纯青" class="headerlink" title="炉火纯青"></a>炉火纯青</h2>
                  <p>好，基本的东西都写好了。 接下来。继续完善一下代码。第一版本完成。 <strong>版本一功能：按照淘宝MM姓名分文件夹，存储MM的 txt 文本简介以及所有美图至本地。</strong> 可配置项：</p>
                  <blockquote>
                    <ul>
                      <li>PAGE_START: 列表开始页码</li>
                      <li>PAGE_END: 列表结束页码</li>
                      <li>DIR_PATH: 资源保存路径</li>
                    </ul>
                  </blockquote>
                  <figure class="highlight ruby">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- encoding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># Created on 2016-03-25 00:59:45</span></span><br><span class="line"><span class="comment"># Project: taobaomm</span></span><br><span class="line"></span><br><span class="line">from pyspider.libs.base_handler import *</span><br><span class="line"></span><br><span class="line">PAGE_START = <span class="number">1</span></span><br><span class="line">PAGE_END = <span class="number">30</span></span><br><span class="line">DIR_PATH = <span class="string">'/var/py/mm'</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Handler</span>(<span class="title">BaseHandler</span>):</span></span><br><span class="line">    crawl_config = &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(<span class="keyword">self</span>)</span></span><span class="symbol">:</span></span><br><span class="line">        <span class="keyword">self</span>.base_url = <span class="string">'https://mm.taobao.com/json/request_top_list.htm?page='</span></span><br><span class="line">        <span class="keyword">self</span>.page_num = PAGE_START</span><br><span class="line">        <span class="keyword">self</span>.total_num = PAGE_END</span><br><span class="line">        <span class="keyword">self</span>.deal = Deal()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">on_start</span><span class="params">(<span class="keyword">self</span>)</span></span><span class="symbol">:</span></span><br><span class="line">        <span class="keyword">while</span> <span class="keyword">self</span>.page_num &lt;= <span class="keyword">self</span>.<span class="symbol">total_num:</span></span><br><span class="line">            url = <span class="keyword">self</span>.base_url + str(<span class="keyword">self</span>.page_num)</span><br><span class="line">            <span class="keyword">self</span>.crawl(url, callback=<span class="keyword">self</span>.index_page)</span><br><span class="line">            <span class="keyword">self</span>.page_num += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">index_page</span><span class="params">(<span class="keyword">self</span>, response)</span></span><span class="symbol">:</span></span><br><span class="line">        <span class="keyword">for</span> each <span class="keyword">in</span> response.doc(<span class="string">'.lady-name'</span>).items()<span class="symbol">:</span></span><br><span class="line">            <span class="keyword">self</span>.crawl(each.attr.href, callback=<span class="keyword">self</span>.detail_page, fetch_type=<span class="string">'js'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">detail_page</span><span class="params">(<span class="keyword">self</span>, response)</span></span><span class="symbol">:</span></span><br><span class="line">        domain = response.doc(<span class="string">'.mm-p-domain-info li &gt; span'</span>).text()</span><br><span class="line">        <span class="keyword">if</span> <span class="symbol">domain:</span></span><br><span class="line">            page_url = <span class="string">'https:'</span> + domain</span><br><span class="line">            <span class="keyword">self</span>.crawl(page_url, callback=<span class="keyword">self</span>.domain_page)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">domain_page</span><span class="params">(<span class="keyword">self</span>, response)</span></span><span class="symbol">:</span></span><br><span class="line">        name = response.doc(<span class="string">'.mm-p-model-info-left-top dd &gt; a'</span>).text()</span><br><span class="line">        dir_path = <span class="keyword">self</span>.deal.mkDir(name)</span><br><span class="line">        brief = response.doc(<span class="string">'.mm-aixiu-content'</span>).text()</span><br><span class="line">        <span class="keyword">if</span> <span class="symbol">dir_path:</span></span><br><span class="line">            imgs = response.doc(<span class="string">'.mm-aixiu-content img'</span>).items()</span><br><span class="line">            count = <span class="number">1</span></span><br><span class="line">            <span class="keyword">self</span>.deal.saveBrief(brief, dir_path, name)</span><br><span class="line">            <span class="keyword">for</span> img <span class="keyword">in</span> <span class="symbol">imgs:</span></span><br><span class="line">                url = img.attr.src</span><br><span class="line">                <span class="keyword">if</span> <span class="symbol">url:</span></span><br><span class="line">                    extension = <span class="keyword">self</span>.deal.getExtension(url)</span><br><span class="line">                    file_name = name + str(count) + <span class="string">'.'</span> + extension</span><br><span class="line">                    count += <span class="number">1</span></span><br><span class="line">                    <span class="keyword">self</span>.crawl(img.attr.src, callback=<span class="keyword">self</span>.save_img,</span><br><span class="line">                               save=&#123;<span class="string">'dir_path'</span>: dir_path, <span class="string">'file_name'</span>: file_name&#125;)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">save_img</span><span class="params">(<span class="keyword">self</span>, response)</span></span><span class="symbol">:</span></span><br><span class="line">        content = response.content</span><br><span class="line">        dir_path = response.save[<span class="string">'dir_path'</span>]</span><br><span class="line">        file_name = response.save[<span class="string">'file_name'</span>]</span><br><span class="line">        file_path = dir_path + <span class="string">'/'</span> + file_name</span><br><span class="line">        <span class="keyword">self</span>.deal.saveImg(content, file_path)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">import os</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Deal</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(<span class="keyword">self</span>)</span></span><span class="symbol">:</span></span><br><span class="line">        <span class="keyword">self</span>.path = DIR_PATH</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> <span class="keyword">self</span>.path.endswith(<span class="string">'/'</span>)<span class="symbol">:</span></span><br><span class="line">            <span class="keyword">self</span>.path = <span class="keyword">self</span>.path + <span class="string">'/'</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(<span class="keyword">self</span>.path)<span class="symbol">:</span></span><br><span class="line">            os.makedirs(<span class="keyword">self</span>.path)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">mkDir</span><span class="params">(<span class="keyword">self</span>, path)</span></span><span class="symbol">:</span></span><br><span class="line">        path = path.strip()</span><br><span class="line">        dir_path = <span class="keyword">self</span>.path + path</span><br><span class="line">        exists = os.path.exists(dir_path)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> <span class="symbol">exists:</span></span><br><span class="line">            os.makedirs(dir_path)</span><br><span class="line">            <span class="keyword">return</span> dir_path</span><br><span class="line">        <span class="symbol">else:</span></span><br><span class="line">            <span class="keyword">return</span> dir_path</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">saveImg</span><span class="params">(<span class="keyword">self</span>, content, path)</span></span><span class="symbol">:</span></span><br><span class="line">        f = open(path, <span class="string">'wb'</span>)</span><br><span class="line">        f.write(content)</span><br><span class="line">        f.close()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">saveBrief</span><span class="params">(<span class="keyword">self</span>, content, dir_path, name)</span></span><span class="symbol">:</span></span><br><span class="line">        file_name = dir_path + <span class="string">"/"</span> + name + <span class="string">".txt"</span></span><br><span class="line">        f = open(file_name, <span class="string">"w+"</span>)</span><br><span class="line">        f.write(content.encode(<span class="string">'utf-8'</span>))</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">getExtension</span><span class="params">(<span class="keyword">self</span>, url)</span></span><span class="symbol">:</span></span><br><span class="line">        extension = url.split(<span class="string">'.'</span>)[-<span class="number">1</span>]</span><br><span class="line">        <span class="keyword">return</span> extension</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>粘贴到你的 PySpider 中运行吧～ 其中有一些知识点，我会在后面作详细的用法总结。大家可以先体会一下代码。 <a href="http://qiniu.cuiqingcai.com/wp-content/uploads/2016/03/QQ20160326-1@2x.png" target="_blank" rel="noopener"><img src="http://qiniu.cuiqingcai.com/wp-content/uploads/2016/03/QQ20160326-1@2x-1024x418.png" alt="QQ20160326-1@2x"></a> 保存之后，点击下方的 run，你会发现，海量的 MM 图片已经涌入你的电脑啦～ <a href="http://qiniu.cuiqingcai.com/wp-content/uploads/2016/03/QQ20160326-2@2x.png" target="_blank" rel="noopener"><img src="http://qiniu.cuiqingcai.com/wp-content/uploads/2016/03/QQ20160326-2@2x-1024x831.png" alt="QQ20160326-2@2x"></a> <a href="http://qiniu.cuiqingcai.com/wp-content/uploads/2016/03/QQ20160326-3@2x.png" target="_blank" rel="noopener"><img src="http://qiniu.cuiqingcai.com/wp-content/uploads/2016/03/QQ20160326-3@2x-1024x831.png" alt="QQ20160326-3@2x"></a> 需要解释？需要我也不解释！</p>
                  <h2 id="项目代码"><a href="#项目代码" class="headerlink" title="项目代码"></a>项目代码</h2>
                  <p> <a href="https://github.com/cqcre/TaobaoMM" target="_blank" rel="noopener">TaobaoMM - GitHub</a></p>
                  <h2 id="尚方宝剑"><a href="#尚方宝剑" class="headerlink" title="尚方宝剑"></a>尚方宝剑</h2>
                  <p>如果想了解 PySpider 的更多内容，可以查看官方文档。 <a href="http://docs.pyspider.org/en/latest/Quickstart/" target="_blank" rel="noopener">官方文档</a></p>
                  </p>
                </div>
              </div>
              <div class="post-meta">
                <span class="post-meta-item">
                  <span class="post-meta-item-icon">
                    <i class="far fa-user"></i>
                  </span>
                  <span class="post-meta-item-text">作者</span>
                  <span><a href="/authors/崔庆才" class="author" itemprop="url" rel="index">崔庆才</a></span>
                </span>
                <span class="post-meta-item">
                  <span class="post-meta-item-icon">
                    <i class="far fa-calendar"></i>
                  </span>
                  <span class="post-meta-item-text">发表于</span>
                  <time title="创建时间：2016-03-26 02:32:36" itemprop="dateCreated datePublished" datetime="2016-03-26T02:32:36+08:00">2016-03-26</time>
                </span>
                <span id="/2652.html" class="post-meta-item leancloud_visitors" data-flag-title="Python爬虫进阶四之PySpider的用法" title="阅读次数">
                  <span class="post-meta-item-icon">
                    <i class="fa fa-eye"></i>
                  </span>
                  <span class="post-meta-item-text">阅读次数：</span>
                  <span class="leancloud-visitors-count"></span>
                </span>
                <span class="post-meta-item" title="本文字数">
                  <span class="post-meta-item-icon">
                    <i class="far fa-file-word"></i>
                  </span>
                  <span class="post-meta-item-text">本文字数：</span>
                  <span>8.1k</span>
                </span>
                <span class="post-meta-item" title="阅读时长">
                  <span class="post-meta-item-icon">
                    <i class="far fa-clock"></i>
                  </span>
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                  <span>7 分钟</span>
                </span>
              </div>
            </article>
            <article itemscope itemtype="http://schema.org/Article" class="post-block index" lang="zh-CN">
              <link itemprop="mainEntityOfPage" href="https://cuiqingcai.com/2636.html">
              <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
                <meta itemprop="image" content="/images/avatar.png">
                <meta itemprop="name" content="崔庆才">
                <meta itemprop="description" content="崔庆才的个人站点，记录生活的瞬间，分享学习的心得。">
              </span>
              <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
                <meta itemprop="name" content="静觅">
              </span>
              <header class="post-header">
                <h2 class="post-title" itemprop="name headline">
                  <a class="label"> Python <i class="label-arrow"></i>
                  </a>
                  <a href="/2636.html" class="post-title-link" itemprop="url">Python爬虫利器六之PyQuery的用法</a>
                </h2>
              </header>
              <div class="post-body" itemprop="articleBody">
                <div class="thumb">
                  <img itemprop="contentUrl" class="random">
                </div>
                <div class="excerpt">
                  <p>
                  <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2>
                  <p>你是否觉得 XPath 的用法多少有点晦涩难记呢？ 你是否觉得 BeautifulSoup 的语法多少有些悭吝难懂呢？ 你是否甚至还在苦苦研究正则表达式却因为少些了一个点而抓狂呢？ 你是否已经有了一些前端基础了解选择器却与另外一些奇怪的选择器语法混淆了呢？ 嗯，那么，前端大大们的福音来了，PyQuery 来了，乍听名字，你一定联想到了 jQuery，如果你对 jQuery 熟悉，那么 PyQuery 来解析文档就是不二之选！包括我在内！ PyQuery 是 Python 仿照 jQuery 的严格实现。语法与 jQuery 几乎完全相同，所以不用再去费心去记一些奇怪的方法了。 天下竟然有这等好事？我都等不及了！</p>
                  <h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2>
                  <p>有这等神器还不赶紧安装了！来！</p>
                  <figure class="highlight cmake">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">pip <span class="keyword">install</span> pyquery</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>还是原来的配方，还是熟悉的味道。</p>
                  <h2 id="参考来源"><a href="#参考来源" class="headerlink" title="参考来源"></a>参考来源</h2>
                  <p>本文内容参考官方文档，更多内容，大家可以去官方文档学习，毕竟那里才是最原汁原味的。 目前版本 1.2.4 (2016/3/24) <a href="https://pythonhosted.org/pyquery/" target="_blank" rel="noopener">官方文档</a></p>
                  <h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2>
                  <blockquote>
                    <p>pyquery allows you to make jquery queries on xml documents. The API is as much as possible the similar to jquery. pyquery uses lxml for fast xml and html manipulation. This is not (or at least not yet) a library to produce or interact with javascript code. I just liked the jquery API and I missed it in python so I told myself “Hey let’s make jquery in python”. This is the result. It can be used for many purposes, one idea that I might try in the future is to use it for templating with pure http templates that you modify using pyquery. I can also be used for web scrapping or for theming applications with Deliverance.</p>
                  </blockquote>
                  <p>pyquery 可让你用 jQuery 的语法来对 xml 进行操作。这I和 jQuery 十分类似。如果利用 lxml，pyquery 对 xml 和 html 的处理将更快。 这个库不是（至少还不是）一个可以和 JavaScript交互的代码库，它只是非常像 jQuery API 而已。</p>
                  <h2 id="初始化"><a href="#初始化" class="headerlink" title="初始化"></a>初始化</h2>
                  <p>在这里介绍四种初始化方式。 （1）直接字符串</p>
                  <figure class="highlight perl">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">from pyquery import PyQuery as pq</span><br><span class="line">doc = p<span class="string">q("&lt;html&gt;&lt;/html&gt;")</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>pq 参数可以直接传入 HTML 代码，doc 现在就相当于 jQuery 里面的 $ 符号了。 （2）lxml.etree</p>
                  <figure class="highlight perl">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">from lxml import etree</span><br><span class="line">doc = p<span class="string">q(etree.fromstring("&lt;html&gt;&lt;/html&gt;")</span>)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>可以首先用 lxml 的 etree 处理一下代码，这样如果你的 HTML 代码出现一些不完整或者疏漏，都会自动转化为完整清晰结构的 HTML代码。 （3）直接传URL</p>
                  <figure class="highlight perl">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">from pyquery import PyQuery as pq</span><br><span class="line">doc = p<span class="string">q('http://www.baidu.com')</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>这里就像直接请求了一个网页一样，类似用 urllib2 来直接请求这个链接，得到 HTML 代码。 （4）传文件</p>
                  <figure class="highlight perl">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">from pyquery import PyQuery as pq</span><br><span class="line">doc = p<span class="string">q(filename='hello.html')</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>可以直接传某个路径的文件名。</p>
                  <h2 id="快速体验"><a href="#快速体验" class="headerlink" title="快速体验"></a>快速体验</h2>
                  <p>现在我们以本地文件为例，传入一个名字为 hello.html 的文件，文件内容为</p>
                  <figure class="highlight xml">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"item-0"</span>&gt;</span>first item<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"item-1"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"link2.html"</span>&gt;</span>second item<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"item-0 active"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"link3.html"</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"bold"</span>&gt;</span>third item<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"item-1 active"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"link4.html"</span>&gt;</span>fourth item<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"item-0"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"link5.html"</span>&gt;</span>fifth item<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>编写如下程序</p>
                  <figure class="highlight routeros">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">from</span> pyquery import PyQuery as pq</span><br><span class="line">doc = pq(<span class="attribute">filename</span>=<span class="string">'hello.html'</span>)</span><br><span class="line"><span class="builtin-name">print</span> doc.html()</span><br><span class="line"><span class="builtin-name">print</span> type(doc)</span><br><span class="line">li = doc(<span class="string">'li'</span>)</span><br><span class="line"><span class="builtin-name">print</span> type(li)</span><br><span class="line"><span class="builtin-name">print</span> li.text()</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>运行结果</p>
                  <figure class="highlight livecodeserver">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">    &lt;ul&gt;</span><br><span class="line">         &lt;li class=<span class="string">"item-0"</span>&gt;<span class="keyword">first</span> <span class="keyword">item</span>&lt;/li&gt;</span><br><span class="line">         &lt;li class=<span class="string">"item-1"</span>&gt;&lt;<span class="keyword">a</span> href=<span class="string">"link2.html"</span>&gt;<span class="keyword">second</span> <span class="keyword">item</span>&lt;/<span class="keyword">a</span>&gt;&lt;/li&gt;</span><br><span class="line">         &lt;li class=<span class="string">"item-0 active"</span>&gt;&lt;<span class="keyword">a</span> href=<span class="string">"link3.html"</span>&gt;&lt;span class=<span class="string">"bold"</span>&gt;<span class="keyword">third</span> <span class="keyword">item</span>&lt;/span&gt;&lt;/<span class="keyword">a</span>&gt;&lt;/li&gt;</span><br><span class="line">         &lt;li class=<span class="string">"item-1 active"</span>&gt;&lt;<span class="keyword">a</span> href=<span class="string">"link4.html"</span>&gt;<span class="keyword">fourth</span> <span class="keyword">item</span>&lt;/<span class="keyword">a</span>&gt;&lt;/li&gt;</span><br><span class="line">         &lt;li class=<span class="string">"item-0"</span>&gt;&lt;<span class="keyword">a</span> href=<span class="string">"link5.html"</span>&gt;<span class="keyword">fifth</span> <span class="keyword">item</span>&lt;/<span class="keyword">a</span>&gt;&lt;/li&gt;</span><br><span class="line">     &lt;/ul&gt;</span><br><span class="line"> </span><br><span class="line">&lt;class <span class="string">'pyquery.pyquery.PyQuery'</span>&gt;</span><br><span class="line">&lt;class <span class="string">'pyquery.pyquery.PyQuery'</span>&gt;</span><br><span class="line"><span class="keyword">first</span> <span class="keyword">item</span> <span class="keyword">second</span> <span class="keyword">item</span> <span class="keyword">third</span> <span class="keyword">item</span> <span class="keyword">fourth</span> <span class="keyword">item</span> <span class="keyword">fifth</span> <span class="keyword">item</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>看，回忆一下 jQuery 的语法，是不是运行结果都是一样的呢？ 在这里我们注意到了一点，PyQuery 初始化之后，返回类型是 PyQuery，利用了选择器筛选一次之后，返回结果的类型依然还是 PyQuery，这简直和 jQuery 如出一辙，不能更赞！然而想一下 BeautifulSoup 和 XPath 返回的是什么？列表！一种不能再进行二次筛选（在这里指依然利用 BeautifulSoup 或者 XPath 语法）的对象！ 然而比比 PyQuery，哦我简直太爱它了！</p>
                  <h2 id="属性操作"><a href="#属性操作" class="headerlink" title="属性操作"></a>属性操作</h2>
                  <p>你可以完全按照 jQuery 的语法来进行 PyQuery 的操作。</p>
                  <figure class="highlight perl">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">from pyquery import PyQuery as pq</span><br><span class="line"></span><br><span class="line">p = p<span class="string">q('&lt;p id="hello" class="hello"&gt;&lt;/p&gt;')</span>(<span class="string">'p'</span>)</span><br><span class="line"><span class="keyword">print</span> p.attr(<span class="string">"id"</span>)</span><br><span class="line"><span class="keyword">print</span> p.attr(<span class="string">"id"</span>, <span class="string">"plop"</span>)</span><br><span class="line"><span class="keyword">print</span> p.attr(<span class="string">"id"</span>, <span class="string">"hello"</span>)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>运行结果</p>
                  <figure class="highlight routeros">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">hello</span><br><span class="line">&lt;p <span class="attribute">id</span>=<span class="string">"plop"</span> <span class="attribute">class</span>=<span class="string">"hello"</span>/&gt;</span><br><span class="line">&lt;p <span class="attribute">id</span>=<span class="string">"hello"</span> <span class="attribute">class</span>=<span class="string">"hello"</span>/&gt;</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>再来一发</p>
                  <figure class="highlight routeros">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">from</span> pyquery import PyQuery as pq</span><br><span class="line"></span><br><span class="line">p = pq(<span class="string">'&lt;p id="hello" class="hello"&gt;&lt;/p&gt;'</span>)(<span class="string">'p'</span>)</span><br><span class="line"><span class="builtin-name">print</span> p.addClass(<span class="string">'beauty'</span>)</span><br><span class="line"><span class="builtin-name">print</span> p.removeClass(<span class="string">'hello'</span>)</span><br><span class="line"><span class="builtin-name">print</span> p.css(<span class="string">'font-size'</span>, <span class="string">'16px'</span>)</span><br><span class="line"><span class="builtin-name">print</span> p.css(&#123;<span class="string">'background-color'</span>: <span class="string">'yellow'</span>&#125;)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>运行结果</p>
                  <figure class="highlight routeros">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">&lt;p <span class="attribute">id</span>=<span class="string">"hello"</span> <span class="attribute">class</span>=<span class="string">"hello beauty"</span>/&gt;</span><br><span class="line">&lt;p <span class="attribute">id</span>=<span class="string">"hello"</span> <span class="attribute">class</span>=<span class="string">"beauty"</span>/&gt;</span><br><span class="line">&lt;p <span class="attribute">id</span>=<span class="string">"hello"</span> <span class="attribute">class</span>=<span class="string">"beauty"</span> <span class="attribute">style</span>=<span class="string">"font-size: 16px"</span>/&gt;</span><br><span class="line">&lt;p <span class="attribute">id</span>=<span class="string">"hello"</span> <span class="attribute">class</span>=<span class="string">"beauty"</span> <span class="attribute">style</span>=<span class="string">"font-size: 16px; background-color: yellow"</span>/&gt;</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>依旧是那么优雅与自信！ 在这里我们发现了，这是一连串的操作，而 p 是一直在原来的结果上变化的。 <strong>因此执行上述操作之后，p 本身也发生了变化。</strong></p>
                  <h2 id="DOM操作"><a href="#DOM操作" class="headerlink" title="DOM操作"></a>DOM操作</h2>
                  <p>同样的原汁原味的 jQuery 语法</p>
                  <figure class="highlight vbnet">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">from</span> pyquery import PyQuery <span class="keyword">as</span> pq</span><br><span class="line"></span><br><span class="line">p = pq(<span class="comment">'<span class="doctag">&lt;p id="hello" class="hello"&gt;</span><span class="doctag">&lt;/p&gt;</span>')('p')</span></span><br><span class="line">print p.append(<span class="comment">' check out <span class="doctag">&lt;a href="http://reddit.com/r/python"&gt;</span><span class="doctag">&lt;span&gt;</span>reddit<span class="doctag">&lt;/span&gt;</span><span class="doctag">&lt;/a&gt;</span>')</span></span><br><span class="line">print p.prepend(<span class="comment">'Oh yes!')</span></span><br><span class="line">d = pq(<span class="comment">'<span class="doctag">&lt;div class="wrap"&gt;</span><span class="doctag">&lt;div id="test"&gt;</span><span class="doctag">&lt;a href="http://cuiqingcai.com"&gt;</span>Germy<span class="doctag">&lt;/a&gt;</span><span class="doctag">&lt;/div&gt;</span><span class="doctag">&lt;/div&gt;</span>')</span></span><br><span class="line">p.prependTo(d(<span class="comment">'#test'))</span></span><br><span class="line">print p</span><br><span class="line">print d</span><br><span class="line">d.empty()</span><br><span class="line">print d</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>运行结果</p>
                  <figure class="highlight xml">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">"hello"</span> <span class="attr">class</span>=<span class="string">"hello"</span>&gt;</span> check out <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"http://reddit.com/r/python"</span>&gt;</span><span class="tag">&lt;<span class="name">span</span>&gt;</span>reddit<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">"hello"</span> <span class="attr">class</span>=<span class="string">"hello"</span>&gt;</span>Oh yes! check out <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"http://reddit.com/r/python"</span>&gt;</span><span class="tag">&lt;<span class="name">span</span>&gt;</span>reddit<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">"hello"</span> <span class="attr">class</span>=<span class="string">"hello"</span>&gt;</span>Oh yes! check out <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"http://reddit.com/r/python"</span>&gt;</span><span class="tag">&lt;<span class="name">span</span>&gt;</span>reddit<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"wrap"</span>&gt;</span><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"test"</span>&gt;</span><span class="tag">&lt;<span class="name">p</span> <span class="attr">id</span>=<span class="string">"hello"</span> <span class="attr">class</span>=<span class="string">"hello"</span>&gt;</span>Oh yes! check out <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"http://reddit.com/r/python"</span>&gt;</span><span class="tag">&lt;<span class="name">span</span>&gt;</span>reddit<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"http://cuiqingcai.com"</span>&gt;</span>Germy<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"wrap"</span>/&gt;</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>这不需要多解释了吧。 DOM 操作也是与 jQuery 如出一辙。</p>
                  <h2 id="遍历"><a href="#遍历" class="headerlink" title="遍历"></a>遍历</h2>
                  <p>遍历用到 items 方法返回对象列表，或者用 lambda</p>
                  <figure class="highlight routeros">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">from</span> pyquery import PyQuery as pq</span><br><span class="line">doc = pq(<span class="attribute">filename</span>=<span class="string">'hello.html'</span>)</span><br><span class="line">lis = doc(<span class="string">'li'</span>)</span><br><span class="line"><span class="keyword">for</span> li <span class="keyword">in</span> lis.items():</span><br><span class="line">    <span class="builtin-name">print</span> li.html()</span><br><span class="line"></span><br><span class="line"><span class="builtin-name">print</span> lis.each(lambda e: e)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>运行结果</p>
                  <figure class="highlight livecodeserver">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">first</span> <span class="keyword">item</span></span><br><span class="line">&lt;<span class="keyword">a</span> href=<span class="string">"link2.html"</span>&gt;<span class="keyword">second</span> <span class="keyword">item</span>&lt;/<span class="keyword">a</span>&gt;</span><br><span class="line">&lt;<span class="keyword">a</span> href=<span class="string">"link3.html"</span>&gt;&lt;span class=<span class="string">"bold"</span>&gt;<span class="keyword">third</span> <span class="keyword">item</span>&lt;/span&gt;&lt;/<span class="keyword">a</span>&gt;</span><br><span class="line">&lt;<span class="keyword">a</span> href=<span class="string">"link4.html"</span>&gt;<span class="keyword">fourth</span> <span class="keyword">item</span>&lt;/<span class="keyword">a</span>&gt;</span><br><span class="line">&lt;<span class="keyword">a</span> href=<span class="string">"link5.html"</span>&gt;<span class="keyword">fifth</span> <span class="keyword">item</span>&lt;/<span class="keyword">a</span>&gt;</span><br><span class="line">&lt;li class=<span class="string">"item-0"</span>&gt;<span class="keyword">first</span> <span class="keyword">item</span>&lt;/li&gt;</span><br><span class="line"> &lt;li class=<span class="string">"item-1"</span>&gt;&lt;<span class="keyword">a</span> href=<span class="string">"link2.html"</span>&gt;<span class="keyword">second</span> <span class="keyword">item</span>&lt;/<span class="keyword">a</span>&gt;&lt;/li&gt;</span><br><span class="line"> &lt;li class=<span class="string">"item-0 active"</span>&gt;&lt;<span class="keyword">a</span> href=<span class="string">"link3.html"</span>&gt;&lt;span class=<span class="string">"bold"</span>&gt;<span class="keyword">third</span> <span class="keyword">item</span>&lt;/span&gt;&lt;/<span class="keyword">a</span>&gt;&lt;/li&gt;</span><br><span class="line"> &lt;li class=<span class="string">"item-1 active"</span>&gt;&lt;<span class="keyword">a</span> href=<span class="string">"link4.html"</span>&gt;<span class="keyword">fourth</span> <span class="keyword">item</span>&lt;/<span class="keyword">a</span>&gt;&lt;/li&gt;</span><br><span class="line"> &lt;li class=<span class="string">"item-0"</span>&gt;&lt;<span class="keyword">a</span> href=<span class="string">"link5.html"</span>&gt;<span class="keyword">fifth</span> <span class="keyword">item</span>&lt;/<span class="keyword">a</span>&gt;&lt;/li&gt;</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>不过最常用的还是 items 方法</p>
                  <h2 id="网页请求"><a href="#网页请求" class="headerlink" title="网页请求"></a>网页请求</h2>
                  <p>PyQuery 本身还有网页请求功能，而且会把请求下来的网页代码转为 PyQuery 对象。</p>
                  <figure class="highlight routeros">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">from</span> pyquery import PyQuery as pq</span><br><span class="line"><span class="builtin-name">print</span> pq(<span class="string">'http://cuiqingcai.com/'</span>, headers=&#123;<span class="string">'user-agent'</span>: <span class="string">'pyquery'</span>&#125;)</span><br><span class="line"><span class="builtin-name">print</span> pq(<span class="string">'http://httpbin.org/post'</span>, &#123;<span class="string">'foo'</span>: <span class="string">'bar'</span>&#125;, <span class="attribute">method</span>=<span class="string">'post'</span>, <span class="attribute">verify</span>=<span class="literal">True</span>)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>感受一下，GET，POST，样样通。</p>
                  <h2 id="Ajax"><a href="#Ajax" class="headerlink" title="Ajax"></a>Ajax</h2>
                  <p>PyQuery 同样支持 Ajax 操作，带有 get 和 post 方法，不过不常用，一般我们不会用 PyQuery 来做网络请求，仅仅是用来解析。 <a href="https://pythonhosted.org/pyquery/ajax.html" target="_blank" rel="noopener">PyQueryAjax</a></p>
                  <h2 id="API"><a href="#API" class="headerlink" title="API"></a>API</h2>
                  <p>最后少不了的，API大放送。 <a href="https://pythonhosted.org/pyquery/api.html" target="_blank" rel="noopener">API</a> 原汁原味最全的API，都在里面了！如果你对 jQuery 语法不熟，强烈建议先学习下 jQuery，再回来看 PyQuery，你会感到异常亲切！</p>
                  <h2 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h2>
                  <p>用完了 PyQuery，我已经深深爱上了他！ 你呢？</p>
                  </p>
                </div>
              </div>
              <div class="post-meta">
                <span class="post-meta-item">
                  <span class="post-meta-item-icon">
                    <i class="far fa-user"></i>
                  </span>
                  <span class="post-meta-item-text">作者</span>
                  <span><a href="/authors/崔庆才" class="author" itemprop="url" rel="index">崔庆才</a></span>
                </span>
                <span class="post-meta-item">
                  <span class="post-meta-item-icon">
                    <i class="far fa-calendar"></i>
                  </span>
                  <span class="post-meta-item-text">发表于</span>
                  <time title="创建时间：2016-03-24 01:44:18" itemprop="dateCreated datePublished" datetime="2016-03-24T01:44:18+08:00">2016-03-24</time>
                </span>
                <span id="/2636.html" class="post-meta-item leancloud_visitors" data-flag-title="Python爬虫利器六之PyQuery的用法" title="阅读次数">
                  <span class="post-meta-item-icon">
                    <i class="fa fa-eye"></i>
                  </span>
                  <span class="post-meta-item-text">阅读次数：</span>
                  <span class="leancloud-visitors-count"></span>
                </span>
                <span class="post-meta-item" title="本文字数">
                  <span class="post-meta-item-icon">
                    <i class="far fa-file-word"></i>
                  </span>
                  <span class="post-meta-item-text">本文字数：</span>
                  <span>6.2k</span>
                </span>
                <span class="post-meta-item" title="阅读时长">
                  <span class="post-meta-item-icon">
                    <i class="far fa-clock"></i>
                  </span>
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                  <span>6 分钟</span>
                </span>
              </div>
            </article>
            <article itemscope itemtype="http://schema.org/Article" class="post-block index" lang="zh-CN">
              <link itemprop="mainEntityOfPage" href="https://cuiqingcai.com/2621.html">
              <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
                <meta itemprop="image" content="/images/avatar.png">
                <meta itemprop="name" content="崔庆才">
                <meta itemprop="description" content="崔庆才的个人站点，记录生活的瞬间，分享学习的心得。">
              </span>
              <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
                <meta itemprop="name" content="静觅">
              </span>
              <header class="post-header">
                <h2 class="post-title" itemprop="name headline">
                  <a class="label"> Python <i class="label-arrow"></i>
                  </a>
                  <a href="/2621.html" class="post-title-link" itemprop="url">Python爬虫利器三之Xpath语法与lxml库的用法</a>
                </h2>
              </header>
              <div class="post-body" itemprop="articleBody">
                <div class="thumb">
                  <img itemprop="contentUrl" class="random">
                </div>
                <div class="excerpt">
                  <p>
                  <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2>
                  <p>前面我们介绍了 BeautifulSoup 的用法，这个已经是非常强大的库了，不过还有一些比较流行的解析库，例如 lxml，使用的是 Xpath 语法，同样是效率比较高的解析方法。如果大家对 BeautifulSoup 使用不太习惯的话，可以尝试下 Xpath。</p>
                  <h2 id="参考来源"><a href="#参考来源" class="headerlink" title="参考来源"></a>参考来源</h2>
                  <p>lxml用法源自 lxml python 官方文档，更多内容请直接参阅官方文档，本文对其进行翻译与整理。 <a href="http://lxml.de/index.html" target="_blank" rel="noopener">lxml</a> XPath语法参考 w3school <a href="http://www.w3school.com.cn/xpath/index.asp" target="_blank" rel="noopener">w3school</a></p>
                  <h2 id="视频资源"><a href="#视频资源" class="headerlink" title="视频资源"></a>视频资源</h2>
                  <p>如果你对 XPath 不熟悉的话，可以看下这个视频资源： <a href="https://www.imooc.com/learn/950" target="_blank" rel="noopener">web端功能自动化定位元素</a></p>
                  <h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2>
                  <figure class="highlight cmake">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">pip <span class="keyword">install</span> lxml</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>利用 pip 安装即可</p>
                  <h2 id="XPath语法"><a href="#XPath语法" class="headerlink" title="XPath语法"></a>XPath语法</h2>
                  <p>XPath 是一门在 XML 文档中查找信息的语言。XPath 可用来在 XML 文档中对元素和属性进行遍历。XPath 是 W3C XSLT 标准的主要元素，并且 XQuery 和 XPointer 都构建于 XPath 表达之上。</p>
                  <h3 id="节点关系"><a href="#节点关系" class="headerlink" title="节点关系"></a>节点关系</h3>
                  <p>（1）父（Parent） 每个元素以及属性都有一个父。 在下面的例子中，book 元素是 title、author、year 以及 price 元素的父：</p>
                  <figure class="highlight xml">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="tag">&lt;<span class="name">book</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Harry Potter<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">author</span>&gt;</span>J K. Rowling<span class="tag">&lt;/<span class="name">author</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">year</span>&gt;</span>2005<span class="tag">&lt;/<span class="name">year</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">price</span>&gt;</span>29.99<span class="tag">&lt;/<span class="name">price</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">book</span>&gt;</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>（2）子（Children） 元素节点可有零个、一个或多个子。 在下面的例子中，title、author、year 以及 price 元素都是 book 元素的子：</p>
                  <figure class="highlight xml">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="tag">&lt;<span class="name">book</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Harry Potter<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">author</span>&gt;</span>J K. Rowling<span class="tag">&lt;/<span class="name">author</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">year</span>&gt;</span>2005<span class="tag">&lt;/<span class="name">year</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">price</span>&gt;</span>29.99<span class="tag">&lt;/<span class="name">price</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">book</span>&gt;</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>（3）同胞（Sibling） 拥有相同的父的节点 在下面的例子中，title、author、year 以及 price 元素都是同胞：</p>
                  <figure class="highlight xml">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="tag">&lt;<span class="name">book</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Harry Potter<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">author</span>&gt;</span>J K. Rowling<span class="tag">&lt;/<span class="name">author</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">year</span>&gt;</span>2005<span class="tag">&lt;/<span class="name">year</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">price</span>&gt;</span>29.99<span class="tag">&lt;/<span class="name">price</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">book</span>&gt;</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>（4）先辈（Ancestor） 某节点的父、父的父，等等。 在下面的例子中，title 元素的先辈是 book 元素和 bookstore 元素：</p>
                  <figure class="highlight xml">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="tag">&lt;<span class="name">bookstore</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">book</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Harry Potter<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">author</span>&gt;</span>J K. Rowling<span class="tag">&lt;/<span class="name">author</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">year</span>&gt;</span>2005<span class="tag">&lt;/<span class="name">year</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">price</span>&gt;</span>29.99<span class="tag">&lt;/<span class="name">price</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">book</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">bookstore</span>&gt;</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>（5）后代（Descendant） 某个节点的子，子的子，等等。 在下面的例子中，bookstore 的后代是 book、title、author、year 以及 price 元素：</p>
                  <figure class="highlight xml">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="tag">&lt;<span class="name">bookstore</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">book</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Harry Potter<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">author</span>&gt;</span>J K. Rowling<span class="tag">&lt;/<span class="name">author</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">year</span>&gt;</span>2005<span class="tag">&lt;/<span class="name">year</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">price</span>&gt;</span>29.99<span class="tag">&lt;/<span class="name">price</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">book</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">bookstore</span>&gt;</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <h3 id="选取节点"><a href="#选取节点" class="headerlink" title="选取节点"></a>选取节点</h3>
                  <p>XPath 使用路径表达式在 XML 文档中选取节点。节点是通过沿着路径或者 step 来选取的。</p>
                  <h3 id="下面列出了最有用的路径表达式："><a href="#下面列出了最有用的路径表达式：" class="headerlink" title="下面列出了最有用的路径表达式："></a>下面列出了最有用的路径表达式：</h3>
                  <p>表达式</p>
                  <p>描述</p>
                  <p>nodename</p>
                  <p>选取此节点的所有子节点。</p>
                  <p>/</p>
                  <p>从根节点选取。</p>
                  <p>//</p>
                  <p>从匹配选择的当前节点选择文档中的节点，而不考虑它们的位置。</p>
                  <p>.</p>
                  <p>选取当前节点。</p>
                  <p>..</p>
                  <p>选取当前节点的父节点。</p>
                  <p>@</p>
                  <p>选取属性。</p>
                  <p><strong>实例</strong> 在下面的表格中，我们已列出了一些路径表达式以及表达式的结果：</p>
                  <p>路径表达式</p>
                  <p>结果</p>
                  <p>bookstore</p>
                  <p>选取 bookstore 元素的所有子节点。</p>
                  <p>/bookstore</p>
                  <p>选取根元素 bookstore。注释：假如路径起始于正斜杠( / )，则此路径始终代表到某元素的绝对路径！</p>
                  <p>bookstore/book</p>
                  <p>选取属于 bookstore 的子元素的所有 book 元素。</p>
                  <p>//book</p>
                  <p>选取所有 book 子元素，而不管它们在文档中的位置。</p>
                  <p>bookstore//book</p>
                  <p>选择属于 bookstore 元素的后代的所有 book 元素，而不管它们位于 bookstore 之下的什么位置。</p>
                  <p>//@lang</p>
                  <p>选取名为 lang 的所有属性。</p>
                  <h3 id="谓语（Predicates）"><a href="#谓语（Predicates）" class="headerlink" title="谓语（Predicates）"></a>谓语（Predicates）</h3>
                  <p>谓语用来查找某个特定的节点或者包含某个指定的值的节点。 谓语被嵌在方括号中。 <strong>实例</strong> 在下面的表格中，我们列出了带有谓语的一些路径表达式，以及表达式的结果：</p>
                  <p>路径表达式</p>
                  <p>结果</p>
                  <p>/bookstore/book[1]</p>
                  <p>选取属于 bookstore 子元素的第一个 book 元素。</p>
                  <p>/bookstore/book[last()]</p>
                  <p>选取属于 bookstore 子元素的最后一个 book 元素。</p>
                  <p>/bookstore/book[last()-1]</p>
                  <p>选取属于 bookstore 子元素的倒数第二个 book 元素。</p>
                  <p>/bookstore/book[position()&lt;3]</p>
                  <p>选取最前面的两个属于 bookstore 元素的子元素的 book 元素。</p>
                  <p>//title[@lang]</p>
                  <p>选取所有拥有名为 lang 的属性的 title 元素。</p>
                  <p>//title[@lang=’eng’]</p>
                  <p>选取所有 title 元素，且这些元素拥有值为 eng 的 lang 属性。</p>
                  <p>/bookstore/book[price&gt;35.00]</p>
                  <p>选取 bookstore 元素的所有 book 元素，且其中的 price 元素的值须大于 35.00。</p>
                  <p>/bookstore/book[price&gt;35.00]/title</p>
                  <p>选取 bookstore 元素中的 book 元素的所有 title 元素，且其中的 price 元素的值须大于 35.00。</p>
                  <h3 id="选取未知节点"><a href="#选取未知节点" class="headerlink" title="选取未知节点"></a>选取未知节点</h3>
                  <p>XPath 通配符可用来选取未知的 XML 元素。</p>
                  <p>通配符</p>
                  <p>描述</p>
                  <p>*</p>
                  <p>匹配任何元素节点。</p>
                  <p>@*</p>
                  <p>匹配任何属性节点。</p>
                  <p>node()</p>
                  <p>匹配任何类型的节点。</p>
                  <p><strong>实例</strong> 在下面的表格中，我们列出了一些路径表达式，以及这些表达式的结果：</p>
                  <p>路径表达式</p>
                  <p>结果</p>
                  <p>/bookstore/*</p>
                  <p>选取 bookstore 元素的所有子元素。</p>
                  <p>//*</p>
                  <p>选取文档中的所有元素。</p>
                  <p>//title[@*]</p>
                  <p>选取所有带有属性的 title 元素。</p>
                  <h3 id="选取若干路径"><a href="#选取若干路径" class="headerlink" title="选取若干路径"></a>选取若干路径</h3>
                  <p>通过在路径表达式中使用“|”运算符，您可以选取若干个路径。 <strong>实例</strong> 在下面的表格中，我们列出了一些路径表达式，以及这些表达式的结果：</p>
                  <p>路径表达式</p>
                  <p>结果</p>
                  <p>//book/title | //book/price</p>
                  <p>选取 book 元素的所有 title 和 price 元素。</p>
                  <p>//title | //price</p>
                  <p>选取文档中的所有 title 和 price 元素。</p>
                  <p>/bookstore/book/title | //price</p>
                  <p>选取属于 bookstore 元素的 book 元素的所有 title 元素，以及文档中所有的 price 元素。</p>
                  <h3 id="XPath-运算符"><a href="#XPath-运算符" class="headerlink" title="XPath 运算符"></a>XPath 运算符</h3>
                  <p>下面列出了可用在 XPath 表达式中的运算符：</p>
                  <p>运算符</p>
                  <p>描述</p>
                  <p>实例</p>
                  <p>返回值</p>
                  <p>|</p>
                  <p>计算两个节点集</p>
                  <p>//book | //cd</p>
                  <p>返回所有拥有 book 和 cd 元素的节点集</p>
                  <p>+</p>
                  <p>加法</p>
                  <p>6 + 4</p>
                  <p>10</p>
                  <p>-</p>
                  <p>减法</p>
                  <p>6 - 4</p>
                  <p>2</p>
                  <p>*</p>
                  <p>乘法</p>
                  <p>6 * 4</p>
                  <p>24</p>
                  <p>div</p>
                  <p>除法</p>
                  <p>8 div 4</p>
                  <p>2</p>
                  <p>\=</p>
                  <p>等于</p>
                  <p>price=9.80</p>
                  <p>如果 price 是 9.80，则返回 true。如果 price 是 9.90，则返回 false。</p>
                  <p>!=</p>
                  <p>不等于</p>
                  <p>price!=9.80</p>
                  <p>如果 price 是 9.90，则返回 true。如果 price 是 9.80，则返回 false。</p>
                  <p>&lt;</p>
                  <p>小于</p>
                  <p>price&lt;9.80</p>
                  <p>如果 price 是 9.00，则返回 true。如果 price 是 9.90，则返回 false。</p>
                  <p>&lt;=</p>
                  <p>小于或等于</p>
                  <p>price&lt;=9.80</p>
                  <p>如果 price 是 9.00，则返回 true。如果 price 是 9.90，则返回 false。</p>
                  <p>></p>
                  <p>大于</p>
                  <p>price&gt;9.80</p>
                  <p>如果 price 是 9.90，则返回 true。如果 price 是 9.80，则返回 false。</p>
                  <p>>=</p>
                  <p>大于或等于</p>
                  <p>price&gt;=9.80</p>
                  <p>如果 price 是 9.90，则返回 true。如果 price 是 9.70，则返回 false。</p>
                  <p>or</p>
                  <p>或</p>
                  <p>price=9.80 or price=9.70</p>
                  <p>如果 price 是 9.80，则返回 true。如果 price 是 9.50，则返回 false。</p>
                  <p>and</p>
                  <p>与</p>
                  <p>price&gt;9.00 and price&lt;9.90</p>
                  <p>如果 price 是 9.80，则返回 true。如果 price 是 8.50，则返回 false。</p>
                  <p>mod</p>
                  <p>计算除法的余数</p>
                  <p>5 mod 2</p>
                  <p>1</p>
                  <h2 id="lxml用法"><a href="#lxml用法" class="headerlink" title="lxml用法"></a>lxml用法</h2>
                  <h3 id="初步使用"><a href="#初步使用" class="headerlink" title="初步使用"></a>初步使用</h3>
                  <p>首先我们利用它来解析 HTML 代码，先来一个小例子来感受一下它的基本用法。</p>
                  <figure class="highlight xml">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">from lxml import etree</span><br><span class="line">text = '''</span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"item-0"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"link1.html"</span>&gt;</span>first item<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"item-1"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"link2.html"</span>&gt;</span>second item<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"item-inactive"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"link3.html"</span>&gt;</span>third item<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"item-1"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"link4.html"</span>&gt;</span>fourth item<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"item-0"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"link5.html"</span>&gt;</span>fifth item<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">'''</span><br><span class="line">html = etree.HTML(text)</span><br><span class="line">result = etree.tostring(html)</span><br><span class="line">print(result)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>首先我们使用 lxml 的 etree 库，然后利用 etree.HTML 初始化，然后我们将其打印出来。 其中，这里体现了 lxml 的一个非常实用的功能就是自动修正 html 代码，大家应该注意到了，最后一个 li 标签，其实我把尾标签删掉了，是不闭合的。不过，lxml 因为继承了 libxml2 的特性，具有自动修正 HTML 代码的功能。 所以输出结果是这样的</p>
                  <figure class="highlight xml">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"item-0"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"link1.html"</span>&gt;</span>first item<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"item-1"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"link2.html"</span>&gt;</span>second item<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"item-inactive"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"link3.html"</span>&gt;</span>third item<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"item-1"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"link4.html"</span>&gt;</span>fourth item<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"item-0"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"link5.html"</span>&gt;</span>fifth item<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>不仅补全了 li 标签，还添加了 body，html 标签。</p>
                  <h3 id="文件读取"><a href="#文件读取" class="headerlink" title="文件读取"></a>文件读取</h3>
                  <p>除了直接读取字符串，还支持从文件读取内容。比如我们新建一个文件叫做 hello.html，内容为</p>
                  <figure class="highlight xml">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"item-0"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"link1.html"</span>&gt;</span>first item<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"item-1"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"link2.html"</span>&gt;</span>second item<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"item-inactive"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"link3.html"</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">"bold"</span>&gt;</span>third item<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"item-1"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"link4.html"</span>&gt;</span>fourth item<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">         <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"item-0"</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"link5.html"</span>&gt;</span>fifth item<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>利用 parse 方法来读取文件。</p>
                  <figure class="highlight routeros">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">from</span> lxml import etree</span><br><span class="line">html = etree.parse(<span class="string">'hello.html'</span>)</span><br><span class="line">result = etree.tostring(html, <span class="attribute">pretty_print</span>=<span class="literal">True</span>)</span><br><span class="line"><span class="builtin-name">print</span>(result)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>同样可以得到相同的结果。</p>
                  <h3 id="XPath实例测试"><a href="#XPath实例测试" class="headerlink" title="XPath实例测试"></a>XPath实例测试</h3>
                  <p>依然以上一段程序为例 （1）获取所有的 <li> 标签</p>
                  <figure class="highlight routeros">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">from</span> lxml import etree</span><br><span class="line">html = etree.parse(<span class="string">'hello.html'</span>)</span><br><span class="line"><span class="builtin-name">print</span> type(html)</span><br><span class="line">result = html.xpath(<span class="string">'//li'</span>)</span><br><span class="line"><span class="builtin-name">print</span> result</span><br><span class="line"><span class="builtin-name">print</span> len(result)</span><br><span class="line"><span class="builtin-name">print</span> type(result)</span><br><span class="line"><span class="builtin-name">print</span> type(result[0])</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>运行结果</p>
                  <figure class="highlight fsharp">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">&lt;<span class="class"><span class="keyword">type</span> '<span class="title">lxml</span>.<span class="title">etree</span>.<span class="title">_ElementTree</span>'&gt;</span></span><br><span class="line"><span class="meta">[&lt;Element li at 0x1014e0e18&gt;, &lt;Element li at 0x1014e0ef0&gt;, &lt;Element li at 0x1014e0f38&gt;, &lt;Element li at 0x1014e0f80&gt;, &lt;Element li at 0x1014e0fc8&gt;]</span></span><br><span class="line"><span class="number">5</span></span><br><span class="line">&lt;<span class="class"><span class="keyword">type</span> '<span class="title">list</span>'&gt;</span></span><br><span class="line">&lt;<span class="class"><span class="keyword">type</span> '<span class="title">lxml</span>.<span class="title">etree</span>.<span class="title">_Element</span>'&gt;</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>可见，etree.parse 的类型是 ElementTree，通过调用 xpath 以后，得到了一个列表，包含了 5 个 <li> 元素，每个元素都是 Element 类型 （2）获取
                    <li> 标签的所有 class
                  </p>
                  <figure class="highlight isbl">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="variable"><span class="class">result</span></span> = <span class="variable">html.xpath</span>(<span class="string">'//li/@class'</span>)</span><br><span class="line"><span class="variable">print</span> <span class="variable"><span class="class">result</span></span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>运行结果</p>
                  <figure class="highlight scheme">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">[<span class="symbol">'item-0</span>', <span class="symbol">'item-1</span>', <span class="symbol">'item-inactive</span>', <span class="symbol">'item-1</span>', <span class="symbol">'item-0</span>']</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>（3）获取 <li> 标签下 href 为 link1.html 的 <a> 标签</p>
                  <figure class="highlight cos">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">result = html.xpath('<span class="comment">//li/a[@href="link1.html"]')</span></span><br><span class="line"><span class="keyword">print</span> result</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>运行结果</p>
                  <figure class="highlight fsharp">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="meta">[&lt;Element a at 0x10ffaae18&gt;]</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>（4）获取 <li> 标签下的所有 <span> 标签 注意这么写是不对的</p>
                  <figure class="highlight ini">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="attr">result</span> = html.xpath(<span class="string">'//li/span'</span>)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>因为 / 是用来获取子元素的，而 <span> 并不是 <li> 的子元素，所以，要用双斜杠</p>
                  <figure class="highlight isbl">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="variable"><span class="class">result</span></span> = <span class="variable">html.xpath</span>(<span class="string">'//li//span'</span>)</span><br><span class="line"><span class="variable">print</span> <span class="variable"><span class="class">result</span></span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>运行结果</p>
                  <figure class="highlight fsharp">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="meta">[&lt;Element span at 0x10d698e18&gt;]</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>（5）获取 <li> 标签下的所有 class，不包括
                    <li>
                  </p>
                  <figure class="highlight cos">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">result = html.xpath('<span class="comment">//li/a//@class')</span></span><br><span class="line"><span class="keyword">print</span> result</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>运行结果</p>
                  <figure class="highlight scheme">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">[<span class="symbol">'blod</span>']</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>（6）获取最后一个 <li> 的 <a> 的 href</p>
                  <figure class="highlight cos">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">result = html.xpath('<span class="comment">//li[last()]/a/@href')</span></span><br><span class="line"><span class="keyword">print</span> result</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>运行结果</p>
                  <figure class="highlight scheme">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">[<span class="symbol">'link5.html</span>']</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>（7）获取倒数第二个元素的内容</p>
                  <figure class="highlight livecodeserver">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="built_in">result</span> = html.xpath(<span class="string">'//li[last()-1]/a'</span>)</span><br><span class="line">print <span class="built_in">result</span>[<span class="number">0</span>].<span class="keyword">text</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>运行结果</p>
                  <figure class="highlight applescript">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">fourth</span> <span class="built_in">item</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>（8）获取 class 为 bold 的标签名</p>
                  <figure class="highlight crmsh">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">result = html.<span class="keyword">xpath</span>('//*[@<span class="attr">class=</span><span class="string">"bold"</span>]')</span><br><span class="line">print result[<span class="number">0</span>].<span class="keyword">tag</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>运行结果</p>
                  <figure class="highlight ebnf">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="attribute">span</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>通过以上实例的练习，相信大家对 XPath 的基本用法有了基本的了解。也可以利用 text 方法来获取元素的内容。 大家多加练习！</p>
                  <h2 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h2>
                  <p>XPath 是一个非常好用的解析方法，同时也作为爬虫学习的基础，在后面的 selenium 以及 scrapy 框架中都会涉及到这部分知识，希望大家可以把它的语法掌握清楚，为后面的深入研究做好铺垫。</p>
                  </p>
                </div>
              </div>
              <div class="post-meta">
                <span class="post-meta-item">
                  <span class="post-meta-item-icon">
                    <i class="far fa-user"></i>
                  </span>
                  <span class="post-meta-item-text">作者</span>
                  <span><a href="/authors/崔庆才" class="author" itemprop="url" rel="index">崔庆才</a></span>
                </span>
                <span class="post-meta-item">
                  <span class="post-meta-item-icon">
                    <i class="far fa-calendar"></i>
                  </span>
                  <span class="post-meta-item-text">发表于</span>
                  <time title="创建时间：2016-03-23 23:19:25" itemprop="dateCreated datePublished" datetime="2016-03-23T23:19:25+08:00">2016-03-23</time>
                </span>
                <span id="/2621.html" class="post-meta-item leancloud_visitors" data-flag-title="Python爬虫利器三之Xpath语法与lxml库的用法" title="阅读次数">
                  <span class="post-meta-item-icon">
                    <i class="fa fa-eye"></i>
                  </span>
                  <span class="post-meta-item-text">阅读次数：</span>
                  <span class="leancloud-visitors-count"></span>
                </span>
                <span class="post-meta-item" title="本文字数">
                  <span class="post-meta-item-icon">
                    <i class="far fa-file-word"></i>
                  </span>
                  <span class="post-meta-item-text">本文字数：</span>
                  <span>7.2k</span>
                </span>
                <span class="post-meta-item" title="阅读时长">
                  <span class="post-meta-item-icon">
                    <i class="far fa-clock"></i>
                  </span>
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                  <span>7 分钟</span>
                </span>
              </div>
            </article>
            <article itemscope itemtype="http://schema.org/Article" class="post-block index" lang="zh-CN">
              <link itemprop="mainEntityOfPage" href="https://cuiqingcai.com/2599.html">
              <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
                <meta itemprop="image" content="/images/avatar.png">
                <meta itemprop="name" content="崔庆才">
                <meta itemprop="description" content="崔庆才的个人站点，记录生活的瞬间，分享学习的心得。">
              </span>
              <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
                <meta itemprop="name" content="静觅">
              </span>
              <header class="post-header">
                <h2 class="post-title" itemprop="name headline">
                  <a class="label"> Python <i class="label-arrow"></i>
                  </a>
                  <a href="/2599.html" class="post-title-link" itemprop="url">Python爬虫利器五之Selenium的用法</a>
                </h2>
              </header>
              <div class="post-body" itemprop="articleBody">
                <div class="thumb">
                  <img itemprop="contentUrl" class="random">
                </div>
                <div class="excerpt">
                  <p>
                  <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2>
                  <p>在上一节我们学习了 PhantomJS 的基本用法，归根结底它是一个没有界面的浏览器，而且运行的是 JavaScript 脚本，然而这就能写爬虫了吗？这又和Python有什么关系？说好的Python爬虫呢？库都学完了你给我看这个？客官别急，接下来我们介绍的这个工具，统统解决掉你的疑惑。</p>
                  <h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2>
                  <p>Selenium 是什么？一句话，自动化测试工具。它支持各种浏览器，包括 Chrome，Safari，Firefox 等主流界面式浏览器，如果你在这些浏览器里面安装一个 Selenium 的插件，那么便可以方便地实现Web界面的测试。换句话说叫 Selenium 支持这些浏览器驱动。话说回来，PhantomJS不也是一个浏览器吗，那么 Selenium 支持不？答案是肯定的，这样二者便可以实现无缝对接了。 然后又有什么好消息呢？Selenium支持多种语言开发，比如 Java，C，Ruby等等，有 Python 吗？那是必须的！哦这可真是天大的好消息啊。 嗯，所以呢？安装一下 Python 的 Selenium 库，再安装好 PhantomJS，不就可以实现 Python＋Selenium＋PhantomJS 的无缝对接了嘛！PhantomJS 用来渲染解析JS，Selenium 用来驱动以及与 Python 的对接，Python 进行后期的处理，完美的三剑客！ 有人问，为什么不直接用浏览器而用一个没界面的 PhantomJS 呢？答案是：效率高！ Selenium 有两个版本，目前最新版本是 2.53.1（2016/3/22）</p>
                  <blockquote>
                    <p>Selenium 2，又名 WebDriver，它的主要新功能是集成了 Selenium 1.0 以及 WebDriver（WebDriver 曾经是 Selenium 的竞争对手）。也就是说 Selenium 2 是 Selenium 和 WebDriver 两个项目的合并，即 Selenium 2 兼容 Selenium，它既支持 Selenium API 也支持 WebDriver API。</p>
                  </blockquote>
                  <p>更多详情可以查看 Webdriver 的简介。 <a href="http://www.51testing.com/zhuanti/webdriver.htm" target="_blank" rel="noopener">Webdriver</a> 嗯，通过以上描述，我们应该对 Selenium 有了大概对认识，接下来就让我们开始进入动态爬取的新世界吧。 本文参考内容来自 <a href="http://www.seleniumhq.org/docs/index.jsp" target="_blank" rel="noopener">Selenium官网</a> <a href="http://selenium-python.readthedocs.org/index.html" target="_blank" rel="noopener">SeleniumPython文档</a></p>
                  <h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2>
                  <p>首先安装 Selenium</p>
                  <figure class="highlight cmake">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">pip <span class="keyword">install</span> selenium</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>或者下载源码 <a href="https://pypi.python.org/pypi/selenium" target="_blank" rel="noopener">下载源码</a> 然后解压后运行下面的命令进行安装</p>
                  <figure class="highlight vim">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">python</span> setup.<span class="keyword">py</span> install</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>安装好了之后我们便开始探索抓取方法了。</p>
                  <h2 id="快速开始"><a href="#快速开始" class="headerlink" title="快速开始"></a>快速开始</h2>
                  <h3 id="初步体验"><a href="#初步体验" class="headerlink" title="初步体验"></a>初步体验</h3>
                  <p>我们先来一个小例子感受一下 Selenium，这里我们用 Chrome 浏览器来测试，方便查看效果，到真正爬取的时候换回 PhantomJS 即可。</p>
                  <figure class="highlight pgsql">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">from</span> selenium <span class="keyword">import</span> webdriver</span><br><span class="line"></span><br><span class="line">browser = webdriver.Chrome()</span><br><span class="line">browser.<span class="keyword">get</span>(<span class="string">'http://www.baidu.com/'</span>)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>运行这段代码，会自动打开浏览器，然后访问百度。 如果程序执行错误，浏览器没有打开，那么应该是没有装 Chrome 浏览器或者 Chrome 驱动没有配置在环境变量里。下载驱动，然后将驱动文件路径配置在环境变量即可。 <a href="https://sites.google.com/a/chromium.org/chromedriver/downloads" target="_blank" rel="noopener">浏览器驱动下载</a> 比如我的是 Mac OS，就把下载好的文件放在 /usr/bin 目录下就可以了。</p>
                  <h3 id="模拟提交"><a href="#模拟提交" class="headerlink" title="模拟提交"></a>模拟提交</h3>
                  <p>下面的代码实现了模拟提交提交搜索的功能，首先等页面加载完成，然后输入到搜索框文本，点击提交。</p>
                  <figure class="highlight sqf">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">from</span> selenium import webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.keys import Keys</span><br><span class="line"></span><br><span class="line"><span class="built_in">driver</span> = webdriver.Chrome()</span><br><span class="line"><span class="built_in">driver</span>.get(<span class="string">"http://www.python.org"</span>)</span><br><span class="line"><span class="built_in">assert</span> <span class="string">"Python"</span> <span class="built_in">in</span> <span class="built_in">driver</span>.title</span><br><span class="line">elem = <span class="built_in">driver</span>.find_element_by_name(<span class="string">"q"</span>)</span><br><span class="line">elem.send_keys(<span class="string">"pycon"</span>)</span><br><span class="line">elem.send_keys(Keys.RETURN)</span><br><span class="line">print <span class="built_in">driver</span>.page_source</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>同样是在 Chrome 里面测试，感受一下。</p>
                  <blockquote>
                    <p>The driver.get method will navigate to a page given by the URL. WebDriver will wait until the page has fully loaded (that is, the “onload” event has fired) before returning control to your test or script. It’s worth noting that if your page uses a lot of AJAX on load then WebDriver may not know when it has completely loaded.</p>
                  </blockquote>
                  <p>其中 driver.get 方法会打开请求的URL，WebDriver 会等待页面完全加载完成之后才会返回，即程序会等待页面的所有内容加载完成，JS渲染完毕之后才继续往下执行。注意：如果这里用到了特别多的 Ajax 的话，程序可能不知道是否已经完全加载完毕。</p>
                  <blockquote>
                    <p>WebDriver offers a number of ways to find elements using one of the find<em>element_by</em>* methods. For example, the input text element can be located by its name attribute using find_element_by_name method</p>
                  </blockquote>
                  <p>WebDriver 提供了许多寻找网页元素的方法，譬如 find<em>element_by</em>* 的方法。例如一个输入框可以通过 find_element_by_name 方法寻找 name 属性来确定。</p>
                  <blockquote>
                    <p>Next we are sending keys, this is similar to entering keys using your keyboard. Special keys can be send using Keys class imported from selenium.webdriver.common.keys</p>
                  </blockquote>
                  <p>然后我们输入来文本然后模拟点击了回车，就像我们敲击键盘一样。我们可以利用 Keys 这个类来模拟键盘输入。 最后最重要的一点 <strong>获取网页渲染后的源代码。</strong> 输出 <strong>page_source</strong> 属性即可。 这样，我们就可以做到网页的动态爬取了。</p>
                  <h3 id="测试用例"><a href="#测试用例" class="headerlink" title="测试用例"></a>测试用例</h3>
                  <p>有了以上特性，我们当然可以用来写测试样例了。</p>
                  <figure class="highlight ruby">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">import unittest</span><br><span class="line">from selenium import webdriver</span><br><span class="line">from selenium.webdriver.common.keys import Keys</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PythonOrgSearch</span>(<span class="title">unittest</span>.<span class="title">TestCase</span>):</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">setUp</span><span class="params">(<span class="keyword">self</span>)</span></span><span class="symbol">:</span></span><br><span class="line">        <span class="keyword">self</span>.driver = webdriver.Chrome()</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">test_search_in_python_org</span><span class="params">(<span class="keyword">self</span>)</span></span><span class="symbol">:</span></span><br><span class="line">        driver = <span class="keyword">self</span>.driver</span><br><span class="line">        driver.get(<span class="string">"http://www.python.org"</span>)</span><br><span class="line">        <span class="keyword">self</span>.assertIn(<span class="string">"Python"</span>, driver.title)</span><br><span class="line">        elem = driver.find_element_by_name(<span class="string">"q"</span>)</span><br><span class="line">        elem.send_keys(<span class="string">"pycon"</span>)</span><br><span class="line">        elem.send_keys(Keys.RETURN)</span><br><span class="line">        assert <span class="string">"No results found."</span> <span class="keyword">not</span> <span class="keyword">in</span> driver.page_source</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">tearDown</span><span class="params">(<span class="keyword">self</span>)</span></span><span class="symbol">:</span></span><br><span class="line">        <span class="keyword">self</span>.driver.close()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name_<span class="number">_</span> == <span class="string">"__main__"</span><span class="symbol">:</span></span><br><span class="line">    unittest.main()</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>运行程序，同样的功能，我们将其封装为测试标准类的形式。</p>
                  <blockquote>
                    <p>The test case class is inherited from unittest.TestCase. Inheriting from TestCase class is the way to tell unittest module that this is a test case. The setUp is part of initialization, this method will get called before every test function which you are going to write in this test case class. The test case method should always start with characters test. The tearDown method will get called after every test method. This is a place to do all cleanup actions. You can also call quit method instead of close. The quit will exit the entire browser, whereas close will close a tab, but if it is the only tab opened, by default most browser will exit entirely.</p>
                  </blockquote>
                  <p>测试用例是继承了 unittest.TestCase 类，继承这个类表明这是一个测试类。setUp方法是初始化的方法，这个方法会在每个测试类中自动调用。每一个测试方法命名都有规范，必须以 test 开头，会自动执行。最后的 tearDown 方法会在每一个测试方法结束之后调用。这相当于最后的析构方法。在这个方法里写的是 close 方法，你还可以写 quit 方法。不过 close 方法相当于关闭了这个 TAB 选项卡，然而 quit 是退出了整个浏览器。当你只开启了一个 TAB 选项卡的时候，关闭的时候也会将整个浏览器关闭。</p>
                  <h2 id="页面操作"><a href="#页面操作" class="headerlink" title="页面操作"></a>页面操作</h2>
                  <h3 id="页面交互"><a href="#页面交互" class="headerlink" title="页面交互"></a>页面交互</h3>
                  <p>仅仅抓取页面没有多大卵用，我们真正要做的是做到和页面交互，比如点击，输入等等。那么前提就是要找到页面中的元素。WebDriver提供了各种方法来寻找元素。例如下面有一个表单输入框。</p>
                  <figure class="highlight pgsql">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">&lt;<span class="keyword">input</span> <span class="keyword">type</span>="text" <span class="type">name</span>="passwd" id="passwd-id" /&gt;</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>我们可以这样获取它</p>
                  <figure class="highlight ini">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="attr">element</span> = driver.find_element_by_id(<span class="string">"passwd-id"</span>)</span><br><span class="line"><span class="attr">element</span> = driver.find_element_by_name(<span class="string">"passwd"</span>)</span><br><span class="line"><span class="attr">element</span> = driver.find_elements_by_tag_name(<span class="string">"input"</span>)</span><br><span class="line"><span class="attr">element</span> = driver.find_element_by_xpath(<span class="string">"//input[@id='passwd-id']"</span>)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>你还可以通过它的文本链接来获取，但是要小心，文本必须完全匹配才可以，所以这并不是一个很好的匹配方式。 而且你在用 xpath 的时候还需要注意的是，如果有多个元素匹配了 xpath，它只会返回第一个匹配的元素。如果没有找到，那么会抛出 NoSuchElementException 的异常。 获取了元素之后，下一步当然就是向文本输入内容了，可以利用下面的方法</p>
                  <figure class="highlight less">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="selector-tag">element</span><span class="selector-class">.send_keys</span>(<span class="string">"some text"</span>)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>同样你还可以利用 Keys 这个类来模拟点击某个按键。</p>
                  <figure class="highlight css">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="selector-tag">element</span><span class="selector-class">.send_keys</span>("<span class="selector-tag">and</span> <span class="selector-tag">some</span>", <span class="selector-tag">Keys</span><span class="selector-class">.ARROW_DOWN</span>)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>你可以对任何获取到到元素使用 send_keys 方法，就像你在 GMail 里面点击发送键一样。不过这样会导致的结果就是输入的文本不会自动清除。所以输入的文本都会在原来的基础上继续输入。你可以用下面的方法来清除输入文本的内容。</p>
                  <figure class="highlight livecodeserver">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">element</span>.<span class="built_in">clear</span>()</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>这样输入的文本会被清除。</p>
                  <h3 id="填充表单"><a href="#填充表单" class="headerlink" title="填充表单"></a>填充表单</h3>
                  <p>我们已经知道了怎样向文本框中输入文字，但是其它的表单元素呢？例如下拉选项卡的的处理可以如下</p>
                  <figure class="highlight sql">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">element = driver.find_element_by_xpath("//<span class="keyword">select</span>[@<span class="keyword">name</span>=<span class="string">'name'</span>]<span class="string">")</span></span><br><span class="line"><span class="string">all_options = element.find_elements_by_tag_name("</span><span class="keyword">option</span><span class="string">")</span></span><br><span class="line"><span class="string">for option in all_options:</span></span><br><span class="line"><span class="string">    print("</span><span class="keyword">Value</span> <span class="keyword">is</span>: %s<span class="string">" % option.get_attribute("</span><span class="keyword">value</span><span class="string">"))</span></span><br><span class="line"><span class="string">    option.click()</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>首先获取了第一个 select 元素，也就是下拉选项卡。然后轮流设置了 select 选项卡中的每一个 option 选项。你可以看到，这并不是一个非常有效的方法。 其实 WebDriver 中提供了一个叫 Select 的方法，可以帮助我们完成这些事情。</p>
                  <figure class="highlight pgsql">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">from</span> selenium.webdriver.support.ui <span class="keyword">import</span> <span class="keyword">Select</span></span><br><span class="line"><span class="keyword">select</span> = <span class="keyword">Select</span>(driver.find_element_by_name(<span class="string">'name'</span>))</span><br><span class="line"><span class="keyword">select</span>.select_by_index(<span class="keyword">index</span>)</span><br><span class="line"><span class="keyword">select</span>.select_by_visible_text("text")</span><br><span class="line"><span class="keyword">select</span>.select_by_value(<span class="keyword">value</span>)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>如你所见，它可以根据索引来选择，可以根据值来选择，可以根据文字来选择。是十分方便的。 全部取消选择怎么办呢？很简单</p>
                  <figure class="highlight reasonml">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">select = <span class="constructor">Select(<span class="params">driver</span>.<span class="params">find_element_by_id</span>('<span class="params">id</span>')</span>)</span><br><span class="line">select.deselect<span class="constructor">_all()</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>这样便可以取消所有的选择。 另外我们还可以通过下面的方法获取所有的已选选项。</p>
                  <figure class="highlight ini">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="attr">select</span> = Select(driver.find_element_by_xpath(<span class="string">"xpath"</span>))</span><br><span class="line"><span class="attr">all_selected_options</span> = select.all_selected_options</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>获取所有可选选项是</p>
                  <figure class="highlight pgsql">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">options</span> = <span class="keyword">select</span>.<span class="keyword">options</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>如果你把表单都填好了，最后肯定要提交表单对吧。怎吗提交呢？很简单</p>
                  <figure class="highlight less">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="selector-tag">driver</span><span class="selector-class">.find_element_by_id</span>(<span class="string">"submit"</span>)<span class="selector-class">.click</span>()</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>这样就相当于模拟点击了 submit 按钮，做到表单提交。 当然你也可以单独提交某个元素</p>
                  <figure class="highlight css">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="selector-tag">element</span><span class="selector-class">.submit</span>()</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>方法，WebDriver 会在表单中寻找它所在的表单，如果发现这个元素并没有被表单所包围，那么程序会抛出 NoSuchElementException 的异常。</p>
                  <h3 id="元素拖拽"><a href="#元素拖拽" class="headerlink" title="元素拖拽"></a>元素拖拽</h3>
                  <p>要完成元素的拖拽，首先你需要指定被拖动的元素和拖动目标元素，然后利用 ActionChains 类来实现。</p>
                  <figure class="highlight pgsql">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">element = driver.find_element_by_name("source")</span><br><span class="line">target = driver.find_element_by_name("target")</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> selenium.webdriver <span class="keyword">import</span> ActionChains</span><br><span class="line">action_chains = ActionChains(driver)</span><br><span class="line">action_chains.drag_and_drop(element, target).<span class="keyword">perform</span>()</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>这样就实现了元素从 source 拖动到 target 的操作。</p>
                  <h3 id="页面切换"><a href="#页面切换" class="headerlink" title="页面切换"></a>页面切换</h3>
                  <p>一个浏览器肯定会有很多窗口，所以我们肯定要有方法来实现窗口的切换。切换窗口的方法如下</p>
                  <figure class="highlight ceylon">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">driver.<span class="keyword">switch</span><span class="number">_</span>to<span class="number">_</span>window(<span class="string">"windowName"</span>)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>另外你可以使用 window_handles 方法来获取每个窗口的操作对象。例如</p>
                  <figure class="highlight css">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="selector-tag">for</span> <span class="selector-tag">handle</span> <span class="selector-tag">in</span> <span class="selector-tag">driver</span><span class="selector-class">.window_handles</span>:</span><br><span class="line">    <span class="selector-tag">driver</span><span class="selector-class">.switch_to_window</span>(<span class="selector-tag">handle</span>)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>另外切换 frame 的方法如下</p>
                  <figure class="highlight css">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="selector-tag">driver</span><span class="selector-class">.switch_to_frame</span>("<span class="selector-tag">frameName</span><span class="selector-class">.0</span><span class="selector-class">.child</span>")</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>这样焦点会切换到一个 name 为 child 的 frame 上。</p>
                  <h3 id="弹窗处理"><a href="#弹窗处理" class="headerlink" title="弹窗处理"></a>弹窗处理</h3>
                  <p>当你出发了某个事件之后，页面出现了弹窗提示，那么你怎样来处理这个提示或者获取提示信息呢？</p>
                  <figure class="highlight ini">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="attr">alert</span> = driver.switch_to_alert()</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>通过上述方法可以获取弹窗对象。</p>
                  <h3 id="历史记录"><a href="#历史记录" class="headerlink" title="历史记录"></a>历史记录</h3>
                  <p>那么怎样来操作页面的前进和后退功能呢？</p>
                  <figure class="highlight css">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="selector-tag">driver</span><span class="selector-class">.forward</span>()</span><br><span class="line"><span class="selector-tag">driver</span><span class="selector-class">.back</span>()</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>嗯，简洁明了。</p>
                  <h3 id="Cookies处理"><a href="#Cookies处理" class="headerlink" title="Cookies处理"></a>Cookies处理</h3>
                  <p>为页面添加 Cookies，用法如下</p>
                  <figure class="highlight applescript">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="comment"># Go to the correct domain</span></span><br><span class="line">driver.<span class="keyword">get</span>(<span class="string">"http://www.example.com"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Now set the cookie. This one's valid for the entire domain</span></span><br><span class="line">cookie = &#123;‘<span class="built_in">name</span>’ : ‘foo’, ‘value’ : ‘bar’&#125;</span><br><span class="line">driver.add_cookie(cookie)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>获取页面 Cookies，用法如下</p>
                  <figure class="highlight routeros">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="comment"># Go to the correct domain</span></span><br><span class="line">driver.<span class="builtin-name">get</span>(<span class="string">"http://www.example.com"</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># And now output all the available cookies for the current URL</span></span><br><span class="line">driver.get_cookies()</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>以上便是 Cookies 的处理，同样是非常简单的。</p>
                  <h2 id="元素选取"><a href="#元素选取" class="headerlink" title="元素选取"></a>元素选取</h2>
                  <p>关于元素的选取，有如下的API 单个元素选取</p>
                  <blockquote>
                    <ul>
                      <li>find_element_by_id</li>
                      <li>find_element_by_name</li>
                      <li>find_element_by_xpath</li>
                      <li>find_element_by_link_text</li>
                      <li>find_element_by_partial_link_text</li>
                      <li>find_element_by_tag_name</li>
                      <li>find_element_by_class_name</li>
                      <li>find_element_by_css_selector</li>
                    </ul>
                  </blockquote>
                  <p>多个元素选取</p>
                  <blockquote>
                    <ul>
                      <li>find_elements_by_name</li>
                      <li>find_elements_by_xpath</li>
                      <li>find_elements_by_link_text</li>
                      <li>find_elements_by_partial_link_text</li>
                      <li>find_elements_by_tag_name</li>
                      <li>find_elements_by_class_name</li>
                      <li>find_elements_by_css_selector</li>
                    </ul>
                  </blockquote>
                  <p>另外还可以利用 By 类来确定哪种选择方式</p>
                  <figure class="highlight pgsql">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">from</span> selenium.webdriver.common.<span class="keyword">by</span> <span class="keyword">import</span> <span class="keyword">By</span></span><br><span class="line"></span><br><span class="line">driver.find_element(<span class="keyword">By</span>.XPATH, <span class="string">'//button[text()="Some text"]'</span>)</span><br><span class="line">driver.find_elements(<span class="keyword">By</span>.XPATH, <span class="string">'//button'</span>)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>By 类的一些属性如下</p>
                  <figure class="highlight ini">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="attr">ID</span> = <span class="string">"id"</span></span><br><span class="line"><span class="attr">XPATH</span> = <span class="string">"xpath"</span></span><br><span class="line"><span class="attr">LINK_TEXT</span> = <span class="string">"link text"</span></span><br><span class="line"><span class="attr">PARTIAL_LINK_TEXT</span> = <span class="string">"partial link text"</span></span><br><span class="line"><span class="attr">NAME</span> = <span class="string">"name"</span></span><br><span class="line"><span class="attr">TAG_NAME</span> = <span class="string">"tag name"</span></span><br><span class="line"><span class="attr">CLASS_NAME</span> = <span class="string">"class name"</span></span><br><span class="line"><span class="attr">CSS_SELECTOR</span> = <span class="string">"css selector"</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>更详细的元素选择方法参见官方文档 <a href="http://selenium-python.readthedocs.org/en/latest/locating-elements.html" target="_blank" rel="noopener">元素选择</a></p>
                  <h2 id="页面等待"><a href="#页面等待" class="headerlink" title="页面等待"></a>页面等待</h2>
                  <p>这是非常重要的一部分，现在的网页越来越多采用了 Ajax 技术，这样程序便不能确定何时某个元素完全加载出来了。这会让元素定位困难而且会提高产生 ElementNotVisibleException 的概率。 所以 Selenium 提供了两种等待方式，一种是隐式等待，一种是显式等待。 隐式等待是等待特定的时间，显式等待是指定某一条件直到这个条件成立时继续执行。</p>
                  <h3 id="显式等待"><a href="#显式等待" class="headerlink" title="显式等待"></a>显式等待</h3>
                  <p>显式等待指定某个条件，然后设置最长等待时间。如果在这个时间还没有找到元素，那么便会抛出异常了。</p>
                  <figure class="highlight vbnet">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">from</span> selenium import webdriver</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.common.<span class="keyword">by</span> import <span class="keyword">By</span></span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.support.ui import WebDriverWait</span><br><span class="line"><span class="keyword">from</span> selenium.webdriver.support import expected_conditions <span class="keyword">as</span> EC</span><br><span class="line"></span><br><span class="line">driver = webdriver.Chrome()</span><br><span class="line">driver.<span class="keyword">get</span>(<span class="string">"http://somedomain/url_that_delays_loading"</span>)</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    element = WebDriverWait(driver, <span class="number">10</span>).<span class="keyword">until</span>(</span><br><span class="line">        EC.presence_of_element_located((<span class="keyword">By</span>.ID, <span class="string">"myDynamicElement"</span>))</span><br><span class="line">    )</span><br><span class="line"><span class="keyword">finally</span>:</span><br><span class="line">    driver.quit()</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>程序默认会 500ms 调用一次来查看元素是否已经生成，如果本来元素就是存在的，那么会立即返回。 下面是一些内置的等待条件，你可以直接调用这些条件，而不用自己写某些等待条件了。</p>
                  <blockquote>
                    <ul>
                      <li>title_is</li>
                      <li>title_contains</li>
                      <li>presence_of_element_located</li>
                      <li>visibility_of_element_located</li>
                      <li>visibility_of</li>
                      <li>presence_of_all_elements_located</li>
                      <li>text_to_be_present_in_element</li>
                      <li>text_to_be_present_in_element_value</li>
                      <li>frame_to_be_available_and_switch_to_it</li>
                      <li>invisibility_of_element_located</li>
                      <li>element_to_be_clickable - it is Displayed and Enabled.</li>
                      <li>staleness_of</li>
                      <li>element_to_be_selected</li>
                      <li>element_located_to_be_selected</li>
                      <li>element_selection_state_to_be</li>
                      <li>element_located_selection_state_to_be</li>
                      <li>alert_is_present</li>
                    </ul>
                  </blockquote>
                  <figure class="highlight livecodeserver">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="built_in">from</span> selenium.webdriver.support import expected_conditions <span class="keyword">as</span> EC</span><br><span class="line"></span><br><span class="line"><span class="built_in">wait</span> = WebDriverWait(driver, <span class="number">10</span>)</span><br><span class="line"><span class="keyword">element</span> = <span class="built_in">wait</span>.<span class="keyword">until</span>(EC.element_to_be_clickable((By.ID,<span class="string">'someid'</span>)))</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <h3 id="隐式等待"><a href="#隐式等待" class="headerlink" title="隐式等待"></a>隐式等待</h3>
                  <p>隐式等待比较简单，就是简单地设置一个等待时间，单位为秒。</p>
                  <figure class="highlight sqf">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">from</span> selenium import webdriver</span><br><span class="line"></span><br><span class="line"><span class="built_in">driver</span> = webdriver.Chrome()</span><br><span class="line"><span class="built_in">driver</span>.implicitly_wait(<span class="number">10</span>) <span class="meta"># seconds</span></span><br><span class="line"><span class="built_in">driver</span>.get(<span class="string">"http://somedomain/url_that_delays_loading"</span>)</span><br><span class="line">myDynamicElement = <span class="built_in">driver</span>.find_element_by_id(<span class="string">"myDynamicElement"</span>)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>当然如果不设置，默认等待时间为0。</p>
                  <h2 id="程序框架"><a href="#程序框架" class="headerlink" title="程序框架"></a>程序框架</h2>
                  <p>对于页面测试和分析，官方提供了一个比较明晰的代码结构，可以参考。 <a href="http://selenium-python.readthedocs.org/en/latest/page-objects.html" target="_blank" rel="noopener">页面测试架构</a></p>
                  <h2 id="API"><a href="#API" class="headerlink" title="API"></a>API</h2>
                  <p>到最后，肯定是放松最全最重要的API了，比较多，希望大家可以多加练习。 <a href="http://selenium-python.readthedocs.org/en/latest/api.html" target="_blank" rel="noopener">API</a></p>
                  <h2 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h2>
                  <p>以上就是 Selenium 的基本用法，我们讲解了页面交互，页面渲染之后的源代码的获取。这样，即使页面是 JS 渲染而成的，我们也可以手到擒来了。就是这么溜！</p>
                  </p>
                </div>
              </div>
              <div class="post-meta">
                <span class="post-meta-item">
                  <span class="post-meta-item-icon">
                    <i class="far fa-user"></i>
                  </span>
                  <span class="post-meta-item-text">作者</span>
                  <span><a href="/authors/崔庆才" class="author" itemprop="url" rel="index">崔庆才</a></span>
                </span>
                <span class="post-meta-item">
                  <span class="post-meta-item-icon">
                    <i class="far fa-calendar"></i>
                  </span>
                  <span class="post-meta-item-text">发表于</span>
                  <time title="创建时间：2016-03-22 21:50:53" itemprop="dateCreated datePublished" datetime="2016-03-22T21:50:53+08:00">2016-03-22</time>
                </span>
                <span id="/2599.html" class="post-meta-item leancloud_visitors" data-flag-title="Python爬虫利器五之Selenium的用法" title="阅读次数">
                  <span class="post-meta-item-icon">
                    <i class="fa fa-eye"></i>
                  </span>
                  <span class="post-meta-item-text">阅读次数：</span>
                  <span class="leancloud-visitors-count"></span>
                </span>
                <span class="post-meta-item" title="本文字数">
                  <span class="post-meta-item-icon">
                    <i class="far fa-file-word"></i>
                  </span>
                  <span class="post-meta-item-text">本文字数：</span>
                  <span>9.4k</span>
                </span>
                <span class="post-meta-item" title="阅读时长">
                  <span class="post-meta-item-icon">
                    <i class="far fa-clock"></i>
                  </span>
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                  <span>9 分钟</span>
                </span>
              </div>
            </article>
            <article itemscope itemtype="http://schema.org/Article" class="post-block index" lang="zh-CN">
              <link itemprop="mainEntityOfPage" href="https://cuiqingcai.com/2577.html">
              <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
                <meta itemprop="image" content="/images/avatar.png">
                <meta itemprop="name" content="崔庆才">
                <meta itemprop="description" content="崔庆才的个人站点，记录生活的瞬间，分享学习的心得。">
              </span>
              <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
                <meta itemprop="name" content="静觅">
              </span>
              <header class="post-header">
                <h2 class="post-title" itemprop="name headline">
                  <a class="label"> Python <i class="label-arrow"></i>
                  </a>
                  <a href="/2577.html" class="post-title-link" itemprop="url">Python爬虫利器四之PhantomJS的用法</a>
                </h2>
              </header>
              <div class="post-body" itemprop="articleBody">
                <div class="thumb">
                  <img itemprop="contentUrl" class="random">
                </div>
                <div class="excerpt">
                  <p>
                  <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2>
                  <p>大家有没有发现之前我们写的爬虫都有一个共性，就是只能爬取单纯的html代码，如果页面是JS渲染的该怎么办呢？如果我们单纯去分析一个个后台的请求，手动去摸索JS渲染的到的一些结果，那简直没天理了。所以，我们需要有一些好用的工具来帮助我们像浏览器一样渲染JS处理的页面。 其中有一个比较常用的工具，那就是 <a href="http://phantomjs.org/" target="_blank" rel="noopener">PhantomJS</a></p>
                  <blockquote>
                    <p>Full web stack No browser required</p>
                    <p>PhantomJS is a headless WebKit scriptable with a JavaScript API. It has <strong>fast</strong> and<strong>native</strong> support for various web standards: DOM handling, CSS selector, JSON, Canvas, and SVG.</p>
                  </blockquote>
                  <p>PhantomJS是一个无界面的,可脚本编程的WebKit浏览器引擎。它原生支持多种web 标准：DOM 操作，CSS选择器，JSON，Canvas 以及SVG。 好，接下来我们就一起来了解一下这个神奇好用的库的用法吧。</p>
                  <h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2>
                  <p>PhantomJS安装方法有两种，一种是下载源码之后自己来编译，另一种是直接下载编译好的二进制文件。然而自己编译需要的时间太长，而且需要挺多的磁盘空间。官方推荐直接下载二进制文件然后安装。 大家可以依照自己的开发平台选择不同的包进行下载 <a href="http://phantomjs.org/download.html" target="_blank" rel="noopener">下载地址</a> 当然如果你不嫌麻烦，可以选择 <a href="http://phantomjs.org/build.html" target="_blank" rel="noopener">下载源码</a> 然后自己编译。 目前（2016/3/21）最新发行版本是 v2.1， 安装完成之后命令行输入</p>
                  <figure class="highlight ebnf">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="attribute">phantomjs -v</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>如果正常显示版本号，那么证明安装成功了。如果提示错误，那么请重新安装。 本文介绍大部分内容来自于官方文档，博主对其进行了整理，学习更多请参考 <a href="http://phantomjs.org/quick-start.html" target="_blank" rel="noopener">官方文档</a></p>
                  <h2 id="快速开始"><a href="#快速开始" class="headerlink" title="快速开始"></a>快速开始</h2>
                  <h3 id="第一个程序"><a href="#第一个程序" class="headerlink" title="第一个程序"></a>第一个程序</h3>
                  <p>第一个程序当然是Hello World，新建一个 js 文件。命名为 helloworld.js</p>
                  <figure class="highlight awk">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">console.log(<span class="string">'Hello, world!'</span>);</span><br><span class="line">phantom.<span class="keyword">exit</span>();</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>命令行输入</p>
                  <figure class="highlight css">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="selector-tag">phantomjs</span> <span class="selector-tag">helloworld</span><span class="selector-class">.js</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>程序输出了 Hello，world！程序第二句话终止了 phantom 的执行。 <strong>注意：<code>phantom.exit();</code>这句话非常重要，否则程序将永远不会终止。</strong></p>
                  <h3 id="页面加载"><a href="#页面加载" class="headerlink" title="页面加载"></a>页面加载</h3>
                  <p>可以利用 phantom 来实现页面的加载，下面的例子实现了页面的加载并将页面保存为一张图片。</p>
                  <figure class="highlight awk">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">var page = require(<span class="string">'webpage'</span>).create();</span><br><span class="line">page.open(<span class="string">'http://cuiqingcai.com'</span>, <span class="keyword">function</span> (status) &#123;</span><br><span class="line">    console.log(<span class="string">"Status: "</span> + status);</span><br><span class="line">    <span class="keyword">if</span> (status === <span class="string">"success"</span>) &#123;</span><br><span class="line">        page.render(<span class="string">'example.png'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    phantom.<span class="keyword">exit</span>();</span><br><span class="line">&#125;);</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>首先创建了一个webpage对象，然后加载本站点主页，判断响应状态，如果成功，那么保存截图为 example.png 以上代码命名为 pageload.js，命令行</p>
                  <figure class="highlight css">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="selector-tag">phantomjs</span> <span class="selector-tag">pageload</span><span class="selector-class">.js</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>发现执行成功，然后目录下多了一张图片，example.png <a href="http://qiniu.cuiqingcai.com/wp-content/uploads/2016/03/example-e1458570294781.png" target="_blank" rel="noopener"><img src="http://qiniu.cuiqingcai.com/wp-content/uploads/2016/03/example-e1458570294781.png" alt="example"></a> 因为这个 render 方法，phantom 经常会用到网页截图的功能。</p>
                  <h3 id="测试页面加载速度"><a href="#测试页面加载速度" class="headerlink" title="测试页面加载速度"></a>测试页面加载速度</h3>
                  <p>下面这个例子计算了一个页面的加载速度，同时还用到了命令行传参的特性。新建文件保存为 loadspeed.js</p>
                  <figure class="highlight routeros">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">var<span class="built_in"> page </span>= require(<span class="string">'webpage'</span>).create(),</span><br><span class="line"> <span class="built_in"> system </span>= require(<span class="string">'system'</span>),</span><br><span class="line">  t, address;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (system.args.length === 1) &#123;</span><br><span class="line">  console.log(<span class="string">'Usage: loadspeed.js &lt;some URL&gt;'</span>);</span><br><span class="line">  phantom.exit();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">t = Date.now();</span><br><span class="line">address = system.args[1];</span><br><span class="line">page.open(address, function(status) &#123;</span><br><span class="line">  <span class="keyword">if</span> (status !== <span class="string">'success'</span>) &#123;</span><br><span class="line">    console.log(<span class="string">'FAIL to load the address'</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    t = Date.now() - t;</span><br><span class="line">    console.log(<span class="string">'Loading '</span> + system.args[1]);</span><br><span class="line">    console.log(<span class="string">'Loading time '</span> + t + <span class="string">' msec'</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  phantom.exit();</span><br><span class="line">&#125;);</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>程序判断了参数的多少，如果参数不够，那么终止运行。然后记录了打开页面的时间，请求页面之后，再纪录当前时间，二者之差就是页面加载速度。</p>
                  <figure class="highlight groovy">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">phantomjs loadspeed.js <span class="string">http:</span><span class="comment">//cuiqingcai.com</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>运行结果</p>
                  <figure class="highlight angelscript">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">Loading http:<span class="comment">//cuiqingcai.com</span></span><br><span class="line">Loading time <span class="number">11678</span> msec</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>这个时间包括JS渲染的时间，当然和网速也有关。</p>
                  <h3 id="代码评估"><a href="#代码评估" class="headerlink" title="代码评估"></a>代码评估</h3>
                  <blockquote>
                    <p>To evaluate JavaScript code in the context of the web page, use <code>evaluate()</code> function. The execution is “sandboxed”, there is no way for the code to access any JavaScript objects and variables outside its own page context. An object can be returned from <code>evaluate()</code>, however it is limited to simple objects and can’t contain functions or closures.</p>
                  </blockquote>
                  <p>利用 evaluate 方法我们可以获取网页的源代码。这个执行是“沙盒式”的，它不会去执行网页外的 JavaScript 代码。evalute 方法可以返回一个对象，然而返回值仅限于对象，不能包含函数（或闭包）</p>
                  <figure class="highlight qml">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">var</span> <span class="built_in">url</span> = <span class="string">'http://www.baidu.com'</span>;</span><br><span class="line"><span class="keyword">var</span> page = <span class="built_in">require</span>(<span class="string">'webpage'</span>).create();</span><br><span class="line">page.open(<span class="built_in">url</span>, <span class="function"><span class="keyword">function</span>(<span class="params">status</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> title = page.evaluate(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">document</span>.title;</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'Page title is '</span> + title);</span><br><span class="line">  phantom.exit();</span><br><span class="line">&#125;);</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>以上代码获取了百度的网站标题。</p>
                  <figure class="highlight maxima">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">Page <span class="built_in">title</span> <span class="built_in">is</span> 百度一下，你就知道</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>任何来自于网页并且包括来自 evaluate() 内部代码的控制台信息，默认不会显示。 需要重写这个行为，使用 onConsoleMessage 回调函数，示例可以改写成</p>
                  <figure class="highlight qml">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">var</span> <span class="built_in">url</span> = <span class="string">'http://www.baidu.com'</span>;</span><br><span class="line"><span class="keyword">var</span> page = <span class="built_in">require</span>(<span class="string">'webpage'</span>).create();</span><br><span class="line">page.onConsoleMessage = <span class="function"><span class="keyword">function</span> (<span class="params">msg</span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(msg);</span><br><span class="line">&#125;;</span><br><span class="line">page.open(<span class="built_in">url</span>, <span class="function"><span class="keyword">function</span> (<span class="params">status</span>) </span>&#123;</span><br><span class="line">    page.evaluate(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="built_in">document</span>.title);</span><br><span class="line">    &#125;);</span><br><span class="line">    phantom.exit();</span><br><span class="line">&#125;);</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>这样的话，如果你用浏览器打开百度首页，打开调试工具的console，可以看到控制台输出信息。 重写了 onConsoleMessage 方法之后，可以发现控制台输出的结果和我们需要输出的标题都打印出来了。</p>
                  <figure class="highlight groovy">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">一张网页，要经历怎样的过程，才能抵达用户面前？</span><br><span class="line">一位新人，要经历怎样的成长，才能站在技术之巅？</span><br><span class="line">探寻这里的秘密；</span><br><span class="line">体验这里的挑战；</span><br><span class="line">成为这里的主人；</span><br><span class="line">加入百度，加入网页搜索，你，可以影响世界。</span><br><span class="line"></span><br><span class="line">请将简历发送至 %c ps_recruiter<span class="meta">@baidu</span>.com（ 邮件标题请以“姓名-应聘XX职位-来自console”命名） <span class="string">color:</span>red</span><br><span class="line">职位介绍：<span class="string">http:</span><span class="comment">//dwz.cn/hr2013</span></span><br><span class="line">百度一下，你就知道</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>啊，我没有在为百度打广告！</p>
                  <h2 id="屏幕捕获"><a href="#屏幕捕获" class="headerlink" title="屏幕捕获"></a>屏幕捕获</h2>
                  <blockquote>
                    <p>Since PhantomJS is using WebKit, a real layout and rendering engine, it can capture a web page as a screenshot. Because PhantomJS can render anything on the web page, it can be used to convert contents not only in HTML and CSS, but also SVG and Canvas.</p>
                  </blockquote>
                  <p>因为 PhantomJS 使用了 WebKit内核，是一个真正的布局和渲染引擎，它可以像屏幕截图一样捕获一个web界面。因为它可以渲染网页中的人和元素，所以它不仅用到HTML，CSS的内容转化，还用在SVG，Canvas。可见其功能是相当强大的。 下面的例子就捕获了github网页的截图。上文有类似内容，不再演示。</p>
                  <figure class="highlight awk">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">var page = require(<span class="string">'webpage'</span>).create();</span><br><span class="line">page.open(<span class="string">'http://github.com/'</span>, <span class="keyword">function</span>() &#123;</span><br><span class="line">  page.render(<span class="string">'github.png'</span>);</span><br><span class="line">  phantom.<span class="keyword">exit</span>();</span><br><span class="line">&#125;);</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>除了 png 格式的转换，PhantomJS还支持 jpg，gif，pdf等格式。 <a href="https://github.com/ariya/phantomjs/blob/master/examples/rasterize.js" target="_blank" rel="noopener">测试样例</a> 其中最重要的方法便是 viewportSize 和 clipRect 属性。 viewportSize 是视区的大小，你可以理解为你打开了一个浏览器，然后把浏览器窗口拖到了多大。 clipRect 是裁切矩形的大小，需要四个参数，前两个是基准点，后两个参数是宽高。 通过下面的小例子感受一下。</p>
                  <figure class="highlight groovy">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">var page = require(<span class="string">'webpage'</span>).create();</span><br><span class="line"><span class="comment">//viewportSize being the actual size of the headless browser</span></span><br><span class="line">page.viewportSize = &#123; <span class="string">width:</span> <span class="number">1024</span>, <span class="string">height:</span> <span class="number">768</span> &#125;;</span><br><span class="line"><span class="comment">//the clipRect is the portion of the page you are taking a screenshot of</span></span><br><span class="line">page.clipRect = &#123; <span class="string">top:</span> <span class="number">0</span>, <span class="string">left:</span> <span class="number">0</span>, <span class="string">width:</span> <span class="number">1024</span>, <span class="string">height:</span> <span class="number">768</span> &#125;;</span><br><span class="line"><span class="comment">//the rest of the code is the same as the previous example</span></span><br><span class="line">page.open(<span class="string">'http://cuiqingcai.com/'</span>, function() &#123;</span><br><span class="line">  page.render(<span class="string">'germy.png'</span>);</span><br><span class="line">  phantom.exit();</span><br><span class="line">&#125;);</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>运行结果 <a href="http://qiniu.cuiqingcai.com/wp-content/uploads/2016/03/germy.png" target="_blank" rel="noopener"><img src="http://qiniu.cuiqingcai.com/wp-content/uploads/2016/03/germy.png" alt="germy"></a> 就相当于把浏览器窗口拖到了 1024x768 大小，然后从左上角裁切出了 1024x768 的页面。</p>
                  <h2 id="网络监听"><a href="#网络监听" class="headerlink" title="网络监听"></a>网络监听</h2>
                  <blockquote>
                    <p>Because PhantomJS permits the inspection of network traffic, it is suitable to build various analysis on the network behavior and performance.</p>
                  </blockquote>
                  <p>因为 PhantomJS 有网络通信的检查功能，它也很适合用来做网络行为的分析。</p>
                  <blockquote>
                    <p>When a page requests a resource from a remote server, both the request and the response can be tracked via onResourceRequested and onResourceReceived callback.</p>
                  </blockquote>
                  <p>当接受到请求时，可以通过改写onResourceRequested和onResourceReceived回调函数来实现接收到资源请求和资源接受完毕的监听。例如</p>
                  <figure class="highlight qml">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">var</span> <span class="built_in">url</span> = <span class="string">'http://www.cuiqingcai.com'</span>;</span><br><span class="line"><span class="keyword">var</span> page = <span class="built_in">require</span>(<span class="string">'webpage'</span>).create();</span><br><span class="line">page.onResourceRequested = <span class="function"><span class="keyword">function</span>(<span class="params">request</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'Request '</span> + <span class="built_in">JSON</span>.stringify(request, <span class="literal">undefined</span>, <span class="number">4</span>));</span><br><span class="line">&#125;;</span><br><span class="line">page.onResourceReceived = <span class="function"><span class="keyword">function</span>(<span class="params">response</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'Receive '</span> + <span class="built_in">JSON</span>.stringify(response, <span class="literal">undefined</span>, <span class="number">4</span>));</span><br><span class="line">&#125;;</span><br><span class="line">page.open(<span class="built_in">url</span>);</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>运行结果会打印出所有资源的请求和接收状态，以JSON格式输出。</p>
                  <h2 id="页面自动化处理"><a href="#页面自动化处理" class="headerlink" title="页面自动化处理"></a>页面自动化处理</h2>
                  <blockquote>
                    <p>Because PhantomJS can load and manipulate a web page, it is perfect to carry out various page automations.</p>
                  </blockquote>
                  <p>因为 PhantomJS 可以加载和操作一个web页面，所以用来自动化处理也是非常适合的。</p>
                  <h3 id="DOM操作"><a href="#DOM操作" class="headerlink" title="DOM操作"></a>DOM操作</h3>
                  <blockquote>
                    <p>Since the script is executed as if it is running on a web browser, standard DOM scripting and CSS selectors work just fine.</p>
                  </blockquote>
                  <p>脚本都是像在浏览器中运行的，所以标准的 JavaScript 的 DOM 操作和 CSS 选择器也是生效的。 例如下面的例子就修改了 User-Agent，然后还返回了页面中某元素的内容。</p>
                  <figure class="highlight lua">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">var page = <span class="built_in">require</span>(<span class="string">'webpage'</span>).<span class="built_in">create</span>();</span><br><span class="line">console.<span class="built_in">log</span>(<span class="string">'The default user agent is '</span> + page.settings.userAgent);</span><br><span class="line">page.settings.userAgent = <span class="string">'SpecialAgent'</span>;</span><br><span class="line">page.<span class="built_in">open</span>(<span class="string">'http://www.httpuseragent.org'</span>, <span class="function"><span class="keyword">function</span><span class="params">(status)</span></span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="built_in">status</span> !== <span class="string">'success'</span>) &#123;</span><br><span class="line">    console.<span class="built_in">log</span>(<span class="string">'Unable to access network'</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    var ua = page.evaluate(<span class="function"><span class="keyword">function</span><span class="params">()</span></span> &#123;</span><br><span class="line">      <span class="keyword">return</span> document.getElementById(<span class="string">'myagent'</span>).textContent;</span><br><span class="line">    &#125;);</span><br><span class="line">    console.<span class="built_in">log</span>(ua);</span><br><span class="line">  &#125;</span><br><span class="line">  phantom.<span class="built_in">exit</span>();</span><br><span class="line">&#125;);</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>运行结果</p>
                  <figure class="highlight routeros">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">The<span class="built_in"> default user </span>agent is Mozilla/5.0 (Macintosh; Intel Mac OS X) AppleWebKit/538.1 (KHTML, like Gecko) PhantomJS/2.1.0 Safari/538.1</span><br><span class="line">Your Http<span class="built_in"> User </span>Agent string is: SpecialAgent</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>首先打印出了默认的 User-Agent，然后通过修改它，请求验证 User-Agent 的一个站点，通过选择器得到了修改后的 User-Agent。</p>
                  <h3 id="使用附加库"><a href="#使用附加库" class="headerlink" title="使用附加库"></a>使用附加库</h3>
                  <p>在1.6版本之后允许添加外部的JS库，比如下面的例子添加了jQuery，然后执行了jQuery代码。</p>
                  <figure class="highlight awk">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">var page = require(<span class="string">'webpage'</span>).create();</span><br><span class="line">page.open(<span class="string">'http://www.sample.com'</span>, <span class="keyword">function</span>() &#123;</span><br><span class="line">  page.includeJs(<span class="string">"http://ajax.googleapis.com/ajax/libs/jquery/1.6.1/jquery.min.js"</span>, <span class="keyword">function</span>() &#123;</span><br><span class="line">    page.evaluate(<span class="keyword">function</span>() &#123;</span><br><span class="line">      $(<span class="string">"button"</span>).click();</span><br><span class="line">    &#125;);</span><br><span class="line">    phantom.<span class="keyword">exit</span>()</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;);</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>引用了 jQuery 之后，我们便可以在下面写一些 jQuery 代码了。</p>
                  <h2 id="Webpage对象"><a href="#Webpage对象" class="headerlink" title="Webpage对象"></a>Webpage对象</h2>
                  <p>在前面我们介绍了 webpage 对象的几个方法和属性，其实它本身还有其它很多的属性。具体的内容可以参考 <a href="http://phantomjs.org/page-automation.html" target="_blank" rel="noopener">Webpage</a> <a href="https://github.com/ariya/phantomjs/blob/master/examples/page_events.js" target="_blank" rel="noopener">Webpage用例</a> 里面介绍了 webpage的所有属性，方法，回调。</p>
                  <h2 id="命令行"><a href="#命令行" class="headerlink" title="命令行"></a>命令行</h2>
                  <p>Command-line Options PhantomJS提供的命令行选项有：</p>
                  <blockquote>
                    <p>--help or -h lists all possible command-line options. Halts immediately, will not run a script passed as argument. ［帮助列表］ —version or -v prints out the version of PhantomJS. Halts immediately, will not run a script passed as argument. ［查看版本］ —cookies-file=/path/to/cookies.txt specifies the file name to store the persistent Cookies. ［指定存放cookies的路径］ —disk-cache=[true|false] enables disk cache (at desktop services cache storage location, default is false). Also accepted: [yes|no]. ［硬盘缓存开关，默认为关］ —ignore-ssl-errors=[true|false] ignores SSL errors, such as expired or self-signed certificate errors (default is false). Also accepted: [yes|no]. ［忽略ssl错误，默认不忽略］ —load-images=[true|false] load all inlined images (default is true). Also accepted: [yes|no]. ［加载图片，默认为加载］ —local-storage-path=/some/path path to save LocalStorage content and WebSQL content. ［本地存储路径，如本地文件和SQL文件等］ —local-storage-quota=number maximum size to allow for data. ［本地文件最大大小］ —local-to-remote-url-access=[true|false] allows local content to access remote URL (default is false). Also accepted: [yes|no]. ［是否允许远程加载文件，默认不允许］ —max-disk-cache-size=size limits the size of disk cache (in KB). ［最大缓存空间］ —output-encoding=encoding sets the encoding used for terminal output (default is utf8). ［默认输出编码，默认utf8］ —remote-debugger-port starts the script in a debug harness and listens on the specified port ［远程调试端口］ —remote-debugger-autorun runs the script in the debugger immediately: ‘yes’ or ‘no’ (default) ［在调试环境下是否立即执行脚本，默认否］ —proxy=address:port specifies the proxy server to use (e.g. —proxy=192.168.1.42:8080). ［代理］ —proxy-type=[http|socks5|none] specifies the type of the proxy server (default is http). ［代理类型，默认http］ —proxy-auth specifies the authentication information for the proxy, e.g. —proxy-auth=username:password). ［代理认证］ —script-encoding=encoding sets the encoding used for the starting script (default is utf8). ［脚本编码，默认utf8］ —ssl-protocol=[sslv3|sslv2|tlsv1|any’] sets the SSL protocol for secure connections (default is SSLv3). ［SSL协议，默认SSLv3］ —ssl-certificates-path=<val> Sets the location for custom CA certificates (if none set, uses system default). ［SSL证书路径，默认系统默认路径］ —web-security=[true|false] enables web security and forbids cross-domain XHR (default is true). Also accepted: [yes|no]. ［是否开启安全保护和禁止异站Ajax，默认开启保护］ —webdriver starts in ‘Remote WebDriver mode’ (embedded GhostDriver): ‘[[:]]’ (default ‘127.0.0.1:8910’) ［以远程WebDriver模式启动］ —webdriver-selenium-grid-hub URL to the Selenium Grid HUB: ‘URLTOHUB’ (default ‘none’) (NOTE: works only together with ‘—webdriver’) ［Selenium接口］ —config=/path/to/config.json can utilize a JavaScript Object Notation (JSON) configuration file instead of passing in multiple command-line optionss ［所有的命令行配置从config.json中读取］</p>
                  </blockquote>
                  <p>注：JSON文件配置格式</p>
                  <figure class="highlight arcade">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">&#123;</span><br><span class="line">  <span class="comment">/* Same as: --ignore-ssl-errors=true */</span></span><br><span class="line">  <span class="string">"ignoreSslErrors"</span>: <span class="literal">true</span>,</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* Same as: --max-disk-cache-size=1000 */</span></span><br><span class="line">  <span class="string">"maxDiskCacheSize"</span>: <span class="number">1000</span>,</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* Same as: --output-encoding=utf8 */</span></span><br><span class="line">  <span class="string">"outputEncoding"</span>: <span class="string">"utf8"</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">/* etc. */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">There are some keys that <span class="keyword">do</span> not translate directly:</span><br><span class="line"></span><br><span class="line"> * --disk-<span class="function"><span class="params">cache</span> =&gt;</span> diskCacheEnabled</span><br><span class="line"> * --load-<span class="function"><span class="params">images</span> =&gt;</span> autoLoadImages</span><br><span class="line"> * --local-storage-<span class="function"><span class="params">path</span> =&gt;</span> offlineStoragePath</span><br><span class="line"> * --local-storage-<span class="function"><span class="params">quota</span> =&gt;</span> offlineStorageDefaultQuota</span><br><span class="line"> * --local-to-remote-url-<span class="function"><span class="params">access</span> =&gt;</span> localToRemoteUrlAccessEnabled</span><br><span class="line"> * --web-<span class="function"><span class="params">security</span> =&gt;</span> webSecurityEnabled</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>以上是命令行的基本配置</p>
                  <h2 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h2>
                  <p>在此提供官方文档实例，多对照实例练习，使用起来会更得心应手。 <a href="http://phantomjs.org/examples/index.html" target="_blank" rel="noopener">官方实例</a></p>
                  <h2 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h2>
                  <p>以上是博主对 PhantomJS 官方文档的基本总结和翻译，如有差错，希望大家可以指正。另外可能有的小伙伴觉得这个工具和 Python 有什么关系？不要急，后面会有 Python 和 PhantomJS 的综合使用的。</p>
                  </p>
                </div>
              </div>
              <div class="post-meta">
                <span class="post-meta-item">
                  <span class="post-meta-item-icon">
                    <i class="far fa-user"></i>
                  </span>
                  <span class="post-meta-item-text">作者</span>
                  <span><a href="/authors/崔庆才" class="author" itemprop="url" rel="index">崔庆才</a></span>
                </span>
                <span class="post-meta-item">
                  <span class="post-meta-item-icon">
                    <i class="far fa-calendar"></i>
                  </span>
                  <span class="post-meta-item-text">发表于</span>
                  <time title="创建时间：2016-03-22 00:56:03" itemprop="dateCreated datePublished" datetime="2016-03-22T00:56:03+08:00">2016-03-22</time>
                </span>
                <span id="/2577.html" class="post-meta-item leancloud_visitors" data-flag-title="Python爬虫利器四之PhantomJS的用法" title="阅读次数">
                  <span class="post-meta-item-icon">
                    <i class="fa fa-eye"></i>
                  </span>
                  <span class="post-meta-item-text">阅读次数：</span>
                  <span class="leancloud-visitors-count"></span>
                </span>
                <span class="post-meta-item" title="本文字数">
                  <span class="post-meta-item-icon">
                    <i class="far fa-file-word"></i>
                  </span>
                  <span class="post-meta-item-text">本文字数：</span>
                  <span>9.9k</span>
                </span>
                <span class="post-meta-item" title="阅读时长">
                  <span class="post-meta-item-icon">
                    <i class="far fa-clock"></i>
                  </span>
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                  <span>9 分钟</span>
                </span>
              </div>
            </article>
            <article itemscope itemtype="http://schema.org/Article" class="post-block index" lang="zh-CN">
              <link itemprop="mainEntityOfPage" href="https://cuiqingcai.com/2556.html">
              <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
                <meta itemprop="image" content="/images/avatar.png">
                <meta itemprop="name" content="崔庆才">
                <meta itemprop="description" content="崔庆才的个人站点，记录生活的瞬间，分享学习的心得。">
              </span>
              <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
                <meta itemprop="name" content="静觅">
              </span>
              <header class="post-header">
                <h2 class="post-title" itemprop="name headline">
                  <a class="label"> Python <i class="label-arrow"></i>
                  </a>
                  <a href="/2556.html" class="post-title-link" itemprop="url">Python爬虫利器一之Requests库的用法</a>
                </h2>
              </header>
              <div class="post-body" itemprop="articleBody">
                <div class="thumb">
                  <img itemprop="contentUrl" class="random">
                </div>
                <div class="excerpt">
                  <p>
                  <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2>
                  <p>之前我们用了 urllib 库，这个作为入门的工具还是不错的，对了解一些爬虫的基本理念，掌握爬虫爬取的流程有所帮助。入门之后，我们就需要学习一些更加高级的内容和工具来方便我们的爬取。那么这一节来简单介绍一下 requests 库的基本用法。 <strong>注：Python 版本依然基于 2.7</strong></p>
                  <h2 id="官方文档"><a href="#官方文档" class="headerlink" title="官方文档"></a>官方文档</h2>
                  <p>以下内容大多来自于官方文档，本文进行了一些修改和总结。要了解更多可以参考 <a href="http://docs.python-requests.org/en/master/" target="_blank" rel="noopener">官方文档</a></p>
                  <h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2>
                  <p>利用 pip 安装</p>
                  <figure class="highlight cmake">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">$ pip <span class="keyword">install</span> requests</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>或者利用 easy_install</p>
                  <figure class="highlight elixir">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="variable">$ </span>easy_install requests</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>通过以上两种方法均可以完成安装。</p>
                  <h2 id="引入"><a href="#引入" class="headerlink" title="引入"></a>引入</h2>
                  <p>首先我们引入一个小例子来感受一下</p>
                  <figure class="highlight routeros">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">import requests</span><br><span class="line"></span><br><span class="line">r = requests.<span class="builtin-name">get</span>(<span class="string">'http://cuiqingcai.com'</span>)</span><br><span class="line"><span class="builtin-name">print</span> type(r)</span><br><span class="line"><span class="builtin-name">print</span> r.status_code</span><br><span class="line"><span class="builtin-name">print</span> r.encoding</span><br><span class="line"><span class="comment">#print r.text</span></span><br><span class="line"><span class="builtin-name">print</span> r.cookies</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>以上代码我们请求了本站点的网址，然后打印出了返回结果的类型，状态码，编码方式，Cookies等内容。 运行结果如下</p>
                  <figure class="highlight apache">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="section">&lt;class 'requests.models.Response'&gt;</span></span><br><span class="line"><span class="attribute">200</span></span><br><span class="line"><span class="attribute">UTF</span>-8</span><br><span class="line"><span class="section">&lt;RequestsCookieJar[]&gt;</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>怎样，是不是很方便。别急，更方便的在后面呢。</p>
                  <h2 id="基本请求"><a href="#基本请求" class="headerlink" title="基本请求"></a>基本请求</h2>
                  <p>requests库提供了http所有的基本请求方式。例如</p>
                  <figure class="highlight ini">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="attr">r</span> = requests.post(<span class="string">"http://httpbin.org/post"</span>)</span><br><span class="line"><span class="attr">r</span> = requests.put(<span class="string">"http://httpbin.org/put"</span>)</span><br><span class="line"><span class="attr">r</span> = requests.delete(<span class="string">"http://httpbin.org/delete"</span>)</span><br><span class="line"><span class="attr">r</span> = requests.head(<span class="string">"http://httpbin.org/get"</span>)</span><br><span class="line"><span class="attr">r</span> = requests.options(<span class="string">"http://httpbin.org/get"</span>)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>嗯，一句话搞定。</p>
                  <h2 id="基本GET请求"><a href="#基本GET请求" class="headerlink" title="基本GET请求"></a>基本GET请求</h2>
                  <p>最基本的GET请求可以直接用get方法</p>
                  <figure class="highlight ini">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="attr">r</span> = requests.get(<span class="string">"http://httpbin.org/get"</span>)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>如果想要加参数，可以利用 params 参数</p>
                  <figure class="highlight routeros">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">import requests</span><br><span class="line"></span><br><span class="line">payload = &#123;<span class="string">'key1'</span>: <span class="string">'value1'</span>, <span class="string">'key2'</span>: <span class="string">'value2'</span>&#125;</span><br><span class="line">r = requests.<span class="builtin-name">get</span>(<span class="string">"http://httpbin.org/get"</span>, <span class="attribute">params</span>=payload)</span><br><span class="line"><span class="builtin-name">print</span> r.url</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>运行结果</p>
                  <figure class="highlight avrasm">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="symbol">http:</span>//httpbin<span class="meta">.org</span>/get?key2=value2&amp;key1=value1</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>如果想请求JSON文件，可以利用 json() 方法解析 例如自己写一个JSON文件命名为a.json，内容如下</p>
                  <figure class="highlight json">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">[<span class="string">"foo"</span>, <span class="string">"bar"</span>, &#123;</span><br><span class="line">  <span class="attr">"foo"</span>: <span class="string">"bar"</span></span><br><span class="line">&#125;]</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>利用如下程序请求并解析</p>
                  <figure class="highlight routeros">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">import requests</span><br><span class="line"></span><br><span class="line">r = requests.<span class="builtin-name">get</span>(<span class="string">"a.json"</span>)</span><br><span class="line"><span class="builtin-name">print</span> r.text</span><br><span class="line"><span class="builtin-name">print</span> r.json()</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>运行结果如下，其中一个是直接输出内容，另外一个方法是利用 json() 方法解析，感受下它们的不同</p>
                  <figure class="highlight awk">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">[<span class="string">"foo"</span>, <span class="string">"bar"</span>, &#123;</span><br><span class="line"> <span class="string">"foo"</span>: <span class="string">"bar"</span></span><br><span class="line"> &#125;]</span><br><span class="line"> [<span class="string">u'foo'</span>, <span class="string">u'bar'</span>, &#123;<span class="string">u'foo'</span>: <span class="string">u'bar'</span>&#125;]</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>如果想获取来自服务器的原始套接字响应，可以取得 r.raw 。 不过需要在初始请求中设置 stream=True 。</p>
                  <figure class="highlight llvm">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">r = requests.get('https://github.com/timeline.json', stream=True)</span><br><span class="line">r.raw</span><br><span class="line">&lt;requests.packages.urllib<span class="number">3</span>.response.HTTPResponse object at <span class="number">0x101194810</span>&gt;</span><br><span class="line">r.raw.read(<span class="number">10</span>)</span><br><span class="line">'\<span class="keyword">x</span><span class="number">1</span>f\<span class="keyword">x</span><span class="number">8</span>b\<span class="keyword">x</span><span class="number">08</span>\<span class="keyword">x</span><span class="number">00</span>\<span class="keyword">x</span><span class="number">00</span>\<span class="keyword">x</span><span class="number">00</span>\<span class="keyword">x</span><span class="number">00</span>\<span class="keyword">x</span><span class="number">00</span>\<span class="keyword">x</span><span class="number">00</span>\<span class="keyword">x</span><span class="number">03</span>'</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>这样就获取了网页原始套接字内容。 如果想添加 headers，可以传 headers 参数</p>
                  <figure class="highlight routeros">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">import requests</span><br><span class="line"></span><br><span class="line">payload = &#123;<span class="string">'key1'</span>: <span class="string">'value1'</span>, <span class="string">'key2'</span>: <span class="string">'value2'</span>&#125;</span><br><span class="line">headers = &#123;<span class="string">'content-type'</span>: <span class="string">'application/json'</span>&#125;</span><br><span class="line">r = requests.<span class="builtin-name">get</span>(<span class="string">"http://httpbin.org/get"</span>, <span class="attribute">params</span>=payload, <span class="attribute">headers</span>=headers)</span><br><span class="line"><span class="builtin-name">print</span> r.url</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>通过headers参数可以增加请求头中的headers信息</p>
                  <h2 id="基本POST请求"><a href="#基本POST请求" class="headerlink" title="基本POST请求"></a>基本POST请求</h2>
                  <p>对于 POST 请求来说，我们一般需要为它增加一些参数。那么最基本的传参方法可以利用 data 这个参数。</p>
                  <figure class="highlight routeros">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">import requests</span><br><span class="line"></span><br><span class="line">payload = &#123;<span class="string">'key1'</span>: <span class="string">'value1'</span>, <span class="string">'key2'</span>: <span class="string">'value2'</span>&#125;</span><br><span class="line">r = requests.post(<span class="string">"http://httpbin.org/post"</span>, <span class="attribute">data</span>=payload)</span><br><span class="line"><span class="builtin-name">print</span> r.text</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>运行结果</p>
                  <figure class="highlight json">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"args"</span>: &#123;&#125;, </span><br><span class="line">  <span class="attr">"data"</span>: <span class="string">""</span>, </span><br><span class="line">  <span class="attr">"files"</span>: &#123;&#125;, </span><br><span class="line">  <span class="attr">"form"</span>: &#123;</span><br><span class="line">    <span class="attr">"key1"</span>: <span class="string">"value1"</span>, </span><br><span class="line">    <span class="attr">"key2"</span>: <span class="string">"value2"</span></span><br><span class="line">  &#125;, </span><br><span class="line">  <span class="attr">"headers"</span>: &#123;</span><br><span class="line">    <span class="attr">"Accept"</span>: <span class="string">"*/*"</span>, </span><br><span class="line">    <span class="attr">"Accept-Encoding"</span>: <span class="string">"gzip, deflate"</span>, </span><br><span class="line">    <span class="attr">"Content-Length"</span>: <span class="string">"23"</span>, </span><br><span class="line">    <span class="attr">"Content-Type"</span>: <span class="string">"application/x-www-form-urlencoded"</span>, </span><br><span class="line">    <span class="attr">"Host"</span>: <span class="string">"httpbin.org"</span>, </span><br><span class="line">    <span class="attr">"User-Agent"</span>: <span class="string">"python-requests/2.9.1"</span></span><br><span class="line">  &#125;, </span><br><span class="line">  <span class="attr">"json"</span>: <span class="literal">null</span>, </span><br><span class="line">  <span class="attr">"url"</span>: <span class="string">"http://httpbin.org/post"</span></span><br><span class="line">&#125;</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>可以看到参数传成功了，然后服务器返回了我们传的数据。 有时候我们需要传送的信息不是表单形式的，需要我们传JSON格式的数据过去，所以我们可以用 json.dumps() 方法把表单数据序列化。</p>
                  <figure class="highlight haskell">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="title">url</span> = 'http://httpbin.org/post'</span><br><span class="line"><span class="title">payload</span> = &#123;'some': '<span class="class"><span class="keyword">data</span>'&#125;</span></span><br><span class="line"><span class="title">r</span> = requests.post(url, <span class="class"><span class="keyword">data</span>=json.dumps(<span class="title">payload</span>))</span></span><br><span class="line"><span class="title">print</span> r.text</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>运行结果</p>
                  <figure class="highlight json">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"args"</span>: &#123;&#125;, </span><br><span class="line">  <span class="attr">"data"</span>: <span class="string">"&#123;\"some\": \"data\"&#125;"</span>, </span><br><span class="line">  <span class="attr">"files"</span>: &#123;&#125;, </span><br><span class="line">  <span class="attr">"form"</span>: &#123;&#125;, </span><br><span class="line">  <span class="attr">"headers"</span>: &#123;</span><br><span class="line">    <span class="attr">"Accept"</span>: <span class="string">"*/*"</span>, </span><br><span class="line">    <span class="attr">"Accept-Encoding"</span>: <span class="string">"gzip, deflate"</span>, </span><br><span class="line">    <span class="attr">"Content-Length"</span>: <span class="string">"16"</span>, </span><br><span class="line">    <span class="attr">"Host"</span>: <span class="string">"httpbin.org"</span>, </span><br><span class="line">    <span class="attr">"User-Agent"</span>: <span class="string">"python-requests/2.9.1"</span></span><br><span class="line">  &#125;, </span><br><span class="line">  <span class="attr">"json"</span>: &#123;</span><br><span class="line">    <span class="attr">"some"</span>: <span class="string">"data"</span></span><br><span class="line">  &#125;,  </span><br><span class="line">  <span class="attr">"url"</span>: <span class="string">"http://httpbin.org/post"</span></span><br><span class="line">&#125;</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>通过上述方法，我们可以POST JSON格式的数据 如果想要上传文件，那么直接用 file 参数即可 新建一个 a.txt 的文件，内容写上 Hello World!</p>
                  <figure class="highlight vim">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">import requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">'http://httpbin.org/post'</span></span><br><span class="line"><span class="keyword">files</span> = &#123;<span class="string">'file'</span>: <span class="keyword">open</span>(<span class="string">'test.txt'</span>, <span class="string">'rb'</span>)&#125;</span><br><span class="line">r = requests.post(url, <span class="keyword">files</span>=<span class="keyword">files</span>)</span><br><span class="line"><span class="keyword">print</span> r.text</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>可以看到运行结果如下</p>
                  <figure class="highlight json">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"args"</span>: &#123;&#125;, </span><br><span class="line">  <span class="attr">"data"</span>: <span class="string">""</span>, </span><br><span class="line">  <span class="attr">"files"</span>: &#123;</span><br><span class="line">    <span class="attr">"file"</span>: <span class="string">"Hello World!"</span></span><br><span class="line">  &#125;, </span><br><span class="line">  <span class="attr">"form"</span>: &#123;&#125;, </span><br><span class="line">  <span class="attr">"headers"</span>: &#123;</span><br><span class="line">    <span class="attr">"Accept"</span>: <span class="string">"*/*"</span>, </span><br><span class="line">    <span class="attr">"Accept-Encoding"</span>: <span class="string">"gzip, deflate"</span>, </span><br><span class="line">    <span class="attr">"Content-Length"</span>: <span class="string">"156"</span>, </span><br><span class="line">    <span class="attr">"Content-Type"</span>: <span class="string">"multipart/form-data; boundary=7d8eb5ff99a04c11bb3e862ce78d7000"</span>, </span><br><span class="line">    <span class="attr">"Host"</span>: <span class="string">"httpbin.org"</span>, </span><br><span class="line">    <span class="attr">"User-Agent"</span>: <span class="string">"python-requests/2.9.1"</span></span><br><span class="line">  &#125;, </span><br><span class="line">  <span class="attr">"json"</span>: <span class="literal">null</span>, </span><br><span class="line">  <span class="attr">"url"</span>: <span class="string">"http://httpbin.org/post"</span></span><br><span class="line">&#125;</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>这样我们便成功完成了一个文件的上传。 requests 是支持流式上传的，这允许你发送大的数据流或文件而无需先把它们读入内存。要使用流式上传，仅需为你的请求体提供一个类文件对象即可</p>
                  <figure class="highlight livecodeserver">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">'massive-body'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    requests.<span class="built_in">post</span>(<span class="string">'http://some.url/streamed'</span>, data=f)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>这是一个非常实用方便的功能。</p>
                  <h2 id="Cookies"><a href="#Cookies" class="headerlink" title="Cookies"></a>Cookies</h2>
                  <p>如果一个响应中包含了cookie，那么我们可以利用 cookies 变量来拿到</p>
                  <figure class="highlight routeros">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">import requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">'http://example.com'</span></span><br><span class="line">r = requests.<span class="builtin-name">get</span>(url)</span><br><span class="line"><span class="builtin-name">print</span> r.cookies</span><br><span class="line"><span class="builtin-name">print</span> r.cookies[<span class="string">'example_cookie_name'</span>]</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>以上程序仅是样例，可以用 cookies 变量来得到站点的 cookies 另外可以利用 cookies 变量来向服务器发送 cookies 信息</p>
                  <figure class="highlight routeros">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">import requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">'http://httpbin.org/cookies'</span></span><br><span class="line">cookies = dict(<span class="attribute">cookies_are</span>=<span class="string">'working'</span>)</span><br><span class="line">r = requests.<span class="builtin-name">get</span>(url, <span class="attribute">cookies</span>=cookies)</span><br><span class="line"><span class="builtin-name">print</span> r.text</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>运行结果</p>
                  <figure class="highlight scilab">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="string">'&#123;"</span>cookies<span class="string">": &#123;"</span>cookies_are<span class="string">": "</span>working<span class="string">"&#125;&#125;'</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>可以已经成功向服务器发送了 cookies</p>
                  <h2 id="超时配置"><a href="#超时配置" class="headerlink" title="超时配置"></a>超时配置</h2>
                  <p>可以利用 timeout 变量来配置最大请求时间</p>
                  <figure class="highlight routeros">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">requests.<span class="builtin-name">get</span>(<span class="string">'http://github.com'</span>, <span class="attribute">timeout</span>=0.001)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p><strong>注：timeout 仅对连接过程有效，与响应体的下载无关。</strong> 也就是说，这个时间只限制请求的时间。即使返回的 response 包含很大内容，下载需要一定时间，然而这并没有什么卵用。</p>
                  <h2 id="会话对象"><a href="#会话对象" class="headerlink" title="会话对象"></a>会话对象</h2>
                  <p>在以上的请求中，每次请求其实都相当于发起了一个新的请求。也就是相当于我们每个请求都用了不同的浏览器单独打开的效果。也就是它并不是指的一个会话，即使请求的是同一个网址。比如</p>
                  <figure class="highlight routeros">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">import requests</span><br><span class="line"></span><br><span class="line">requests.<span class="builtin-name">get</span>(<span class="string">'http://httpbin.org/cookies/set/sessioncookie/123456789'</span>)</span><br><span class="line">r = requests.<span class="builtin-name">get</span>(<span class="string">"http://httpbin.org/cookies"</span>)</span><br><span class="line"><span class="builtin-name">print</span>(r.text)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>结果是</p>
                  <figure class="highlight json">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"cookies"</span>: &#123;&#125;</span><br><span class="line">&#125;</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>很明显，这不在一个会话中，无法获取 cookies，那么在一些站点中，我们需要保持一个持久的会话怎么办呢？就像用一个浏览器逛淘宝一样，在不同的选项卡之间跳转，这样其实就是建立了一个长久会话。 解决方案如下</p>
                  <figure class="highlight routeros">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">import requests</span><br><span class="line"></span><br><span class="line">s = requests.Session()</span><br><span class="line">s.<span class="builtin-name">get</span>(<span class="string">'http://httpbin.org/cookies/set/sessioncookie/123456789'</span>)</span><br><span class="line">r = s.<span class="builtin-name">get</span>(<span class="string">"http://httpbin.org/cookies"</span>)</span><br><span class="line"><span class="builtin-name">print</span>(r.text)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>在这里我们请求了两次，一次是设置 cookies，一次是获得 cookies 运行结果</p>
                  <figure class="highlight json">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"cookies"</span>: &#123;</span><br><span class="line">    <span class="attr">"sessioncookie"</span>: <span class="string">"123456789"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>发现可以成功获取到 cookies 了，这就是建立一个会话到作用。体会一下。 那么既然会话是一个全局的变量，那么我们肯定可以用来全局的配置了。</p>
                  <figure class="highlight pgsql">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">s = requests.<span class="keyword">Session</span>()</span><br><span class="line">s.headers.<span class="keyword">update</span>(&#123;<span class="string">'x-test'</span>: <span class="string">'true'</span>&#125;)</span><br><span class="line">r = s.<span class="keyword">get</span>(<span class="string">'http://httpbin.org/headers'</span>, headers=&#123;<span class="string">'x-test2'</span>: <span class="string">'true'</span>&#125;)</span><br><span class="line">print r.text</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>通过 s.headers.update 方法设置了 headers 的变量。然后我们又在请求中设置了一个 headers，那么会出现什么结果？ 很简单，两个变量都传送过去了。 运行结果</p>
                  <figure class="highlight json">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"headers"</span>: &#123;</span><br><span class="line">    <span class="attr">"Accept"</span>: <span class="string">"*/*"</span>, </span><br><span class="line">    <span class="attr">"Accept-Encoding"</span>: <span class="string">"gzip, deflate"</span>, </span><br><span class="line">    <span class="attr">"Host"</span>: <span class="string">"httpbin.org"</span>, </span><br><span class="line">    <span class="attr">"User-Agent"</span>: <span class="string">"python-requests/2.9.1"</span>, </span><br><span class="line">    <span class="attr">"X-Test"</span>: <span class="string">"true"</span>, </span><br><span class="line">    <span class="attr">"X-Test2"</span>: <span class="string">"true"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>如果get方法传的headers 同样也是 x-test 呢？</p>
                  <figure class="highlight ini">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="attr">r</span> = s.get(<span class="string">'http://httpbin.org/headers'</span>, headers=&#123;<span class="string">'x-test'</span>: <span class="string">'true'</span>&#125;)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>嗯，它会覆盖掉全局的配置</p>
                  <figure class="highlight json">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"headers"</span>: &#123;</span><br><span class="line">    <span class="attr">"Accept"</span>: <span class="string">"*/*"</span>, </span><br><span class="line">    <span class="attr">"Accept-Encoding"</span>: <span class="string">"gzip, deflate"</span>, </span><br><span class="line">    <span class="attr">"Host"</span>: <span class="string">"httpbin.org"</span>, </span><br><span class="line">    <span class="attr">"User-Agent"</span>: <span class="string">"python-requests/2.9.1"</span>, </span><br><span class="line">    <span class="attr">"X-Test"</span>: <span class="string">"true"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>那如果不想要全局配置中的一个变量了呢？很简单，设置为 None 即可</p>
                  <figure class="highlight ini">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="attr">r</span> = s.get(<span class="string">'http://httpbin.org/headers'</span>, headers=&#123;<span class="string">'x-test'</span>: None&#125;)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>运行结果</p>
                  <figure class="highlight json">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"headers"</span>: &#123;</span><br><span class="line">    <span class="attr">"Accept"</span>: <span class="string">"*/*"</span>, </span><br><span class="line">    <span class="attr">"Accept-Encoding"</span>: <span class="string">"gzip, deflate"</span>, </span><br><span class="line">    <span class="attr">"Host"</span>: <span class="string">"httpbin.org"</span>, </span><br><span class="line">    <span class="attr">"User-Agent"</span>: <span class="string">"python-requests/2.9.1"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>嗯，以上就是 session 会话的基本用法</p>
                  <h2 id="SSL证书验证"><a href="#SSL证书验证" class="headerlink" title="SSL证书验证"></a>SSL证书验证</h2>
                  <p>现在随处可见 https 开头的网站，Requests可以为HTTPS请求验证SSL证书，就像web浏览器一样。要想检查某个主机的SSL证书，你可以使用 verify 参数 现在 12306 证书不是无效的嘛，来测试一下</p>
                  <figure class="highlight routeros">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">import requests</span><br><span class="line"></span><br><span class="line">r = requests.<span class="builtin-name">get</span>(<span class="string">'https://kyfw.12306.cn/otn/'</span>, <span class="attribute">verify</span>=<span class="literal">True</span>)</span><br><span class="line"><span class="builtin-name">print</span> r.text</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>结果</p>
                  <figure class="highlight css">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="selector-tag">requests</span><span class="selector-class">.exceptions</span><span class="selector-class">.SSLError</span>: <span class="selector-attr">[SSL: CERTIFICATE_VERIFY_FAILED]</span> <span class="selector-tag">certificate</span> <span class="selector-tag">verify</span> <span class="selector-tag">failed</span> (_<span class="selector-tag">ssl</span><span class="selector-class">.c</span><span class="selector-pseudo">:590)</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>果真如此 来试下 github 的</p>
                  <figure class="highlight routeros">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">import requests</span><br><span class="line"></span><br><span class="line">r = requests.<span class="builtin-name">get</span>(<span class="string">'https://github.com'</span>, <span class="attribute">verify</span>=<span class="literal">True</span>)</span><br><span class="line"><span class="builtin-name">print</span> r.text</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>嗯，正常请求，内容我就不输出了。 如果我们想跳过刚才 12306 的证书验证，把 verify 设置为 False 即可</p>
                  <figure class="highlight routeros">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">import requests</span><br><span class="line"></span><br><span class="line">r = requests.<span class="builtin-name">get</span>(<span class="string">'https://kyfw.12306.cn/otn/'</span>, <span class="attribute">verify</span>=<span class="literal">False</span>)</span><br><span class="line"><span class="builtin-name">print</span> r.text</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>发现就可以正常请求了。在默认情况下 verify 是 True，所以如果需要的话，需要手动设置下这个变量。</p>
                  <h2 id="代理"><a href="#代理" class="headerlink" title="代理"></a>代理</h2>
                  <p>如果需要使用代理，你可以通过为任意请求方法提供 proxies 参数来配置单个请求</p>
                  <figure class="highlight nix">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="built_in">import</span> requests</span><br><span class="line"></span><br><span class="line"><span class="attr">proxies</span> = &#123;</span><br><span class="line">  <span class="string">"https"</span>: <span class="string">"http://41.118.132.69:4433"</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="attr">r</span> = requests.post(<span class="string">"http://httpbin.org/post"</span>, <span class="attr">proxies=proxies)</span></span><br><span class="line">print r.text</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>也可以通过环境变量 HTTP_PROXY 和 HTTPS_PROXY 来配置代理</p>
                  <figure class="highlight routeros">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="builtin-name">export</span> <span class="attribute">HTTP_PROXY</span>=<span class="string">"http://10.10.1.10:3128"</span></span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">HTTPS_PROXY</span>=<span class="string">"http://10.10.1.10:1080"</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>通过以上方式，可以方便地设置代理。</p>
                  <h2 id="API"><a href="#API" class="headerlink" title="API"></a>API</h2>
                  <p>以上讲解了 requests 中最常用的参数，如果需要用到更多，请参考官方文档 API <a href="http://docs.python-requests.org/en/master/api/" target="_blank" rel="noopener">API</a></p>
                  <h2 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h2>
                  <p>以上总结了一下 requests 的基本用法，如果你对爬虫有了一定的基础，那么肯定可以很快上手，在此就不多赘述了。 练习才是王道，大家尽快投注于实践中吧。</p>
                  </p>
                </div>
              </div>
              <div class="post-meta">
                <span class="post-meta-item">
                  <span class="post-meta-item-icon">
                    <i class="far fa-user"></i>
                  </span>
                  <span class="post-meta-item-text">作者</span>
                  <span><a href="/authors/崔庆才" class="author" itemprop="url" rel="index">崔庆才</a></span>
                </span>
                <span class="post-meta-item">
                  <span class="post-meta-item-icon">
                    <i class="far fa-calendar"></i>
                  </span>
                  <span class="post-meta-item-text">发表于</span>
                  <time title="创建时间：2016-03-19 21:05:03" itemprop="dateCreated datePublished" datetime="2016-03-19T21:05:03+08:00">2016-03-19</time>
                </span>
                <span id="/2556.html" class="post-meta-item leancloud_visitors" data-flag-title="Python爬虫利器一之Requests库的用法" title="阅读次数">
                  <span class="post-meta-item-icon">
                    <i class="fa fa-eye"></i>
                  </span>
                  <span class="post-meta-item-text">阅读次数：</span>
                  <span class="leancloud-visitors-count"></span>
                </span>
                <span class="post-meta-item" title="本文字数">
                  <span class="post-meta-item-icon">
                    <i class="far fa-file-word"></i>
                  </span>
                  <span class="post-meta-item-text">本文字数：</span>
                  <span>7.2k</span>
                </span>
                <span class="post-meta-item" title="阅读时长">
                  <span class="post-meta-item-icon">
                    <i class="far fa-clock"></i>
                  </span>
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                  <span>7 分钟</span>
                </span>
              </div>
            </article>
            <article itemscope itemtype="http://schema.org/Article" class="post-block index" lang="zh-CN">
              <link itemprop="mainEntityOfPage" href="https://cuiqingcai.com/2529.html">
              <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
                <meta itemprop="image" content="/images/avatar.png">
                <meta itemprop="name" content="崔庆才">
                <meta itemprop="description" content="崔庆才的个人站点，记录生活的瞬间，分享学习的心得。">
              </span>
              <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
                <meta itemprop="name" content="静觅">
              </span>
              <header class="post-header">
                <h2 class="post-title" itemprop="name headline">
                  <a class="label"> JavaScript <i class="label-arrow"></i>
                  </a>
                  <a href="/2529.html" class="post-title-link" itemprop="url">jQuery易忽略的知识点总结</a>
                </h2>
              </header>
              <div class="post-body" itemprop="articleBody">
                <div class="thumb">
                  <img itemprop="contentUrl" class="random">
                </div>
                <div class="excerpt">
                  <p>
                  <h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2>
                  <p>之前在用jQuery，不过有时候用着用着一些用法发现并没有用到过，比较陌生，现在重新梳理一下，把易忽略的知识点总结一下，长期更新。 参考梳理来源： <a href="http://www.imooc.com/learn/11" target="_blank" rel="noopener">慕课网</a></p>
                  <h2 id="sele1-sele2-seleN选择器"><a href="#sele1-sele2-seleN选择器" class="headerlink" title="sele1,sele2,seleN选择器"></a>sele1,sele2,seleN选择器</h2>
                  <p>有时需要精确的选择任意<strong>多个指定的元素</strong>，类似于从文具盒中挑选出多根自已喜欢的笔，就需要调用sele1,sele2,seleN选择器，它的调用格式如下： <code>$(“sele1,sele2,seleN”)</code> 其中参数sele1、sele2到seleN为有效选择器，每个选择器之间用“，”号隔开，它们可以是之前提及的各种类型选择器，如<code>$(“#id”)、$(“.class”)、$(“selector”)</code>选择器等。 例如，通过选择器获取其中的任意两个元素，并将它们显示的内容设为相同，如图所示： <a href="http://img.mukewang.com/528705b000012a1102890134.jpg" target="_blank" rel="noopener"><img src="http://img.mukewang.com/528705b000012a1102890134.jpg" alt=""></a> 在浏览器中显示的效果： <a href="http://img.mukewang.com/528705c700010e6d04720207.jpg" target="_blank" rel="noopener"><img src="http://img.mukewang.com/528705c700010e6d04720207.jpg" alt=""></a> 虽然页面中添加了三个元素，但是通过使用<code>$(“div,p”)</code>选择器方式获取了其中的
                  <div>和<p>元素，并设置它们显示的内容。</p>
                    <h2 id="prev-next选择器"><a href="#prev-next选择器" class="headerlink" title="prev + next选择器"></a>prev + next选择器</h2>
                    <p>俗话说“远亲不如近邻”，而通过<code>prev + next</code>选择器就可以查找与“prev”元素紧邻的下一个“next”元素，格式如下： <code>$(“prev + next”)</code> 其中参数prev为任何有效的选择器，参数“next”为另外一个有效选择器，它们之间的“+”表示一种上下的层次关系，也就是说，“prev”元素最紧邻的下一个元素由“next”选择器返回的并且只返回唯的一个元素。 例如，使用<code>prev + next</code>选择器，获取
                    <p>元素最近邻的下一个元素，如下图所示： <a href="http://img.mukewang.com/5292e68c000191c204000224.jpg" target="_blank" rel="noopener"><img src="http://img.mukewang.com/5292e68c000191c204000224.jpg" alt=""></a> 在浏览器中显示的效果： <a href="http://img.mukewang.com/5292ebe60001dc2b03350376.jpg" target="_blank" rel="noopener"><img src="http://img.mukewang.com/5292ebe60001dc2b03350376.jpg" alt=""></a></p>
                    <h2 id="prev-siblings选择器"><a href="#prev-siblings选择器" class="headerlink" title="prev ~ siblings选择器"></a>prev ~ siblings选择器</h2>
                    <p>与上一节中介绍的<code>prev + next</code>层次选择器相同，<code>prev ~ siblings</code>选择器也是查找prev 元素之后的相邻元素，但前者只获取第一个相邻的元素，而后者则获取prev 元素后面全部相邻的元素，它的调用格式如下： <code>$(“prev ~ siblings”)</code> 其中参数prev与siblings两者之间通过“~”符号形成一种层次相邻的关系，表明siblings选择器获取的元素都是prev元素之后的同辈元素。 例如，使用<code>prev ~ next</code>选择器，获取
                    <p>元素后面相邻的全部元素，并设置它们在页面中显示的内容，如下图所示： <a href="http://img.mukewang.com/5292fc460001105a03310216.jpg" target="_blank" rel="noopener"><img src="http://img.mukewang.com/5292fc460001105a03310216.jpg" alt=""></a> 在浏览器中显示的效果： <a href="http://img.mukewang.com/5292fc690001e15d04200411.jpg" target="_blank" rel="noopener"><img src="http://img.mukewang.com/5292fc690001e15d04200411.jpg" alt=""></a> 可以看出，调用<code>$(&quot;p~span&quot;)</code>选择器代码，获取了
                    <p>元素下面两个(全部)的<span>元素，该元素不包含<p>元素上面的元素和不属于同辈范围的元素。</p>
                        <h2 id="contains-text-过滤选择器"><a href="#contains-text-过滤选择器" class="headerlink" title=":contains(text)过滤选择器"></a>:contains(text)过滤选择器</h2>
                        <p>与上一节介绍的:eq(index)选择器按索引查找元素相比，有时候我们可能希望按照<strong>文本内容</strong>来查找一个或多个元素，那么使用<code>:contains(text)</code>选择器会更加方便， 它的功能是选择<strong>包含</strong>指定字符串的全部元素，它通常与其他元素结合使用，获取包含“text”字符串内容的全部元素对象。其中参数<code>text</code>表示页面中的文字。 例如: <a href="http://img.mukewang.com/529c067b00014cad03480210.jpg" target="_blank" rel="noopener"><img src="http://img.mukewang.com/529c067b00014cad03480210.jpg" alt=""></a> 在浏览器中显示的效果： <a href="http://img.mukewang.com/529c069b0001879204890294.jpg" target="_blank" rel="noopener"><img src="http://img.mukewang.com/529c069b0001879204890294.jpg" alt=""></a> 从图中可以看出，调用<code>li:contains(&#39;土豪&#39;)</code>代码，可以很方便地获取<li>中<strong>包含</strong>‘土豪’字符内容的全部元素，并且只要与选择的元素中或子元素中包含该字符内容，就可以被选中。 注意：<code>li:contains(&#39;土豪&#39;)</code> 土豪为什么必须加单引号呢？因为它是一个字符串，而不是一个变量，所以不加单或双引号的话是会报错的。</p>
                        <h2 id="has-selector-过滤选择器"><a href="#has-selector-过滤选择器" class="headerlink" title=":has(selector)过滤选择器"></a>:has(selector)过滤选择器</h2>
                        <p>除了在上一小节介绍的使用包含的字符串内容过滤元素之外，还可以使用包含的元素名称来过滤，<code>:has(selector)</code>过滤选择器的功能是获取选择器中包含指定元素名称的全部元素，其中<code>selector</code>参数就是包含的元素名称，是被包含元素。 例如：获取指定包含某个元素名的全部<li>元素，并改变它们显示文字的颜色，如下图所示： <a href="http://img.mukewang.com/529c1a8300017dd003040210.jpg" target="_blank" rel="noopener"><img src="http://img.mukewang.com/529c1a8300017dd003040210.jpg" alt=""></a> 在浏览器中显示的效果： <a href="http://img.mukewang.com/529c1aab00017a4d04890294.jpg" target="_blank" rel="noopener"><img src="http://img.mukewang.com/529c1aab00017a4d04890294.jpg" alt=""></a> 可以看出，通过使用<code>$(&quot;li:has(&#39;p&#39;)&quot;)</code>选择器代码，获取了包含<p>元素的全部
                          <li>元素，并通过css方法改变了这些元素在页面中显示的文字样式。
                        </p>
                        <h2 id="hidden过滤选择器"><a href="#hidden过滤选择器" class="headerlink" title=":hidden过滤选择器"></a>:hidden过滤选择器</h2>
                        <p><code>:hidden</code>过滤选择器的功能是获取全部不可见的元素，这些不可见的元素中包括type属性值为hidden的元素。 例如，调用<code>:hidden</code>选择器获取不可见的
                        <p>元素，并将该元素的内容显示在
                        <div>元素中，如下图所示： <a href="http://img.mukewang.com/529c1c5a00011bc303620165.jpg" target="_blank" rel="noopener"><img src="http://img.mukewang.com/529c1c5a00011bc303620165.jpg" alt=""></a> 在浏览器中显示的效果： <a href="http://img.mukewang.com/529c1c760001eaf304890212.jpg" target="_blank" rel="noopener"><img src="http://img.mukewang.com/529c1c760001eaf304890212.jpg" alt=""></a> 从图中可以看出，先调用<code>$(&quot;p:hidden&quot;)</code>代码获取隐藏的<p>元素，并调用该元素的html()方法获取该元素中的内容，最后将该内容显示在
                          <div>元素中。</p>
                    <h2 id="visible过滤选择器"><a href="#visible过滤选择器" class="headerlink" title=":visible过滤选择器"></a>:visible过滤选择器</h2>
                    <p>与上一节的<code>:hidden</code>过滤选择器相反，<code>:visible</code>过滤选择器获取的是全部可见的元素，也就是说，只要不将元素的display属性值设置为“none”，那么，都可以通过该选择器获取。 例如，使用<code>:visible</code>选择器获取可见的
                    <p>元素，并将该元素的内容显示在
                    <div>元素中，如下图所示： <a href="http://img.mukewang.com/529c2106000192f303620159.jpg" target="_blank" rel="noopener"><img src="http://img.mukewang.com/529c2106000192f303620159.jpg" alt=""></a> 在浏览器中显示的效果： <a href="http://img.mukewang.com/529c212000016e8e04890193.jpg" target="_blank" rel="noopener"><img src="http://img.mukewang.com/529c212000016e8e04890193.jpg" alt=""></a> 从图中可以看出，调用<code>$(&quot;p:visible&quot;)</code>选择器代码，获取那个可见的<p>元素，并调用<code>html()</code>方法获取该元素的内容，最后将该内容显示在
                      <div>元素中。</p>
                        <h2 id="input表单选择器"><a href="#input表单选择器" class="headerlink" title=":input表单选择器"></a>:input表单选择器</h2>
                        <p>如何获取表单全部元素？<code>:input</code>表单选择器可以实现，它的功能是返回<strong>全部的表单元素</strong>，不仅包括所有<input>标记的表单元素，而且还包括<textarea>、<select> 和 <button>标记的表单元素，因此，它选择的表单元素是最广的。 如下图所示，使用<code>:input</code>表单选择器获取表单元素，并向这些元素增加一个CSS样式类别，修改它们在页面中显示的边框颜色。 <img src="http://img.mukewang.com/52970dc4000102ab03820242.jpg" alt=""> 在浏览器中显示的效果： <img src="http://img.mukewang.com/52970dd300016ac304760305.jpg" alt=""> 可以看出，通过调用$(“#frmTest :input”)表单选择器代码获取了表单中的全部元素，并使用addClass()方法修改它们在页面中显示的边框颜色。addClass()方法的功能是为元素添加指定的样式类别名称，它的更多使用将会在后续章节中进行详细介绍。</p>
<h2 id="text表单文本选择器"><a href="#text表单文本选择器" class="headerlink" title=":text表单文本选择器"></a>:text表单文本选择器</h2><p><code>:text</code>表单文本选择器可以获取表单中全部单行的文本输入框元素，单行的文本输入框就像一个不换行的字条工具，使用非常广泛。 例如，在表单中添加多个元素，使用<code>:text</code>选择器获取单行的文本输入框元素，并修改字的边框颜色，如下图所示： <img src="http://img.mukewang.com/5297107600011ddf04240201.jpg" alt=""> 在浏览器中显示的效果： <img src="http://img.mukewang.com/52971086000125ea04440275.jpg" alt=""> 从图中可以看出，通过<code>:text</code>表单选择器只获取单行的文本输入框元素，对于<textarea>区域文本、按钮元素无效。</p>
<h2 id="password表单密码选择器"><a href="#password表单密码选择器" class="headerlink" title=":password表单密码选择器"></a>:password表单密码选择器</h2><p>如果想要获取密码输入文本框，可以使用<code>:password</code>选择器，它的功能是获取表单中全部的密码输入文本框元素。 例如，在表单中添加多个输入框元素，使用<code>:password</code>获取密码输入文本框元素，并修改它的边框颜色，如下图所示： <img src="http://img.mukewang.com/529713cd000159b804810217.jpg" alt=""> 在浏览器中显示的效果： <img src="http://img.mukewang.com/529713e50001b30004510309.jpg" alt=""> 从图中可以看出，在多个文本输入框中，使用:password选择器只能获取表单中的密码输入文本框，并使用addClass()方法改变它的边框颜色。</p>
<h2 id="radio单选按钮选择器"><a href="#radio单选按钮选择器" class="headerlink" title=":radio单选按钮选择器"></a>:radio单选按钮选择器</h2><p>表单中的单选按钮常用于多项数据中仅选择其一，而使用<code>:radio</code>选择器可轻松获取表单中的<strong>全部单选按钮</strong>元素。 例如，在表单中添加多种类型的表单元素，使用<code>:radio</code>选择器获取并隐藏这些元素中的全部单选按钮元素，如下图所示： <img src="http://img.mukewang.com/529715580001099503830280.jpg" alt=""> <code>hide()</code>方法的功能是隐藏指定的元素。 在浏览器中显示的效果： <img src="http://img.mukewang.com/529715c60001ca0504500321.jpg" alt=""> 以上是:radio选择器的效果。</p>
<h2 id="checkbox复选框选择器"><a href="#checkbox复选框选择器" class="headerlink" title=":checkbox复选框选择器"></a>:checkbox复选框选择器</h2><p>表单中的复选框常用于多项数据的选择，使用<code>:checkbox</code>选择器可以快速定位并获取表单中的复选框元素。 例如，在表单中增加多个不同类型的元素，使用<code>:checkbox</code>选择器获取其中的全部复选框元素，并将它们全部设为选中状态，如下图所示： <a href="http://img.mukewang.com/52971ac700017fbf03830322.jpg" target="_blank" rel="noopener"><img src="http://img.mukewang.com/52971ac700017fbf03830322.jpg" alt=""></a> 在浏览器中显示的效果： <a href="http://img.mukewang.com/52971afe0001750304500280.jpg" target="_blank" rel="noopener"><img src="http://img.mukewang.com/52971afe0001750304500280.jpg" alt=""></a> 这样便实现了选中 checkbox 的效果，做<strong>全选</strong>的时候比较方便。</p>
<h2 id="submit提交按钮选择器"><a href="#submit提交按钮选择器" class="headerlink" title=":submit提交按钮选择器"></a>:submit提交按钮选择器</h2><p>通常情况下，一个表单中只允许有一个“type”属性值为“submit”的提交按钮，使用<code>:submit</code>选择器可获取表单中的这个<strong>提交按钮</strong>元素。 例如，在表单中添加多个不同类型的按钮，使用<code>:submit</code>选择器获取其中的提交按钮，并使用<code>attr()</code>方法修改按钮显示的文本内容，如下图所示： <a href="http://img.mukewang.com/52b2584e000129a804330199.jpg" target="_blank" rel="noopener"><img src="http://img.mukewang.com/52b2584e000129a804330199.jpg" alt=""></a> 在浏览器中显示的效果： <a href="http://img.mukewang.com/52b258c60001e23604500280.jpg" target="_blank" rel="noopener"><img src="http://img.mukewang.com/52b258c60001e23604500280.jpg" alt=""></a> 从图中可以看出，使用<code>:submit</code>选择器从三种类型按钮中获取了提交按钮，并使用<code>attr()</code>方法将该按钮显示的文字修改为“点我就提交了”。</p>
<h2 id="button表单按钮选择器"><a href="#button表单按钮选择器" class="headerlink" title=":button表单按钮选择器"></a>:button表单按钮选择器</h2><p>表单中包含许多类型的按钮，而使用<code>:button</code>选择器能获取且只能获取“type”属性值为“button”的<input>和<button>这两类普通按钮元素。 例如，在表单中添加多种类型的按钮元素，使用<code>:button</code>选择器获取其中的普通按钮元素，并修改它们的边框色，如下图所示： <a href="http://img.mukewang.com/52b286a50001862e04740207.jpg" target="_blank" rel="noopener"><img src="http://img.mukewang.com/52b286a50001862e04740207.jpg" alt=""></a> 在浏览器中显示的效果： <a href="http://img.mukewang.com/52b286e100017beb04530252.jpg" target="_blank" rel="noopener"><img src="http://img.mukewang.com/52b286e100017beb04530252.jpg" alt=""></a> 从图中可以看出，使用<code>:button</code>选择器只能获取两种类型的普通按钮，且修改了它们的边框颜色，并未获取表单中的“提交按钮”。</p>
<h2 id="checked选中状态选择器"><a href="#checked选中状态选择器" class="headerlink" title=":checked选中状态选择器"></a>:checked选中状态选择器</h2><p>有一些元素存在选中状态，如复选框、单选按钮元素，选中时“checked”属性值为“checked”，调用:checked可以获取处于选中状态的全部元素。 例如，在表单中添加多个复选框和单选按钮，其中有一些元素处于选中状态，使用<code>:checked</code><strong>获取</strong>并<strong>隐藏</strong>处于选中状态的元素，如下图所示： <a href="http://img.mukewang.com/52b28b1500017db404530386.jpg" target="_blank" rel="noopener"><img src="http://img.mukewang.com/52b28b1500017db404530386.jpg" alt=""></a> 在浏览器中显示的效果： <a href="http://img.mukewang.com/52b28b3b00015c7f04500290.jpg" target="_blank" rel="noopener"><img src="http://img.mukewang.com/52b28b3b00015c7f04500290.jpg" alt=""></a> 从图中可以看出，使用<code>:checked</code>选择器可以获取处于选中状态的元素，并调用<code>hide()</code>方法将它们进行隐藏。</p>
<h2 id="selected选中状态选择器"><a href="#selected选中状态选择器" class="headerlink" title=":selected选中状态选择器"></a>:selected选中状态选择器</h2><p>与<code>:checked</code>选择器相比，<code>:selected</code>选择器只能获取<select>下拉列表框中全部处于选中状态的<option>选项元素。 例如，在一个添加多个<option>选项的下拉列表框中，使用<code>:selected</code>选择器修改处于选中状态的内容值，如下图所示： <a href="http://img.mukewang.com/52b28d15000198f404430262.jpg" target="_blank" rel="noopener"><img src="http://img.mukewang.com/52b28d15000198f404430262.jpg" alt=""></a> 在浏览器中显示的效果： <a href="http://img.mukewang.com/52b28d370001a09004570304.jpg" target="_blank" rel="noopener"><img src="http://img.mukewang.com/52b28d370001a09004570304.jpg" alt=""></a> 从图中可以看出，使用<code>:selected</code>选择器获取处于选中状态的<option>元素，并调用<code>text()</code>方法修改这些选中状态元素显示的内容。<code>text()</code>方法的功能是获取或设置元素的文本内容，该方法在后续将有详细的介绍。</p>
<h2 id="first-child子元素过滤选择器"><a href="#first-child子元素过滤选择器" class="headerlink" title=":first-child子元素过滤选择器"></a>:first-child子元素过滤选择器</h2><p>通过上面章节的学习，我们知道使用<code>:first</code>过滤选择器可以获取指定父元素中的首个子元素，但该选择器返回的只有一个元素，并不是一个集合，而使用<code>:first-child</code>子元素过滤选择器则可以获取每个父元素中返回的首个子元素，它是一个集合，常用多个集合数据的选择处理。 如下图，如果想把页面中每个ul中的第一个li获取到，并改变其颜色。则可以使用 <code>: first-child</code> <a href="http://img.mukewang.com/529c2a9000014a0e03500322.jpg" target="_blank" rel="noopener"><img src="http://img.mukewang.com/529c2a9000014a0e03500322.jpg" alt=""></a> 在浏览器中显示的效果： <a href="http://img.mukewang.com/529c2ab600011b5804890326.jpg" target="_blank" rel="noopener"><img src="http://img.mukewang.com/529c2ab600011b5804890326.jpg" alt=""></a> 通过<code>$(&quot;li:first-child&quot;)</code>选择器代码，获取了两个<ul>父元素中的第一个<li>元素，并使用<code>css()</code>方法修改了它们在页面中显示的文字颜色。</p>
<h2 id="替换内容"><a href="#替换内容" class="headerlink" title="替换内容"></a>替换内容</h2><p><code>replaceWith()</code>和<code>replaceAll()</code>方法都可以用于替换元素或元素中的内容，但它们调用时，内容和被替换元素所在的位置不同，分别为如下所示： <code>**$(selector).replaceWith(content)**</code>和<code>**$(content).replaceAll(selector)**</code> 参数selector为被替换的元素，content为替换的内容。 例如，调用<code>replaceWith()</code>方法将页面中<span>元素替换成一段HTML字符串，如下图所示： <a href="http://img.mukewang.com/52bcdc2c0001b69c04750130.jpg" target="_blank" rel="noopener"><img src="http://img.mukewang.com/52bcdc2c0001b69c04750130.jpg" alt=""></a> 在浏览器中显示的效果： <a href="http://img.mukewang.com/52bcdc4f0001e25f04830237.jpg" target="_blank" rel="noopener"><img src="http://img.mukewang.com/52bcdc4f0001e25f04830237.jpg" alt=""></a> 从图中可以看出，使用<code>replaceWith()</code>方法替换类别名为“green”的<span>元素，替换之后，旧元素完全由新替换的元素所取代。</p>
<h2 id="使用wrap-和wrapInner-方法包裹元素和内容"><a href="#使用wrap-和wrapInner-方法包裹元素和内容" class="headerlink" title="使用wrap()和wrapInner()方法包裹元素和内容"></a>使用wrap()和wrapInner()方法包裹元素和内容</h2><p><code>wrap()</code>和<code>wrapInner()</code>方法都可以进行元素的包裹，但前者用于包裹元素本身，后者则用于包裹元素中的内容，它们的调用格式分别为： <code>**$(selector).wrap(wrapper)**</code>和<code>**$(selector).wrapInner(wrapper)**</code> 参数selector为被包裹的元素，wrapper参数为包裹元素的格式。 例如，调用<code>wrap()</code>方法，将<span>用<div>元素包裹起来，如下图所示： <a href="http://img.mukewang.com/52bcdea700016dbf03980120.jpg" target="_blank" rel="noopener"><img src="http://img.mukewang.com/52bcdea700016dbf03980120.jpg" alt=""></a> 在浏览器中显示的效果： <a href="http://img.mukewang.com/52bcdf080001301504830245.jpg" target="_blank" rel="noopener"><img src="http://img.mukewang.com/52bcdf080001301504830245.jpg" alt=""></a> 从图中可以看出，红色区域的<span>元素被蓝色边框的<div>元素通过<code>wrap()</code>方法包裹起来</p>
<h2 id="使用remove-和empty-方法删除元素"><a href="#使用remove-和empty-方法删除元素" class="headerlink" title="使用remove()和empty()方法删除元素"></a>使用remove()和empty()方法删除元素</h2><p><code>remove()</code>方法删除所选元素本身和子元素，该方法可以通过添加过滤参数指定需要删除的某些元素，而<code>empty()</code>方法则只删除所选元素的子元素。 例如，调用<code>remove()</code>方法删除<span>元素中类别名为“red”的，如下图所示： <a href="http://img.mukewang.com/52bceff500018e0702910171.jpg" target="_blank" rel="noopener"><img src="http://img.mukewang.com/52bceff500018e0702910171.jpg" alt=""></a> 在浏览器中显示的效果： <a href="http://img.mukewang.com/52bcf01c00013b5004830297.jpg" target="_blank" rel="noopener"><img src="http://img.mukewang.com/52bcf01c00013b5004830297.jpg" alt=""></a> 从图中可以看出，使用<code>remove(&quot;.red&quot;)</code>方法只是把<span>元素中类别名为“red”的这部分元素给删除了。</p>
<h2 id="使用hover-方法切换事件"><a href="#使用hover-方法切换事件" class="headerlink" title="使用hover()方法切换事件"></a>使用hover()方法切换事件</h2><p><code>hover()</code>方法的功能是当鼠标移到所选元素上时，执行方法中的第一个函数，鼠标移出时，执行方法中的第二个函数，实现事件的切实效果，调用格式如下： <code>**$(selector).hover(over****，****out);**</code> over参数为移到所选元素上触发的函数，out参数为移出元素时触发的函数。 例如，当鼠标移到<div>元素上时，元素中的字体变成金黄色，如下图所示： <a href="http://img.mukewang.com/52d22c9900013dbd03190241.jpg" target="_blank" rel="noopener"><img src="http://img.mukewang.com/52d22c9900013dbd03190241.jpg" alt=""></a> 在浏览器中显示的效果： <a href="http://img.mukewang.com/52d22cba0001163f04670262.jpg" target="_blank" rel="noopener"><img src="http://img.mukewang.com/52d22cba0001163f04670262.jpg" alt=""></a> 从图中可以看出，使用<code>hover()</code>方法执行两个函数，当鼠标移在元素上时调用<code>addClass()</code>方法增加一个样式，移出时，调用<code>removeClass()</code>方法移除该样式。</p>
<h2 id="使用toggle-方法绑定多个函数"><a href="#使用toggle-方法绑定多个函数" class="headerlink" title="使用toggle()方法绑定多个函数"></a>使用toggle()方法绑定多个函数</h2><p><code>toggle()</code>方法可以在元素的click事件中绑定两个或两个以上的函数，同时，它还可以实现元素的隐藏与显示的切换，绑定多个函数的调用格式如下： <code>**$(selector).toggle(fun1(),fun2(),funN(),...)**</code> 其中，fun1，fun2就是多个函数的名称 例如，使用<code>toggle()</code>方法，当每次点击<div>元素时，显示不同内容，如下图所示： <a href="http://img.mukewang.com/52d22e3a0001c56d02980289.jpg" target="_blank" rel="noopener"><img src="http://img.mukewang.com/52d22e3a0001c56d02980289.jpg" alt=""></a> 在浏览器中显示的效果： <a href="http://img.mukewang.com/52d22e570001902a04670335.jpg" target="_blank" rel="noopener"><img src="http://img.mukewang.com/52d22e570001902a04670335.jpg" alt=""></a> 从图中可以看出，每次点击<div>元素时，都依次执行<code>toggle()</code>方法绑定的函数，当执行到最后一个函数时，再次点击将又返回执行第一个函数。 注意：toggle()方法支持目前主流稳定的jQuery版本1.8.2，在1.9.0之后的版本是不支持的。</p>
<h2 id="使用one-方法绑定元素的一次性事件"><a href="#使用one-方法绑定元素的一次性事件" class="headerlink" title="使用one()方法绑定元素的一次性事件"></a>使用one()方法绑定元素的一次性事件</h2><p><code>one()</code>方法可以绑定元素任何有效的事件，但这种方法绑定的事件只会触发一次，它的调用格式如下： <code>**$(selector).one(event,[data],fun)**</code> 参数event为事件名称，data为触发事件时携带的数据，fun为触发该事件时执行的函数。 例如，使用one方法绑定<div>元素的单击事件，在事件执行的函数中，累计执行的次数，并将该次数显示在页面中，如下图所示： <a href="http://img.mukewang.com/52d231bd000192fb04310219.jpg" target="_blank" rel="noopener"><img src="http://img.mukewang.com/52d231bd000192fb04310219.jpg" alt=""></a> 在浏览器中显示的效果： <a href="http://img.mukewang.com/52d231dd00011da004890293.jpg" target="_blank" rel="noopener"><img src="http://img.mukewang.com/52d231dd00011da004890293.jpg" alt=""></a> 从图中可以看出，由于使用了<code>one()</code>方法绑定<div>元素的单击事件，因为事件函数只能执行一次，执行完成后，无论如何单击，都不再触发。</p>
<h2 id="调用animate-方法制作移动位置的动画"><a href="#调用animate-方法制作移动位置的动画" class="headerlink" title="调用animate()方法制作移动位置的动画"></a>调用animate()方法制作移动位置的动画</h2><p>调用<code>animate()</code>方法不仅可以制作简单渐渐变大的动画效果，而且还能制作移动位置的动画，在移动位置之前，必须将被移元素的“position”属性值设为“absolute”或“relative”，否则，该元素移动不了。 例如，调用<code>animate()</code>方法先将图片向右移动90px，然后，再将图片宽度与高度分别增加30px，如下图所示： <a href="http://img.mukewang.com/52dcc4eb0001c08e03410291.jpg" target="_blank" rel="noopener"><img src="http://img.mukewang.com/52dcc4eb0001c08e03410291.jpg" alt=""></a> 在浏览器中显示的效果： <a href="http://img.mukewang.com/52dcc50b0001ba2205060337.jpg" target="_blank" rel="noopener"><img src="http://img.mukewang.com/52dcc50b0001ba2205060337.jpg" alt=""></a> 从图中可以看出，图片先向右移动了“90px”，然后，移动成功后，再在原来的基础之上以动画的效果增大30px，增加成功后，显示“执行完成！”的字样。</p>
<p>s</p>
</p>
      
    </div>

  </div>

  
  
  

  <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-user"></i>
      </span>
      <span class="post-meta-item-text">作者</span>
      <span><a href="/authors/崔庆才" class="author" itemprop="url" rel="index">崔庆才</a></span>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2016-03-16 14:12:32" itemprop="dateCreated datePublished"
            datetime="2016-03-16T14:12:32+08:00">2016-03-16</time>
    </span>

    
    <span id="/2529.html" class="post-meta-item leancloud_visitors" data-flag-title="jQuery易忽略的知识点总结"
          title="阅读次数">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span class="leancloud-visitors-count"></span>
            </span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
        <span class="post-meta-item-text">本文字数：</span>
      <span>6.2k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
        <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>6 分钟</span>
    </span>

  </div>

</article>

    <article itemscope itemtype="http://schema.org/Article" class="post-block index" lang="zh-CN">
  <link itemprop="mainEntityOfPage" href="https://cuiqingcai.com/2491.html">
  <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="image" content="/images/avatar.png">
    <meta itemprop="name" content="崔庆才">
    <meta itemprop="description" content="崔庆才的个人站点，记录生活的瞬间，分享学习的心得。">
  </span>
  <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="静觅">
  </span>
  <header class="post-header">
    <h2 class="post-title" itemprop="name headline">
      <a class="label"> Other <i class="label-arrow"></i>
      </a>
      <a href="/2491.html" class="post-title-link" itemprop="url">PhpStorm使用File Watchers自动编译less</a>
    </h2>
  </header>
  <div class="post-body" itemprop="articleBody">
    <div class="thumb">
      <img itemprop="contentUrl" class="random">
    </div>
    <div class="excerpt">
      <p>
      <h2 id="综述"><a href="#综述" class="headerlink" title="综述"></a>综述</h2>
      <p>PhpStorm可以使用File Watchers自动编译Less，有了这个IDE，妈妈再也不用担心我的Less编译了。下面说一下我的配置过程。 下面的例子以 Mac OS X为例。</p>
      <h2 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h2>
      <h3 id="1-配置npm"><a href="#1-配置npm" class="headerlink" title="1.配置npm"></a>1.配置npm</h3>
      <figure class="highlight mipsasm">
        <table>
          <tr>
            <td class="gutter">
              <pre><span class="line">1</span><br></pre>
            </td>
            <td class="code">
              <pre><span class="line"><span class="keyword">brew </span><span class="keyword">install </span>npm</span><br></pre>
            </td>
          </tr>
        </table>
      </figure>
      <p>更多平台安装方式 <a href="https://www.npmjs.com/" target="_blank" rel="noopener">npm</a></p>
      <h3 id="2-安装lessc"><a href="#2-安装lessc" class="headerlink" title="2.安装lessc"></a>2.安装lessc</h3>
      <figure class="highlight cmake">
        <table>
          <tr>
            <td class="gutter">
              <pre><span class="line">1</span><br></pre>
            </td>
            <td class="code">
              <pre><span class="line">npm <span class="keyword">install</span> <span class="keyword">less</span> -g</span><br></pre>
            </td>
          </tr>
        </table>
      </figure>
      <p>安装完毕后查看安装路径</p>
      <figure class="highlight bash">
        <table>
          <tr>
            <td class="gutter">
              <pre><span class="line">1</span><br></pre>
            </td>
            <td class="code">
              <pre><span class="line"><span class="built_in">which</span> lessc</span><br></pre>
            </td>
          </tr>
        </table>
      </figure>
      <p>Mac OS X的结果是</p>
      <figure class="highlight awk">
        <table>
          <tr>
            <td class="gutter">
              <pre><span class="line">1</span><br></pre>
            </td>
            <td class="code">
              <pre><span class="line"><span class="regexp">/usr/</span>local<span class="regexp">/bin/</span>lessc</span><br></pre>
            </td>
          </tr>
        </table>
      </figure>
      <h3 id="3-配置PhpStorm"><a href="#3-配置PhpStorm" class="headerlink" title="3.配置PhpStorm"></a>3.配置PhpStorm</h3>
      <p>打开PhpStorm，Preferences-&gt;Tools-&gt;File Watchers 点击加号新增 Less Template，然后点击编辑按钮编辑，页面如下 <a href="http://qiniu.cuiqingcai.com/wp-content/uploads/2016/02/56926F1E-D626-4E66-925D-15971F993F30.jpg" target="_blank" rel="noopener"><img src="http://qiniu.cuiqingcai.com/wp-content/uploads/2016/02/56926F1E-D626-4E66-925D-15971F993F30-1024x557.jpg" alt="56926F1E-D626-4E66-925D-15971F993F30"></a> 其中需要配置两个地方</p>
      <h4 id="Program："><a href="#Program：" class="headerlink" title="Program："></a>Program：</h4>
      <p>配置为lessc的路径，这边配置为 /usr/local/bin/lessc</p>
      <h4 id="Output-paths-to-refresh："><a href="#Output-paths-to-refresh：" class="headerlink" title="Output paths to refresh："></a>Output paths to refresh：</h4>
      <figure class="highlight groovy">
        <table>
          <tr>
            <td class="gutter">
              <pre><span class="line">1</span><br></pre>
            </td>
            <td class="code">
              <pre><span class="line">$FileParentDir(less)<span class="string">$/css/$</span>FileDirPathFromParent(less)<span class="string">$/$FileNameWithoutExtension$.css</span></span><br></pre>
            </td>
          </tr>
        </table>
      </figure>
      <p>在这里简单解释下这个路径的意思。</p>
      <blockquote>
        <p>例如项目名为 project，less文件我们放置在 project/public/less/manage/style.less $FileParentDir(less)$ 是获取 less 目录的路径，也就是 project/public $FileDirPathFromParent(less)$ 是获取 less 文件到 less 目录的路径，也就是 manage $FileNameWithoutExtension$ 是获取 less 文件不带后缀的名字，也就是 style 经过如上拼接，生成的内容为 project/public/css/manage/style.css</p>
      </blockquote>
      <p>所以，不论我们的 less 文件如何放置，都可以生成相对路径的 css 文件。 配置完成之后，我们新建 less 目录，任意编辑一个 less 文件，都会在 css 目录下生成相应的文件。</p>
      <h2 id="简单配置"><a href="#简单配置" class="headerlink" title="简单配置"></a>简单配置</h2>
      <p>当然，如果你的 less 文件就直接在 less 目录下，可以简单配置以上的 Output Path如下 ../css/$FileNameWithoutExtension$.css 这也是一种比较常用的配置方法。 如果目录结构简单，可以采取以上方式。</p>
      </p>
    </div>
  </div>
  <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-user"></i>
      </span>
      <span class="post-meta-item-text">作者</span>
      <span><a href="/authors/崔庆才" class="author" itemprop="url" rel="index">崔庆才</a></span>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      <time title="创建时间：2016-02-25 14:16:39" itemprop="dateCreated datePublished" datetime="2016-02-25T14:16:39+08:00">2016-02-25</time>
    </span>
    <span id="/2491.html" class="post-meta-item leancloud_visitors" data-flag-title="PhpStorm使用File Watchers自动编译less" title="阅读次数">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span class="leancloud-visitors-count"></span>
    </span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>949</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>1 分钟</span>
    </span>
  </div>
</article>

    <article itemscope itemtype="http://schema.org/Article" class="post-block index" lang="zh-CN">
  <link itemprop="mainEntityOfPage" href="https://cuiqingcai.com/2469.html">
  <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="image" content="/images/avatar.png">
    <meta itemprop="name" content="崔庆才">
    <meta itemprop="description" content="崔庆才的个人站点，记录生活的瞬间，分享学习的心得。">
  </span>
  <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="静觅">
  </span>
  <header class="post-header">
    <h2 class="post-title" itemprop="name headline">
      <a class="label"> JavaScript <i class="label-arrow"></i>
      </a>
      <a href="/2469.html" class="post-title-link" itemprop="url">JavaScript与jQuery基本用法总结</a>
    </h2>
  </header>
  <div class="post-body" itemprop="articleBody">
    <div class="thumb">
      <img itemprop="contentUrl" class="random">
    </div>
    <div class="excerpt">
      <p>
      <h2 id="JavaScript"><a href="#JavaScript" class="headerlink" title="JavaScript"></a>JavaScript</h2>
      <ol>
        <li><a href="http://cuiqingcai.com/1253.html">JavaScript高级用法一之事件响应与网页交互</a> 2. <a href="http://cuiqingcai.com/1257.html">JavaScript高级用法二之内置对象</a> 3. <a href="http://cuiqingcai.com/1263.html">JavaScript高级用法三之浏览器对象</a> 4. <a href="http://cuiqingcai.com/1278.html">JavaScript高级用法四之DOM对象</a> 5. <a href="http://cuiqingcai.com/1444.html">JavaScript高级用法五之常用对象</a></li>
      </ol>
      <h2 id="jQuery"><a href="#jQuery" class="headerlink" title="jQuery"></a>jQuery</h2>
      <ol>
        <li><a href="http://cuiqingcai.com/1544.html">jQuery应用一之验证插件validate的使用</a> 2. <a href="http://cuiqingcai.com/1573.html">jQuery应用二之邮箱下拉列表自动补全</a> 3. <a href="http://cuiqingcai.com/1585.html">jQuery应用三之图片浏览插件LightBox</a> 4. <a href="http://cuiqingcai.com/1592.html">jQuery应用四之图片局部放大插件jQZoom</a> 5. <a href="http://cuiqingcai.com/1680.html">jQuery应用五之瀑布流效果的实现</a></li>
      </ol>
      </p>
    </div>
  </div>
  <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-user"></i>
      </span>
      <span class="post-meta-item-text">作者</span>
      <span><a href="/authors/崔庆才" class="author" itemprop="url" rel="index">崔庆才</a></span>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      <time title="创建时间：2016-02-11 21:50:19" itemprop="dateCreated datePublished" datetime="2016-02-11T21:50:19+08:00">2016-02-11</time>
    </span>
    <span id="/2469.html" class="post-meta-item leancloud_visitors" data-flag-title="JavaScript与jQuery基本用法总结" title="阅读次数">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span class="leancloud-visitors-count"></span>
    </span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>250</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>1 分钟</span>
    </span>
  </div>
</article>

    <article itemscope itemtype="http://schema.org/Article" class="post-block index" lang="zh-CN">
  <link itemprop="mainEntityOfPage" href="https://cuiqingcai.com/2467.html">
  <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="image" content="/images/avatar.png">
    <meta itemprop="name" content="崔庆才">
    <meta itemprop="description" content="崔庆才的个人站点，记录生活的瞬间，分享学习的心得。">
  </span>
  <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="静觅">
  </span>
  <header class="post-header">
    <h2 class="post-title" itemprop="name headline">
      <a class="label"> C/C++ <i class="label-arrow"></i>
      </a>
      <a href="/2467.html" class="post-title-link" itemprop="url">OpenGL绘图学习总结</a>
    </h2>
  </header>
  <div class="post-body" itemprop="articleBody">
    <div class="thumb">
      <img itemprop="contentUrl" class="random">
    </div>
    <div class="excerpt">
      <p>
      <h2 id="目录索引"><a href="#目录索引" class="headerlink" title="目录索引"></a>目录索引</h2>
      <ol>
        <li><a href="http://cuiqingcai.com/1597.html">OpenGL绘图实例一之机器人的绘制</a> 2. <a href="http://cuiqingcai.com/1613.html">OpenGL绘图实例二之直线和圆弧的绘制</a> 3. O<a href="http://cuiqingcai.com/1640.html">penGL绘图实例三之种子填充算法</a> 4. <a href="http://cuiqingcai.com/1649.html">OpenGL绘图实例四之区域颜色填充</a> 5. <a href="http://cuiqingcai.com/1658.html">OpenGL绘图实例五之平移缩放旋转</a> 6. <a href="http://cuiqingcai.com/1776.html">OpenGL绘图实例六之鼠标监听事件</a> 7. <a href="http://cuiqingcai.com/1783.html">OpenGL绘图实例七之鼠标设色取点绘图</a> 7. <a href="http://cuiqingcai.com/1802.html">OpenGL绘图实例八之图形的移动删除存盘</a> 9. <a href="http://cuiqingcai.com/1860.html">OpenGL绘图实例九之3D绘图基础</a> 10. <a href="http://cuiqingcai.com/1867.html">OpenGL绘图实例十之绘制3D机器人</a></li>
      </ol>
      </p>
    </div>
  </div>
  <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-user"></i>
      </span>
      <span class="post-meta-item-text">作者</span>
      <span><a href="/authors/崔庆才" class="author" itemprop="url" rel="index">崔庆才</a></span>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      <time title="创建时间：2016-02-11 21:42:24" itemprop="dateCreated datePublished" datetime="2016-02-11T21:42:24+08:00">2016-02-11</time>
    </span>
    <span id="/2467.html" class="post-meta-item leancloud_visitors" data-flag-title="OpenGL绘图学习总结" title="阅读次数">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span class="leancloud-visitors-count"></span>
    </span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>211</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>1 分钟</span>
    </span>
  </div>
</article>

    <article itemscope itemtype="http://schema.org/Article" class="post-block index" lang="zh-CN">
  <link itemprop="mainEntityOfPage" href="https://cuiqingcai.com/2465.html">
  <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="image" content="/images/avatar.png">
    <meta itemprop="name" content="崔庆才">
    <meta itemprop="description" content="崔庆才的个人站点，记录生活的瞬间，分享学习的心得。">
  </span>
  <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="静觅">
  </span>
  <header class="post-header">
    <h2 class="post-title" itemprop="name headline">
      <a class="label"> C/C++ <i class="label-arrow"></i>
      </a>
      <a href="/2465.html" class="post-title-link" itemprop="url">Winpcap网络编程学习探究</a>
    </h2>
  </header>
  <div class="post-body" itemprop="articleBody">
    <div class="thumb">
      <img itemprop="contentUrl" class="random">
    </div>
    <div class="excerpt">
      <p>
      <h2 id="目录索引"><a href="#目录索引" class="headerlink" title="目录索引"></a>目录索引</h2>
      <p>1. <a href="http://cuiqingcai.com/1890.html">Winpcap网络编程一之前言，实验要求，实验目标</a> 2. <a href="http://cuiqingcai.com/1898.html">Winpcap网络编程二之环境配置，Eclipse配置C/C++环境</a> 3. <a href="http://cuiqingcai.com/1906.html">Winpcap网络编程三之环境配置，Eclipse配置Winpcap环境</a> 4. <a href="http://cuiqingcai.com/1913.html">Winpcap网络编程四之环境配置，VS配置Winpcap环境</a> 5. <a href="http://cuiqingcai.com/1918.html">Winpcap网络编程五之ARP协议获得MAC表及主机通信</a> 6. <a href="http://cuiqingcai.com/1922.html">Winpcap网络编程六之两台主机通过中间主机通信</a></p>
      </p>
    </div>
  </div>
  <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-user"></i>
      </span>
      <span class="post-meta-item-text">作者</span>
      <span><a href="/authors/崔庆才" class="author" itemprop="url" rel="index">崔庆才</a></span>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      <time title="创建时间：2016-02-11 21:27:53" itemprop="dateCreated datePublished" datetime="2016-02-11T21:27:53+08:00">2016-02-11</time>
    </span>
    <span id="/2465.html" class="post-meta-item leancloud_visitors" data-flag-title="Winpcap网络编程学习探究" title="阅读次数">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span class="leancloud-visitors-count"></span>
    </span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>196</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>1 分钟</span>
    </span>
  </div>
</article>

    <article itemscope itemtype="http://schema.org/Article" class="post-block index" lang="zh-CN">
  <link itemprop="mainEntityOfPage" href="https://cuiqingcai.com/2443.html">
  <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="image" content="/images/avatar.png">
    <meta itemprop="name" content="崔庆才">
    <meta itemprop="description" content="崔庆才的个人站点，记录生活的瞬间，分享学习的心得。">
  </span>
  <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="静觅">
  </span>
  <header class="post-header">
    <h2 class="post-title" itemprop="name headline">
      <a class="label"> Python <i class="label-arrow"></i>
      </a>
      <a href="/2443.html" class="post-title-link" itemprop="url">Python爬虫进阶二之PySpider框架安装配置</a>
    </h2>
  </header>
  <div class="post-body" itemprop="articleBody">
    <div class="thumb">
      <img itemprop="contentUrl" class="random">
    </div>
    <div class="excerpt">
      <p>
      <h2 id="关于"><a href="#关于" class="headerlink" title="关于"></a>关于</h2>
      <p>首先，在此附上项目的地址，以及官方文档 <a href="https://github.com/binux/pyspider" target="_blank" rel="noopener">PySpider</a> <a href="http://docs.pyspider.org/en/latest/" target="_blank" rel="noopener">官方文档</a></p>
      <h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2>
      <h3 id="1-pip"><a href="#1-pip" class="headerlink" title="1. pip"></a>1. pip</h3>
      <p>首先确保你已经安装了pip，若没有安装，请参照 <a href="http://pip-cn.readthedocs.org/en/latest/installing.html" target="_blank" rel="noopener">pip安装</a></p>
      <h3 id="2-phantomjs"><a href="#2-phantomjs" class="headerlink" title="2. phantomjs"></a>2. phantomjs</h3>
      <p>PhantomJS 是一个基于 WebKit 的服务器端 JavaScript API。它全面支持web而不需浏览器支持，其快速、原生支持各种Web标准：DOM 处理、CSS 选择器、JSON、Canvas 和 SVG。 PhantomJS 可以用于页面自动化、网络监测、网页截屏以及无界面测试等。 <a href="http://phantomjs.org/download.html" target="_blank" rel="noopener">安装</a> 以上附有官方安装方式，如果你是 Ubuntu 或 Mac OS X用户，可以直接用命令来安装 Ubuntu:</p>
      <figure class="highlight routeros">
        <table>
          <tr>
            <td class="gutter">
              <pre><span class="line">1</span><br></pre>
            </td>
            <td class="code">
              <pre><span class="line">sudo apt-<span class="builtin-name">get</span> install phantomjs</span><br></pre>
            </td>
          </tr>
        </table>
      </figure>
      <p>Mac OS X:</p>
      <figure class="highlight mipsasm">
        <table>
          <tr>
            <td class="gutter">
              <pre><span class="line">1</span><br></pre>
            </td>
            <td class="code">
              <pre><span class="line"><span class="keyword">brew </span><span class="keyword">install </span>phantomjs</span><br></pre>
            </td>
          </tr>
        </table>
      </figure>
      <h3 id="3-pyspider"><a href="#3-pyspider" class="headerlink" title="3. pyspider"></a>3. pyspider</h3>
      <p>直接利用 pip 安装即可</p>
      <figure class="highlight cmake">
        <table>
          <tr>
            <td class="gutter">
              <pre><span class="line">1</span><br></pre>
            </td>
            <td class="code">
              <pre><span class="line">pip <span class="keyword">install</span> pyspider</span><br></pre>
            </td>
          </tr>
        </table>
      </figure>
      <p>如果你是 Ubuntu 用户，请提前安装好以下支持类库</p>
      <figure class="highlight vim">
        <table>
          <tr>
            <td class="gutter">
              <pre><span class="line">1</span><br></pre>
            </td>
            <td class="code">
              <pre><span class="line">sudo apt-<span class="built_in">get</span> install <span class="keyword">python</span> <span class="keyword">python</span>-dev <span class="keyword">python</span>-distribute <span class="keyword">python</span>-pip libcurl4-openssl-dev libxml2-dev libxslt1-dev <span class="keyword">python</span>-lxml</span><br></pre>
            </td>
          </tr>
        </table>
      </figure>
      <p>测试 如果安装过程没有提示任何错误，那就证明一些OK。 命令行输入</p>
      <figure class="highlight ada">
        <table>
          <tr>
            <td class="gutter">
              <pre><span class="line">1</span><br></pre>
            </td>
            <td class="code">
              <pre><span class="line">pyspider <span class="keyword">all</span></span><br></pre>
            </td>
          </tr>
        </table>
      </figure>
      <p>然后浏览器访问 <a href="http://localhost:5000" target="_blank" rel="noopener">http://localhost:5000</a> 观察一下效果，如果可以正常出现 PySpider 的页面，那证明一切OK 在此附图一张，这是我写了几个爬虫之后的界面。 <a href="http://qiniu.cuiqingcai.com/wp-content/uploads/2016/02/2016-02-11-20.55.36.png" target="_blank" rel="noopener"><img src="http://qiniu.cuiqingcai.com/wp-content/uploads/2016/02/2016-02-11-20.55.36-1024x355.png" alt="2016-02-11 20.55.36"></a> 好，接下来我会进一步介绍这个框架的使用。</p>
      <h2 id="常见错误"><a href="#常见错误" class="headerlink" title="常见错误"></a>常见错误</h2>
      <p>我曾遇到过的一个错误： <a href="http://cuiqingcai.com/2703.html">PySpider HTTP 599: SSL certificate problem错误的解决方法</a> ，后来在作者那发了issue得到了答案，其他的暂时没什么问题。 不过发现有的小伙伴提了各种各样的问题啊，不过我确实都没遇到过，我再Win10，Linux Ubuntu，Linux CentOS，Mac OS X都成功运行。不过确实有些奇怪的问题，跑着跑着崩了，一点就崩了我也就比较纳闷了。 如果大家有问题，可以看看作者项目里面有没有类似的issue，另外也推荐大家直接到作者的GitHub上发issue。 毕竟，这个框架不是我写的。 在此附上Issue地址： <a href="https://github.com/binux/pyspider/issues" target="_blank" rel="noopener">PySpider Issue</a></p>
      </p>
    </div>
  </div>
  <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-user"></i>
      </span>
      <span class="post-meta-item-text">作者</span>
      <span><a href="/authors/崔庆才" class="author" itemprop="url" rel="index">崔庆才</a></span>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      <time title="创建时间：2016-02-11 21:00:04" itemprop="dateCreated datePublished" datetime="2016-02-11T21:00:04+08:00">2016-02-11</time>
    </span>
    <span id="/2443.html" class="post-meta-item leancloud_visitors" data-flag-title="Python爬虫进阶二之PySpider框架安装配置" title="阅读次数">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span class="leancloud-visitors-count"></span>
    </span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>944</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>1 分钟</span>
    </span>
  </div>
</article>

    <article itemscope itemtype="http://schema.org/Article" class="post-block index" lang="zh-CN">
  <link itemprop="mainEntityOfPage" href="https://cuiqingcai.com/2433.html">
  <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="image" content="/images/avatar.png">
    <meta itemprop="name" content="崔庆才">
    <meta itemprop="description" content="崔庆才的个人站点，记录生活的瞬间，分享学习的心得。">
  </span>
  <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="静觅">
  </span>
  <header class="post-header">
    <h2 class="post-title" itemprop="name headline">
      <a class="label"> Python <i class="label-arrow"></i>
      </a>
      <a href="/2433.html" class="post-title-link" itemprop="url">Python爬虫进阶一之爬虫框架概述</a>
    </h2>
  </header>
  <div class="post-body" itemprop="articleBody">
    <div class="thumb">
      <img itemprop="contentUrl" class="random">
    </div>
    <div class="excerpt">
      <p>
      <h2 id="综述"><a href="#综述" class="headerlink" title="综述"></a>综述</h2>
      <p>爬虫入门之后，我们有两条路可以走。 一个是继续深入学习，以及关于设计模式的一些知识，强化Python相关知识，自己动手造轮子，继续为自己的爬虫增加分布式，多线程等功能扩展。另一条路便是学习一些优秀的框架，先把这些框架用熟，可以确保能够应付一些基本的爬虫任务，也就是所谓的解决温饱问题，然后再深入学习它的源码等知识，进一步强化。 就个人而言，前一种方法其实就是自己动手造轮子，前人其实已经有了一些比较好的框架，可以直接拿来用，但是为了自己能够研究得更加深入和对爬虫有更全面的了解，自己动手去多做。后一种方法就是直接拿来前人已经写好的比较优秀的框架，拿来用好，首先确保可以完成你想要完成的任务，然后自己再深入研究学习。第一种而言，自己探索的多，对爬虫的知识掌握会比较透彻。第二种，拿别人的来用，自己方便了，可是可能就会没有了深入研究框架的心情，还有可能思路被束缚。 不过个人而言，我自己偏向后者。造轮子是不错，但是就算你造轮子，你这不也是在基础类库上造轮子么？能拿来用的就拿来用，学了框架的作用是确保自己可以满足一些爬虫需求，这是最基本的温饱问题。倘若你一直在造轮子，到最后都没造出什么来，别人找你写个爬虫研究了这么长时间了都写不出来，岂不是有点得不偿失？所以，进阶爬虫我还是建议学习一下框架，作为自己的几把武器。至少，我们可以做到了，就像你拿了把枪上战场了，至少，你是可以打击敌人的，比你一直在磨刀好的多吧？</p>
      <h2 id="框架概述"><a href="#框架概述" class="headerlink" title="框架概述"></a>框架概述</h2>
      <p>博主接触了几个爬虫框架，其中比较好用的是 Scrapy 和PySpider。就个人而言，pyspider上手更简单，操作更加简便，因为它增加了 WEB 界面，写爬虫迅速，集成了phantomjs，可以用来抓取js渲染的页面。Scrapy自定义程度高，比 PySpider更底层一些，适合学习研究，需要学习的相关知识多，不过自己拿来研究分布式和多线程等等是非常合适的。 在这里博主会一一把自己的学习经验写出来与大家分享，希望大家可以喜欢，也希望可以给大家一些帮助。</p>
      <h2 id="PySpider"><a href="#PySpider" class="headerlink" title="PySpider"></a>PySpider</h2>
      <p><a href="https://github.com/binux/pyspider" target="_blank" rel="noopener">PySpider</a>是<a href="https://github.com/binux" target="_blank" rel="noopener">binux</a>做的一个爬虫架构的开源化实现。主要的功能需求是：</p>
      <ul>
        <li>抓取、更新调度多站点的特定的页面</li>
        <li>需要对页面进行结构化信息提取</li>
        <li>灵活可扩展，稳定可监控</li>
      </ul>
      <p>而这也是绝大多数python爬虫的需求 —— 定向抓取，结构化化解析。但是面对结构迥异的各种网站，单一的抓取模式并不一定能满足，灵活的抓取控制是必须的。为了达到这个目的，单纯的配置文件往往不够灵活，于是，通过脚本去控制抓取是最后的选择。 而去重调度，队列，抓取，异常处理，监控等功能作为框架，提供给抓取脚本，并保证灵活性。最后加上web的编辑调试环境，以及web任务监控，即成为了这套框架。 pyspider的设计基础是：<strong>以python脚本驱动的抓取环模型爬虫</strong></p>
      <ul>
        <li>通过python脚本进行结构化信息的提取，follow链接调度抓取控制，实现最大的灵活性</li>
        <li>通过web化的脚本编写、调试环境。web展现调度状态</li>
        <li>抓取环模型成熟稳定，模块间相互独立，通过消息队列连接，从单进程到多机分布式灵活拓展</li>
      </ul>
      <p><img src="http://blog.binux.me/assets/image/pyspider-arch.png" alt="pyspider-arch"></p>
      <p>pyspider的架构主要分为 scheduler（调度器）, fetcher（抓取器）, processor（脚本执行）：</p>
      <ul>
        <li>各个组件间使用消息队列连接，除了scheduler是单点的，fetcher 和 processor 都是可以多实例分布式部署的。 scheduler 负责整体的调度控制</li>
        <li>任务由 scheduler 发起调度，fetcher 抓取网页内容， processor 执行预先编写的python脚本，输出结果或产生新的提链任务（发往 scheduler），形成闭环。</li>
        <li>每个脚本可以灵活使用各种python库对页面进行解析，使用框架API控制下一步抓取动作，通过设置回调控制解析动作。</li>
      </ul>
      <h2 id="Scrapy"><a href="#Scrapy" class="headerlink" title="Scrapy"></a>Scrapy</h2>
      <blockquote>
        <p>Scrapy是一个为了爬取网站数据，提取结构性数据而编写的应用框架。 可以应用在包括数据挖掘，信息处理或存储历史数据等一系列的程序中。 其最初是为了页面抓取 (更确切来说, 网络抓取 )所设计的， 也可以应用在获取API所返回的数据(例如 Amazon Associates Web Services ) 或者通用的网络爬虫。Scrapy用途广泛，可以用于数据挖掘、监测和自动化测试</p>
      </blockquote>
      <p>Scrapy 使用了 Twisted 异步网络库来处理网络通讯。整体架构大致如下</p>
      <p><img src="http://newtonblogimg.qiniudn.com/Scrapy%20Architecture.png" alt="Scrapy"></p>
      <p>Scrapy主要包括了以下组件：</p>
      <ul>
        <li>引擎(Scrapy): 用来处理整个系统的数据流处理, 触发事务(框架核心)</li>
        <li>调度器(Scheduler): 用来接受引擎发过来的请求, 压入队列中, 并在引擎再次请求的时候返回. 可以想像成一个URL（抓取网页的网址或者说是链接）的优先队列, 由它来决定下一个要抓取的网址是什么, 同时去除重复的网址</li>
        <li>下载器(Downloader): 用于下载网页内容, 并将网页内容返回给蜘蛛(Scrapy下载器是建立在twisted这个高效的异步模型上的)</li>
        <li>爬虫(Spiders): 爬虫是主要干活的, 用于从特定的网页中提取自己需要的信息, 即所谓的实体(Item)。用户也可以从中提取出链接,让Scrapy继续抓取下一个页面</li>
        <li>项目管道(Pipeline): 负责处理爬虫从网页中抽取的实体，主要的功能是持久化实体、验证实体的有效性、清除不需要的信息。当页面被爬虫解析后，将被发送到项目管道，并经过几个特定的次序处理数据。</li>
        <li>下载器中间件(Downloader Middlewares): 位于Scrapy引擎和下载器之间的框架，主要是处理Scrapy引擎与下载器之间的请求及响应。</li>
        <li>爬虫中间件(Spider Middlewares): 介于Scrapy引擎和爬虫之间的框架，主要工作是处理蜘蛛的响应输入和请求输出。</li>
        <li>调度中间件(Scheduler Middewares): 介于Scrapy引擎和调度之间的中间件，从Scrapy引擎发送到调度的请求和响应。</li>
      </ul>
      <p>Scrapy运行流程大概如下：</p>
      <ul>
        <li>首先，引擎从调度器中取出一个链接(URL)用于接下来的抓取</li>
        <li>引擎把URL封装成一个请求(Request)传给下载器，下载器把资源下载下来，并封装成应答包(Response)</li>
        <li>然后，爬虫解析Response</li>
        <li>若是解析出实体（Item）,则交给实体管道进行进一步的处理。</li>
        <li>若是解析出的是链接（URL）,则把URL交给Scheduler等待抓取</li>
      </ul>
      <h2 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h2>
      <p>对这两个框架进行基本的介绍之后，接下来我会介绍这两个框架的安装以及框架的使用方法，希望对大家有帮助。</p>
      </p>
    </div>
  </div>
  <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-user"></i>
      </span>
      <span class="post-meta-item-text">作者</span>
      <span><a href="/authors/崔庆才" class="author" itemprop="url" rel="index">崔庆才</a></span>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      <time title="创建时间：2016-02-11 20:29:29" itemprop="dateCreated datePublished" datetime="2016-02-11T20:29:29+08:00">2016-02-11</time>
    </span>
    <span id="/2433.html" class="post-meta-item leancloud_visitors" data-flag-title="Python爬虫进阶一之爬虫框架概述" title="阅读次数">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span class="leancloud-visitors-count"></span>
    </span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>2.6k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>2 分钟</span>
    </span>
  </div>
</article>

    <article itemscope itemtype="http://schema.org/Article" class="post-block index" lang="zh-CN">
  <link itemprop="mainEntityOfPage" href="https://cuiqingcai.com/2416.html">
  <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="image" content="/images/avatar.png">
    <meta itemprop="name" content="崔庆才">
    <meta itemprop="description" content="崔庆才的个人站点，记录生活的瞬间，分享学习的心得。">
  </span>
  <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="静觅">
  </span>
  <header class="post-header">
    <h2 class="post-title" itemprop="name headline">
      <a class="label"> 个人随笔 <i class="label-arrow"></i>
      </a>
      <a href="/2416.html" class="post-title-link" itemprop="url">弃用多说，改用畅言</a>
    </h2>
  </header>
  <div class="post-body" itemprop="articleBody">
    <div class="thumb">
      <img itemprop="contentUrl" class="random">
    </div>
    <div class="excerpt">
      <p>
      <p>最近博客的多说评论总是抽风，先来吐槽一下。 刚在整理评论的时候吓我一跳，之前我的好多评论都没了，是的，是只有我自己的评论没有了，而其它人的评论还有。摸不着头脑的我打开多说后台管理，哦天，我之前所有的评论和回复全部自动转为垃圾评论了，八百多条啊，废了一会功夫好不容易批量还原了。结果刷新页面一看，咦，还是没有，重新刷一下后台，竟然再次把我的评论设成垃圾评论了，后来又退出重新绑定了其它平台的账号，总算还原回来了。 然后我就继续开始回复大家的评论呀，结果要发布评论的时候，点一下发布，按钮就卡在正在发布这里不动了。打开浏览器看一下 Ajax 出了什么问题，结果出现了一个 create_json 报了个500服务器错误，查看页面信息显示参数配置不正确还是怎么了，没错，是显示我的站点多说评论配置不正确。那，其它人怎么评论上来的？ 另外，之前，多说崩溃了已经不知道多少次了。 真是不爽的多说。 另外，多说还有一个非常令人发指的行为，会自动同步用户文章，收集用户信息，同步我们社交账号，即使是修改用户信息也要进行备份，这尼玛发展一定程度，多说还真有可能有利用这些用户信息谋利，甚至可能利用各个用户的文章做一个个性化阅读推荐也说不定。当然最开始的时候我只是觉得多说比较火，当时用上了也感觉比较方便，加上最初网站没几个东西，心想同步就同步呗，然后就一直用着了。现在再想想，也是可怕。 果断！弃用！弃用！弃用！ 搜索了网上比较热门的评论插件，发现了畅言。使用了 WordPress 插件。 于是用上了，不过还是有一些令我感到不是太友好的地方，简单在此提一下。 嗯，首先我是比较追求美感的，界面问题。首先我会关注有没有个性化主题定制这个功能，畅言还是有的，支持CSS自定义。不过这个功能比较蛋疼，如果你不选择已经提供的主题，而是选择自定义CSS样式的话，你需要把所有样式重写一遍，它缺省继承了默认主题。比如我如果想在浅色主题红色风格基础上修改几个样式的话，这是办不到的，除非重写所有的红色风格样式，这就鸡肋了。建议可以选择继承某个默认主题的功能，然后自定义的CSS是在这个基础上设置的功能。而且我看WAP版本并没有自定义CSS，非常建议增加这个功能。最后我还是选择了红色主题，不过自定义样式就写在了站点全局样式表里面了，以此解决。 其次，同步本地评论功能，由于换了插件，所以评论都留在了本地了。同步完成之后，我并不能在畅言后台管理看到我刚才同步的评论，但是新发的评论是可以看到的，页面也是可以正常显示的。只是不能在线管理早先的原始评论了。 另外，头像问题，其实我个人非常不能忍受一个账号没有头像的行为，简直是大逆不道。畅言有个QQ快速登录的功能，然而，登录之后竟然不能获取我的QQ头像！不知道是不是我这边的问题，如果大家正常希望可以反馈我一下。另外，QQ登录之后怎么会给我取了一个奇怪的用户名，叫什么cmcccc，有点醉。而微博的快速登录的昵称和头像都是正常的，然而每次评论的时候都会默认勾选那个同步到微博的按钮，这个可以默认取消么？ 还有，希望可以增加更多的平台的支持，比如微信、GitHub、脸书、推特等平台啦。 最后，有没有发表文章自动分享到各个平台的功能？我暂时没有发现。这点多说还是做得比较好的。 以上。 嗯，总之换上畅言之后用起来还是比较开心的，嘿嘿主要是改好了样式，看起来一阵舒爽。 昂，没错，我就是颜控！ 有时候，我会因为一个样式不合我意而执着地去修改，即使要花费几个小时。 有时候，我会因为一个应用的图标（没错，就是说的图标）太丑了而卸载掉，即使是它的功能再怎么好。 有时候，我会因为一个屏幕膜有一点点损伤而去重新买一个新的。额，其实是因为今天给电脑贴膜折角了，我又花了几十块重新买了一个新的。 有时候，我就是一个强迫症，在写上面三句话的时候，第一句原本是在第二行的，然而因为看起来长度参差不齐我就把它移动到了最上面。嗯，这第四句话要写得更长才行。 好啦，貌似跑题了，时候不早啦，大家晚安。 嗯，换上调教好的美美的畅言还是很开心的，文章前后呼应，拜～ <a href="http://qiniu.cuiqingcai.com/wp-content/uploads/2016/02/屏幕快照-2016-02-03-03.43.51.png" target="_blank" rel="noopener"><img src="http://qiniu.cuiqingcai.com/wp-content/uploads/2016/02/屏幕快照-2016-02-03-03.43.51-1024x622.png" alt="屏幕快照 2016-02-03 03.43.51"></a> 美美哒～</p>
      </p>
    </div>
  </div>
  <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-user"></i>
      </span>
      <span class="post-meta-item-text">作者</span>
      <span><a href="/authors/崔庆才" class="author" itemprop="url" rel="index">崔庆才</a></span>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      <time title="创建时间：2016-02-03 03:36:48" itemprop="dateCreated datePublished" datetime="2016-02-03T03:36:48+08:00">2016-02-03</time>
    </span>
    <span id="/2416.html" class="post-meta-item leancloud_visitors" data-flag-title="弃用多说，改用畅言" title="阅读次数">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span class="leancloud-visitors-count"></span>
    </span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>1.7k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>2 分钟</span>
    </span>
  </div>
</article>

    <article itemscope itemtype="http://schema.org/Article" class="post-block index" lang="zh-CN">
  <link itemprop="mainEntityOfPage" href="https://cuiqingcai.com/2401.html">
  <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="image" content="/images/avatar.png">
    <meta itemprop="name" content="崔庆才">
    <meta itemprop="description" content="崔庆才的个人站点，记录生活的瞬间，分享学习的心得。">
  </span>
  <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="静觅">
  </span>
  <header class="post-header">
    <h2 class="post-title" itemprop="name headline">
      <a class="label"> 个人日记 <i class="label-arrow"></i>
      </a>
      <a href="/2401.html" class="post-title-link" itemprop="url">强势回归博客，顺便祝大家小年快乐</a>
    </h2>
  </header>
  <div class="post-body" itemprop="articleBody">
    <div class="thumb">
      <img itemprop="contentUrl" class="random">
    </div>
    <div class="excerpt">
      <p>
      <p>Hello，时隔一个多月，终于再次回到博客啦，首先跟大家说声抱歉，许多评论没有及时回复感到非常抱歉，希望我现在给大家的回复为时不晚。 距离上次在博客上写日记过去了几个月了吧。那时的我刚刚结束大学三年级。而现在，大四上半学期已经过半啦。这半年的时间可以说忙也可以说不忙。不忙是说这半年以来的课程比较轻松，只有四门选修课，学业负担比较轻。忙是说半年以来各种错综复杂的事情，许多事情需要好好安排一下时间才可以好好把握各个“进程”的合理分配。 那么就从我上次日记开始总结一下吧。 当时更新是去年七月十二日，刚大三放假不久。那个暑假前期过得可谓是心惊胆战呀，当时为了保研北京航空航天大学一直在紧张地复习准备。包括复习备考三年的专业课，还有准备C语言的上机考试。七月二十八二十九那两天机考和面试，不负众望，我顺利拿到了北京航空航天大学计算机科学与技术学院的Offer，心里的石头也落了地，当时看到通过面试的消息时真的激动得说不出口，这也算是我人生中为数不多的重大十字路口做出的一个选择吧。 面试结束之后，我便留在了导师那边做项目，一些大数据处理和爬虫的项目。不过当时的项目个人感觉比较简单，所以就在整个八月份找了一份实习，PHP研发工程师的岗位，之前准备保研也一直没有找工作，这也算是我找的第一份工作吧，不求赚神马，只求充实一下我的假期，也学习一些新的东西。 在这里顺便安利一下，公司名称是佳信德润，主打品牌是<a href="http://www.lingxi360.com/index.php" target="_blank" rel="noopener">灵析</a>，北京三环。在那边工作真的感觉特别舒心，虽然是创业公司，但是CEO玛丽老板（女哦）还有负责技术的柱子哥真的超级热情，为人特别好，谈吐之间就有一种亲切的感觉，那边的小伙伴十几个，相处地也十分融洽。在那边工作你不会有一种被忽视和指使的感觉，你可以随意向老板们发表自己的看法，甚至你可以与他们探讨代码问题，甚至公司某处的装饰啦，哪里的餐馆不错啦等等。有次我眼睛发炎，玛丽老板和柱子哥还特别关心我，亲自送到我医院，在这里再次说声谢谢，不知道你们是不是可以看到。我还记得小伙伴们一起拍公司写真，真的超赞。当然最主要的还是一起商讨项目进度，代码问题，接触到我之前没有接触过的新知识。在这里你可以负责许多事情，最大限度地发挥你的光和热。不是我打广告，如果有小伙伴们有意向做PHP，非常推荐你们过去，可以去他们<a href="http://www.lingxi360.com/index.php" target="_blank" rel="noopener">官网</a>发应聘哦。相信我，不会坑你的。 实习时间真的过得很快，转眼一个月过去了，九月份来了，大四开学啦。 因为需要开学以后办一些保研的相关手续，另外重要的事当然是陪妹纸啦嘿嘿，你懂得。 开学之后就开始忙一些项目了。大四的课程不紧，趁着这大四的时光，多学点东西，以后这样的日子真不多了，好好珍惜。 所以大四上学期的基调是，专注陪妹子，业余撸代码，顺便做做外包。请叫我全职男朋友，兼职程序猿。 这半年以来做的项目不算多。首先，学习了Laravel框架，嗯，保证你学完之后就不想用其他的框架了。最开始是帮我的叔叔做一个拍电影的网站，规模还比较大，一直在完善中。另外在暑假实习的过程中发现了公司自己写了一款CMS框架，自己觉得还有许多功能可以添加，一些架构可以继续完善，所以决定自己写一个CMS，不仅算是练手，也算是造轮子吧。毕竟你写好了就是你自己的，用起来都是那么自然，假如来了个外包神马的，轻松应对分分钟的事，神马深度定制都是浮云。当然还有帮爸爸妈妈写的一个微信平台，在微信订餐售卖东西，嗯，这叫做自己动手实现O2O。另外就是一些零零散散的小外包，没事可以赚点外快养活一下自己。 最近刚刚入手了自己人生中的第一台MAC，当然还是要感谢父亲大人的支持，自己的手头还是比较紧的，你懂得。 嗯摒弃Windows，感觉撸代码的快感不止提升了几管气，也希望它可以陪我度过接下来许多年的学习时光。在这里也安利一下一个小店，微博上的<a href="http://weibo.com/u/2067562447?is_hot=1" target="_blank" rel="noopener">小闷小闷</a>，水果从她这里买，价格真的是十分公道啊，正品无误了，入手十几天了，感觉逼格提升了，心情也舒畅了，多年的Windows卡顿症也治好了～ 嗯，接下来的时间，爸爸妈妈年前工作辛苦，接下来几天我要去帮他们分担一下工作啦。 最后，恭祝大家小年快乐，工作顺心，别跟钱过不去，开心最重要～ 欢欢喜喜过大年啦～</p>
      </p>
    </div>
  </div>
  <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-user"></i>
      </span>
      <span class="post-meta-item-text">作者</span>
      <span><a href="/authors/崔庆才" class="author" itemprop="url" rel="index">崔庆才</a></span>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      <time title="创建时间：2016-02-01 20:20:53" itemprop="dateCreated datePublished" datetime="2016-02-01T20:20:53+08:00">2016-02-01</time>
    </span>
    <span id="/2401.html" class="post-meta-item leancloud_visitors" data-flag-title="强势回归博客，顺便祝大家小年快乐" title="阅读次数">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span class="leancloud-visitors-count"></span>
    </span>
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>1.7k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>2 分钟</span>
    </span>
  </div>
</article>



  <script>
  document.querySelectorAll('.random').forEach(item => item.src="https://picsum.photos/id/" + Math.floor(Math.random() * Math.floor(300)) + "/200/133")
  </script>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/18/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/18/">18</a><span class="page-number current">19</span><a class="page-number" href="/page/20/">20</a><span class="space">&hellip;</span><a class="page-number" href="/page/26/">26</a><a class="extend next" rel="next" href="/page/20/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
<div class="toggle sidebar-toggle">
  <span class="toggle-line toggle-line-first"></span>
  <span class="toggle-line toggle-line-middle"></span>
  <span class="toggle-line toggle-line-last"></span>
</div>

<aside class="sidebar">
  <div class="sidebar-inner">

    <ul class="sidebar-nav motion-element">
      <li class="sidebar-nav-toc">
        文章目录
      </li>
      <li class="sidebar-nav-overview">
        站点概览
      </li>
    </ul>

    <!--noindex-->
    <div class="post-toc-wrap sidebar-panel">
    </div>
    <!--/noindex-->

    <div class="site-overview-wrap sidebar-panel">
      <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <img class="site-author-image" itemprop="image" alt="崔庆才" src="/images/avatar.png">
  <p class="site-author-name" itemprop="name">崔庆才</p>
  <div class="site-description" itemprop="description">崔庆才的个人站点，记录生活的瞬间，分享学习的心得。</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
    <div class="site-state-item site-state-posts">
      <a href="/archives/">
        <span class="site-state-item-count">518</span>
        <span class="site-state-item-name">日志</span>
      </a>
    </div>
    <div class="site-state-item site-state-categories">
      <a href="/categories/">
        <span class="site-state-item-count">21</span>
        <span class="site-state-item-name">分类</span></a>
    </div>
    <div class="site-state-item site-state-tags">
      <a href="/tags/">
        <span class="site-state-item-count">121</span>
        <span class="site-state-item-name">标签</span></a>
    </div>
  </nav>
</div>
<div class="links-of-author motion-element">
  <span class="links-of-author-item">
    <a href="https://github.com/Germey" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;Germey" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
  </span>
  <span class="links-of-author-item">
    <a href="mailto:cqc@cuiqingcai.com.com" title="邮件 → mailto:cqc@cuiqingcai.com.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>邮件</a>
  </span>
  <span class="links-of-author-item">
    <a href="https://weibo.com/cuiqingcai" title="微博 → https:&#x2F;&#x2F;weibo.com&#x2F;cuiqingcai" rel="noopener" target="_blank"><i class="fab fa-weibo fa-fw"></i>微博</a>
  </span>
  <span class="links-of-author-item">
    <a href="https://www.zhihu.com/people/Germey" title="知乎 → https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;Germey" rel="noopener" target="_blank"><i class="fa fa-magic fa-fw"></i>知乎</a>
  </span>
</div>

    </div>
    <div
      style=" width: 100%;"
      class="sidebar-panel sidebar-panel-image sidebar-panel-active">
      <a href="https://www.abuyun.com/http-proxy/introduce.html" target="_blank" rel="noopener">
        <img src="https://qiniu.cuiqingcai.com/88au8.jpg"
             style=" width: 100%;">
      </a>
    </div>
    <div
      style=" width: 100%;"
      class="sidebar-panel sidebar-panel-image sidebar-panel-active">
      <a href="https://tutorial.lengyue.video/?coupon=12ef4b1a-a3db-11ea-bb37-0242ac130002_cqx_850" target="_blank" rel="noopener">
        <img src="https://qiniu.cuiqingcai.com/bco2a.png"
             style=" width: 100%;">
      </a>
    </div>
    <div
      style=" width: 100%;"
      class="sidebar-panel sidebar-panel-image sidebar-panel-active">
      <a href="https://luminati-china.io/?affiliate=ref_5fbbaaa9647883f5c6f77095" target="_blank" rel="noopener">
        <img src="https://qiniu.cuiqingcai.com/ikkq9.jpg"
             style=" width: 100%;">
      </a>
    </div>
    <div class="sidebar-panel sidebar-panel-tags sidebar-panel-active">
      <h4 class="name">
        标签云
      </h4>
      <div class="content">
        <a href="/tags/2048/" style="font-size: 10px;">2048</a> <a href="/tags/599/" style="font-size: 10px;">599</a> <a href="/tags/Bootstrap/" style="font-size: 11.25px;">Bootstrap</a> <a href="/tags/CDN/" style="font-size: 10px;">CDN</a> <a href="/tags/CQC/" style="font-size: 10px;">CQC</a> <a href="/tags/CSS/" style="font-size: 10px;">CSS</a> <a href="/tags/CSS-%E5%8F%8D%E7%88%AC%E8%99%AB/" style="font-size: 10px;">CSS 反爬虫</a> <a href="/tags/CV/" style="font-size: 10px;">CV</a> <a href="/tags/Django/" style="font-size: 10px;">Django</a> <a href="/tags/Eclipse/" style="font-size: 11.25px;">Eclipse</a> <a href="/tags/FTP/" style="font-size: 10px;">FTP</a> <a href="/tags/GitHub/" style="font-size: 11.25px;">GitHub</a> <a href="/tags/HTML5/" style="font-size: 10px;">HTML5</a> <a href="/tags/Hexo/" style="font-size: 10px;">Hexo</a> <a href="/tags/IT/" style="font-size: 10px;">IT</a> <a href="/tags/JSP/" style="font-size: 10px;">JSP</a> <a href="/tags/JavaScript/" style="font-size: 10px;">JavaScript</a> <a href="/tags/K8s/" style="font-size: 10px;">K8s</a> <a href="/tags/LOGO/" style="font-size: 10px;">LOGO</a> <a href="/tags/Linux/" style="font-size: 10px;">Linux</a> <a href="/tags/MIUI/" style="font-size: 10px;">MIUI</a> <a href="/tags/MongoDB/" style="font-size: 10px;">MongoDB</a> <a href="/tags/Mysql/" style="font-size: 10px;">Mysql</a> <a href="/tags/PHP/" style="font-size: 11.25px;">PHP</a> <a href="/tags/PS/" style="font-size: 10px;">PS</a> <a href="/tags/Pathlib/" style="font-size: 10px;">Pathlib</a> <a href="/tags/PhantomJS/" style="font-size: 10px;">PhantomJS</a> <a href="/tags/PySpider/" style="font-size: 10px;">PySpider</a> <a href="/tags/Python/" style="font-size: 16.25px;">Python</a> <a href="/tags/Python3/" style="font-size: 12.5px;">Python3</a> <a href="/tags/Pythonic/" style="font-size: 10px;">Pythonic</a> <a href="/tags/QQ/" style="font-size: 10px;">QQ</a> <a href="/tags/Redis/" style="font-size: 10px;">Redis</a> <a href="/tags/SAE/" style="font-size: 10px;">SAE</a> <a href="/tags/SSH/" style="font-size: 10px;">SSH</a> <a href="/tags/SVG/" style="font-size: 10px;">SVG</a> <a href="/tags/Scrapy/" style="font-size: 10px;">Scrapy</a> <a href="/tags/Scrapy-redis/" style="font-size: 10px;">Scrapy-redis</a> <a href="/tags/Scrapy%E5%88%86%E5%B8%83%E5%BC%8F/" style="font-size: 10px;">Scrapy分布式</a> <a href="/tags/Selenium/" style="font-size: 10px;">Selenium</a> <a href="/tags/TKE/" style="font-size: 10px;">TKE</a> <a href="/tags/Ubuntu/" style="font-size: 11.25px;">Ubuntu</a> <a href="/tags/Vue/" style="font-size: 11.25px;">Vue</a> <a href="/tags/Webpack/" style="font-size: 10px;">Webpack</a> <a href="/tags/Windows/" style="font-size: 10px;">Windows</a> <a href="/tags/Winpcap/" style="font-size: 10px;">Winpcap</a> <a href="/tags/WordPress/" style="font-size: 13.75px;">WordPress</a> <a href="/tags/object-Object/" style="font-size: 10px;">[object Object]</a> <a href="/tags/android/" style="font-size: 10px;">android</a> <a href="/tags/ansible/" style="font-size: 10px;">ansible</a> <a href="/tags/cocos2d-x/" style="font-size: 10px;">cocos2d-x</a> <a href="/tags/e6/" style="font-size: 10px;">e6</a> <a href="/tags/fitvids/" style="font-size: 10px;">fitvids</a> <a href="/tags/git/" style="font-size: 11.25px;">git</a> <a href="/tags/json/" style="font-size: 10px;">json</a> <a href="/tags/js%E9%80%86%E5%90%91/" style="font-size: 10px;">js逆向</a> <a href="/tags/kubernetes/" style="font-size: 10px;">kubernetes</a> <a href="/tags/log/" style="font-size: 10px;">log</a> <a href="/tags/logging/" style="font-size: 10px;">logging</a> <a href="/tags/matlab/" style="font-size: 11.25px;">matlab</a> <a href="/tags/python/" style="font-size: 20px;">python</a> <a href="/tags/pywin32/" style="font-size: 10px;">pywin32</a> <a href="/tags/style/" style="font-size: 10px;">style</a> <a href="/tags/tomcat/" style="font-size: 10px;">tomcat</a> <a href="/tags/ubuntu/" style="font-size: 10px;">ubuntu</a> <a href="/tags/uwsgi/" style="font-size: 10px;">uwsgi</a> <a href="/tags/validate-cert/" style="font-size: 10px;">validate_cert</a> <a href="/tags/vsftpd/" style="font-size: 10px;">vsftpd</a> <a href="/tags/wamp/" style="font-size: 10px;">wamp</a> <a href="/tags/wineQQ/" style="font-size: 10px;">wineQQ</a> <a href="/tags/%E4%B8%83%E7%89%9B/" style="font-size: 11.25px;">七牛</a> <a href="/tags/%E4%B8%8A%E6%B5%B7/" style="font-size: 10px;">上海</a> <a href="/tags/%E4%B8%AA%E4%BA%BA%E7%BD%91%E7%AB%99/" style="font-size: 10px;">个人网站</a> <a href="/tags/%E4%B8%BB%E9%A2%98/" style="font-size: 10px;">主题</a> <a href="/tags/%E4%BA%91%E5%AD%98%E5%82%A8/" style="font-size: 10px;">云存储</a> <a href="/tags/%E4%BA%AC%E4%B8%9C%E4%BA%91/" style="font-size: 10px;">京东云</a> <a href="/tags/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/" style="font-size: 10px;">人工智能</a> <a href="/tags/%E4%BB%A3%E7%90%86/" style="font-size: 10px;">代理</a> <a href="/tags/%E4%BB%A3%E7%A0%81/" style="font-size: 10px;">代码</a> <a href="/tags/%E4%BC%98%E5%8C%96/" style="font-size: 10px;">优化</a> <a href="/tags/%E4%BD%8D%E8%BF%90%E7%AE%97/" style="font-size: 10px;">位运算</a> <a href="/tags/%E5%88%86%E4%BA%AB/" style="font-size: 10px;">分享</a> <a href="/tags/%E5%88%86%E5%B8%83%E5%BC%8F/" style="font-size: 10px;">分布式</a> <a href="/tags/%E5%88%9B%E4%B8%9A/" style="font-size: 10px;">创业</a> <a href="/tags/%E5%89%8D%E7%AB%AF/" style="font-size: 11.25px;">前端</a> <a href="/tags/%E5%8E%9F%E7%94%9FAPP/" style="font-size: 10px;">原生APP</a> <a href="/tags/%E5%8F%8D%E7%88%AC%E8%99%AB/" style="font-size: 12.5px;">反爬虫</a> <a href="/tags/%E5%91%BD%E4%BB%A4/" style="font-size: 10px;">命令</a> <a href="/tags/%E5%93%8D%E5%BA%94%E5%BC%8F%E5%B8%83%E5%B1%80/" style="font-size: 10px;">响应式布局</a> <a href="/tags/%E5%9F%9F%E5%90%8D%E7%BB%91%E5%AE%9A/" style="font-size: 10px;">域名绑定</a> <a href="/tags/%E5%A4%A7%E4%BC%97%E7%82%B9%E8%AF%84/" style="font-size: 10px;">大众点评</a> <a href="/tags/%E5%AD%97%E4%BD%93%E5%8F%8D%E7%88%AC%E8%99%AB/" style="font-size: 10px;">字体反爬虫</a> <a href="/tags/%E5%AE%9E%E7%94%A8/" style="font-size: 10px;">实用</a> <a href="/tags/%E5%B4%94%E5%BA%86%E6%89%8D/" style="font-size: 18.75px;">崔庆才</a> <a href="/tags/%E5%B7%A5%E5%85%B7/" style="font-size: 10px;">工具</a> <a href="/tags/%E6%89%8B%E6%9C%BA%E8%AE%BF%E9%97%AE/" style="font-size: 10px;">手机访问</a> <a href="/tags/%E6%95%99%E7%A8%8B/" style="font-size: 10px;">教程</a> <a href="/tags/%E6%97%85%E6%B8%B8/" style="font-size: 10px;">旅游</a> <a href="/tags/%E6%97%A5%E5%BF%97/" style="font-size: 10px;">日志</a> <a href="/tags/%E6%9D%9C%E5%85%B0%E7%89%B9/" style="font-size: 10px;">杜兰特</a> <a href="/tags/%E6%A1%8C%E9%9D%A2/" style="font-size: 10px;">桌面</a> <a href="/tags/%E6%B1%9F%E5%8D%97/" style="font-size: 10px;">江南</a> <a href="/tags/%E6%B8%B8%E6%88%8F/" style="font-size: 10px;">游戏</a> <a href="/tags/%E7%88%AC%E8%99%AB/" style="font-size: 15px;">爬虫</a> <a href="/tags/%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F/" style="font-size: 10px;">环境变量</a> <a href="/tags/%E7%94%9F%E6%B4%BB%E7%AC%94%E8%AE%B0/" style="font-size: 10px;">生活笔记</a> <a href="/tags/%E7%99%BB%E5%BD%95/" style="font-size: 10px;">登录</a> <a href="/tags/%E7%9F%A5%E4%B9%8E/" style="font-size: 10px;">知乎</a> <a href="/tags/%E7%9F%AD%E4%BF%A1/" style="font-size: 10px;">短信</a> <a href="/tags/%E7%BA%B8%E5%BC%A0/" style="font-size: 10px;">纸张</a> <a href="/tags/%E7%BD%91%E7%AB%99/" style="font-size: 10px;">网站</a> <a href="/tags/%E8%82%89%E5%A4%B9%E9%A6%8D/" style="font-size: 10px;">肉夹馍</a> <a href="/tags/%E8%A5%BF%E5%B0%91%E7%88%B7/" style="font-size: 10px;">西少爷</a> <a href="/tags/%E8%A7%86%E9%A2%91/" style="font-size: 10px;">视频</a> <a href="/tags/%E8%BF%9C%E7%A8%8B/" style="font-size: 10px;">远程</a> <a href="/tags/%E9%80%86%E5%90%91/" style="font-size: 10px;">逆向</a> <a href="/tags/%E9%85%8D%E7%BD%AE/" style="font-size: 10px;">配置</a> <a href="/tags/%E9%87%8D%E8%A3%85/" style="font-size: 10px;">重装</a> <a href="/tags/%E9%9D%99%E8%A7%85/" style="font-size: 17.5px;">静觅</a> <a href="/tags/%E9%A2%A0%E8%A6%86/" style="font-size: 10px;">颠覆</a> <a href="/tags/%E9%A3%9E%E4%BF%A1/" style="font-size: 10px;">飞信</a>
      </div>
      <script>
        const tagsColors = ['#00a67c', '#5cb85c', '#d9534f', '#567e95', '#b37333', '#f4843d', '#15a287']
        const tagsElements = document.querySelectorAll('.sidebar-panel-tags .content a')
        tagsElements.forEach((item) => {
          item.style.backgroundColor = tagsColors[Math.floor(Math.random() * tagsColors.length)]
        })
      </script>
    </div>
    <div class="sidebar-panel sidebar-panel-categories sidebar-panel-active">
      <h4 class="name">
        分类
      </h4>
      <div class="content">
        <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/C-C/">C/C++</a><span class="category-list-count">23</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/HTML/">HTML</a><span class="category-list-count">13</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Java/">Java</a><span class="category-list-count">5</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/JavaScript/">JavaScript</a><span class="category-list-count">26</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Linux/">Linux</a><span class="category-list-count">15</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Markdown/">Markdown</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Net/">Net</a><span class="category-list-count">4</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Other/">Other</a><span class="category-list-count">38</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/PHP/">PHP</a><span class="category-list-count">27</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Paper/">Paper</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/Python/">Python</a><span class="category-list-count">256</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/TypeScript/">TypeScript</a><span class="category-list-count">2</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E4%B8%AA%E4%BA%BA%E5%B1%95%E7%A4%BA/">个人展示</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E4%B8%AA%E4%BA%BA%E6%97%A5%E8%AE%B0/">个人日记</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E4%B8%AA%E4%BA%BA%E9%9A%8F%E7%AC%94/">个人随笔</a><span class="category-list-count">10</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%8A%80%E6%9C%AF%E6%9D%82%E8%B0%88/">技术杂谈</a><span class="category-list-count">74</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E6%9C%AA%E5%88%86%E7%B1%BB/">未分类</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%94%9F%E6%B4%BB%E7%AC%94%E8%AE%B0/">生活笔记</a><span class="category-list-count">1</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E7%A6%8F%E5%88%A9%E4%B8%93%E5%8C%BA/">福利专区</a><span class="category-list-count">6</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/%E8%81%8C%E4%BD%8D%E6%8E%A8%E8%8D%90/">职位推荐</a><span class="category-list-count">2</span></li></ul>
      </div>
    </div>
    <div class="sidebar-panel sidebar-panel-friends sidebar-panel-active">
      <h4 class="name">
        友情链接
      </h4>
      <ul class="friends">
        <li class="friend">
          <span class="logo">
            <img src="https://qiniu.cuiqingcai.com/j2dub.jpg">
          </span>
          <span class="link">
            <a href="https://www.findhao.net/" target="_blank" rel="noopener">FindHao</a>
          </span>
        </li>
        <li class="friend">
          <span class="logo">
            <img src="https://qiniu.cuiqingcai.com/ou6mm.jpg">
          </span>
          <span class="link">
            <a href="https://diygod.me/" target="_blank" rel="noopener">DIYgod</a>
          </span>
        </li>
        <li class="friend">
          <span class="logo">
            <img src="https://qiniu.cuiqingcai.com/6apxu.jpg">
          </span>
          <span class="link">
            <a href="https://www.51dev.com/" target="_blank" rel="noopener">IT技术社区</a>
          </span>
        </li>
        <li class="friend">
          <span class="logo">
            <img src="https://www.jankl.com/img/titleshu.jpg">
          </span>
          <span class="link">
            <a href="https://www.jankl.com/" target="_blank" rel="noopener">liberalist</a>
          </span>
        </li>
        <li class="friend">
          <span class="logo">
            <img src="https://qiniu.cuiqingcai.com/bqlbs.png">
          </span>
          <span class="link">
            <a href="http://www.urselect.com/" target="_blank" rel="noopener">优社电商</a>
          </span>
        </li>
        <li class="friend">
          <span class="logo">
            <img src="https://qiniu.cuiqingcai.com/8s88c.jpg">
          </span>
          <span class="link">
            <a href="https://www.yuanrenxue.com/" target="_blank" rel="noopener">猿人学</a>
          </span>
        </li>
        <li class="friend">
          <span class="logo">
            <img src="https://qiniu.cuiqingcai.com/4i7yf.jpg">
          </span>
          <span class="link">
            <a href="https://www.lizenghai.com/" target="_blank" rel="noopener">Python量化投资</a>
          </span>
        </li>
        <li class="friend">
          <span class="logo">
            <img src="https://qiniu.cuiqingcai.com/2wgg5.jpg">
          </span>
          <span class="link">
            <a href="https://www.yunlifang.cn/" target="_blank" rel="noopener">云立方</a>
          </span>
        </li>
        <li class="friend">
          <span class="logo">
            <img src="https://qiniu.cuiqingcai.com/shwr6.png">
          </span>
          <span class="link">
            <a href="http://lanbing510.info/" target="_blank" rel="noopener">冰蓝</a>
          </span>
        </li>
        <li class="friend">
          <span class="logo">
            <img src="https://qiniu.cuiqingcai.com/blvoh.jpg">
          </span>
          <span class="link">
            <a href="https://lengyue.me/" target="_blank" rel="noopener">冷月</a>
          </span>
        </li>
        <li class="friend">
          <span class="logo">
            <img src="http://qianxunclub.com/favicon.png">
          </span>
          <span class="link">
            <a href="http://qianxunclub.com/" target="_blank" rel="noopener">千寻啊千寻</a>
          </span>
        </li>
        <li class="friend">
          <span class="logo">
            <img src="https://qiniu.cuiqingcai.com/0044u.jpg">
          </span>
          <span class="link">
            <a href="http://kodcloud.com/" target="_blank" rel="noopener">可道云</a>
          </span>
        </li>
        <li class="friend">
          <span class="logo">
            <img src="https://qiniu.cuiqingcai.com/ygnpn.jpg">
          </span>
          <span class="link">
            <a href="http://www.kunkundashen.cn/" target="_blank" rel="noopener">坤坤大神</a>
          </span>
        </li>
        <li class="friend">
          <span class="logo">
            <img src="https://qiniu.cuiqingcai.com/22uv1.png">
          </span>
          <span class="link">
            <a href="http://www.cenchong.com/" target="_blank" rel="noopener">岑冲博客</a>
          </span>
        </li>
        <li class="friend">
          <span class="logo">
            <img src="https://qiniu.cuiqingcai.com/ev9kl.png">
          </span>
          <span class="link">
            <a href="http://www.zxiaoji.com/" target="_blank" rel="noopener">张小鸡</a>
          </span>
        </li>
        <li class="friend">
          <span class="logo">
            <img src="https://www.chrafz.com/favicon.ico">
          </span>
          <span class="link">
            <a href="https://www.chrafz.com/" target="_blank" rel="noopener">张弦先生</a>
          </span>
        </li>
        <li class="friend">
          <span class="logo">
            <img src="https://www.503error.com/favicon.ico">
          </span>
          <span class="link">
            <a href="https://www.503error.com/" target="_blank" rel="noopener">张志明个人博客</a>
          </span>
        </li>
        <li class="friend">
          <span class="logo">
            <img src="https://seofangfa.com/favicon.ico">
          </span>
          <span class="link">
            <a href="https://seofangfa.com/" target="_blank" rel="noopener">方法SEO</a>
          </span>
        </li>
        <li class="friend">
          <span class="logo">
            <img src="https://qiniu.cuiqingcai.com/x714o.jpg">
          </span>
          <span class="link">
            <a href="http://www.hubwiz.com/" target="_blank" rel="noopener">汇智网</a>
          </span>
        </li>
        <li class="friend">
          <span class="logo">
            <img src="https://qiniu.cuiqingcai.com/lfmj3.png">
          </span>
          <span class="link">
            <a href="http://frankchen.xyz/" target="_blank" rel="noopener">不正经数据科学家</a>
          </span>
        </li>
        <li class="friend">
          <span class="logo">
            <img src="https://qiniu.cuiqingcai.com/129d8.png">
          </span>
          <span class="link">
            <a href="https://www.bysocket.com/" target="_blank" rel="noopener">泥瓦匠BYSocket</a>
          </span>
        </li>
        <li class="friend">
          <span class="logo">
            <img src="https://www.xiongge.club/favicon.ico">
          </span>
          <span class="link">
            <a href="https://www.xiongge.club/" target="_blank" rel="noopener">熊哥club</a>
          </span>
        </li>
        <li class="friend">
          <span class="logo">
            <img src="https://qiniu.cuiqingcai.com/3w4fe.png">
          </span>
          <span class="link">
            <a href="https://zerlong.com/" target="_blank" rel="noopener">知语</a>
          </span>
        </li>
        <li class="friend">
          <span class="logo">
            <img src="https://qiniu.cuiqingcai.com/262r1.jpg">
          </span>
          <span class="link">
            <a href="http://www.ysir308.com/" target="_blank" rel="noopener">程序员虾说</a>
          </span>
        </li>
        <li class="friend">
          <span class="logo">
            <img src="https://qiniu.cuiqingcai.com/44hxf.png">
          </span>
          <span class="link">
            <a href="http://redstonewill.com/" target="_blank" rel="noopener">红色石头</a>
          </span>
        </li>
        <li class="friend">
          <span class="logo">
            <img src="https://qiniu.cuiqingcai.com/8g1fk.jpg">
          </span>
          <span class="link">
            <a href="http://www.laodong.me/" target="_blank" rel="noopener">老董博客</a>
          </span>
        </li>
        <li class="friend">
          <span class="logo">
            <img src="https://qiniu.cuiqingcai.com/wkaus.jpg">
          </span>
          <span class="link">
            <a href="https://zhaoshuai.me/" target="_blank" rel="noopener">碎念</a>
          </span>
        </li>
        <li class="friend">
          <span class="logo">
            <img src="https://qiniu.cuiqingcai.com/pgo0r.jpg">
          </span>
          <span class="link">
            <a href="https://www.chenwenguan.com/" target="_blank" rel="noopener">陈文管的博客</a>
          </span>
        </li>
        <li class="friend">
          <span class="logo">
            <img src="https://qiniu.cuiqingcai.com/kk82a.jpg">
          </span>
          <span class="link">
            <a href="https://www.lxlinux.net/" target="_blank" rel="noopener">良许Linux教程网</a>
          </span>
        </li>
        <li class="friend">
          <span class="logo">
            <img src="https://qiniu.cuiqingcai.com/lj0t2.jpg">
          </span>
          <span class="link">
            <a href="https://tanqingbo.cn/" target="_blank" rel="noopener">IT码农</a>
          </span>
        </li>
        <li class="friend">
          <span class="logo">
            <img src="https://qiniu.cuiqingcai.com/i8cdr.png">
          </span>
          <span class="link">
            <a href="https://junyiseo.com/" target="_blank" rel="noopener">均益个人博客</a>
          </span>
        </li>
        <li class="friend">
          <span class="logo">
            <img src="https://qiniu.cuiqingcai.com/chwv2.png">
          </span>
          <span class="link">
            <a href="https://brucedone.com/" target="_blank" rel="noopener">大鱼的鱼塘</a>
          </span>
        </li>
        <li class="friend">
          <span class="logo">
            <img src="https://qiniu.cuiqingcai.com/2y43o.png">
          </span>
          <span class="link">
            <a href="http://bbs.nightteam.cn/" target="_blank" rel="noopener">夜幕爬虫安全论坛</a>
          </span>
        </li>
      </ul>
    </div>

  </div>
</aside>
<div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        <div class="copyright"> &copy; <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">崔庆才丨静觅</span>
  <span class="post-meta-divider">|</span>
  <span class="post-meta-item-icon">
    <i class="fa fa-chart-area"></i>
  </span>
  <span title="站点总字数">2.5m</span>
  <span class="post-meta-divider">|</span>
  <span class="post-meta-item-icon">
    <i class="fa fa-coffee"></i>
  </span>
  <span title="站点阅读时长">37:31</span>
</div>
<div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动 </div>
<div class="beian"><a href="https://beian.miit.gov.cn/" rel="noopener" target="_blank">京ICP备18015597号-1 </a>
</div>

        <script>
  (function ()
  {
    function leancloudSelector(url)
    {
      url = encodeURI(url);
      return document.getElementById(url).querySelector('.leancloud-visitors-count');
    }

    function addCount(Counter)
    {
      var visitors = document.querySelector('.leancloud_visitors');
      var url = decodeURI(visitors.id);
      var title = visitors.dataset.flagTitle;
      Counter('get', '/classes/Counter?where=' + encodeURIComponent(JSON.stringify(
      {
        url
      }))).then(response => response.json()).then((
      {
        results
      }) =>
      {
        if (results.length > 0)
        {
          var counter = results[0];
          leancloudSelector(url).innerText = counter.time + 1;
          Counter('put', '/classes/Counter/' + counter.objectId,
          {
            time:
            {
              '__op': 'Increment',
              'amount': 1
            }
          }).catch(error =>
          {
            console.error('Failed to save visitor count', error);
          });
        }
        else
        {
          Counter('post', '/classes/Counter',
          {
            title,
            url,
            time: 1
          }).then(response => response.json()).then(() =>
          {
            leancloudSelector(url).innerText = 1;
          }).catch(error =>
          {
            console.error('Failed to create', error);
          });
        }
      }).catch(error =>
      {
        console.error('LeanCloud Counter Error', error);
      });
    }

    function showTime(Counter)
    {
      var visitors = document.querySelectorAll('.leancloud_visitors');
      var entries = [...visitors].map(element =>
      {
        return decodeURI(element.id);
      });
      Counter('get', '/classes/Counter?where=' + encodeURIComponent(JSON.stringify(
      {
        url:
        {
          '$in': entries
        }
      }))).then(response => response.json()).then((
      {
        results
      }) =>
      {
        for (let url of entries)
        {
          let target = results.find(item => item.url === url);
          leancloudSelector(url).innerText = target ? target.time : 0;
        }
      }).catch(error =>
      {
        console.error('LeanCloud Counter Error', error);
      });
    }
    let
    {
      app_id,
      app_key,
      server_url
    } = {
      "enable": true,
      "app_id": "6X5dRQ0pnPWJgYy8SXOg0uID-gzGzoHsz",
      "app_key": "ziLDVEy73ne5HtFTiGstzHMS",
      "server_url": null,
      "security": false
    };

    function fetchData(api_server)
    {
      var Counter = (method, url, data) =>
      {
        return fetch(`${api_server}/1.1${url}`,
        {
          method,
          headers:
          {
            'X-LC-Id': app_id,
            'X-LC-Key': app_key,
            'Content-Type': 'application/json',
          },
          body: JSON.stringify(data)
        });
      };
      if (CONFIG.page.isPost)
      {
        if (CONFIG.hostname !== location.hostname) return;
        addCount(Counter);
      }
      else if (document.querySelectorAll('.post-title-link').length >= 1)
      {
        showTime(Counter);
      }
    }
    let api_server = app_id.slice(-9) !== '-MdYXbMMI' ? server_url : `https://${app_id.slice(0, 8).toLowerCase()}.api.lncldglobal.com`;
    if (api_server)
    {
      fetchData(api_server);
    }
    else
    {
      fetch('https://app-router.leancloud.cn/2/route?appId=' + app_id).then(response => response.json()).then((
      {
        api_server
      }) =>
      {
        fetchData('https://' + api_server);
      });
    }
  })();

</script>

      </div>
      <div class="footer-stat">
        <span id="cnzz_stat_icon_1279355174"></span>
        <script type="text/javascript">document.write(unescape("%3Cspan id='cnzz_stat_icon_1279355174'%3E%3C/span%3E%3Cscript src='https://v1.cnzz.com/z_stat.php%3Fid%3D1279355174%26online%3D1%26show%3Dline' type='text/javascript'%3E%3C/script%3E"));</script>
      </div>
    </footer>
  </div>

  <script src="//cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js"></script>
<script src="//cdn.jsdelivr.net/npm/pangu@4/dist/browser/pangu.min.js"></script>
<script src="/js/utils.js"></script>
<script src="/.js"></script>
<script src="/js/schemes/pisces.js"></script>
<script src="/.js"></script>
<script src="/js/next-boot.js"></script>
<script src="/.js"></script>

  <script>
  (function ()
  {
    var canonicalURL, curProtocol;
    //Get the <link> tag
    var x = document.getElementsByTagName("link");
    //Find the last canonical URL
    if (x.length > 0)
    {
      for (i = 0; i < x.length; i++)
      {
        if (x[i].rel.toLowerCase() == 'canonical' && x[i].href)
        {
          canonicalURL = x[i].href;
        }
      }
    }
    //Get protocol
    if (!canonicalURL)
    {
      curProtocol = window.location.protocol.split(':')[0];
    }
    else
    {
      curProtocol = canonicalURL.split(':')[0];
    }
    //Get current URL if the canonical URL does not exist
    if (!canonicalURL) canonicalURL = window.location.href;
    //Assign script content. Replace current URL with the canonical URL
    ! function ()
    {
      var e = /([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi,
        r = canonicalURL,
        t = document.referrer;
      if (!e.test(r))
      {
        var n = (String(curProtocol).toLowerCase() === 'https') ? "https://sp0.baidu.com/9_Q4simg2RQJ8t7jm9iCKT-xh_/s.gif" : "//api.share.baidu.com/s.gif";
        t ? (n += "?r=" + encodeURIComponent(document.referrer), r && (n += "&l=" + r)) : r && (n += "?l=" + r);
        var i = new Image;
        i.src = n
      }
    }(window);
  })();

</script>
<script src="/js/local-search.js"></script>
<script src="/.js"></script>

  

  

  


</body>
</html>
