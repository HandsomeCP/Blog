<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
  <meta name="theme-color" content="#222">
  <meta name="generator" content="Hexo 4.2.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/safari-pinned-tab.svg" color="#222">
  <link rel="stylesheet" href="/css/main.css">
  <link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="/lib/pace/pace-theme-minimal.min.css">
  <script src="/lib/pace/pace.min.js"></script>
  <script id="hexo-configurations">
    var NexT = window.NexT ||
    {};
    var CONFIG = {
      "hostname": "cuiqingcai.com",
      "root": "/",
      "scheme": "Pisces",
      "version": "7.8.0",
      "exturl": false,
      "sidebar":
      {
        "position": "right",
        "width": 360,
        "display": "post",
        "padding": 18,
        "offset": 12,
        "onmobile": false,
        "widgets": [
          {
            "type": "image",
            "name": "阿布云",
            "enable": true,
            "url": "https://www.abuyun.com/http-proxy/introduce.html",
            "src": "https://qiniu.cuiqingcai.com/88au8.jpg",
            "width": "100%"
      },
          {
            "type": "image",
            "name": "天验",
            "enable": true,
            "url": "https://tutorial.lengyue.video/?coupon=12ef4b1a-a3db-11ea-bb37-0242ac130002_cqx_850",
            "src": "https://qiniu.cuiqingcai.com/bco2a.png",
            "width": "100%"
      },
          {
            "type": "image",
            "name": "华为云",
            "enable": false,
            "url": "https://activity.huaweicloud.com/2020_618_promotion/index.html?bpName=5f9f98a29e2c40b780c1793086f29fe2&bindType=1&salesID=wangyubei",
            "src": "https://qiniu.cuiqingcai.com/y42ik.jpg",
            "width": "100%"
      },
          {
            "type": "image",
            "name": "张小鸡",
            "enable": false,
            "url": "http://www.zxiaoji.com/",
            "src": "https://qiniu.cuiqingcai.com/fm72f.png",
            "width": "100%"
      },
          {
            "type": "image",
            "name": "Luminati",
            "src": "https://qiniu.cuiqingcai.com/ikkq9.jpg",
            "url": "https://luminati-china.io/?affiliate=ref_5fbbaaa9647883f5c6f77095",
            "width": "100%",
            "enable": true
      },
          {
            "type": "tags",
            "name": "标签云",
            "enable": true
      },
          {
            "type": "categories",
            "name": "分类",
            "enable": true
      },
          {
            "type": "friends",
            "name": "友情链接",
            "enable": true
      },
          {
            "type": "hot",
            "name": "猜你喜欢",
            "enable": true
      }]
      },
      "copycode":
      {
        "enable": true,
        "show_result": true,
        "style": "mac"
      },
      "back2top":
      {
        "enable": true,
        "sidebar": false,
        "scrollpercent": true
      },
      "bookmark":
      {
        "enable": false,
        "color": "#222",
        "save": "auto"
      },
      "fancybox": false,
      "mediumzoom": false,
      "lazyload": false,
      "pangu": true,
      "comments":
      {
        "style": "tabs",
        "active": "gitalk",
        "storage": true,
        "lazyload": false,
        "nav": null
      },
      "algolia":
      {
        "hits":
        {
          "per_page": 10
        },
        "labels":
        {
          "input_placeholder": "Search for Posts",
          "hits_empty": "We didn't find any results for the search: ${query}",
          "hits_stats": "${hits} results found in ${time} ms"
        }
      },
      "localsearch":
      {
        "enable": true,
        "trigger": "auto",
        "top_n_per_article": 10,
        "unescape": false,
        "preload": false
      },
      "motion":
      {
        "enable": false,
        "async": false,
        "transition":
        {
          "post_block": "bounceDownIn",
          "post_header": "slideDownIn",
          "post_body": "slideDownIn",
          "coll_header": "slideLeftIn",
          "sidebar": "slideUpIn"
        }
      },
      "path": "search.xml"
    };

  </script>
  <meta name="description" content="崔庆才的个人站点，记录生活的瞬间，分享学习的心得。">
  <meta property="og:type" content="website">
  <meta property="og:title" content="静觅">
  <meta property="og:url" content="https://cuiqingcai.com/page/9/index.html">
  <meta property="og:site_name" content="静觅">
  <meta property="og:description" content="崔庆才的个人站点，记录生活的瞬间，分享学习的心得。">
  <meta property="og:locale" content="zh_CN">
  <meta property="article:author" content="崔庆才">
  <meta property="article:tag" content="崔庆才">
  <meta property="article:tag" content="静觅">
  <meta property="article:tag" content="PHP">
  <meta property="article:tag" content="Java">
  <meta property="article:tag" content="Python">
  <meta property="article:tag" content="Spider">
  <meta property="article:tag" content="爬虫">
  <meta property="article:tag" content="Web">
  <meta property="article:tag" content="Kubernetes">
  <meta property="article:tag" content="深度学习">
  <meta property="article:tag" content="机器学习">
  <meta property="article:tag" content="数据分析">
  <meta property="article:tag" content="网络">
  <meta property="article:tag" content="IT">
  <meta property="article:tag" content="技术">
  <meta property="article:tag" content="博客">
  <meta name="twitter:card" content="summary">
  <link rel="canonical" href="https://cuiqingcai.com/page/9/">
  <script id="page-configurations">
    // https://hexo.io/docs/variables.html
    CONFIG.page = {
      sidebar: "",
      isHome: true,
      isPost: false,
      lang: 'zh-CN'
    };

  </script>
  <title>静觅丨崔庆才的个人站点</title>
  <meta name="google-site-verification" content="p_bIcnvirkFzG2dYKuNDivKD8-STet5W7D-01woA2fc" />
  <noscript>
    <style>
      .use-motion .brand,
      .use-motion .menu-item,
      .sidebar-inner,
      .use-motion .post-block,
      .use-motion .pagination,
      .use-motion .comments,
      .use-motion .post-header,
      .use-motion .post-body,
      .use-motion .collection-header
      {
        opacity: initial;
      }

      .use-motion .site-title,
      .use-motion .site-subtitle
      {
        opacity: initial;
        top: initial;
      }

      .use-motion .logo-line-before i
      {
        left: initial;
      }

      .use-motion .logo-line-after i
      {
        right: initial;
      }

    </style>
  </noscript>
  <link rel="alternate" href="/atom.xml" title="静觅" type="application/atom+xml">
</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container">
    <div class="headband"></div>
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner">
        <div class="site-brand-container">
          <div class="site-nav-toggle">
            <div class="toggle" aria-label="切换导航栏">
              <span class="toggle-line toggle-line-first"></span>
              <span class="toggle-line toggle-line-middle"></span>
              <span class="toggle-line toggle-line-last"></span>
            </div>
          </div>
          <div class="site-meta">
            <a href="/" class="brand" rel="start">
              <span class="logo-line-before"><i></i></span>
              <h1 class="site-title">静觅 <span class="site-subtitle"> 崔庆才的个人站点 </span>
              </h1>
              <span class="logo-line-after"><i></i></span>
            </a>
          </div>
          <div class="site-nav-right">
            <div class="toggle popup-trigger">
              <i class="fa fa-search fa-fw fa-lg"></i>
            </div>
          </div>
        </div>
        <nav class="site-nav">
          <ul id="menu" class="main-menu menu">
            <li class="menu-item menu-item-home">
              <a href="/" rel="section">首页</a>
            </li>
            <li class="menu-item menu-item-archives">
              <a href="/archives/" rel="section">文章列表</a>
            </li>
            <li class="menu-item menu-item-tags">
              <a href="/tags/" rel="section">文章标签</a>
            </li>
            <li class="menu-item menu-item-categories">
              <a href="/categories/" rel="section">文章分类</a>
            </li>
            <li class="menu-item menu-item-about">
              <a href="/about/" rel="section">关于博主</a>
            </li>
            <li class="menu-item menu-item-message">
              <a href="/message/" rel="section">给我留言</a>
            </li>
            <li class="menu-item menu-item-search">
              <a role="button" class="popup-trigger">搜索 </a>
            </li>
          </ul>
        </nav>
        <div class="search-pop-overlay">
          <div class="popup search-popup">
            <div class="search-header">
              <span class="search-icon">
                <i class="fa fa-search"></i>
              </span>
              <div class="search-input-container">
                <input autocomplete="off" autocapitalize="off" placeholder="搜索..." spellcheck="false" type="search" class="search-input">
              </div>
              <span class="popup-btn-close">
                <i class="fa fa-times-circle"></i>
              </span>
            </div>
            <div id="search-result">
              <div id="no-result">
                <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
              </div>
            </div>
          </div>
        </div>
      </div>
    </header>
    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
      <span>0%</span>
    </div>
    <div class="reading-progress-bar"></div>
    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div class="content index posts-expand">
            <div class="carousel">
              <div id="wowslider-container">
                <div class="ws_images">
                  <ul>
                    <li><a target="_blank" href="https://cuiqingcai.com/5052.html"><img title="Python3网络爬虫开发实战教程" src="https://qiniu.cuiqingcai.com/ipy96.jpg" /></a></li>
                    <li><a target="_blank" href="https://t.lagou.com/fRCBRsRCSN6FA"><img title="52讲轻松搞定网络爬虫" src="https://qiniu.cuiqingcai.com/fqq5e.png" /></a></li>
                    <li><a target="_blank" href="https://cuiqingcai.com/4320.html"><img title="Python3网络爬虫开发视频教程" src="https://qiniu.cuiqingcai.com/bjrny.jpg" /></a></li>
                    <li><a target="_blank" href="https://cuiqingcai.com/1052.html"><img title="Python2爬虫学习系列教程" src="https://qiniu.cuiqingcai.com/uyl5v.jpg" /></a></li>
                    <li><a target="_blank" href="https://cuiqingcai.com/5094.html"><img title="爬虫代理哪家强？十大付费代理详细对比评测出炉！" src="https://qiniu.cuiqingcai.com/nifs6.jpg" /></a></li>
                  </ul>
                </div>
                <div class="ws_thumbs">
                  <div>
                    <a target="_blank" href="#"><img src="https://qiniu.cuiqingcai.com/ipy96.jpg" /></a>
                    <a target="_blank" href="#"><img src="https://qiniu.cuiqingcai.com/fqq5e.png" /></a>
                    <a target="_blank" href="#"><img src="https://qiniu.cuiqingcai.com/bjrny.jpg" /></a>
                    <a target="_blank" href="#"><img src="https://qiniu.cuiqingcai.com/uyl5v.jpg" /></a>
                    <a target="_blank" href="#"><img src="https://qiniu.cuiqingcai.com/nifs6.jpg" /></a>
                  </div>
                </div>
                <div class="ws_shadow"></div>
              </div>
            </div>
            <link rel="stylesheet" href="/lib/wowslide/slide.css">
            <script src="/lib/wowslide/jquery.min.js"></script>
            <script src="/lib/wowslide/slider.js"></script>
            <script>
              jQuery("#wowslider-container").wowSlider(
              {
                effect: "cube",
                prev: "",
                next: "",
                duration: 20 * 100,
                delay: 20 * 100,
                width: 716,
                height: 297,
                autoPlay: true,
                playPause: true,
                stopOnHover: false,
                loop: false,
                bullets: 0,
                caption: true,
                captionEffect: "slide",
                controls: true,
                onBeforeStep: 0,
                images: 0
              });

            </script>
            <article itemscope itemtype="http://schema.org/Article" class="post-block index" lang="zh-CN">
              <link itemprop="mainEntityOfPage" href="https://cuiqingcai.com/6804.html">
              <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
                <meta itemprop="image" content="/images/avatar.png">
                <meta itemprop="name" content="崔庆才">
                <meta itemprop="description" content="崔庆才的个人站点，记录生活的瞬间，分享学习的心得。">
              </span>
              <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
                <meta itemprop="name" content="静觅">
              </span>
              <header class="post-header">
                <h2 class="post-title" itemprop="name headline">
                  <a class="label"> JavaScript <i class="label-arrow"></i>
                  </a>
                  <a href="/6804.html" class="post-title-link" itemprop="url">JavaScript 实用窍门总结</a>
                </h2>
              </header>
              <div class="post-body" itemprop="articleBody">
                <div class="thumb">
                  <img itemprop="contentUrl" class="random">
                </div>
                <div class="excerpt">
                  <p>
                  <blockquote>
                    <p>简评：一开始 JavaScript 只是为网页增添一些实时动画效果，现在 JS 已经能做到前后端通吃了，而且还是年度流行语言。本文分享几则 JS 小窍门，可以让你事半功倍 ~</p>
                  </blockquote>
                  <h2 id="1-删除数组尾部元素"><a href="#1-删除数组尾部元素" class="headerlink" title="1. 删除数组尾部元素"></a>1. 删除数组尾部元素</h2>
                  <p>一个简单方法就是改变数组的length值:</p>
                  <figure class="highlight angelscript">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">const</span> arr = [<span class="number">11</span>, <span class="number">22</span>, <span class="number">33</span>, <span class="number">44</span>, <span class="number">55</span>, <span class="number">66</span>];</span><br><span class="line"><span class="comment">// truncanting</span></span><br><span class="line">arr.length = <span class="number">3</span>;</span><br><span class="line">console.log(arr); <span class="comment">//=&gt; [11, 22, 33]</span></span><br><span class="line"><span class="comment">// clearing</span></span><br><span class="line">arr.length = <span class="number">0</span>;</span><br><span class="line">console.log(arr); <span class="comment">//=&gt; []</span></span><br><span class="line">console.log(arr[<span class="number">2</span>]); <span class="comment">//=&gt; undefined</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <h2 id="2-使用对象解构（object-destructuring）来模拟命名参数"><a href="#2-使用对象解构（object-destructuring）来模拟命名参数" class="headerlink" title="2. 使用对象解构（object destructuring）来模拟命名参数"></a>2. 使用对象解构（object destructuring）来模拟命名参数</h2>
                  <p>如果需要将一系列可选项作为参数传入函数，你很可能会使用对象（Object）来定义配置（Config）。</p>
                  <figure class="highlight actionscript">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">doSomething(&#123; foo: <span class="string">'Hello'</span>, bar: <span class="string">'Hey!'</span>, baz: <span class="number">42</span> &#125;);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">doSomething</span><span class="params">(config)</span> </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> foo = config.foo !== <span class="literal">undefined</span> ? config.foo : <span class="string">'Hi'</span>;</span><br><span class="line">  <span class="keyword">const</span> bar = config.bar !== <span class="literal">undefined</span> ? config.bar : <span class="string">'Yo!'</span>;</span><br><span class="line">  <span class="keyword">const</span> baz = config.baz !== <span class="literal">undefined</span> ? config.baz : <span class="number">13</span>;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>不过这是一个比较老的方法了，它模拟了 JavaScript 中的命名参数。 在 ES 2015 中，你可以直接使用对象解构：</p>
                  <figure class="highlight reasonml">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">function</span> <span class="keyword">do</span><span class="constructor">Something(&#123; <span class="params">foo</span> = 'Hi', <span class="params">bar</span> = 'Yo!', <span class="params">baz</span> = 13 &#125;)</span> &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>让参数可选也很简单：</p>
                  <figure class="highlight reasonml">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">function</span> <span class="keyword">do</span><span class="constructor">Something(&#123; <span class="params">foo</span> = 'Hi', <span class="params">bar</span> = 'Yo!', <span class="params">baz</span> = 13 &#125; = &#123;&#125;)</span> &#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <h2 id="3-使用对象解构来处理数组"><a href="#3-使用对象解构来处理数组" class="headerlink" title="3. 使用对象解构来处理数组"></a>3. 使用对象解构来处理数组</h2>
                  <p>可以使用对象解构的语法来获取数组的元素：</p>
                  <figure class="highlight stata">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">const</span> csvFileLine = '1997,John <span class="keyword">Doe</span>,<span class="keyword">US</span>,john@<span class="keyword">doe</span>.com,New York';</span><br><span class="line"><span class="keyword">const</span> &#123; 2: country, 4: state &#125; = csvFileLine.<span class="keyword">split</span>(',');</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <h2 id="4-在-Switch-语句中使用范围值"><a href="#4-在-Switch-语句中使用范围值" class="headerlink" title="4. 在 Switch 语句中使用范围值"></a>4. 在 Switch 语句中使用范围值</h2>
                  <p>可以这样写满足范围值的语句：</p>
                  <figure class="highlight javascript">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getWaterState</span>(<span class="params">tempInCelsius</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">let</span> state;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">switch</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">    <span class="keyword">case</span> (tempInCelsius &lt;= <span class="number">0</span>): </span><br><span class="line">      state = <span class="string">'Solid'</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> (tempInCelsius &gt; <span class="number">0</span> &amp;&amp; tempInCelsius &lt; <span class="number">100</span>): </span><br><span class="line">      state = <span class="string">'Liquid'</span>;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">default</span>: </span><br><span class="line">      state = <span class="string">'Gas'</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> state;</span><br><span class="line">&#125;</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <h2 id="5-await-多个-async-函数"><a href="#5-await-多个-async-函数" class="headerlink" title="5. await 多个 async 函数"></a>5. await 多个 async 函数</h2>
                  <p>在使用 async/await 的时候，可以使用 Promise.all 来 await 多个 async 函数</p>
                  <figure class="highlight css">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="selector-tag">await</span> <span class="selector-tag">Promise</span><span class="selector-class">.all</span>(<span class="selector-attr">[anAsyncCall(), thisIsAlsoAsync(), oneMore()]</span>)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <h2 id="6-创建-Pure-objects"><a href="#6-创建-Pure-objects" class="headerlink" title="6. 创建 Pure objects"></a>6. 创建 <a href="http://www.codeceo.com/article/yahoo-pure-css.html" target="_blank" rel="noopener" title="Pure">Pure</a> objects</h2>
                  <p>你可以创建一个 100% pure object，它不从Object中继承任何属性或则方法（比如constructor, toString()等）</p>
                  <figure class="highlight delphi">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">const</span> pureObject = <span class="keyword">Object</span>.create(null);</span><br><span class="line">console.log(pureObject); <span class="comment">//=&gt; &#123;&#125;</span></span><br><span class="line">console.log(pureObject<span class="function">.<span class="keyword">constructor</span>);</span> <span class="comment">//=&gt; undefined</span></span><br><span class="line">console.log(pureObject.toString); <span class="comment">//=&gt; undefined</span></span><br><span class="line">console.log(pureObject.hasOwnProperty); <span class="comment">//=&gt; undefined</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <h2 id="7-格式化-JSON-代码"><a href="#7-格式化-JSON-代码" class="headerlink" title="7. 格式化 JSON 代码"></a>7. 格式化 JSON 代码</h2>
                  <p>JSON.stringify除了可以将一个对象字符化，还可以格式化输出 JSON 对象</p>
                  <figure class="highlight angelscript">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">const</span> obj = &#123; </span><br><span class="line">  foo: &#123; bar: [<span class="number">11</span>, <span class="number">22</span>, <span class="number">33</span>, <span class="number">44</span>], baz: &#123; bing: <span class="literal">true</span>, boom: <span class="string">'Hello'</span> &#125; &#125; </span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// The third parameter is the number of spaces used to </span></span><br><span class="line"><span class="comment">// beautify the JSON output.</span></span><br><span class="line">JSON.<span class="built_in">string</span>ify(obj, <span class="literal">null</span>, <span class="number">4</span>); </span><br><span class="line"><span class="comment">// =&gt;"&#123;</span></span><br><span class="line"><span class="comment">// =&gt;    "foo": &#123;</span></span><br><span class="line"><span class="comment">// =&gt;        "bar": [</span></span><br><span class="line"><span class="comment">// =&gt;            11,</span></span><br><span class="line"><span class="comment">// =&gt;            22,</span></span><br><span class="line"><span class="comment">// =&gt;            33,</span></span><br><span class="line"><span class="comment">// =&gt;            44</span></span><br><span class="line"><span class="comment">// =&gt;        ],</span></span><br><span class="line"><span class="comment">// =&gt;        "baz": &#123;</span></span><br><span class="line"><span class="comment">// =&gt;            "bing": true,</span></span><br><span class="line"><span class="comment">// =&gt;            "boom": "Hello"</span></span><br><span class="line"><span class="comment">// =&gt;        &#125;</span></span><br><span class="line"><span class="comment">// =&gt;    &#125;</span></span><br><span class="line"><span class="comment">// =&gt;&#125;"</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <h2 id="8-从数组中移除重复元素"><a href="#8-从数组中移除重复元素" class="headerlink" title="8. 从数组中移除重复元素"></a>8. 从数组中移除重复元素</h2>
                  <p>通过使用集合语法和 Spread 操作，可以很容易将重复的元素移除：</p>
                  <figure class="highlight dart">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">const</span> removeDuplicateItems = arr =&gt; [...<span class="keyword">new</span> <span class="built_in">Set</span>(arr)];</span><br><span class="line">removeDuplicateItems([<span class="number">42</span>, <span class="string">'foo'</span>, <span class="number">42</span>, <span class="string">'foo'</span>, <span class="keyword">true</span>, <span class="keyword">true</span>]);</span><br><span class="line"><span class="comment">//=&gt; [42, "foo", true]</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <h2 id="9-平铺多维数组"><a href="#9-平铺多维数组" class="headerlink" title="9. 平铺多维数组"></a>9. 平铺多维数组</h2>
                  <p>使用 Spread 操作平铺嵌套多维数组：</p>
                  <figure class="highlight angelscript">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">const</span> arr = [<span class="number">11</span>, [<span class="number">22</span>, <span class="number">33</span>], [<span class="number">44</span>, <span class="number">55</span>], <span class="number">66</span>];</span><br><span class="line"><span class="keyword">const</span> flatArr = [].concat(...arr); <span class="comment">//=&gt; [11, 22, 33, 44, 55, 66]</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>不过上面的方法仅适用于二维数组，但是通过递归，就可以平铺任意维度的嵌套数组了：</p>
                  <figure class="highlight reasonml">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">function</span> flatten<span class="constructor">Array(<span class="params">arr</span>)</span> &#123;</span><br><span class="line">  const flattened = <span class="literal">[]</span>.concat(...arr);</span><br><span class="line">  return flattened.some(item =&gt; <span class="module-access"><span class="module"><span class="identifier">Array</span>.</span></span>is<span class="constructor">Array(<span class="params">item</span>)</span>) ? </span><br><span class="line">    flatten<span class="constructor">Array(<span class="params">flattened</span>)</span> : flattened;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const arr = <span class="literal">[<span class="number">11</span>, [<span class="number">22</span>, <span class="number">33</span>]</span>, <span class="literal">[<span class="number">44</span>, [<span class="number">55</span>, <span class="number">66</span>, [<span class="number">77</span>, [<span class="number">88</span>]</span>], <span class="number">99</span>]]];</span><br><span class="line">const flatArr = flatten<span class="constructor">Array(<span class="params">arr</span>)</span>; </span><br><span class="line"><span class="comment">//=&gt; [11, 22, 33, 44, 55, 66, 77, 88, 99]</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>希望这些小技巧能帮助你写好 JavaScript ~ 原文：<a href="https://zhuanlan.zhihu.com/p/37493249" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/37493249</a></p>
                  </p>
                </div>
              </div>
              <div class="post-meta">
                <span class="post-meta-item">
                  <span class="post-meta-item-icon">
                    <i class="far fa-user"></i>
                  </span>
                  <span class="post-meta-item-text">作者</span>
                  <span><a href="/authors/崔庆才" class="author" itemprop="url" rel="index">崔庆才</a></span>
                </span>
                <span class="post-meta-item">
                  <span class="post-meta-item-icon">
                    <i class="far fa-calendar"></i>
                  </span>
                  <span class="post-meta-item-text">发表于</span>
                  <time title="创建时间：2019-07-08 01:20:57" itemprop="dateCreated datePublished" datetime="2019-07-08T01:20:57+08:00">2019-07-08</time>
                </span>
                <span id="/6804.html" class="post-meta-item leancloud_visitors" data-flag-title="JavaScript 实用窍门总结" title="阅读次数">
                  <span class="post-meta-item-icon">
                    <i class="fa fa-eye"></i>
                  </span>
                  <span class="post-meta-item-text">阅读次数：</span>
                  <span class="leancloud-visitors-count"></span>
                </span>
                <span class="post-meta-item" title="本文字数">
                  <span class="post-meta-item-icon">
                    <i class="far fa-file-word"></i>
                  </span>
                  <span class="post-meta-item-text">本文字数：</span>
                  <span>2.9k</span>
                </span>
                <span class="post-meta-item" title="阅读时长">
                  <span class="post-meta-item-icon">
                    <i class="far fa-clock"></i>
                  </span>
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                  <span>3 分钟</span>
                </span>
              </div>
            </article>
            <article itemscope itemtype="http://schema.org/Article" class="post-block index" lang="zh-CN">
              <link itemprop="mainEntityOfPage" href="https://cuiqingcai.com/6801.html">
              <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
                <meta itemprop="image" content="/images/avatar.png">
                <meta itemprop="name" content="崔庆才">
                <meta itemprop="description" content="崔庆才的个人站点，记录生活的瞬间，分享学习的心得。">
              </span>
              <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
                <meta itemprop="name" content="静觅">
              </span>
              <header class="post-header">
                <h2 class="post-title" itemprop="name headline">
                  <a class="label"> 技术杂谈 <i class="label-arrow"></i>
                  </a>
                  <a href="/6801.html" class="post-title-link" itemprop="url">知识付费的发展趋势</a>
                </h2>
              </header>
              <div class="post-body" itemprop="articleBody">
                <div class="thumb">
                  <img itemprop="contentUrl" class="random">
                </div>
                <div class="excerpt">
                  <p>
                  <p><img src="https://img0.tuicool.com/n2MFZbv.jpg!web" alt=""> 现代人都普遍比较焦虑，越来越多的人感到生活压力很大，在一二线城市不少白领人士更是已是患上“知识焦虑症”：这年头知识信息迭代太快，学习跟不上，别人懂的自己都不懂，总感觉自己欠缺的很多，没有技术和专长不知未来靠什么生存，担心自己长期落后他人从而被社会淘汰，从而产生了一种对未来不确定的心理恐惧。 于是，他们就急于渴求，希望能在短时间内学习大量知识希望从根本上解决自己的实际问题，拼命利用碎片化时间学习补充欠缺知识，不断完善自己的知识体系。这时知识付费的出现，正好满足了他们这些刚性需求。 再加上2018年前以逻辑思维为主一批内容供应商到处鼓吹和贩卖知识焦虑，在这种风气影响下连身边的很多小伙伴都购买了大量知识付费产品，但一年下来却发现这些知识根本没有学会几个，内容良莠不齐，服务跟不上，就算能坚持学完下来还是什么都不会，焦虑依然存在 。甚至更多人觉得其实知识付费就是一场骗局，从本质上来说知识付费并没有解决任何的问题，表面上只是缓解了一些焦虑，在短时间内让一些人自我感觉良好，实则上只是自欺欺人而已。 于是，一些感觉被欺骗的用户纷纷发声，对某些知识付费大号和机构更是愤怒抨击，在这些负面影响下这两年知识付费其实已逐渐降温并遭遇爆冷，甚至还有一些负面声音在说： <strong>在线知识付费的寒冬是不是要来临了？</strong> 其实不然，纵观当下市场发展态势知识付费的前景仍然是广阔的，竞争激烈程度仍方兴未艾，当人们对知识的盲目消费退烧后，知识付费更多的是回归服务价值， <strong>核心需求有两方面</strong> ： 一方面是为了提升欠缺的知识让自己具有更多的市场竞争力，另一方面也希望自己花钱买的知识付费产品是一些真正有帮助的东西，可帮自己迎来一个不错的未来。所以，知识付费的下一阶段必然聚焦于如何让学习用户获得真正有效的学习效果。 那么，知识付费下半场风口到底会吹去哪？ 好学豚认为这一领域的大方向以后的发展趋势大致有如下特征：</p>
                  <h4 id="趋势一：内容下沉，回归有价值的真实内容"><a href="#趋势一：内容下沉，回归有价值的真实内容" class="headerlink" title="趋势一：内容下沉，回归有价值的真实内容"></a>趋势一：内容下沉，回归有价值的真实内容</h4>
                  <h4 id="1、职场技能"><a href="#1、职场技能" class="headerlink" title="1、职场技能"></a>1、职场技能</h4>
                  <p>在知识付费领域和在整个教育市场体系里，职场技能都是最刚需的内容板块，从最早的电算会计化到后来的英语类培训，再到如今一些以工具为代表的设计、办公技能、IT编程等等培训，无一不彰显着其旺盛的生命力。 究其根本原因，这是因为它能够切实解决职场人士的实际需求，所以职场技能内容才会一直火爆，繁荣至今仍在蓬勃发展。</p>
                  <h4 id="2、知识拓展"><a href="#2、知识拓展" class="headerlink" title="2、知识拓展"></a>2、知识拓展</h4>
                  <p>知识拓展是近年来兴起的版块内容，也是互联网上传播特别广泛的内容。以得到为代表，邀请行业细分领域的专业人士，按照标准的生产流程来生产较高质量的内容，帮助拓广知识的视野从而实现专家指路的效果。不容忽视的是，知识拓展的内容从今天来看存在较大的局限，很难解决用户的实际问题，学习效果也很难得到保证；如何打磨出更加直击用户痛点的产品，需要更多的探索和尝试。</p>
                  <h4 id="3、兴趣爱好"><a href="#3、兴趣爱好" class="headerlink" title="3、兴趣爱好"></a>3、兴趣爱好</h4>
                  <p>在线教育领域，兴趣爱好的内容已经有了长足发展。用户的痛点正在逐渐从追求高大上、财务自由这些虚伪的概念转型到享受生活：提 升生活趣味让自己活得更舒服。兴趣爱好内容之所以能生命力如此旺盛，最大因素要得益于其以兴趣为导向，学习者本身并不会有太高的学习结果诉求，更多的是在学习之中获得的乐趣以及对授课老师的认同。</p>
                  <h4 id="趋势二：后续服务提升，注重全流程效果"><a href="#趋势二：后续服务提升，注重全流程效果" class="headerlink" title="趋势二：后续服务提升，注重全流程效果"></a>趋势二：后续服务提升，注重全流程效果</h4>
                  <p>今后知识付费需要做好三个关键点的平衡：碎片化学习、学习规模和学习效果，这三者缺一不可。根据业内行家的实践和推断，下一阶段知识付费的标配服务模式将会是1+1+N模式，能较好地实现以上三个关键点的平衡。 第一个“1”代表的是标准化的课程： 这个课程将会以“图文”、“视频”或“音频”形式进行展现，让学习者完成自学。这个“1”满足了碎片化学习的随时随地性，给予了学习者最大限度的自由度，同时也满足了由于学习规模日益扩大而带来的各种问题。 第二个“1”代表的是在线训练营： 就是把线下的集中学习模式搬到线上，开展一段时间的在线集中训练，通过学习流程、学习氛围、学习评估的三位一体运作，从而使学习效果得以达成。总体做法是把所有参与训练营的学员，分成不同的小组，然后配定相应老师。每个学员在学习过程中都需要完成相应作业，然后交给老师进行批改和点评。整个训练营阶段会有实战练习，根据学习者的自身情况或使用真实的案例来进行实战，进而帮助学习者实现学以致用。同时，老师需要对每个学习者进行阶段性评分，在学习完成时要进行总体评估；老师还需要针对小组学习效果进行展示和相应氛围的营造。 最后一个“N”则代表通过科技的力量，实现多种教学辅助手段 ：比如老师和学员之间的交互，老师批量布置和批改作业，对学员进行评分和评估，给积极学习者一些奖励等等，所有这些辅助手段，将会让老师和学员之间的交互更紧密，让学习效率更高、让学习流程更完整、学习模式更人性，从而最终达到提升学习效果的目的。</p>
                  <h4 id="趋势三：更多垂直领域的小KOL将通过工具类平台输出产品"><a href="#趋势三：更多垂直领域的小KOL将通过工具类平台输出产品" class="headerlink" title="趋势三：更多垂直领域的小KOL将通过工具类平台输出产品"></a>趋势三：更多垂直领域的小KOL将通过工具类平台输出产品</h4>
                  <p>垂直领域的小KOL，他们标签清晰、价值点明确，用户深度认可，反倒更容易突围，甚至可以脱离平台，通过好学豚这类工具就可以完成知识店铺的搭建。而且因为他们有很强的用户沉淀能力，所以也更有动力参与。长期来看，小KOL通过线上虚拟产品输出知识将会成为一个新的趋势。</p>
                  <h4 id="趋势四：一线城市受众有限，二、三线城市女性用户价值开始受到重视"><a href="#趋势四：一线城市受众有限，二、三线城市女性用户价值开始受到重视" class="headerlink" title="趋势四：一线城市受众有限，二、三线城市女性用户价值开始受到重视"></a>趋势四：一线城市受众有限，二、三线城市女性用户价值开始受到重视</h4>
                  <p>一线城市对于知识付费产品的承载能力是有限的，据观察主流付费用户都不是一线白领，而是二三线城市的宝妈。她们更愿意在知识上付钱，也愿意分享课程，赚取一定分成。 互联网独角兽的发展规律一再地证明二三线城市的女性是主力消费群体，知识付费也不会逃离这个规律，现在很多母婴类课程、女性个人提升课程、陪伴式励志课程、情商人际关系类课程销量都很不错。这是一个巨大的市场空窗，目前市场上的多数知识付费平台还忽视了二三线城市的用户，电商平台和垂直大号也还没有真正介入这一行业，这个空窗很有可能下一家知识付费独角兽企业崛起的机会。 针对以上趋势，好学豚知识付费平台也正在进行多方面的尝试，希望能把握住这些新的市场机会迎来爆发性增长，对于当下的知识付费从业者来说既是一个巨大的挑战，也是突围而出成为新独角兽企业的机会。 原文：<a href="https://www.iyiou.com/p/104850.html" target="_blank" rel="noopener">https://www.iyiou.com/p/104850.html</a></p>
                  </p>
                </div>
              </div>
              <div class="post-meta">
                <span class="post-meta-item">
                  <span class="post-meta-item-icon">
                    <i class="far fa-user"></i>
                  </span>
                  <span class="post-meta-item-text">作者</span>
                  <span><a href="/authors/崔庆才" class="author" itemprop="url" rel="index">崔庆才</a></span>
                </span>
                <span class="post-meta-item">
                  <span class="post-meta-item-icon">
                    <i class="far fa-calendar"></i>
                  </span>
                  <span class="post-meta-item-text">发表于</span>
                  <time title="创建时间：2019-07-08 00:54:09" itemprop="dateCreated datePublished" datetime="2019-07-08T00:54:09+08:00">2019-07-08</time>
                </span>
                <span id="/6801.html" class="post-meta-item leancloud_visitors" data-flag-title="知识付费的发展趋势" title="阅读次数">
                  <span class="post-meta-item-icon">
                    <i class="fa fa-eye"></i>
                  </span>
                  <span class="post-meta-item-text">阅读次数：</span>
                  <span class="leancloud-visitors-count"></span>
                </span>
                <span class="post-meta-item" title="本文字数">
                  <span class="post-meta-item-icon">
                    <i class="far fa-file-word"></i>
                  </span>
                  <span class="post-meta-item-text">本文字数：</span>
                  <span>2.5k</span>
                </span>
                <span class="post-meta-item" title="阅读时长">
                  <span class="post-meta-item-icon">
                    <i class="far fa-clock"></i>
                  </span>
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                  <span>2 分钟</span>
                </span>
              </div>
            </article>
            <article itemscope itemtype="http://schema.org/Article" class="post-block index" lang="zh-CN">
              <link itemprop="mainEntityOfPage" href="https://cuiqingcai.com/6799.html">
              <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
                <meta itemprop="image" content="/images/avatar.png">
                <meta itemprop="name" content="崔庆才">
                <meta itemprop="description" content="崔庆才的个人站点，记录生活的瞬间，分享学习的心得。">
              </span>
              <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
                <meta itemprop="name" content="静觅">
              </span>
              <header class="post-header">
                <h2 class="post-title" itemprop="name headline">
                  <a class="label"> 技术杂谈 <i class="label-arrow"></i>
                  </a>
                  <a href="/6799.html" class="post-title-link" itemprop="url">未来，你可能会主动点开这种广告</a>
                </h2>
              </header>
              <div class="post-body" itemprop="articleBody">
                <div class="thumb">
                  <img itemprop="contentUrl" class="random">
                </div>
                <div class="excerpt">
                  <p>
                  <p>首先，这篇文章不是一个广告。 但你可能已经要被这个时代无处不在的洗脑广告逼疯了。 大街小巷贴满的纸皮广告、商场和电梯里循环播放的电子屏广告、电脑上避不开关不掉停不了的网页广告…… 某招聘软件和某旅拍公司的循环怒吼式视频让人生理性地记住了它，但心理上可能想把相关人员关电梯里让它们把这条广告看一万遍。 <img src="https://img2.tuicool.com/YVBRNze.png!web" alt=""> ▲ 图片来自：「伯爵旅拍」广告截图 广告的形式不断在变化，从广播、平面、视频，到 H5、直播，部分广告会以新颖的形式和优质的内容取胜，但人们看广告一直都是被动接受的过程。 上周蜘蛛侠上映，索尼在 Snapchat 上 <a href="https://mobilemarketingmagazine.com/sony-snapchatspider-man-far-from-home-ar-campaign" target="_blank" rel="noopener">推出了 AR 活动宣传</a> ，为了贴合「英雄远征」的主题，索尼让蜘蛛侠「出现」在世界各地的地标处，比如纽约的熨斗大厦、伦敦的白金汉宫、巴黎的艾菲尔铁塔，只要你将自拍镜头对准建筑，就可以看到蜘蛛侠在屏幕上摆动。 <img src="https://img2.tuicool.com/QZNRjaI.jpg!web" alt=""> ▲图片来自：mobilemarketingmagazine 它让人们愿意看蜘蛛侠的广告，同时也让广告成了一种主动参与的过程。 接下来要讲的，就是未来这一种我们会主动点开的——VR 广告。</p>
                  <h3 id="当广告变成了一种「真实」的体验"><a href="#当广告变成了一种「真实」的体验" class="headerlink" title="当广告变成了一种「真实」的体验"></a>当广告变成了一种「真实」的体验</h3>
                  <p>我们看现在的广告，有一种潜意识默认的原则，就是注意力只给它们 3 秒钟。 但现在的 VR 广告，是给你无限的时间，让你自己去体验。 AR 火起来，还是被 2015 年 Snapchat 的搞怪 AR 滤镜，以及 2016 年的神奇宝贝 GO 带动，这也改变了市场营销对 AR 的看法，让 AR 开始在广告界生根发芽。 <img src="https://img1.tuicool.com/naMv6nE.png!web" alt=""> 宜家是首批尝试购买 AR 技术并以此宣传的公司之一。 在 <a href="https://sensortower.com/ios/US/inter-ikea-systems-b-v/app/ikea-place/1279244498/" target="_blank" rel="noopener">IKEA Place app 中</a> ，人们可以看到新款家具实际摆放在家里的样子，以判断它们是不是有足够空间布局放置、颜色风格是否和周围环境搭调，这可以帮宜家提高客户满意度以及降低产品退回率。 <img src="https://img1.tuicool.com/J3iYnqr.gif" alt=""> 随后苹果发布了 ARkit 技术，Google、Facebook、亚马逊等大公司也在 2017 年和 2018 年期间发布了自己 AR 软件开发套件，以支持日后 AR 技术的发展。 Facebook 去年就为广告商提供了 <a href="https://techcrunch.com/2018/07/10/facebook-ar-ads/" target="_blank" rel="noopener">展示产品的新方式</a> ，让人们在新闻流中看到品牌广告时，能够通过前置摄像头对比自己戴上太阳镜等配饰、甚至穿各种衣服的样子。现在 Facebook 也一直在通过各个平台包括 Instagram 扩大购物范围和增值产品。 <img src="https://img1.tuicool.com/VNRRBvZ.png!web" alt=""> 除了家居服饰，美容时尚等行业也开始尝试利用 AR 营销，主要是为了弥补线上和线下的差距。 两周前，人们已经能在 YouTube 上一边看美妆博主的化妆教程，一边在分屏之下跟着博主一起涂口红试色，这个名为 <a href="https://techcrunch.com/2019/06/18/youtubes-new-ar-beauty-try-on-lets-viewers-virtually-try-on-makeup-while-watching-video-reviews/" target="_blank" rel="noopener">AR Beauty Try-On 的功能</a> 由 Google 推出，M・A・C 是第一个跟上这项 AR 广告的品牌。测试结果发现，人们愿意花费超过 80 秒的时间去体验虚拟唇膏色调。 <img src="https://img1.tuicool.com/NbAJRrm.gif" alt=""> 甚至当你逛淘宝店，在前几周 <a href="https://www.chinanews.com/it/2019/06-25/8874866.shtml" target="_blank" rel="noopener">天猫旗舰店升级的</a> 2.0 版本，能直接让你像逛线下实体店一样逛线上 3D 商店、参观漫游，每家店铺展示内容也因人而异。 而且，你还可以实地进入 AR 广告之中。 在汽车行业，宝马、保时捷、丰田等汽车品牌都成为了 AR 广告的追随者。 丰田上个月给 2020 年卡罗拉 <a href="https://mobile-ar.reality.news/news/toyota-rolls-out-web-based-ar-advertising-campaign-via-8th-wall-0198696/" target="_blank" rel="noopener">推出了 AR 移动广告</a> ，人们可以 360 度全方位观看车内视图和功能，以及固定在一个地方的 3D 数字模型，甚至还可以在车内行走。这能让购买者更简单地了解车辆的技术特性，也有助于在购买车辆前对其预先认证。 <img src="https://img2.tuicool.com/Ivu2ume.gif" alt=""> 这种自然而直观的方式，不仅让人们和品牌建立起更真实的关系，与以往广告最大的不同就是，人们还能随时参与、持续互动，并响应内容。</p>
                  <h3 id="我们可以拿回看广告的主动权"><a href="#我们可以拿回看广告的主动权" class="headerlink" title="我们可以拿回看广告的主动权"></a>我们可以拿回看广告的主动权</h3>
                  <p>现在，我们自己可以掌控广告。 目前我们 <a href="https://www.clickz.com/ar-in-marketing-iab-playbook/241746/" target="_blank" rel="noopener">能看到的 AR 广告</a> ，主要包括被赞助的拍照滤镜镜头、应用软件和游戏内的 AR 广告单元，信息流内的 AR 广告单元等。 之前是广告「邀请」我们看，没有任何协商。但现在我们「侵入」广告，去满足自己的好奇心。广告变成了一个工具，我们通过它与我们喜欢的品牌获得联系。 这种形式现在也让 AR 广告成为当今市场上破坏性最小的广告单元之一。 <img src="https://img1.tuicool.com/z63EnqU.png!web" alt=""> ▲ 图片来自：unsplash 另外，AR 广告已经不再是单独的一个内容，而是进入我们的真实生活，或者进入其它我们沉浸的内容之中——广告本身就是商品的展示位，不会再有其它如美化特效、夸张视觉等因素插入和干扰。 而且这些 AR 广告最初打开的阀门，就掌握在消费者手上。 因为 AR 广告现在都需要申请对其相机／设备的访问，在非相机优先的应用中，也需要申请特定权限，因此你完全可以选择你需要的内容，并与之开始进一步互动。 <img src="https://img2.tuicool.com/aiUJVnA.jpg!web" alt=""> ▲ 图片来自： <a href="https://www.cisin.com/coffee-break/technology/augmented-reality-ar-technology-sets-free-an-enormous-company-development-prospects.html" target="_blank" rel="noopener">Cyber Infrastructure</a> 可以说，AR 就是有史以来最强大的故事叙述媒体。它的互动带来的「响应式特色」，就是它最大的优势。 Unity 技术的 AR / VR 广告创新 <a href="https://appdevelopermagazine.com/why-ar-advertising-is-hard/" target="_blank" rel="noopener">负责人 Tony Parisi 说</a> ： 响应性 AR 广告是一种更加友好，不那么令人生畏的方法，这些广告能够提高客户的选择率，同时通过控制权来提高用户的舒适度。 尽管 AR 广告现在还不足以吸引大多数用户，人们似乎更觉得这只是消费者的一种自我意淫。 但实际上幸运的是，现在它背后有一批最大的科技公司在支持和推动，这就让更多设计师有机会去创造更好的 AR 广告环境，更多品牌有空间去施放更大的营销活动。 Google、苹果、Facebook 这样的大平台仍然主导着 AR 领域及其营销的发展。这些科技公司还和零售商 <a href="https://www.mobilemarketer.com/news/more-than-140-retailers-tech-companies-team-up-to-improve-arvr/553412/" target="_blank" rel="noopener">组成了一个小组</a> ，为用于增强现实购物的 3D 图像创建一套通用标准。 <img src="https://img2.tuicool.com/juaaIzr.gif" alt=""> ▲ Google 推出名为 Swirl 的沉浸式显示，消费者可以 360 度查看、旋转、放大、缩小商品 在这个背景之下，市场研究公司 <a href="https://www.seaberyat.com/augmented-reality-stats/" target="_blank" rel="noopener">Markets and Markets 的数据</a> 预计，到明年 AR 将拥有 10 亿用户，到 2022 年将达到 22 亿美元的广告支出。 AR 广告进入我们的生活将会更加快速，而我们掌握的主动权也会越来越多，正如以色列最大的互联网公司 IronSource 首席设计官 <a href="http://www.adotas.com/2017/11/__trashed-115/" target="_blank" rel="noopener">Dan Greenberg</a> <a href="http://www.adotas.com/2017/11/__trashed-115/" target="_blank" rel="noopener">所认为的</a> ： 我们不断研究如何在广告中为用户提供尽可能多的选择的方法。因为给用户提供更多控制权，才是创建真正个性化移动体验的关键。</p>
                  <h3 id="AR-会是下一个广告形态"><a href="#AR-会是下一个广告形态" class="headerlink" title="AR 会是下一个广告形态"></a>AR 会是下一个广告形态</h3>
                  <p>数字广告总体上正朝着更丰富、更身临其境、更多选择的方向发展，消费者正在被置于互动体验的中心。 <a href="https://www.mobilemarketer.com/news/study-agencies-face-cost-tech-hurdles-with-ar-advertising/557067/" target="_blank" rel="noopener">根据 Gartner 的估计</a> ，随着 5G 高速移动服务的推出，明年它将推动 AR 购物增长到 1 亿消费者。 <img src="https://img2.tuicool.com/bI77bau.png!web" alt=""> ▲ 图片来自：unsplash 因为在高速运行的网络下，开发者不仅能够创造更高质量的 3D 可视化技术，消费者也能获得更多形式的沉浸式体验，品牌也能将其购物平台更多扩展到商店和传统网站之外的移动设备上，而且广告也不会再只限于移动设备的小屏幕。 还可以预见的是，5G 网络之下数据信息密度也会迅速加大，除了文本，还有图像、视频，人们接受的购物信息无疑更广、更深、更繁杂，而 AR 能够降低广告的感知成本，让人们消费数字内容将更简便和直观。 <img src="https://img0.tuicool.com/2QRNfqF.png!web" alt=""> ▲ 图片来自：unsplash 但现在 AR 广告还未普及的主要问题，就在于它的成本和技术。 比起其他广告形式来说，其实它的投入成本并不低。Digiday 指出 <a href="https://www.skyword.com/contentstandard/marketing/snapchat-ar-ads-are-now-more-affordable-making-it-a-go-to-ar-destination/" target="_blank" rel="noopener">单一的广告体验</a> 可能需要花费 5,000 到 30,000 美元甚至更多才能正常开发，投资回报率也很难衡量。 而近阶段虽然 AR 技术发展很快，但 5G 手机还刚推出第一批，5G 网络也并未稳定普及，这也是影响 AR 广告现在扩大规模的关键因素——没有与之匹配的设备。另外，比起其它开发多年的其它形式的广告，AR 广告迭代和优化也还不太灵活，并非广告商们信手就可捏来。 <img src="https://img1.tuicool.com/Y3Uz2uV.png!web" alt=""> ▲ 图片来自：unsplash AR 热潮刚刚开始真正起飞，我们现在看到的只是关于 AR 能带来什么以及它能做些什么的一瞥。不过苹果 2017 年推出 ARKit 时，首席执行官蒂姆・库克在 <a href="https://www.mobilemarketer.com/news/mobile-disruptor-of-the-year-augmented-reality/510150/" target="_blank" rel="noopener">财报电话会议上就指出</a> AR 将成为「主流」： 虽然我们现在还只触及冰山一角，但它将永久改变我们使用技术的方式。 而这个未来正在靠近。Digi-Capital <a href="https://www.mobilemarketer.com/news/mobile-disruptor-of-the-year-augmented-reality/510150/" target="_blank" rel="noopener">预计在未来五年内</a> AR 广告的市场价值将达到 830 亿美元。而且下一代移动设备，还会为我们带来更多新的可能性。 折叠手机的柔性屏幕将能让 AR 广告拥有更多形式；内置投影仪的手机，能让 AR 广告用更大的位置呈现，当广告变成了一种看电影的方式，这对广告商也意味着有更多的空间来宣传。 <img src="https://img2.tuicool.com/NzMNNrq.jpg!web" alt=""> ▲ 图片来自： <a href="https://www.satzuma.com/product-page/3d-hologram-visualiser" target="_blank" rel="noopener">satzuma</a> 但无论何种新的形式，接下来，当我们沉迷于自己所选的 AR 广告体验中无法自拔，会不会更加停不下来「买买买」呢？ 我开始觉得这是一篇关于 AR 的沉浸式广告了。 原文：<a href="https://www.ifanr.com/1230440?utm_source=tuicool&amp;utm_medium=referral" target="_blank" rel="noopener">https://www.ifanr.com/1230440</a></p>
                  </p>
                </div>
              </div>
              <div class="post-meta">
                <span class="post-meta-item">
                  <span class="post-meta-item-icon">
                    <i class="far fa-user"></i>
                  </span>
                  <span class="post-meta-item-text">作者</span>
                  <span><a href="/authors/崔庆才" class="author" itemprop="url" rel="index">崔庆才</a></span>
                </span>
                <span class="post-meta-item">
                  <span class="post-meta-item-icon">
                    <i class="far fa-calendar"></i>
                  </span>
                  <span class="post-meta-item-text">发表于</span>
                  <time title="创建时间：2019-07-08 00:52:27" itemprop="dateCreated datePublished" datetime="2019-07-08T00:52:27+08:00">2019-07-08</time>
                </span>
                <span id="/6799.html" class="post-meta-item leancloud_visitors" data-flag-title="未来，你可能会主动点开这种广告" title="阅读次数">
                  <span class="post-meta-item-icon">
                    <i class="fa fa-eye"></i>
                  </span>
                  <span class="post-meta-item-text">阅读次数：</span>
                  <span class="leancloud-visitors-count"></span>
                </span>
                <span class="post-meta-item" title="本文字数">
                  <span class="post-meta-item-icon">
                    <i class="far fa-file-word"></i>
                  </span>
                  <span class="post-meta-item-text">本文字数：</span>
                  <span>3.3k</span>
                </span>
                <span class="post-meta-item" title="阅读时长">
                  <span class="post-meta-item-icon">
                    <i class="far fa-clock"></i>
                  </span>
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                  <span>3 分钟</span>
                </span>
              </div>
            </article>
            <article itemscope itemtype="http://schema.org/Article" class="post-block index" lang="zh-CN">
              <link itemprop="mainEntityOfPage" href="https://cuiqingcai.com/6797.html">
              <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
                <meta itemprop="image" content="/images/avatar.png">
                <meta itemprop="name" content="崔庆才">
                <meta itemprop="description" content="崔庆才的个人站点，记录生活的瞬间，分享学习的心得。">
              </span>
              <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
                <meta itemprop="name" content="静觅">
              </span>
              <header class="post-header">
                <h2 class="post-title" itemprop="name headline">
                  <a class="label"> 技术杂谈 <i class="label-arrow"></i>
                  </a>
                  <a href="/6797.html" class="post-title-link" itemprop="url">阿里新开发了一款神器，零基础也能轻松做出酷炫动效！</a>
                </h2>
              </header>
              <div class="post-body" itemprop="articleBody">
                <div class="thumb">
                  <img itemprop="contentUrl" class="random">
                </div>
                <div class="excerpt">
                  <p>
                  <p>阿里作为中国互联网企业的标杆，不仅一直在为广大人民群众提供快捷便利的服务。也不断引领行业，在各个专业领域，给专业人员提供了优质的工具与服务。对设计师而言，无论是每年一度的 UCAN大会，还是 Kitchen、语雀、Ant Design 等设计开发工具，都给广大设计师带来很大的便利。 而最近，阿里又推出了一款基于 Lottie 的动效设计平台 ── 犸良。能够快速生成设计师想要的动态效果，并交付给开发，极大地提高了设计效率和设计还原度。</p>
                  <h4 id="犸良是什么？"><a href="#犸良是什么？" class="headerlink" title="犸良是什么？"></a>犸良是什么？</h4>
                  <p>它是一个积累了很多通用动效素材的平台，让不会动效的同学们也能基于动效库和素材库快速生成一个通用动效创意，你只需要简单地编辑图片、颜色或者文字即可。同时平台集成了以 Lottie 为代表的动效技术，让曾经令人苦恼的安装包大小和性能问题一并解决。 <img src="https://img2.tuicool.com/uQFZNzN.gif" alt=""> △ 官网： <a href="https://design.alipay.com/emotion" target="_blank" rel="noopener">https://design.alipay.com/emotion</a></p>
                  <h4 id="犸良的应用场景"><a href="#犸良的应用场景" class="headerlink" title="犸良的应用场景"></a>犸良的应用场景</h4>
                  <p>犸良支持全平台 iOS、Android、H5、小程序。无论是营销展位、活动页面、空状态还是产品icon。犸良编辑器对接投放平台，一站式完成动效创意制作和投放。 丰富的动效素材能够满足多种场景需要。</p>
                  <h4 id="犸良怎么用？"><a href="#犸良怎么用？" class="headerlink" title="犸良怎么用？"></a>犸良怎么用？</h4>
                  <h4 id="方式一：基于模版直接制作（适用于设计师进行动态banner制作）"><a href="#方式一：基于模版直接制作（适用于设计师进行动态banner制作）" class="headerlink" title="方式一：基于模版直接制作（适用于设计师进行动态banner制作）"></a>方式一：基于模版直接制作（适用于设计师进行动态banner制作）</h4>
                  <ol>
                    <li>选择模版</li>
                    <li>从动画仓库选择动画进行当前动画的替换</li>
                    <li>通过替换图片或修改颜色来自定义动画</li>
                    <li>自定义模板文字内容</li>
                    <li>选择模板背景图片</li>
                    <li>完成编辑选择是否带背景（banner模版默认带背景）</li>
                    <li>导出成功下载 json</li>
                  </ol>
                  <h4 id="方式二：自定义画布制作（适用于设计师进行模板覆盖不到的动效应用场景）"><a href="#方式二：自定义画布制作（适用于设计师进行模板覆盖不到的动效应用场景）" class="headerlink" title="方式二：自定义画布制作（适用于设计师进行模板覆盖不到的动效应用场景）"></a>方式二：自定义画布制作（适用于设计师进行模板覆盖不到的动效应用场景）</h4>
                  <p>使用犸良一分钟做出来的效果，大家感受下： <img src="https://img0.tuicool.com/ZZFjIn3.gif" alt=""> <img src="https://img1.tuicool.com/M7Bjuuy.gif" alt=""></p>
                  <h4 id="体验感受"><a href="#体验感受" class="headerlink" title="体验感受"></a>体验感受</h4>
                  <p>综合体验了一下犸良，相对于鹿班人工智能随意撸图。猛良其实是一款基于人工的动效模板网站。所有的动态效果都是设计师提前做好的。基于 Lottie 的特性，将可编辑的属性进行模块化。 说到这里有些设计师可能有疑问了，Lottie 究竟是什么？在优设已经有相关文章介绍的比较全面了，这里就不赘述了，阅读链接： <a href="http://www.uisdc.com/tag/lottie/" target="_blank" rel="noopener">http://www.uisdc.com/tag/lottie/</a> 。 简言之 Lottie 就是一个快速将 AE 中设计的动效快速调出，并且开发可以直接调用的动效库。 Lottie 的原理是将矢量图形和动态效果通过代码实现，复杂的图形导出图片资源。最终生成 json 文件+图片资源。犸良所做的就是，将 json 里的颜色属性提取出来，用户可以从外部修改。同样只需要替换图片资源，就可以让用户自己设计的图形根据 json 写好的运动方式来展示。如果你把一只移动的猪替换成猫了，那么你看到的效果就是一只移动的猫。 而它的文字编辑功能，我觉得就比较神奇了。因为 Lottie 貌似不能从外部修改字体，应该是阿里自己写的。如果有知道的同学也欢迎解惑。因为我们在实际工作中经常遇到这样的问题，就是如果动效包含文本了，需要适配国际化，就没法从外部修改语言。如果能解决这个问题，将会减少很多麻烦。 从现有的素材来看，其主要应用场景还是电商和运营方面。相信未来会增加更多的素材和应用场景。希望以后能够开放出让设计师可以将自己做的动效分享出来供大家使用，或者提供优质付费内容也是不错的选择。 就个人的工作经验来看，Lottie 还是有丰富的应用场景的。比如可以做动态图标、动态闪屏页、表情贴纸、直播礼物、空白页、动态banner…… 其实 Lottie 官方社区也有很多的动效资源，都是来自全世界的设计师上传的，大家可以去下载参考，如果要商用，可能需要联系作者。 <img src="https://img1.tuicool.com/zuuqe2R.gif" alt=""> △ 附上链接： <a href="https://lottiefiles.com/popular" target="_blank" rel="noopener">https://lottiefiles.com/popular</a> 本文资料，很多都是来自语雀的分享。再次感谢相关人员的辛勤付出。大家可以在此处查看犸良的完整介绍： <a href="https://www.yuque.com/dapolloali/news/ui43vg" target="_blank" rel="noopener">https://www.yuque.com/dapolloali/news/ui43vg</a> 。 再次附上官网： <a href="https://design.alipay.com/emotion" target="_blank" rel="noopener">https://design.alipay.com/emotion</a> 因为犸良是基于 Lottie 的工具，所以有相关基础的设计师很容易上手。还不了解的同学也可以在各大设计网站搜索到。 欢迎关注作者的微信公众号：「懿凡设计」 本文原文：<a href="https://www.uisdc.com/alibaba-emotion" target="_blank" rel="noopener">https://www.uisdc.com/alibaba-emotion</a></p>
                  </p>
                </div>
              </div>
              <div class="post-meta">
                <span class="post-meta-item">
                  <span class="post-meta-item-icon">
                    <i class="far fa-user"></i>
                  </span>
                  <span class="post-meta-item-text">作者</span>
                  <span><a href="/authors/崔庆才" class="author" itemprop="url" rel="index">崔庆才</a></span>
                </span>
                <span class="post-meta-item">
                  <span class="post-meta-item-icon">
                    <i class="far fa-calendar"></i>
                  </span>
                  <span class="post-meta-item-text">发表于</span>
                  <time title="创建时间：2019-07-08 00:43:19" itemprop="dateCreated datePublished" datetime="2019-07-08T00:43:19+08:00">2019-07-08</time>
                </span>
                <span id="/6797.html" class="post-meta-item leancloud_visitors" data-flag-title="阿里新开发了一款神器，零基础也能轻松做出酷炫动效！" title="阅读次数">
                  <span class="post-meta-item-icon">
                    <i class="fa fa-eye"></i>
                  </span>
                  <span class="post-meta-item-text">阅读次数：</span>
                  <span class="leancloud-visitors-count"></span>
                </span>
                <span class="post-meta-item" title="本文字数">
                  <span class="post-meta-item-icon">
                    <i class="far fa-file-word"></i>
                  </span>
                  <span class="post-meta-item-text">本文字数：</span>
                  <span>1.7k</span>
                </span>
                <span class="post-meta-item" title="阅读时长">
                  <span class="post-meta-item-icon">
                    <i class="far fa-clock"></i>
                  </span>
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                  <span>2 分钟</span>
                </span>
              </div>
            </article>
            <article itemscope itemtype="http://schema.org/Article" class="post-block index" lang="zh-CN">
              <link itemprop="mainEntityOfPage" href="https://cuiqingcai.com/6702.html">
              <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
                <meta itemprop="image" content="/images/avatar.png">
                <meta itemprop="name" content="崔庆才">
                <meta itemprop="description" content="崔庆才的个人站点，记录生活的瞬间，分享学习的心得。">
              </span>
              <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
                <meta itemprop="name" content="静觅">
              </span>
              <header class="post-header">
                <h2 class="post-title" itemprop="name headline">
                  <a class="label"> 个人随笔 <i class="label-arrow"></i>
                  </a>
                  <a href="/6702.html" class="post-title-link" itemprop="url">对崔庆才的个人采访记录</a>
                </h2>
              </header>
              <div class="post-body" itemprop="articleBody">
                <div class="thumb">
                  <img itemprop="contentUrl" class="random">
                </div>
                <div class="excerpt">
                  <p>
                  <p>前几天，公众号「人工智能爱好者社区」的负责人书豪对我进行了一次采访，问了我一些问题，其中有些问题确实有深度，我在此一一进行了作答，这里将其记录下来。</p>
                  <h2 id="当前觉得自己最不可替代性或最有优势的劳动价值在哪里？"><a href="#当前觉得自己最不可替代性或最有优势的劳动价值在哪里？" class="headerlink" title="当前觉得自己最不可替代性或最有优势的劳动价值在哪里？"></a>当前觉得自己最不可替代性或最有优势的劳动价值在哪里？</h2>
                  <p>有一种不断追求更优的心吧。 作为一名程序员，就拿写代码来说，比如做一个项目，我会把自己看作是负责人，以负责人的心态来做这件事情，自己主动有这份心去把这件事做好，而不是别人分配给我我做完就应付完事了。 在做项目过程中我会一直想着自己怎么实现是更优化的，如架构怎样设计扩展性更好，算法模块怎样效率更高，用户怎样使用会更方便。另外我一般会从多个角度来优化自己的项目，比如站在产品角度思考这么实现的用户体验，站在程序员角度思考更好的技术方案，站在设计角度思考布局交互。 此外就是感觉自己有点强迫症，如果某件事做不完，会一直在心里挂念着，直到把这件事完成。</p>
                  <h2 id="觉得自己最牛逼的能力是什么？"><a href="#觉得自己最牛逼的能力是什么？" class="headerlink" title="觉得自己最牛逼的能力是什么？"></a>觉得自己最牛逼的能力是什么？</h2>
                  <p>不能说是牛逼的能力，因为我觉得我并没有什么牛逼的能力。我只能说有一些习惯或特性会对完成一件事情或达成一个目标更有帮助。 比如在学习的时候我会有做记录的习惯，学习的时候我会把我理解到的东西记录下来，然后学习完毕之后会把记录和理解的知识点归纳和总结一下，在这个过程中确实会需要对整个知识点进一步的思考，确实是非常有帮助的。 另外一个或许就是自控能力吧，我不敢说自己的自控能力是多么强，因为我自己确实也有时候是什么都不想做的。不过当自己一旦开始做一件事的时候，我会控制自己不去做的无关的事情，比如编写一个程序我可能一天到晚都会专注于这件事情，在没有完成的时候总觉得心里有件事没完成，于是乎就会继续干下去，可能熬个通宵也会想把它做完 ，这可以总结为一旦开始了就不容易停下。但自己也有个缺点，就是有时候就是觉得一件事麻烦不想开始做，不容易开始。所以我也在改正这个缺点。如果做事情的时候能够容易开始、持续专注，那就更好了。 另外就是上文提到的，自己有个追求完美的心。比如做一件事的时候会想追求完美和极致，一旦某处觉得不是很切合自己的想法，我会想办法把它变得更好一点。但我也不知道这样是不是好的，因为可能有些时候会把自己搞得比较累，但是事情的结果总归是相对好一点的。</p>
                  <h2 id="工作以来，经历的困难是什么？如何面对的，是如何爬出这段艰难的处境的？"><a href="#工作以来，经历的困难是什么？如何面对的，是如何爬出这段艰难的处境的？" class="headerlink" title="工作以来，经历的困难是什么？如何面对的，是如何爬出这段艰难的处境的？"></a>工作以来，经历的困难是什么？如何面对的，是如何爬出这段艰难的处境的？</h2>
                  <p>我正式工作只有三个月，不过工作之前已经在微软实习了一年多的时间了。 我自己有个特点就是不想给别人添麻烦，即使自己的事情压得太多，承担太多，也不想给别人添什么麻烦。所以很多时候我会把一些事情扛在自己身上，也不容易去拒绝一些事情，所以之前有时候我会同时并行着非常多的事情。 比如某个同学让我帮忙做点事情，我会答应并把它加到自己的待做清单里面；然后导师、领导又同时安排了一些事情；然后同事又让我帮忙做点事情。好，我基本都会答应然后去处理，即使真的自己压的喘不过气来了，也不想去再找另外的人帮忙或者推脱掉。直到有一天，我累得生病了，发了好几天烧也不舒服，很多事情也没有完成。 有一次我去找我当时在微软的宋老师交流的时候，她告诉我了一些方法。其实我这种做法是不对的，一些事情没有必要一定会去答应和接受，并把所有的责任都扛在自己身上，一些事情要学会拒绝，并去主动和别人确定好事情的重要程度、紧急程度，以及你真的有没有必要去帮某些人做某些事情。时间是自己的，要学会合理安排自己的时间，如果遇到新来的事情，要跟对方说清楚，比如我正在忙，你的事情我可能得晚几天才能帮你。另外遇到突发的情况或者实在让自己为难的事情，就多去跟对方商量，确定下事情的紧急程度、重要程度，然后再去合理分配自己的时间。后来我尝试做出了一些改变，一些事情不再无条件强加到自己身上，并会主动与对方沟通情况以把握好处理每件事情的时机，我的心态和生活规律也就慢慢地调整过来了。</p>
                  <h2 id="你经历过的至暗时刻大致是什么样的，为什么说它是你的至暗时刻，主观能力和客观环境当时是什么样的？"><a href="#你经历过的至暗时刻大致是什么样的，为什么说它是你的至暗时刻，主观能力和客观环境当时是什么样的？" class="headerlink" title="你经历过的至暗时刻大致是什么样的，为什么说它是你的至暗时刻，主观能力和客观环境当时是什么样的？"></a>你经历过的至暗时刻大致是什么样的，为什么说它是你的至暗时刻，主观能力和客观环境当时是什么样的？</h2>
                  <p>每个人都会经历过很多挫折，并且会在经历挫折的时候由于当时的心智和世界观觉得那个挫折就是无法抵抗的“至暗时刻”，我大学时候被劈腿，高考失利，初中脑炎，甚至小学的时候摔断胳膊和食物中毒昏迷一周，都觉得那是在我能力范围内无法解决的事情了，但实际上我并没有把它们称为是”至暗时刻“。 我在遇到挫折的时候，我会想，两年之后或者十年之后，这个事情对我有没有影响。很多情况下是没有的，所以，它仅仅是我成长历程上的一个小坎，迈过去就好了。很多人在经历所谓“至暗时刻”的时候，总以为自己处在这个黑暗圆圈的最中央最无助最绝望的地方，但至暗时刻其实是一个圆环，你只需要从直径 8 走到直径 10 的地方就可以看到明天和未来，如果这么想的话，大多数的至暗时刻都不值一提了。</p>
                  <h2 id="你印象中对你影响最深刻的人是哪一位，他给了你什么样的启发和力量？"><a href="#你印象中对你影响最深刻的人是哪一位，他给了你什么样的启发和力量？" class="headerlink" title="你印象中对你影响最深刻的人是哪一位，他给了你什么样的启发和力量？"></a>你印象中对你影响最深刻的人是哪一位，他给了你什么样的启发和力量？</h2>
                  <p>我小时候其实成长条件还算不错的，父母几乎从来没有打过我骂过我，都是以鼓励的心态来培养我的，其实父母是对我影响最深刻的人，没有他们就没有我的现在。 不过除了父母以外就再提一位让我印象比较深刻的老师吧。之所以印象深刻可能就是因为他是惟一一位打过我的老师，因为人总是能对和平常状态反差强烈的事情印象最为深刻。 当时是高中上晚自习的时候，我没有好好写作业，而是拿着我的学习机在看游戏的图片，正好被老师抓到了，他把我拽出教室，狠狠地打了我的胸口两拳，当时他问过我一句话：“你知道什么是‘慎独’吗？”，我当时沉默了，他接着说：“‘慎独’就是谨慎独行，就是在别人没有监督你的时候，自己能够管住自己做正确的事情。” 从那以后，我便把这两个字一直记在心里，知道什么时候应该去做什么，当我向偷懒或者被某些事情诱惑的时候，我会尽力地控制自己。到现在为止，我个人觉得自己的自控力或专注力还算是比较强了。 真的非常感谢老师当年给我上的这一课。</p>
                  <h2 id="技术成长最快的一段时间当时面对的是什么样的环境下，为什么说这段时间成长环境最快？"><a href="#技术成长最快的一段时间当时面对的是什么样的环境下，为什么说这段时间成长环境最快？" class="headerlink" title="技术成长最快的一段时间当时面对的是什么样的环境下，为什么说这段时间成长环境最快？"></a>技术成长最快的一段时间当时面对的是什么样的环境下，为什么说这段时间成长环境最快？</h2>
                  <p>我认为不论是做什么，成长最快的时间基本上就是刚刚接触这个领域的时刻，成长的速度会慢慢地放缓。所以技术上来说，成长最快的时间可以说是我大学刚刚接触技术领域各个方向的时候了。 大学那会儿初步了解了一些编程理念之后，我加入了一个实验室，那会儿实验室分了很多方向，可以说是学校中技术方向最为全面的实验室了，包括前端、后台、安卓、iOS、美工、游戏等等，那会儿还有几个非常厉害的学长带着我们，带我们去学习和探索很多技术上的东西，那会儿就接触了 Git、Web 开发、移动开发、游戏开发，参加了非常多的比赛，做了一系列的外包，搭建自己的博客，分享自己的技术。总的来说学到了很多，真的特别感谢当时带我的几位学长，有了平台，有人带飞，的确是可以飞速成长的。</p>
                  <h2 id="未来-3-到-5-年的打算是什么？打算如何突破这个打算，量化来说，困难程度有多大？需要的运气成分有多大？"><a href="#未来-3-到-5-年的打算是什么？打算如何突破这个打算，量化来说，困难程度有多大？需要的运气成分有多大？" class="headerlink" title="未来 3 到 5 年的打算是什么？打算如何突破这个打算，量化来说，困难程度有多大？需要的运气成分有多大？"></a>未来 3 到 5 年的打算是什么？打算如何突破这个打算，量化来说，困难程度有多大？需要的运气成分有多大？</h2>
                  <p>现在我自己来看，我还是一个初出茅庐的小喽啰，不论是技术、金钱、人脉都还是比较薄弱的。我其中一个目标便是能够在生活上立稳脚跟，不为生活上的各种条件所困，娶到我的女朋友并一起过上富足快乐的日子。再长远的目标就是实现各种自由，如财务自由、时间自由。 要达成这个目标的确还是比较有挑战性的，我还需要非常的多的努力。当前初步的打算一定是努力工作，自己的主业上能够稳扎稳打，自己的主要工作必须要做好，从技术等各个层面上提升自己。另外其他的时间我会想办法累积自己的一些软实力，比如提升自己的知名度、积累自己的人脉等等。这个困难没法量化，也几乎不会靠什么运气成分，需要靠自己稳扎稳打地来一步步地做。</p>
                  <h2 id="如果有天你失业了，会如何面对这个处境，当前的危机在哪里？"><a href="#如果有天你失业了，会如何面对这个处境，当前的危机在哪里？" class="headerlink" title="如果有天你失业了，会如何面对这个处境，当前的危机在哪里？"></a>如果有天你失业了，会如何面对这个处境，当前的危机在哪里？</h2>
                  <p>其实这个对于来说倒不怕，我本是技术出身，某个时代总是会有当前时代所最流行的技术的。如果但从技术方面看话，我可以不断地去学习和输出，即使是我四十多岁了，我一样可以做一个学习者，那会儿可能拼精力比不过，但那会儿构思能力、总结能力还是不会差的，至于知识的变现，方式就太多了。 但肯定不能仅靠这个来生存，多少还是有一定的压力的。其他的副业一定也是需要发展的，比如理财、投资、写作、服务等多种形式都可以成为经济的来源。所以我个人建议不要把所有的精力都完全压在主业上，推荐适当发展一下副业。</p>
                  <h2 id="你拿到过最好的工作机会的这段经历自己是如何准备这个过程的？"><a href="#你拿到过最好的工作机会的这段经历自己是如何准备这个过程的？" class="headerlink" title="你拿到过最好的工作机会的这段经历自己是如何准备这个过程的？"></a>你拿到过最好的工作机会的这段经历自己是如何准备这个过程的？</h2>
                  <p>我拿到的最好的工作机会就是我当前选择的微软了，这边工作氛围我非常喜欢，各种待遇都算不错。 由于我当时是在微软实习，所以最后是通过转正的途径来参加面试的。转正面试我非常非常重视，在工作的同时我提前准备了面试可能问的各个方面的问题。这边面试首先要求基本的算法能力是过关的，这是一个硬性要求，如果这都写不出来可能会被直接 Pass 的，所以当时一直在刷题、看数据结构、算法题等等，确保一些 LeetCode 上面简单和中等难度的题目都能比较稳地做出来。由于我面试的岗位对算法、工程能力都比较看重，所以那会儿还准备了很多机器学习算法、熟悉了相关的机器学习模型，比如逻辑回归、SVM、BP 算法的具体推导过程。对于工程方面这个可能真的要看平时的积累了，由于我之前做过很多的工程类项目，包括网络爬虫、前端开发、后端开发、框架搭建等等，所以简历上的项目还算比较说得过去，面试的时候聊一聊其中的一些理念和架构就好了。 当时面试真的特别重视，所以准备面试的过程也是非常焦虑，整个准备时间一个多月，所以当时可以算是焦虑了一个多月吧，当时也同时在忙公司和学校的项目，可以说压力是非常大的，不过好在取得了不错的结果，得知面试结果的一刻也是舒了一口气，感谢自己曾经的努力。</p>
                  <h2 id="你觉得自己拥有什么样的缺点，这些缺点，是什么原因和经历造成的，未来的你，会选择什么样的行业和岗位进行跟进突击？"><a href="#你觉得自己拥有什么样的缺点，这些缺点，是什么原因和经历造成的，未来的你，会选择什么样的行业和岗位进行跟进突击？" class="headerlink" title="你觉得自己拥有什么样的缺点，这些缺点，是什么原因和经历造成的，未来的你，会选择什么样的行业和岗位进行跟进突击？"></a>你觉得自己拥有什么样的缺点，这些缺点，是什么原因和经历造成的，未来的你，会选择什么样的行业和岗位进行跟进突击？</h2>
                  <p>我觉得我个人有个缺点，就是挺多事情不是特别主动。这确实就是自己的性格导致的，我挺多事情并不想去麻烦别人，也不想去占用别人的时间，很多事情愿意靠自己的力量去探索去达成。 在我的成长历程上，挺多事情好像都是别人找到我，比如加好友、比如合作项目，基本都是别人找到我，然后我觉得 OK，就去答应然后做了，目前看来这并不是一件坏事，也对我的生活没有产生一些负面影响。 但是这样其实我无形中失去了一些可能我能力上能触及的更好的机会，比如结交更多朋友，合作更好的项目。所以，以后我也会去求变，去主动结实更优秀的人，去主动找寻更好的机会。 至于行业和岗位的话，我对我目前的行业和岗位是非常满意的，我在目前我的计划里面也会从事当前的行业和岗位的。</p>
                  <h2 id="对于投资风险你有什么样的理解？你如何打理自己的资金？理财策略是什么？"><a href="#对于投资风险你有什么样的理解？你如何打理自己的资金？理财策略是什么？" class="headerlink" title="对于投资风险你有什么样的理解？你如何打理自己的资金？理财策略是什么？"></a>对于投资风险你有什么样的理解？你如何打理自己的资金？理财策略是什么？</h2>
                  <p>投资会伴随着风险，这是毋庸置疑的，对于投资的回报，虽然说存在非常多的不可控因素，但风险的大小是可以通过一定的观察、计算、经验来的出来的。不同的投资和操作，其对结果的影响是不同的。 投资我通常和理财挂钩，因为广义上的大额的投资对我来说还是不现实的，目前的我是会在我现有的资金基础上进行适当的理财的。 我会把我的资产划分为四个部分。第一部分是危急时刻可以救命的，这部分是完全不能动的，就存起来，当自己危机的情况下可以取出来保证自己正常的生存的，量的大小的话就按照能满足自己正常生活一年的水平来存就好。第二部分是作为自己的固有资产来存的，比如为了自己将来买房子、车子来做准备用的，这部分基本上就是只增不减的，平时也不会动用这部分的资产。第三部分是满足自己日常花销和生活的，这部分基本上我就放在了支付宝和微信里面，平时买点东西或者正常开支来使用。最后一部分就是用来做理财的，由于我是一个相对比较保守型的，这部分占比不算多，我会拿这些钱去购买一些比较高风险高收益的基金等，观察某个情形出售，然后短期捞利收手再去出手下一个，当然赚的还不多，也有些情况下由于判断失误就亏了不少。不过这部分的盈亏我自己都是可以接受的，不会影响我的正常生活。 总的来说，我个人建议适当划分一下自己的资产及分配，然后在自己可承受的范围内适当去理财和投资。当然如果钱多的话当我什么都没有说哈。</p>
                  <h2 id="庆才是个有感情经历的人，我想问你，对于男人寻找结婚伴侣或者找女朋友，你觉得最需要对方什么样的特质，有哪些变量是必须要的，有哪些变量是可以剔除的？"><a href="#庆才是个有感情经历的人，我想问你，对于男人寻找结婚伴侣或者找女朋友，你觉得最需要对方什么样的特质，有哪些变量是必须要的，有哪些变量是可以剔除的？" class="headerlink" title="庆才是个有感情经历的人，我想问你，对于男人寻找结婚伴侣或者找女朋友，你觉得最需要对方什么样的特质，有哪些变量是必须要的，有哪些变量是可以剔除的？"></a>庆才是个有感情经历的人，我想问你，对于男人寻找结婚伴侣或者找女朋友，你觉得最需要对方什么样的特质，有哪些变量是必须要的，有哪些变量是可以剔除的？</h2>
                  <p>对于伴侣的选择，我个人觉得性格三观合得来、脾气好是非常重要的。因为性格和脾气基本上就是与生俱来的东西，这个是非常难改的。如果两个人性格上合不来，比如很多事情上处事态度不同、三观不一致，每次产生冲突的时候是会感觉非常累的，另外如果脾气上两个人都控制不好，事情可能会进一步变得艰难。 另外相貌其实也挺重要的，我不得不承认自己确实也是一个看脸的人，而且看得还蛮重的。这不仅仅是为了自己觉得开心和舒服，也有一部分会为后代考虑吧。 所以有一句名言说的好，相貌决定了你愿不愿意去了解一个人内心，而内心决定了你会不会一票否决这个人的样貌。</p>
                  <h2 id="你的第一桶金是如何获得的，是自己，还是团队一起，这件事的主观能力方面当时的难度有多大，客观上，你创造了哪些条件达成它？"><a href="#你的第一桶金是如何获得的，是自己，还是团队一起，这件事的主观能力方面当时的难度有多大，客观上，你创造了哪些条件达成它？" class="headerlink" title="你的第一桶金是如何获得的，是自己，还是团队一起，这件事的主观能力方面当时的难度有多大，客观上，你创造了哪些条件达成它？"></a>你的第一桶金是如何获得的，是自己，还是团队一起，这件事的主观能力方面当时的难度有多大，客观上，你创造了哪些条件达成它？</h2>
                  <p>第一桶金如果不论大小的话，那就是大学时候和实验室的同学一起做外包赚到的，几千到上万不等，做过不少项目，具体记不太清了。 完成这些项目，大部分是技术上的突破，当时我更多是以技术开发的身份参与到其中的，由于当时对相关的技术栈还算比较了解，所以当时并没有觉得实现难度上有多大，不过当时也非常感谢实验室和学校能提供对接的平台，让我们的技术能力得以更好地发挥。</p>
                  <h2 id="当下，你最担心什么，最害怕什么，为何会有这个恐惧，你会如何破局？"><a href="#当下，你最担心什么，最害怕什么，为何会有这个恐惧，你会如何破局？" class="headerlink" title="当下，你最担心什么，最害怕什么，为何会有这个恐惧，你会如何破局？"></a>当下，你最担心什么，最害怕什么，为何会有这个恐惧，你会如何破局？</h2>
                  <p>思来想去没想到有什么担心和害怕的，我目前对自己的生活还是比较喜欢的，另外我也对将来的生活充满信心。不过我现在并没有什么心思会考虑将来会出现什么让我担心和害怕的事，因为可能这些事情的出现都是不可预料到的吧。 所以，与其去担心这些事情，还不如着眼当下，去努力拼搏。</p>
                  <h2 id="你觉得自己在商业能力上与技术能力上，哪个更有优势，为什么？"><a href="#你觉得自己在商业能力上与技术能力上，哪个更有优势，为什么？" class="headerlink" title="你觉得自己在商业能力上与技术能力上，哪个更有优势，为什么？"></a>你觉得自己在商业能力上与技术能力上，哪个更有优势，为什么？</h2>
                  <p>现在肯定还是技术能力上更有优势，因为自己目前的定位就是技术为主的工程师，我目前赖以生存的能力就是自己的技术。商业能力上，我并没有什么经验，人脉也不算广，当然这肯定也是我想扩展的一个方向之一。</p>
                  <h2 id="平时工作中会用到哪些算法，在算法方面的能力你是如何突破的？"><a href="#平时工作中会用到哪些算法，在算法方面的能力你是如何突破的？" class="headerlink" title="平时工作中会用到哪些算法，在算法方面的能力你是如何突破的？"></a>平时工作中会用到哪些算法，在算法方面的能力你是如何突破的？</h2>
                  <p>现在工作做的事情涉及的方向比较多，包括前端、后台、机器学习、图像处理、自然语言处理等技术，爬虫是我自己的附加职责了。 算法方面，自然语言处理方向涉及较多。由于我更加专注于产品和落地，所以会更偏向于使用一些实用和更有效率的算法，保证上线和实际使用的真实效果。另外对于一些前沿的模型，可能和大多数搞科研的同学一样，我也会去搜索当前前沿的论文来看，找找开源代码，然后尝试对接实现，不断迭代调整自己的算法。</p>
                  <h2 id="你做过最成功最有成就感的一件事是什么？"><a href="#你做过最成功最有成就感的一件事是什么？" class="headerlink" title="你做过最成功最有成就感的一件事是什么？"></a>你做过最成功最有成就感的一件事是什么？</h2>
                  <p>应该就是写出来了一本爬虫相关的书籍，并帮助了很多人。 我研究爬虫时间不短了，当时图灵的王编辑找我约稿的时候我还是非常激动和欣喜的，当时正好也想借机把自己学过的爬虫知识系统地做一个梳理，写书的过程很辛苦，不过后来顺利出版了，现在销量也已经远超我的预期。 现在还有不少读者加我，说看了我的书收获很大，有的读者还是看了我的书顺利转行爬虫并找到了工作，听到这些消息，真的非常非常有成就感，希望我的书对读者有帮助。</p>
                  <h2 id="你做股票投资亏损最严重的经历是什么样的，亏损的原因可否总结？"><a href="#你做股票投资亏损最严重的经历是什么样的，亏损的原因可否总结？" class="headerlink" title="你做股票投资亏损最严重的经历是什么样的，亏损的原因可否总结？"></a>你做股票投资亏损最严重的经历是什么样的，亏损的原因可否总结？</h2>
                  <p>我没做过股票，只做过一些高风险高收益的基金投资，亏损倒不严重，都在我自己的可控范围之内。 亏损的一些原因可以稍微归结下，一个就是自己对市场的把握程度不够，有时候听别人说好，或者看着短期的势头不错就直接出手买了。另外就是自己平时工作忙，无暇分配那么多的时间来关注市场行情的变化，结果导致下次看到的时候，已经跌到没法看了。</p>
                  <h2 id="你对于人性是什么样的看法，可以结合自己的工作经历或者投资经历谈谈。"><a href="#你对于人性是什么样的看法，可以结合自己的工作经历或者投资经历谈谈。" class="headerlink" title="你对于人性是什么样的看法，可以结合自己的工作经历或者投资经历谈谈。"></a>你对于人性是什么样的看法，可以结合自己的工作经历或者投资经历谈谈。</h2>
                  <p>人性这个东西非常复杂，这个看法就太宽泛了。 体会最深的一点就是，不要试图去改变一个人，很多都是天生的，难以更改的。改变可能仅仅发生在某些重大变化和突发情况下，或者从小的教育。所以，对于我们日常生活和工作来看，一个人三观不合，或者性格不合，还是不要去修正了，这太难了。所以，我的选择是对于这样的人，少去接触、少去交流、少去合作。不过好在我现在几乎没有碰到多少难以交流和合作的人，但一旦有，我还是会持有那样的态度的。毕竟让一个自己不认可的人来浪费自己的时间是非常亏的。</p>
                  <h2 id="人生中有无数的风险，为规避人生的种种风险，你做了什么？"><a href="#人生中有无数的风险，为规避人生的种种风险，你做了什么？" class="headerlink" title="人生中有无数的风险，为规避人生的种种风险，你做了什么？"></a>人生中有无数的风险，为规避人生的种种风险，你做了什么？</h2>
                  <p>风险我主要就考虑两个方面了，一个是健康风险，一个是资金风险。 健康风险，对于我这一行，可能听得最多的就是程序员过劳猝死了。其实我也挺害怕的，有时候我也会熬夜，有时候工作强度也很大，有时候也会久坐不动。所以我会控制自己的时间，比如坐的时间长了就起来活动一下，注意波保护自己的颈椎腰椎等等，另外定期体检，看看自己身体有什么不良状况及时整治。佛祖保佑，我是不会猝死的好不好。 资金风险，这个是上文所提到的，主业技术方向，需要保持一个终身学习能力，靠自己的技术能力通过多种方式变现。另外也得注意发展一下副业，比如投资、理财、写作等等方向，并且要培养一个可以累积和增长的能力，比如写作，其水平就是慢慢累积的，而且是持续可增长的，这种就比较稳了。总之建议大家多个方向都去尝试一下，不要把鸡蛋放在同一个篮子里。</p>
                  <h2 id="你是如何追到这么优秀的女朋友的？"><a href="#你是如何追到这么优秀的女朋友的？" class="headerlink" title="你是如何追到这么优秀的女朋友的？"></a>你是如何追到这么优秀的女朋友的？</h2>
                  <p>关于这个问题我是比较困惑的啊，为什么一定是我追的不能是她追的我或者是互相喜欢呢？当然，事实上，确实算得上我“追”她，不过此追非彼追。我觉得很多人之所以觉得追女孩子困难，是因为大家追的不是这个女孩子跟自己脾气性格符合，而是追的漂亮，这样一来自然会容易觉得聊天总陷入死路，如果换个想法，只是寻找和自己脾气性格符合能够开心的在一起的（当然最好还能漂亮一点），在一起就非常顺其自然啦。所以我女朋友经常说我们之间不存在我追她或者她追我，因为两个人接触之后就觉得应该在一起啦~ 最后欢迎大家关注「崔庆才」的个人公众号「进击的Coder」 <img src="https://qiniu.cuiqingcai.com/2019-06-02-163318.jpg" alt=""></p>
                  </p>
                </div>
              </div>
              <div class="post-meta">
                <span class="post-meta-item">
                  <span class="post-meta-item-icon">
                    <i class="far fa-user"></i>
                  </span>
                  <span class="post-meta-item-text">作者</span>
                  <span><a href="/authors/崔庆才" class="author" itemprop="url" rel="index">崔庆才</a></span>
                </span>
                <span class="post-meta-item">
                  <span class="post-meta-item-icon">
                    <i class="far fa-calendar"></i>
                  </span>
                  <span class="post-meta-item-text">发表于</span>
                  <time title="创建时间：2019-07-04 19:05:12" itemprop="dateCreated datePublished" datetime="2019-07-04T19:05:12+08:00">2019-07-04</time>
                </span>
                <span id="/6702.html" class="post-meta-item leancloud_visitors" data-flag-title="对崔庆才的个人采访记录" title="阅读次数">
                  <span class="post-meta-item-icon">
                    <i class="fa fa-eye"></i>
                  </span>
                  <span class="post-meta-item-text">阅读次数：</span>
                  <span class="leancloud-visitors-count"></span>
                </span>
                <span class="post-meta-item" title="本文字数">
                  <span class="post-meta-item-icon">
                    <i class="far fa-file-word"></i>
                  </span>
                  <span class="post-meta-item-text">本文字数：</span>
                  <span>7.2k</span>
                </span>
                <span class="post-meta-item" title="阅读时长">
                  <span class="post-meta-item-icon">
                    <i class="far fa-clock"></i>
                  </span>
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                  <span>7 分钟</span>
                </span>
              </div>
            </article>
            <article itemscope itemtype="http://schema.org/Article" class="post-block index" lang="zh-CN">
              <link itemprop="mainEntityOfPage" href="https://cuiqingcai.com/6763.html">
              <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
                <meta itemprop="image" content="/images/avatar.png">
                <meta itemprop="name" content="崔庆才">
                <meta itemprop="description" content="崔庆才的个人站点，记录生活的瞬间，分享学习的心得。">
              </span>
              <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
                <meta itemprop="name" content="静觅">
              </span>
              <header class="post-header">
                <h2 class="post-title" itemprop="name headline">
                  <a class="label"> Python <i class="label-arrow"></i>
                  </a>
                  <a href="/6763.html" class="post-title-link" itemprop="url">微信公众号文章爬取之：微信自动化</a>
                </h2>
              </header>
              <div class="post-body" itemprop="articleBody">
                <div class="thumb">
                  <img itemprop="contentUrl" class="random">
                </div>
                <div class="excerpt">
                  <p>
                  <p>本文转载自：<a href="https://www.chenwenguan.com/wechat-browse-automation/" target="_blank" rel="noopener">陈文管的博客-微信公众号文章爬取之：微信自动化</a> 本文内容详细介绍微信公众号历史文章自动化浏览脚本的实现，配合服务端对公众号文章数据爬取来实现微信公众号文章数据的采集。服务端爬取实现见：<a href="https://www.chenwenguan.com/wechat-spider-server/" target="_blank" rel="noopener">微信公众号文章爬取之：服务端数据采集</a>。 背景：在团队的学习方面需要每周收集开发方面的博客文章，汇总输出每周的技术周报。周报小组成员收集的文章大多数是来自微信公众号，公众号的内容相对网页博客内容质量还是比较高的。既然数据的来源是确定的，收集汇总的流程是确定的，那么就把这个流程自动化，把人工成本降低到0。</p>
                  <h3 id="一、方案选取"><a href="#一、方案选取" class="headerlink" title="一、方案选取"></a>一、方案选取</h3>
                  <h4 id="1、数据源选取"><a href="#1、数据源选取" class="headerlink" title="1、数据源选取"></a>1、数据源选取</h4>
                  <p>主要是爬取的数据来源选取，网上资料看的较多是爬取搜狗微信的内容，但是第三方平台（包括新榜、清博等 ）的公众号文章数据更新做不到实时，而且数据也不全，还要和各种反爬措施斗智斗勇，浪费时间精力的事情划不来。最直接的方式当然是直接爬取微信公众号历史文章里面的内容。 在前期预研主要参考的资料是知乎专栏：<a href="https://zhuanlan.zhihu.com/c_65943221" target="_blank" rel="noopener">微信公众号内容的批量采集与应用</a> 。 上面的方案是借助阿里巴巴开源的<a href="http://anyproxy.io/cn/" target="_blank" rel="noopener">AnyProxy</a>工具，AnyProxy作为一个中间人在微信客户端和服务器之间的交互过程中做数据截获和转发。获取到公众号文章的实际链接地址之后转发到自己的服务器进行保存，整个数据采集的自动化程度较大取决于微信客户端的自动化浏览实现。</p>
                  <h4 id="2、自动化方案选取"><a href="#2、自动化方案选取" class="headerlink" title="2、自动化方案选取"></a>2、自动化方案选取</h4>
                  <p>如果是比较简单的安卓应用自动化操作的实现，一般直接使用AccessibilityService就行，UIAutomator也是基于AccessibilityService来实现的，但是AccessibilityService不支持WebView的操作，因为微信公众号历史文章页面是用WebView来加载的，要实现自动化必须同时支持安卓原生和WebView两个上下文环境的操作。 经过现有的几个自动化方案实现对比，最便利又具备极佳扩展性的方案就是使用<a href="http://appium.io/" target="_blank" rel="noopener">Appium</a>。</p>
                  <ul>
                    <li>Appium是开源的移动端自动化测试框架；</li>
                    <li>支持Native App、Hybird App、Web App；</li>
                    <li>支持Android、iOS、Firefox OS；</li>
                    <li>跨平台，可以在Mac，Windows以及Linux系统上；</li>
                    <li>用Appium自动化测试不需要重新编译App；</li>
                    <li>支持Java、python、ruby、C#、Objective C、PHP等主流语言;</li>
                  </ul>
                  <p>更多资料参考：<a href="https://www.cnblogs.com/zeo-to-one/p/6618611.html" target="_blank" rel="noopener">Android自动化测试框架</a></p>
                  <p><a href="https://www.chenwenguan.com/wechat-browse-automation/" target="_blank" rel="noopener"><img src="https://www.chenwenguan.com/wp-content/uploads/2018/06/wechat-gzh-spider-system.png" alt="公众号文章爬取系统架构图"></a></p>
                  <p>公众号文章爬取系统架构图</p>
                  <h3 id="二、Appium安装配置（Mac）"><a href="#二、Appium安装配置（Mac）" class="headerlink" title="二、Appium安装配置（Mac）"></a>二、Appium安装配置（Mac）</h3>
                  <p>Appium程序的安装，我这边不是使用brew命令安装的方式，直接从<a href="https://bitbucket.org/appium/appium.app/downloads/" target="_blank" rel="noopener">BitBucket</a>下载Appium安装包，也可以从<a href="https://github.com/appium/appium-desktop/releases" target="_blank" rel="noopener">Github</a>上下载。这边使用BitBucket 1.5.3版本。 Appium1.5.0之后的版本，需要在终端安装doctor，在终端输入命令：npm install -g appium-doctor，安装完毕之后，在终端输入命令：appium-doctor，查看所需的各个配置是否都已经安装配置完毕。下面是我这边在终端输出得到的结果：</p>
                  <figure class="highlight sql">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">info AppiumDoctor Appium Doctor v.1.4.3</span><br><span class="line">info AppiumDoctor <span class="comment">### Diagnostic starting ###</span></span><br><span class="line">info AppiumDoctor  ✔ The Node.js binary was found at: /Users/chenwenguan/.nvm/versions/node/v8.9.3/bin/node</span><br><span class="line">info AppiumDoctor  ✔ Node version is 8.9.3</span><br><span class="line">info AppiumDoctor  ✔ Xcode is installed at: /Library/Developer/CommandLineTools</span><br><span class="line">info AppiumDoctor  ✔ Xcode Command Line Tools are installed.</span><br><span class="line">info AppiumDoctor  ✔ DevToolsSecurity is enabled.</span><br><span class="line">info AppiumDoctor  ✔ The Authorization DB is <span class="keyword">set</span> up properly.</span><br><span class="line">WARN AppiumDoctor  ✖ Carthage was <span class="keyword">NOT</span> <span class="keyword">found</span>!</span><br><span class="line">info AppiumDoctor  ✔ HOME <span class="keyword">is</span> <span class="keyword">set</span> <span class="keyword">to</span>: /<span class="keyword">Users</span>/chenwenguan</span><br><span class="line">WARN AppiumDoctor  ✖ ANDROID_HOME <span class="keyword">is</span> <span class="keyword">NOT</span> <span class="keyword">set</span>!</span><br><span class="line">WARN AppiumDoctor  ✖ JAVA_HOME <span class="keyword">is</span> <span class="keyword">NOT</span> <span class="keyword">set</span>!</span><br><span class="line">WARN AppiumDoctor  ✖ adb could <span class="keyword">not</span> be <span class="keyword">found</span> because ANDROID_HOME <span class="keyword">is</span> <span class="keyword">NOT</span> <span class="keyword">set</span>!</span><br><span class="line">WARN AppiumDoctor  ✖ android could <span class="keyword">not</span> be <span class="keyword">found</span> because ANDROID_HOME <span class="keyword">is</span> <span class="keyword">NOT</span> <span class="keyword">set</span>!</span><br><span class="line">WARN AppiumDoctor  ✖ emulator could <span class="keyword">not</span> be <span class="keyword">found</span> because ANDROID_HOME <span class="keyword">is</span> <span class="keyword">NOT</span> <span class="keyword">set</span>!</span><br><span class="line">WARN AppiumDoctor  ✖ <span class="keyword">Bin</span> <span class="keyword">directory</span> <span class="keyword">for</span> $JAVA_HOME <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">set</span></span><br><span class="line">info AppiumDoctor <span class="comment">### Diagnostic completed, 7 fixes needed. ###</span></span><br><span class="line">info AppiumDoctor </span><br><span class="line">info AppiumDoctor <span class="comment">### Manual Fixes Needed ###</span></span><br><span class="line">info AppiumDoctor The configuration cannot be automatically <span class="keyword">fixed</span>, please <span class="keyword">do</span> the <span class="keyword">following</span> <span class="keyword">first</span>:</span><br><span class="line">WARN AppiumDoctor - Please <span class="keyword">install</span> Carthage. Visit https://github.com/Carthage/Carthage<span class="comment">#installing-carthage for more information.</span></span><br><span class="line">WARN AppiumDoctor - Manually configure ANDROID_HOME.</span><br><span class="line">WARN AppiumDoctor - Manually configure JAVA_HOME.</span><br><span class="line">WARN AppiumDoctor - Manually configure ANDROID_HOME <span class="keyword">and</span> run appium-doctor again.</span><br><span class="line">WARN AppiumDoctor - <span class="keyword">Add</span> <span class="string">'$JAVA_HOME/bin'</span> <span class="keyword">to</span> your <span class="keyword">PATH</span> environment</span><br><span class="line">info AppiumDoctor <span class="comment">###</span></span><br><span class="line">info AppiumDoctor </span><br><span class="line">info AppiumDoctor Bye! Run appium-doctor again <span class="keyword">when</span> <span class="keyword">all</span> <span class="keyword">manual</span> fixes have been applied!</span><br><span class="line">info AppiumDoctor</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>上面打叉的都是没配置好的，在终端输入命令安装Carthage ：brew install carthage</p>
                  <p>输入命令查看JDK安装路径：/usr/libexec/java_home -V</p>
                  <figure class="highlight groovy">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="number">1.8</span><span class="number">.0</span>_60, <span class="string">x86_64:</span> <span class="string">"Java SE 8"</span> <span class="regexp">/Library/</span>Java<span class="regexp">/JavaVirtualMachines/</span>jdk1<span class="number">.8</span><span class="number">.0</span>_60.jdk<span class="regexp">/Contents/</span>Home</span><br><span class="line"><span class="regexp">/Library/</span>Java<span class="regexp">/JavaVirtualMachines/</span>jdk1<span class="number">.8</span><span class="number">.0</span>_60.jdk<span class="regexp">/Contents/</span>Home</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>需要把上面的路径配置到环境变量中，ANDROID_HOME就是Android SDK的安装路径。</p>
                  <p>输入命令打开配置文件： open ~/.bash_profile，在文件中添加如下内容：</p>
                  <figure class="highlight routeros">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="builtin-name">export</span> <span class="attribute">JAVA_HOME</span>=/Library/Java/JavaVirtualMachines/jdk1.8.0_60.jdk/Contents/Home  </span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">PATH</span>=<span class="variable">$JAVA_HOME</span>/bin:$PATH  </span><br><span class="line"><span class="builtin-name">export</span> <span class="attribute">ANDROID_HOME</span>=/Users/chenwenguan/Library/Android/sdk</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>输入命令让配置立即生效：source ~/.bash_profile</p>
                  <p>更多安装配置资料可参考：<a href="http://www.cnblogs.com/zoeya/p/6022481.html" target="_blank" rel="noopener">Mac上搭建Appium环境过程以及遇到的问题</a></p>
                  <h3 id="TIPS"><a href="#TIPS" class="headerlink" title="TIPS"></a>TIPS</h3>
                  <p>在首次使用Appium时可能会出现一个错误：</p>
                  <figure class="highlight sas">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">Could <span class="meta">not</span> detect Mac OS <span class="meta">X</span> Version <span class="meta">from</span> sw_vers <span class="meta">output</span>: <span class="string">'10.13.2</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>在终端输入命令：</p>
                  <figure class="highlight gradle">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">grep</span> -rl <span class="string">"Could not detect Mac OS X Version from sw_vers output"</span> <span class="regexp">/Applications/</span>Appium.app<span class="regexp">/</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>得到如下结果：</p>
                  <figure class="highlight crystal">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">/Applications/Appium.app/<span class="regexp">/Contents/</span>Resources/node_modules/appium-support/<span class="class"><span class="keyword">lib</span>/<span class="title">system</span>.<span class="title">js</span></span></span><br><span class="line">/Applications/Appium.app/<span class="regexp">/Contents/</span>Resources/node_modules/appium-support/build/<span class="class"><span class="keyword">lib</span>/<span class="title">system</span>.<span class="title">js</span></span></span><br><span class="line">/Applications/Appium.app/<span class="regexp">/Contents/</span>Resources/node_modules/appium/node_modules/appium-support/<span class="class"><span class="keyword">lib</span>/<span class="title">system</span>.<span class="title">js</span></span></span><br><span class="line">/Applications/Appium.app/<span class="regexp">/Contents/</span>Resources/node_modules/appium/node_modules/appium-support/build/<span class="class"><span class="keyword">lib</span>/<span class="title">system</span>.<span class="title">js</span></span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>打开上面四个路径下的文件，添加当前的Appium版本参数，具体内容可参考：<a href="https://blog.csdn.net/smallHorseDaDa/article/details/72865685?locationNum=12&amp;fps=1" target="_blank" rel="noopener">在Mac OS 10.12 上安装配置appium</a></p>
                  <h3 id="三、具体代码实现"><a href="#三、具体代码实现" class="headerlink" title="三、具体代码实现"></a>三、具体代码实现</h3>
                  <p>预研资料主要参考这篇博文：<a href="https://testerhome.com/topics/6954" target="_blank" rel="noopener">Appium 微信 webview 的自动化技术</a> 自动化实现的原理就是通过ID或者模糊匹配找到相应的控件，之后对这个控件做点击、滑动等操作。如果要对微信WebView做自动化，必须能够获取到WebView里面的对象，如果是Android原生的控件可以通过AndroidStudio里面的Android Device Monitor来查看控件的id、类名等各种属性。</p>
                  <h4 id="1、Android原生控件属性参数值的获取"><a href="#1、Android原生控件属性参数值的获取" class="headerlink" title="1、Android原生控件属性参数值的获取"></a>1、Android原生控件属性参数值的获取</h4>
                  <p>在AndroidStudio打开Monitor工具：Tools-&gt;Android-&gt;Android Device Monitor 按照下图的步骤查看控件的ID等属性，后续在代码实现中会用到。</p>
                  <p><a href="https://www.chenwenguan.com/wechat-browse-automation/" target="_blank" rel="noopener"><img src="https://www.chenwenguan.com/wp-content/uploads/2018/06/android-device-monitor-1024x583.jpg" alt="Android Device Monitor"></a></p>
                  <p>Android Device Monitor</p>
                  <h4 id="2、WebView属性参数值的获取"><a href="#2、WebView属性参数值的获取" class="headerlink" title="2、WebView属性参数值的获取"></a>2、WebView属性参数值的获取</h4>
                  <p>如果是在安卓真机上，需要打开WebView的调试模式才能读取到WebView的各个属性，在微信里面可以在任意聊天窗口输入debugx5.qq.com，这是微信x5内核调试页面，在信息模块中勾选打开TBS内核Inspector调试功能。</p>
                  <p><a href="https://www.chenwenguan.com/wechat-browse-automation/" target="_blank" rel="noopener"><img src="https://www.chenwenguan.com/wp-content/uploads/2018/06/wechat-x5-debug-169x300.jpg" alt="微信X5内核调试页面"></a></p>
                  <p>微信X5内核调试页面</p>
                  <p>之后还要在真机上<strong>安装Chrome浏览器</strong>，如果是在虚拟机上无需做此操作。 接下来在Chrome浏览器中输入：<a href="chrome://inspect/">chrome://inspect</a> ，我这边使用的是虚拟机，真机上也一样，进入到公众号历史文章页面，这边就会显示相应可检视的WebView页面，点击inspect，进入到Developer Tools页面。</p>
                  <p><a href="https://www.chenwenguan.com/wechat-browse-automation/" target="_blank" rel="noopener"><img src="https://www.chenwenguan.com/wp-content/uploads/2018/06/chrome-inspect-1024x585.jpg" alt="chrome inspect页面"></a></p>
                  <p>chrome inspect页面</p>
                  <p>如果进入到Developer Tools页面显示一片空白，是因为chrome inspect需要加载 <a href="https://chrome-devtools-frontend.appspot.com" target="_blank" rel="noopener">https://chrome-devtools-frontend.appspot.com</a> 上的资源，所以需要翻墙，把appstop.com 加入翻墙代理白名单，或者直接全局应用翻墙VPN，具体可参考：<a href="https://github.com/HuarenYu/note/issues/1" target="_blank" rel="noopener">使用chrome remote debug时打开inspect时出现一片空白</a> 下面是美团技术团队历史文章列表的详细结构信息，具体的文章列表项在weui-panel-&gt;weui-panel__bd appmsg_history_container-&gt;js_profile_history_container-&gt;weui_msg_card_list路径下。</p>
                  <p><a href="https://www.chenwenguan.com/wechat-browse-automation/" target="_blank" rel="noopener"><img src="https://www.chenwenguan.com/wp-content/uploads/2018/06/chrome-inspect-developer-tools-1024x635.jpg" alt="Chrome inspect查看WebView详细内容"></a></p>
                  <p>Chrome inspect查看WebView详细内容</p>
                  <p>继续展开节点查看文章详细结构信息，这边可以看到每篇文章的ID都是以“WXAPPMSG100″开头的，类名都是“weui_media_box”开头，一开始的实现是通过模糊匹配ID来查找历史文章列表项数据，但在测试过程中出现来一个异常，后来发现，如果是纯文本类型的文章，也就是只有一段话的文章，它是没有ID的，所以不能通过ID来模糊匹配。</p>
                  <p><a href="https://www.chenwenguan.com/wechat-browse-automation/" target="_blank" rel="noopener"><img src="https://www.chenwenguan.com/wp-content/uploads/2018/06/wechat-webview-detail-1024x801.jpg" alt="公众号历史文章列表项详细结构"></a></p>
                  <p>公众号历史文章列表项详细结构</p>
                  <p>之后就把现有的四种公众号文章类型都找来出来，找它们的共性，虽然ID不一定有，但是class类型值一定有，四种类型值如下，这样就可以通过class类型值来匹配查找数据了。</p>
                  <figure class="highlight ada">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"> * weui_media_box appmsg js_appmsg : 文章</span><br><span class="line"> * weui_media_box text js_appmsg : 文本</span><br><span class="line"> * weui_media_box img js_appmsg : 图片</span><br><span class="line">* weui_media_box appmsg audio_msg_primary js_appmsg playing : 语音</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <h4 id="3、具体代码实现"><a href="#3、具体代码实现" class="headerlink" title="3、具体代码实现"></a>3、具体代码实现</h4>
                  <p>整体自动化是按照如下顺序：通讯录页面-&gt;点击公众号进入公众号列表页面-&gt;公众号列表项选择一个点击-&gt;公众号页面-&gt;公众号消息页面-&gt;点击“全部消息”进入公众号历史文章页面-&gt;根据设置的时间类型（一周之内、一个月之内、一年之内或者全部）逐个点击历史文章列表项，完毕之后返回公众号列表页面，继续下一个公众号浏览的操作；</p>
                  <h5 id="1）初始化"><a href="#1）初始化" class="headerlink" title="1）初始化"></a>1）初始化</h5>
                  <figure class="highlight reasonml">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">private</span> static AndroidDriver get<span class="constructor">Driver()</span> throws MalformedURLException &#123;</span><br><span class="line">        DesiredCapabilities capability = <span class="keyword">new</span> <span class="constructor">DesiredCapabilities()</span>;</span><br><span class="line">         capability.set<span class="constructor">Capability(<span class="string">"platformName"</span>, <span class="string">"emulator-5554"</span>)</span>;</span><br><span class="line">         capability.set<span class="constructor">Capability(<span class="string">"platformVersion"</span>, <span class="string">"4.4.4"</span>)</span>;</span><br><span class="line">         capability.set<span class="constructor">Capability(<span class="string">"deviceName"</span>, <span class="string">"MuMu"</span>)</span>;</span><br><span class="line">         <span class="comment">/**</span></span><br><span class="line"><span class="comment">          * 真机上platformName使用"Android"</span></span><br><span class="line"><span class="comment">          */</span></span><br><span class="line">         <span class="comment">/*</span></span><br><span class="line"><span class="comment">         capability.setCapability("platformName", "Android");</span></span><br><span class="line"><span class="comment">         capability.setCapability("platformVersion", "6.0");</span></span><br><span class="line"><span class="comment">         capability.setCapability("deviceName", "FRD-AL00");</span></span><br><span class="line"><span class="comment">         */</span></span><br><span class="line">         capability.set<span class="constructor">Capability(<span class="string">"unicodeKeyboard"</span>,<span class="string">"True"</span>)</span>;</span><br><span class="line">         capability.set<span class="constructor">Capability(<span class="string">"resetKeyboard"</span>,<span class="string">"True"</span>)</span>;</span><br><span class="line">         capability.set<span class="constructor">Capability(<span class="string">"app"</span>, <span class="string">""</span>)</span>;</span><br><span class="line">         capability.set<span class="constructor">Capability(<span class="string">"appPackage"</span>, <span class="string">"com.tencent.mm"</span>)</span>;</span><br><span class="line">         capability.set<span class="constructor">Capability(<span class="string">"appActivity"</span>, <span class="string">".ui.LauncherUI"</span>)</span>;</span><br><span class="line">         capability.set<span class="constructor">Capability(<span class="string">"fastReset"</span>, <span class="params">false</span>)</span>;</span><br><span class="line">         capability.set<span class="constructor">Capability(<span class="string">"fullReset"</span>, <span class="params">false</span>)</span>;</span><br><span class="line">         capability.set<span class="constructor">Capability(<span class="string">"noReset"</span>, <span class="params">true</span>)</span>;</span><br><span class="line">         capability.set<span class="constructor">Capability(<span class="string">"newCommandTimeout"</span>, 2000)</span>;</span><br><span class="line">         <span class="comment">/**</span></span><br><span class="line"><span class="comment">          * 必须加这句，否则webView和native来回切换会有问题</span></span><br><span class="line"><span class="comment">          */</span></span><br><span class="line">         capability.set<span class="constructor">Capability(<span class="string">"recreateChromeDriverSessions"</span>, <span class="params">true</span>)</span>;</span><br><span class="line">         <span class="comment">/**</span></span><br><span class="line"><span class="comment">          * 关键是加上这段</span></span><br><span class="line"><span class="comment">          */</span></span><br><span class="line">         ChromeOptions options = <span class="keyword">new</span> <span class="constructor">ChromeOptions()</span>;</span><br><span class="line">         options.set<span class="constructor">ExperimentalOption(<span class="string">"androidProcess"</span>, <span class="string">"com.tencent.mm:tools"</span>)</span>;</span><br><span class="line">         capability.set<span class="constructor">Capability(ChromeOptions.CAPABILITY, <span class="params">options</span>)</span>;</span><br><span class="line">         String url = <span class="string">"http://127.0.0.1:4723/wd/hub"</span>;</span><br><span class="line">         mDriver = <span class="keyword">new</span> AndroidDriver&lt;&gt;(<span class="keyword">new</span> <span class="constructor">URL(<span class="params">url</span>)</span>, capability);</span><br><span class="line">         return mDriver;</span><br><span class="line">     &#125;</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>如果是虚拟机则platformName使用具体的虚拟机名称，如果是真机使用“Android”，platformVersion和deviceName可以使用工程安装APK之后查看详细信息，对应的参数就是显示的系统版本和设备名称。</p>
                  <p><a href="https://www.chenwenguan.com/wechat-browse-automation/" target="_blank" rel="noopener"><img src="https://www.chenwenguan.com/wp-content/uploads/2018/06/wechat-deviceInfo-169x300.jpg" alt="设备信息"></a></p>
                  <p>设备信息</p>
                  <p>URL参数是在Appium里面设置的，确保”<a href="http://127.0.0.1:4723/wd/hub”字符串中的服务器地址和端口与Appium设置一致。" target="_blank" rel="noopener">http://127.0.0.1:4723/wd/hub”字符串中的服务器地址和端口与Appium设置一致。</a></p>
                  <p><a href="https://www.chenwenguan.com/wechat-browse-automation/" target="_blank" rel="noopener"><img src="https://www.chenwenguan.com/wp-content/uploads/2018/06/appium-setting-1024x884.jpg" alt="Appium URL参数设置"></a></p>
                  <p>Appium URL参数设置</p>
                  <h5 id="2）列表滑动和元素获取"><a href="#2）列表滑动和元素获取" class="headerlink" title="2）列表滑动和元素获取"></a>2）列表滑动和元素获取</h5>
                  <p>不管是WebView还是Android原生ListView的滑动都需要在Android原生上下文环境下操作driver.context(“NATIVE_APP”); 滑动操作都可以通过如下代码实现，通过滑动前后的PageSource对比可以知道列表是否已经滑动到底部。</p>
                  <figure class="highlight arduino">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">     <span class="comment">/**</span></span><br><span class="line"><span class="comment">      * 滑动列表加载下一页数据</span></span><br><span class="line"><span class="comment">      *</span></span><br><span class="line"><span class="comment">      * @param driver</span></span><br><span class="line"><span class="comment">      * @return</span></span><br><span class="line"><span class="comment">      * @throws InterruptedException</span></span><br><span class="line"><span class="comment">      */</span></span><br><span class="line">     <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">isScrollToBottom</span><span class="params">(AndroidDriver driver)</span> throws InterruptedException </span>&#123;</span><br><span class="line">         <span class="keyword">int</span> <span class="built_in">width</span> = driver.manage().window().getSize().<span class="built_in">width</span>;</span><br><span class="line">         <span class="keyword">int</span> <span class="built_in">height</span> = driver.manage().window().getSize().<span class="built_in">height</span>;</span><br><span class="line">         <span class="keyword">String</span> beforeswipe = driver.getPageSource();</span><br><span class="line">         driver.swipe(<span class="built_in">width</span> / <span class="number">2</span>, <span class="built_in">height</span> * <span class="number">3</span> / <span class="number">4</span>, <span class="built_in">width</span> / <span class="number">2</span>, <span class="built_in">height</span> / <span class="number">4</span>, <span class="number">1000</span>);</span><br><span class="line">         <span class="comment">/**</span></span><br><span class="line"><span class="comment">          * 设置8s超时，网络较差情况下时间过短加载不出内容</span></span><br><span class="line"><span class="comment">          */</span></span><br><span class="line">         mDriver.manage().timeouts().implicitlyWait(<span class="number">8000</span>, TimeUnit.MILLISECONDS);</span><br><span class="line">         <span class="keyword">String</span> afterswipe = driver.getPageSource();</span><br><span class="line">         <span class="comment">/**</span></span><br><span class="line"><span class="comment">          * 已经到底部</span></span><br><span class="line"><span class="comment">          */</span></span><br><span class="line">         <span class="keyword">if</span> (beforeswipe.equals(afterswipe)) &#123;</span><br><span class="line">             <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">         &#125;</span><br><span class="line">         <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">     &#125;</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p><strong>TIPS：</strong> <strong>如果是Android原生的ListView读取到的数据是在屏幕上显示的数据，超过屏幕的数据是获取不到的，如果是WebView的列表获取的数据是所有已加载的数据，不管是否在屏幕显示范围内。</strong> 获取公众号列表数据逻辑代码如下，”com.tencent.mm:id/a0y”是具体的公众号名称TextView的ID。</p>
                  <figure class="highlight abnf">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">List&lt;WebElement&gt; elementList = mDriver.findElementsById(<span class="string">"com.tencent.mm:id/a0y"</span>)<span class="comment">;</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>获取历史文章列表数据逻辑代码如下，div是节点，上面说到公众号四种类型的文章都是以’weui_media_box’类名开头的，通过模糊匹配class类名以’weui_media_box’开始的元素来过滤出所有的公众号文章列表项。</p>
                  <figure class="highlight lasso">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="built_in">List</span>&lt;WebElement&gt; msgHistory = driver.findElements(<span class="keyword">By</span>.xpath(<span class="string">"//div[starts-with(@class,'weui_media_box')]"</span>));</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <h5 id="3）元素定位方式"><a href="#3）元素定位方式" class="headerlink" title="3）元素定位方式"></a>3）元素定位方式</h5>
                  <p>如果一定需要模糊匹配就使用By.xpath()的方式，因为Android APK应用如果有增加或减少了布局字符串资源或者控件，编译之后生成的ID可能会不一样，这边说的ID是指通过Android Device Monitor查看的布局ID，不是实际的布局代码控件id，布局控件id除非命名改动，否则不会变化。所以<strong>不同版本的微信客户端生成的ID很可能会不一样</strong>，如果要批量实现自动化最好使用模糊匹配的方式，但By.xpath()方式查找定位元素是遍历页面的所有元素，会比较耗时，也容易出现异常。 在测试过程中执行</p>
                  <figure class="highlight less">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="selector-tag">driver</span><span class="selector-class">.findElement</span>(By.xpath(<span class="string">"//android.widget.ImageView[@content-desc='返回']"</span>))<span class="selector-class">.click</span>();</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>时候经常出现如下错误，改为</p>
                  <figure class="highlight less">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="selector-tag">driver</span><span class="selector-class">.findElementById</span>(<span class="string">"com.tencent.mm:id/ht"</span>)<span class="selector-class">.click</span>();</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>异常消失，猜测原因就是因为By.xpath()方法查找比较耗时导致。</p>
                  <figure class="highlight stylus">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">org<span class="selector-class">.openqa</span><span class="selector-class">.selenium</span><span class="selector-class">.WebDriverException</span>: An unknown server-side error occurred while processing the command. (WARNING: The server did not provide any stacktrace information)</span><br><span class="line"> Command duration or timeout: <span class="number">1.41</span> seconds</span><br><span class="line"> Build info: version: <span class="string">'2.44.0'</span>, revision: <span class="string">'76d78cf'</span>, <span class="selector-tag">time</span>: <span class="string">'2014-10-23 20:02:37'</span></span><br><span class="line"> System info: host: <span class="string">'wenguanchen-MacBook-Pro.local'</span>, ip: <span class="string">'30.85.214.6'</span>, os<span class="selector-class">.name</span>: <span class="string">'Mac OS X'</span>, os<span class="selector-class">.arch</span>: <span class="string">'x86_64'</span>, os<span class="selector-class">.version</span>: <span class="string">'10.13.2'</span>, java<span class="selector-class">.version</span>: <span class="string">'1.8.0_112-release'</span></span><br><span class="line"> Driver info: io<span class="selector-class">.appium</span><span class="selector-class">.java_client</span><span class="selector-class">.android</span>.AndroidDriver</span><br><span class="line"> Capabilities [&#123;appPackage=com<span class="selector-class">.tencent</span><span class="selector-class">.mm</span>, noReset=true, dontStopAppOnReset=true, deviceName=emulator-<span class="number">5554</span>, fullReset=false, platform=LINUX, deviceUDID=emulator-<span class="number">5554</span>, desired=&#123;app=, appPackage=com<span class="selector-class">.tencent</span><span class="selector-class">.mm</span>, recreateChromeDriverSessions=true, noReset=true, dontStopAppOnReset=true, deviceName=MuMu, fullReset=false, appActivity=<span class="selector-class">.ui</span><span class="selector-class">.LauncherUI</span>, platformVersion=<span class="number">4.4</span>.<span class="number">4</span>, automationName=Appium, unicodeKeyboard=true, fastReset=false, chromeOptions=&#123;args=[], extensions=[], androidProcess=com<span class="selector-class">.tencent</span><span class="selector-class">.mm</span>:tools&#125;, platformName=Android, resetKeyboard=true&#125;, platformVersion=<span class="number">4.4</span>.<span class="number">4</span>, webStorageEnabled=false, automationName=Appium, takesScreenshot=true, javascriptEnabled=true, unicodeKeyboard=true, platformName=Android, resetKeyboard=true, app=, networkConnectionEnabled=true, recreateChromeDriverSessions=true, warnings=&#123;&#125;, databaseEnabled=false, appActivity=<span class="selector-class">.ui</span><span class="selector-class">.LauncherUI</span>, locationContextEnabled=false, fastReset=false, chromeOptions=&#123;args=[], extensions=[], androidProcess=com<span class="selector-class">.tencent</span><span class="selector-class">.mm</span>:tools&#125;&#125;]</span><br><span class="line"> Session ID: <span class="number">592813</span>d6-<span class="number">7</span>c6e-<span class="number">4</span>a3c-<span class="number">8183</span>-e5f93d1d3bf0</span><br><span class="line">  at sun<span class="selector-class">.reflect</span><span class="selector-class">.NativeConstructorAccessorImpl</span>.newInstance0(Native Method)</span><br><span class="line">  at sun<span class="selector-class">.reflect</span><span class="selector-class">.NativeConstructorAccessorImpl</span>.newInstance(NativeConstructorAccessorImpl<span class="selector-class">.java</span>:<span class="number">62</span>)</span><br><span class="line">  at sun<span class="selector-class">.reflect</span><span class="selector-class">.DelegatingConstructorAccessorImpl</span>.newInstance(DelegatingConstructorAccessorImpl<span class="selector-class">.java</span>:<span class="number">45</span>)</span><br><span class="line">  at java<span class="selector-class">.lang</span><span class="selector-class">.reflect</span><span class="selector-class">.Constructor</span>.newInstance(Constructor<span class="selector-class">.java</span>:<span class="number">423</span>)</span><br><span class="line">  at org<span class="selector-class">.openqa</span><span class="selector-class">.selenium</span><span class="selector-class">.remote</span><span class="selector-class">.ErrorHandler</span>.createThrowable(ErrorHandler<span class="selector-class">.java</span>:<span class="number">204</span>)</span><br><span class="line">  at org<span class="selector-class">.openqa</span><span class="selector-class">.selenium</span><span class="selector-class">.remote</span><span class="selector-class">.ErrorHandler</span>.throwIfResponseFailed(ErrorHandler<span class="selector-class">.java</span>:<span class="number">156</span>)</span><br><span class="line">  at org<span class="selector-class">.openqa</span><span class="selector-class">.selenium</span><span class="selector-class">.remote</span><span class="selector-class">.RemoteWebDriver</span>.execute(RemoteWebDriver<span class="selector-class">.java</span>:<span class="number">599</span>)</span><br><span class="line">  at io<span class="selector-class">.appium</span><span class="selector-class">.java_client</span><span class="selector-class">.DefaultGenericMobileDriver</span>.execute(DefaultGenericMobileDriver<span class="selector-class">.java</span>:<span class="number">27</span>)</span><br><span class="line">  at io<span class="selector-class">.appium</span><span class="selector-class">.java_client</span><span class="selector-class">.AppiumDriver</span>.execute(AppiumDriver<span class="selector-class">.java</span>:<span class="number">1</span>)</span><br><span class="line">  at io<span class="selector-class">.appium</span><span class="selector-class">.java_client</span><span class="selector-class">.android</span><span class="selector-class">.AndroidDriver</span>.execute(AndroidDriver<span class="selector-class">.java</span>:<span class="number">1</span>)</span><br><span class="line">  at org<span class="selector-class">.openqa</span><span class="selector-class">.selenium</span><span class="selector-class">.remote</span><span class="selector-class">.RemoteWebDriver</span>.findElement(RemoteWebDriver<span class="selector-class">.java</span>:<span class="number">352</span>)</span><br><span class="line">  at org<span class="selector-class">.openqa</span><span class="selector-class">.selenium</span><span class="selector-class">.remote</span><span class="selector-class">.RemoteWebDriver</span>.findElementByXPath(RemoteWebDriver<span class="selector-class">.java</span>:<span class="number">449</span>)</span><br><span class="line">  at io<span class="selector-class">.appium</span><span class="selector-class">.java_client</span><span class="selector-class">.DefaultGenericMobileDriver</span>.findElementByXPath(DefaultGenericMobileDriver<span class="selector-class">.java</span>:<span class="number">99</span>)</span><br><span class="line">  at io<span class="selector-class">.appium</span><span class="selector-class">.java_client</span><span class="selector-class">.AppiumDriver</span>.findElementByXPath(AppiumDriver<span class="selector-class">.java</span>:<span class="number">1</span>)</span><br><span class="line">  at io<span class="selector-class">.appium</span><span class="selector-class">.java_client</span><span class="selector-class">.android</span><span class="selector-class">.AndroidDriver</span>.findElementByXPath(AndroidDriver<span class="selector-class">.java</span>:<span class="number">1</span>)</span><br><span class="line">  at org<span class="selector-class">.openqa</span><span class="selector-class">.selenium</span>.By<span class="variable">$ByXPath</span>.findElement(By<span class="selector-class">.java</span>:<span class="number">357</span>)</span><br><span class="line">  at org<span class="selector-class">.openqa</span><span class="selector-class">.selenium</span><span class="selector-class">.remote</span><span class="selector-class">.RemoteWebDriver</span>.findElement(RemoteWebDriver<span class="selector-class">.java</span>:<span class="number">344</span>)</span><br><span class="line">  at io<span class="selector-class">.appium</span><span class="selector-class">.java_client</span><span class="selector-class">.DefaultGenericMobileDriver</span>.findElement(DefaultGenericMobileDriver<span class="selector-class">.java</span>:<span class="number">37</span>)</span><br><span class="line">  at io<span class="selector-class">.appium</span><span class="selector-class">.java_client</span><span class="selector-class">.AppiumDriver</span>.findElement(AppiumDriver<span class="selector-class">.java</span>:<span class="number">1</span>)</span><br><span class="line">  at io<span class="selector-class">.appium</span><span class="selector-class">.java_client</span><span class="selector-class">.android</span><span class="selector-class">.AndroidDriver</span>.findElement(AndroidDriver<span class="selector-class">.java</span>:<span class="number">1</span>)</span><br><span class="line">  at com<span class="selector-class">.example</span><span class="selector-class">.AppiumAutoScan</span>.getArticleDetail(AppiumAutoScan<span class="selector-class">.java</span>:<span class="number">335</span>)</span><br><span class="line">  at com<span class="selector-class">.example</span><span class="selector-class">.AppiumAutoScan</span>.launchBrowser(AppiumAutoScan<span class="selector-class">.java</span>:<span class="number">96</span>)</span><br><span class="line">  at sun<span class="selector-class">.reflect</span><span class="selector-class">.NativeMethodAccessorImpl</span>.invoke0(Native Method)</span><br><span class="line">  at sun<span class="selector-class">.reflect</span><span class="selector-class">.NativeMethodAccessorImpl</span>.invoke(NativeMethodAccessorImpl<span class="selector-class">.java</span>:<span class="number">62</span>)</span><br><span class="line">  at sun<span class="selector-class">.reflect</span><span class="selector-class">.DelegatingMethodAccessorImpl</span>.invoke(DelegatingMethodAccessorImpl<span class="selector-class">.java</span>:<span class="number">43</span>)</span><br><span class="line">  at java<span class="selector-class">.lang</span><span class="selector-class">.reflect</span><span class="selector-class">.Method</span>.invoke(Method<span class="selector-class">.java</span>:<span class="number">498</span>)</span><br><span class="line">  at org<span class="selector-class">.junit</span><span class="selector-class">.runners</span><span class="selector-class">.model</span>.FrameworkMethod$<span class="number">1</span>.runReflectiveCall(FrameworkMethod<span class="selector-class">.java</span>:<span class="number">45</span>)</span><br><span class="line">  at org<span class="selector-class">.junit</span><span class="selector-class">.internal</span><span class="selector-class">.runners</span><span class="selector-class">.model</span><span class="selector-class">.ReflectiveCallable</span>.run(ReflectiveCallable<span class="selector-class">.java</span>:<span class="number">15</span>)</span><br><span class="line">  at org<span class="selector-class">.junit</span><span class="selector-class">.runners</span><span class="selector-class">.model</span><span class="selector-class">.FrameworkMethod</span>.invokeExplosively(FrameworkMethod<span class="selector-class">.java</span>:<span class="number">42</span>)</span><br><span class="line">  at org<span class="selector-class">.junit</span><span class="selector-class">.internal</span><span class="selector-class">.runners</span><span class="selector-class">.statements</span><span class="selector-class">.InvokeMethod</span>.evaluate(InvokeMethod<span class="selector-class">.java</span>:<span class="number">20</span>)</span><br><span class="line">  at org<span class="selector-class">.junit</span><span class="selector-class">.runners</span><span class="selector-class">.ParentRunner</span>.runLeaf(ParentRunner<span class="selector-class">.java</span>:<span class="number">263</span>)</span><br><span class="line">  at org<span class="selector-class">.junit</span><span class="selector-class">.runners</span><span class="selector-class">.BlockJUnit4ClassRunner</span>.runChild(BlockJUnit4ClassRunner<span class="selector-class">.java</span>:<span class="number">68</span>)</span><br><span class="line">  at org<span class="selector-class">.junit</span><span class="selector-class">.runners</span><span class="selector-class">.BlockJUnit4ClassRunner</span>.runChild(BlockJUnit4ClassRunner<span class="selector-class">.java</span>:<span class="number">47</span>)</span><br><span class="line">  at org<span class="selector-class">.junit</span><span class="selector-class">.runners</span>.ParentRunner$<span class="number">3</span>.run(ParentRunner<span class="selector-class">.java</span>:<span class="number">231</span>)</span><br><span class="line">  at org<span class="selector-class">.junit</span><span class="selector-class">.runners</span>.ParentRunner$<span class="number">1</span>.schedule(ParentRunner<span class="selector-class">.java</span>:<span class="number">60</span>)</span><br><span class="line">  at org<span class="selector-class">.junit</span><span class="selector-class">.runners</span><span class="selector-class">.ParentRunner</span>.runChildren(ParentRunner<span class="selector-class">.java</span>:<span class="number">229</span>)</span><br><span class="line">  at org<span class="selector-class">.junit</span><span class="selector-class">.runners</span><span class="selector-class">.ParentRunner</span>.access$<span class="number">000</span>(ParentRunner<span class="selector-class">.java</span>:<span class="number">50</span>)</span><br><span class="line">  at org<span class="selector-class">.junit</span><span class="selector-class">.runners</span>.ParentRunner$<span class="number">2</span>.evaluate(ParentRunner<span class="selector-class">.java</span>:<span class="number">222</span>)</span><br><span class="line">  at org<span class="selector-class">.junit</span><span class="selector-class">.runners</span><span class="selector-class">.ParentRunner</span>.run(ParentRunner<span class="selector-class">.java</span>:<span class="number">300</span>)</span><br><span class="line">  at org<span class="selector-class">.junit</span><span class="selector-class">.runner</span><span class="selector-class">.JUnitCore</span>.run(JUnitCore<span class="selector-class">.java</span>:<span class="number">157</span>)</span><br><span class="line">  at com<span class="selector-class">.intellij</span><span class="selector-class">.junit4</span><span class="selector-class">.JUnit4IdeaTestRunner</span>.startRunnerWithArgs(JUnit4IdeaTestRunner<span class="selector-class">.java</span>:<span class="number">117</span>)</span><br><span class="line">  at com<span class="selector-class">.intellij</span><span class="selector-class">.junit4</span><span class="selector-class">.JUnit4IdeaTestRunner</span>.startRunnerWithArgs(JUnit4IdeaTestRunner<span class="selector-class">.java</span>:<span class="number">42</span>)</span><br><span class="line">  at com<span class="selector-class">.intellij</span><span class="selector-class">.rt</span><span class="selector-class">.execution</span><span class="selector-class">.junit</span><span class="selector-class">.JUnitStarter</span>.prepareStreamsAndStart(JUnitStarter<span class="selector-class">.java</span>:<span class="number">262</span>)</span><br><span class="line">  at com<span class="selector-class">.intellij</span><span class="selector-class">.rt</span><span class="selector-class">.execution</span><span class="selector-class">.junit</span><span class="selector-class">.JUnitStarter</span>.main(JUnitStarter<span class="selector-class">.java</span>:<span class="number">84</span>)</span><br><span class="line">  at sun<span class="selector-class">.reflect</span><span class="selector-class">.NativeMethodAccessorImpl</span>.invoke0(Native Method)</span><br><span class="line">  at sun<span class="selector-class">.reflect</span><span class="selector-class">.NativeMethodAccessorImpl</span>.invoke(NativeMethodAccessorImpl<span class="selector-class">.java</span>:<span class="number">62</span>)</span><br><span class="line">  at sun<span class="selector-class">.reflect</span><span class="selector-class">.DelegatingMethodAccessorImpl</span>.invoke(DelegatingMethodAccessorImpl<span class="selector-class">.java</span>:<span class="number">43</span>)</span><br><span class="line">  at java<span class="selector-class">.lang</span><span class="selector-class">.reflect</span><span class="selector-class">.Method</span>.invoke(Method<span class="selector-class">.java</span>:<span class="number">498</span>)</span><br><span class="line">  at com<span class="selector-class">.intellij</span><span class="selector-class">.rt</span><span class="selector-class">.execution</span><span class="selector-class">.application</span><span class="selector-class">.AppMain</span>.main(AppMain<span class="selector-class">.java</span>:<span class="number">147</span>)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>如果容易出现如下异常，则是因为页面的内容还未加载完毕，可以通过</p>
                  <figure class="highlight css">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="selector-tag">mDriver</span><span class="selector-class">.manage</span>()<span class="selector-class">.timeouts</span>()<span class="selector-class">.implicitlyWait</span>(8000, <span class="selector-tag">TimeUnit</span><span class="selector-class">.MILLISECONDS</span>);</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>方法设置下超时等待时间，等待页面内容加载完毕，具体超时时间可自己调试看看设置一个合适的值。</p>
                  <figure class="highlight stylus">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">org<span class="selector-class">.openqa</span><span class="selector-class">.selenium</span><span class="selector-class">.StaleElementReferenceException</span>: stale element reference: element is not attached to the page document</span><br><span class="line">   (Session info: webview=<span class="number">33.0</span>.<span class="number">0.0</span>)</span><br><span class="line">   (Driver info: chromedriver=<span class="number">2.20</span>.<span class="number">353124</span> (<span class="number">035346203162</span>d32c80f1dce587c8154a1efa0c3b),platform=Mac OS X <span class="number">10.13</span>.<span class="number">2</span> x86_64) (WARNING: The server did not provide any stacktrace information)</span><br><span class="line"> Command duration or timeout: <span class="number">2.41</span> seconds</span><br><span class="line"> For documentation on this error, please visit: http:<span class="comment">//seleniumhq.org/exceptions/stale_element_reference.html</span></span><br><span class="line"> Build info: version: <span class="string">'2.44.0'</span>, revision: <span class="string">'76d78cf'</span>, <span class="selector-tag">time</span>: <span class="string">'2014-10-23 20:02:37'</span></span><br><span class="line"> System info: host: <span class="string">'wenguanchen-MacBook-Pro.local'</span>, ip: <span class="string">'30.85.214.81'</span>, os<span class="selector-class">.name</span>: <span class="string">'Mac OS X'</span>, os<span class="selector-class">.arch</span>: <span class="string">'x86_64'</span>, os<span class="selector-class">.version</span>: <span class="string">'10.13.2'</span>, java<span class="selector-class">.version</span>: <span class="string">'1.8.0_112-release'</span></span><br><span class="line"> Driver info: io<span class="selector-class">.appium</span><span class="selector-class">.java_client</span><span class="selector-class">.android</span>.AndroidDriver</span><br><span class="line"> Capabilities [&#123;appPackage=com<span class="selector-class">.tencent</span><span class="selector-class">.mm</span>, noReset=true, dontStopAppOnReset=true, deviceName=emulator-<span class="number">5554</span>, fullReset=false, platform=LINUX, deviceUDID=emulator-<span class="number">5554</span>, desired=&#123;app=, appPackage=com<span class="selector-class">.tencent</span><span class="selector-class">.mm</span>, recreateChromeDriverSessions=true, noReset=true, dontStopAppOnReset=true, deviceName=MuMu, fullReset=false, appActivity=<span class="selector-class">.ui</span><span class="selector-class">.LauncherUI</span>, platformVersion=<span class="number">4.4</span>.<span class="number">4</span>, automationName=Appium, unicodeKeyboard=true, fastReset=false, chromeOptions=&#123;args=[], extensions=[], androidProcess=com<span class="selector-class">.tencent</span><span class="selector-class">.mm</span>:tools&#125;, platformName=Android, resetKeyboard=true&#125;, platformVersion=<span class="number">4.4</span>.<span class="number">4</span>, webStorageEnabled=false, automationName=Appium, takesScreenshot=true, javascriptEnabled=true, unicodeKeyboard=true, platformName=Android, resetKeyboard=true, app=, networkConnectionEnabled=true, recreateChromeDriverSessions=true, warnings=&#123;&#125;, databaseEnabled=false, appActivity=<span class="selector-class">.ui</span><span class="selector-class">.LauncherUI</span>, locationContextEnabled=false, fastReset=false, chromeOptions=&#123;args=[], extensions=[], androidProcess=com<span class="selector-class">.tencent</span><span class="selector-class">.mm</span>:tools&#125;&#125;]</span><br><span class="line"> Session ID: b5e933e1-<span class="number">0</span>ddf-<span class="number">421</span>d-<span class="number">9144</span>-e423a7bb25b1</span><br><span class="line">  at sun<span class="selector-class">.reflect</span><span class="selector-class">.NativeConstructorAccessorImpl</span>.newInstance0(Native Method)</span><br><span class="line">  at sun<span class="selector-class">.reflect</span><span class="selector-class">.NativeConstructorAccessorImpl</span>.newInstance(NativeConstructorAccessorImpl<span class="selector-class">.java</span>:<span class="number">62</span>)</span><br><span class="line">  at sun<span class="selector-class">.reflect</span><span class="selector-class">.DelegatingConstructorAccessorImpl</span>.newInstance(DelegatingConstructorAccessorImpl<span class="selector-class">.java</span>:<span class="number">45</span>)</span><br><span class="line">  at java<span class="selector-class">.lang</span><span class="selector-class">.reflect</span><span class="selector-class">.Constructor</span>.newInstance(Constructor<span class="selector-class">.java</span>:<span class="number">423</span>)</span><br><span class="line">  at org<span class="selector-class">.openqa</span><span class="selector-class">.selenium</span><span class="selector-class">.remote</span><span class="selector-class">.ErrorHandler</span>.createThrowable(ErrorHandler<span class="selector-class">.java</span>:<span class="number">204</span>)</span><br><span class="line">  at org<span class="selector-class">.openqa</span><span class="selector-class">.selenium</span><span class="selector-class">.remote</span><span class="selector-class">.ErrorHandler</span>.throwIfResponseFailed(ErrorHandler<span class="selector-class">.java</span>:<span class="number">156</span>)</span><br><span class="line">  at org<span class="selector-class">.openqa</span><span class="selector-class">.selenium</span><span class="selector-class">.remote</span><span class="selector-class">.RemoteWebDriver</span>.execute(RemoteWebDriver<span class="selector-class">.java</span>:<span class="number">599</span>)</span><br><span class="line">  at io<span class="selector-class">.appium</span><span class="selector-class">.java_client</span><span class="selector-class">.DefaultGenericMobileDriver</span>.execute(DefaultGenericMobileDriver<span class="selector-class">.java</span>:<span class="number">27</span>)</span><br><span class="line">  at io<span class="selector-class">.appium</span><span class="selector-class">.java_client</span><span class="selector-class">.AppiumDriver</span>.execute(AppiumDriver<span class="selector-class">.java</span>:<span class="number">1</span>)</span><br><span class="line">  at io<span class="selector-class">.appium</span><span class="selector-class">.java_client</span><span class="selector-class">.android</span><span class="selector-class">.AndroidDriver</span>.execute(AndroidDriver<span class="selector-class">.java</span>:<span class="number">1</span>)</span><br><span class="line">  at org<span class="selector-class">.openqa</span><span class="selector-class">.selenium</span><span class="selector-class">.remote</span><span class="selector-class">.RemoteWebElement</span>.execute(RemoteWebElement<span class="selector-class">.java</span>:<span class="number">268</span>)</span><br><span class="line">  at io<span class="selector-class">.appium</span><span class="selector-class">.java_client</span><span class="selector-class">.DefaultGenericMobileElement</span>.execute(DefaultGenericMobileElement<span class="selector-class">.java</span>:<span class="number">27</span>)</span><br><span class="line">  at io<span class="selector-class">.appium</span><span class="selector-class">.java_client</span><span class="selector-class">.MobileElement</span>.execute(MobileElement<span class="selector-class">.java</span>:<span class="number">1</span>)</span><br><span class="line">  at io<span class="selector-class">.appium</span><span class="selector-class">.java_client</span><span class="selector-class">.android</span><span class="selector-class">.AndroidElement</span>.execute(AndroidElement<span class="selector-class">.java</span>:<span class="number">1</span>)</span><br><span class="line">  at org<span class="selector-class">.openqa</span><span class="selector-class">.selenium</span><span class="selector-class">.remote</span><span class="selector-class">.RemoteWebElement</span>.getText(RemoteWebElement<span class="selector-class">.java</span>:<span class="number">152</span>)</span><br><span class="line">  at com<span class="selector-class">.example</span><span class="selector-class">.AppiumAutoScan</span>.getArticleDetail(AppiumAutoScan<span class="selector-class">.java</span>:<span class="number">294</span>)</span><br><span class="line">  at com<span class="selector-class">.example</span><span class="selector-class">.AppiumAutoScan</span>.launchBrowser(AppiumAutoScan<span class="selector-class">.java</span>:<span class="number">110</span>)</span><br><span class="line">  at sun<span class="selector-class">.reflect</span><span class="selector-class">.NativeMethodAccessorImpl</span>.invoke0(Native Method)</span><br><span class="line">  at sun<span class="selector-class">.reflect</span><span class="selector-class">.NativeMethodAccessorImpl</span>.invoke(NativeMethodAccessorImpl<span class="selector-class">.java</span>:<span class="number">62</span>)</span><br><span class="line">  at sun<span class="selector-class">.reflect</span><span class="selector-class">.DelegatingMethodAccessorImpl</span>.invoke(DelegatingMethodAccessorImpl<span class="selector-class">.java</span>:<span class="number">43</span>)</span><br><span class="line">  at java<span class="selector-class">.lang</span><span class="selector-class">.reflect</span><span class="selector-class">.Method</span>.invoke(Method<span class="selector-class">.java</span>:<span class="number">498</span>)</span><br><span class="line">  at org<span class="selector-class">.junit</span><span class="selector-class">.runners</span><span class="selector-class">.model</span>.FrameworkMethod$<span class="number">1</span>.runReflectiveCall(FrameworkMethod<span class="selector-class">.java</span>:<span class="number">45</span>)</span><br><span class="line">  at org<span class="selector-class">.junit</span><span class="selector-class">.internal</span><span class="selector-class">.runners</span><span class="selector-class">.model</span><span class="selector-class">.ReflectiveCallable</span>.run(ReflectiveCallable<span class="selector-class">.java</span>:<span class="number">15</span>)</span><br><span class="line">  at org<span class="selector-class">.junit</span><span class="selector-class">.runners</span><span class="selector-class">.model</span><span class="selector-class">.FrameworkMethod</span>.invokeExplosively(FrameworkMethod<span class="selector-class">.java</span>:<span class="number">42</span>)</span><br><span class="line">  at org<span class="selector-class">.junit</span><span class="selector-class">.internal</span><span class="selector-class">.runners</span><span class="selector-class">.statements</span><span class="selector-class">.InvokeMethod</span>.evaluate(InvokeMethod<span class="selector-class">.java</span>:<span class="number">20</span>)</span><br><span class="line">  at org<span class="selector-class">.junit</span><span class="selector-class">.runners</span><span class="selector-class">.ParentRunner</span>.runLeaf(ParentRunner<span class="selector-class">.java</span>:<span class="number">263</span>)</span><br><span class="line">  at org<span class="selector-class">.junit</span><span class="selector-class">.runners</span><span class="selector-class">.BlockJUnit4ClassRunner</span>.runChild(BlockJUnit4ClassRunner<span class="selector-class">.java</span>:<span class="number">68</span>)</span><br><span class="line">  at org<span class="selector-class">.junit</span><span class="selector-class">.runners</span><span class="selector-class">.BlockJUnit4ClassRunner</span>.runChild(BlockJUnit4ClassRunner<span class="selector-class">.java</span>:<span class="number">47</span>)</span><br><span class="line">  at org<span class="selector-class">.junit</span><span class="selector-class">.runners</span>.ParentRunner$<span class="number">3</span>.run(ParentRunner<span class="selector-class">.java</span>:<span class="number">231</span>)</span><br><span class="line">  at org<span class="selector-class">.junit</span><span class="selector-class">.runners</span>.ParentRunner$<span class="number">1</span>.schedule(ParentRunner<span class="selector-class">.java</span>:<span class="number">60</span>)</span><br><span class="line">  at org<span class="selector-class">.junit</span><span class="selector-class">.runners</span><span class="selector-class">.ParentRunner</span>.runChildren(ParentRunner<span class="selector-class">.java</span>:<span class="number">229</span>)</span><br><span class="line">  at org<span class="selector-class">.junit</span><span class="selector-class">.runners</span><span class="selector-class">.ParentRunner</span>.access$<span class="number">000</span>(ParentRunner<span class="selector-class">.java</span>:<span class="number">50</span>)</span><br><span class="line">  at org<span class="selector-class">.junit</span><span class="selector-class">.runners</span>.ParentRunner$<span class="number">2</span>.evaluate(ParentRunner<span class="selector-class">.java</span>:<span class="number">222</span>)</span><br><span class="line">  at org<span class="selector-class">.junit</span><span class="selector-class">.runners</span><span class="selector-class">.ParentRunner</span>.run(ParentRunner<span class="selector-class">.java</span>:<span class="number">300</span>)</span><br><span class="line">  at org<span class="selector-class">.junit</span><span class="selector-class">.runner</span><span class="selector-class">.JUnitCore</span>.run(JUnitCore<span class="selector-class">.java</span>:<span class="number">157</span>)</span><br><span class="line">  at com<span class="selector-class">.intellij</span><span class="selector-class">.junit4</span><span class="selector-class">.JUnit4IdeaTestRunner</span>.startRunnerWithArgs(JUnit4IdeaTestRunner<span class="selector-class">.java</span>:<span class="number">117</span>)</span><br><span class="line">  at com<span class="selector-class">.intellij</span><span class="selector-class">.junit4</span><span class="selector-class">.JUnit4IdeaTestRunner</span>.startRunnerWithArgs(JUnit4IdeaTestRunner<span class="selector-class">.java</span>:<span class="number">42</span>)</span><br><span class="line">  at com<span class="selector-class">.intellij</span><span class="selector-class">.rt</span><span class="selector-class">.execution</span><span class="selector-class">.junit</span><span class="selector-class">.JUnitStarter</span>.prepareStreamsAndStart(JUnitStarter<span class="selector-class">.java</span>:<span class="number">262</span>)</span><br><span class="line">  at com<span class="selector-class">.intellij</span><span class="selector-class">.rt</span><span class="selector-class">.execution</span><span class="selector-class">.junit</span><span class="selector-class">.JUnitStarter</span>.main(JUnitStarter<span class="selector-class">.java</span>:<span class="number">84</span>)</span><br><span class="line">  at sun<span class="selector-class">.reflect</span><span class="selector-class">.NativeMethodAccessorImpl</span>.invoke0(Native Method)</span><br><span class="line">  at sun<span class="selector-class">.reflect</span><span class="selector-class">.NativeMethodAccessorImpl</span>.invoke(NativeMethodAccessorImpl<span class="selector-class">.java</span>:<span class="number">62</span>)</span><br><span class="line">  at sun<span class="selector-class">.reflect</span><span class="selector-class">.DelegatingMethodAccessorImpl</span>.invoke(DelegatingMethodAccessorImpl<span class="selector-class">.java</span>:<span class="number">43</span>)</span><br><span class="line">  at java<span class="selector-class">.lang</span><span class="selector-class">.reflect</span><span class="selector-class">.Method</span>.invoke(Method<span class="selector-class">.java</span>:<span class="number">498</span>)</span><br><span class="line">  at com<span class="selector-class">.intellij</span><span class="selector-class">.rt</span><span class="selector-class">.execution</span><span class="selector-class">.application</span><span class="selector-class">.AppMain</span>.main(AppMain<span class="selector-class">.java</span>:<span class="number">147</span>)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>更多元素定位方法可参考官网：</p>
                  <figure class="highlight markdown">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">[<span class="string">http://selenium-python.readthedocs.io/locating-elements.html#locating-by-id</span>](<span class="link">http://selenium-python.readthedocs.io/locating-elements.html#locating-by-id</span>)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <h5 id="4）chromedriver相关问题"><a href="#4）chromedriver相关问题" class="headerlink" title="4）chromedriver相关问题"></a>4）chromedriver相关问题</h5>
                  <p>在2017年6月微信热更新升级了X5内核之后，真机上切换到WebView上下文环境就出问题了，具体见这篇博文的评论<a href="https://testerhome.com/topics/6954" target="_blank" rel="noopener">Appium 微信 webview 的自动化技术</a> 和 <a href="https://testerhome.com/topics/8990" target="_blank" rel="noopener">Appium 微信小程序，driver.context (“WEBVIEW_com.tencent.mm:tools”) 切换 webview 报错</a> 看评论是通过降低chromedriver版本的方式来避免异常，但是在试过降低版本到20之后还是不行，更新到最新的版本也不行，于是放弃在真机上实现自动化，在模拟器中跑起来的速度也还可以接受。 在真机上跑的时候，切换到WebView上下文环境，程序控制台输出no such session异常，异常信息如下：</p>
                  <figure class="highlight stylus">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">org<span class="selector-class">.openqa</span><span class="selector-class">.selenium</span><span class="selector-class">.remote</span><span class="selector-class">.SessionNotFoundException</span>: no such session</span><br><span class="line">   (Driver info: chromedriver=<span class="number">2.21</span>.<span class="number">371459</span> (<span class="number">36</span>d3d07f660ff2bc1bf28a75d1cdabed0983e7c4),platform=Mac OS X <span class="number">10.13</span>.<span class="number">2</span> x86_64) (WARNING: The server did not provide any stacktrace information)</span><br><span class="line"> Command duration or timeout: <span class="number">14</span> milliseconds</span><br><span class="line"> Build info: version: <span class="string">'2.44.0'</span>, revision: <span class="string">'76d78cf'</span>, <span class="selector-tag">time</span>: <span class="string">'2014-10-23 20:02:37'</span></span><br><span class="line"> System info: host: <span class="string">'wenguanchen-MacBook-Pro.local'</span>, ip: <span class="string">'192.168.1.102'</span>, os<span class="selector-class">.name</span>: <span class="string">'Mac OS X'</span>, os<span class="selector-class">.arch</span>: <span class="string">'x86_64'</span>, os<span class="selector-class">.version</span>: <span class="string">'10.13.2'</span>, java<span class="selector-class">.version</span>: <span class="string">'1.8.0_112-release'</span></span><br><span class="line"> Driver info: io<span class="selector-class">.appium</span><span class="selector-class">.java_client</span><span class="selector-class">.android</span>.AndroidDriver</span><br><span class="line"> Capabilities [&#123;appPackage=com<span class="selector-class">.tencent</span><span class="selector-class">.mm</span>, noReset=true, dontStopAppOnReset=true, deviceName=<span class="number">55</span>CDU16C07009329, fullReset=false, platform=LINUX, deviceUDID=<span class="number">55</span>CDU16C07009329, desired=&#123;app=, appPackage=com<span class="selector-class">.tencent</span><span class="selector-class">.mm</span>, recreateChromeDriverSessions=True, noReset=true, dontStopAppOnReset=true, deviceName=FRD-AL00, fullReset=false, appActivity=<span class="selector-class">.ui</span><span class="selector-class">.LauncherUI</span>, platformVersion=<span class="number">6.0</span>, automationName=Appium, unicodeKeyboard=true, fastReset=false, chromeOptions=&#123;args=[], extensions=[], androidProcess=com<span class="selector-class">.tencent</span><span class="selector-class">.mm</span>:tools&#125;, platformName=Android, resetKeyboard=true&#125;, platformVersion=<span class="number">6.0</span>, webStorageEnabled=false, automationName=Appium, takesScreenshot=true, javascriptEnabled=true, unicodeKeyboard=true, platformName=Android, resetKeyboard=true, app=, networkConnectionEnabled=true, recreateChromeDriverSessions=True, warnings=&#123;&#125;, databaseEnabled=false, appActivity=<span class="selector-class">.ui</span><span class="selector-class">.LauncherUI</span>, locationContextEnabled=false, fastReset=false, chromeOptions=&#123;args=[], extensions=[], androidProcess=com<span class="selector-class">.tencent</span><span class="selector-class">.mm</span>:tools&#125;&#125;]</span><br><span class="line"> Session ID: e2e50190-<span class="number">398</span>b-<span class="number">4</span>fa2-bc66-db1097201e3f</span><br><span class="line">  at sun<span class="selector-class">.reflect</span><span class="selector-class">.NativeConstructorAccessorImpl</span>.newInstance0(Native Method)</span><br><span class="line">  at sun<span class="selector-class">.reflect</span><span class="selector-class">.NativeConstructorAccessorImpl</span>.newInstance(NativeConstructorAccessorImpl<span class="selector-class">.java</span>:<span class="number">62</span>)</span><br><span class="line">  at sun<span class="selector-class">.reflect</span><span class="selector-class">.DelegatingConstructorAccessorImpl</span>.newInstance(DelegatingConstructorAccessorImpl<span class="selector-class">.java</span>:<span class="number">45</span>)</span><br><span class="line">  at java<span class="selector-class">.lang</span><span class="selector-class">.reflect</span><span class="selector-class">.Constructor</span>.newInstance(Constructor<span class="selector-class">.java</span>:<span class="number">423</span>)</span><br><span class="line">  at org<span class="selector-class">.openqa</span><span class="selector-class">.selenium</span><span class="selector-class">.remote</span><span class="selector-class">.ErrorHandler</span>.createThrowable(ErrorHandler<span class="selector-class">.java</span>:<span class="number">204</span>)</span><br><span class="line">  at org<span class="selector-class">.openqa</span><span class="selector-class">.selenium</span><span class="selector-class">.remote</span><span class="selector-class">.ErrorHandler</span>.throwIfResponseFailed(ErrorHandler<span class="selector-class">.java</span>:<span class="number">162</span>)</span><br><span class="line">  at org<span class="selector-class">.openqa</span><span class="selector-class">.selenium</span><span class="selector-class">.remote</span><span class="selector-class">.RemoteWebDriver</span>.execute(RemoteWebDriver<span class="selector-class">.java</span>:<span class="number">599</span>)</span><br><span class="line">  at io<span class="selector-class">.appium</span><span class="selector-class">.java_client</span><span class="selector-class">.DefaultGenericMobileDriver</span>.execute(DefaultGenericMobileDriver<span class="selector-class">.java</span>:<span class="number">27</span>)</span><br><span class="line">  at io<span class="selector-class">.appium</span><span class="selector-class">.java_client</span><span class="selector-class">.AppiumDriver</span>.execute(AppiumDriver<span class="selector-class">.java</span>:<span class="number">272</span>)</span><br><span class="line">  at org<span class="selector-class">.openqa</span><span class="selector-class">.selenium</span><span class="selector-class">.remote</span><span class="selector-class">.RemoteWebDriver</span>.getPageSource(RemoteWebDriver<span class="selector-class">.java</span>:<span class="number">459</span>)</span><br><span class="line">  at com<span class="selector-class">.example</span><span class="selector-class">.AppiumAutoScan</span>.getArticleDetail(AppiumAutoScan<span class="selector-class">.java</span>:<span class="number">238</span>)</span><br><span class="line">  at com<span class="selector-class">.example</span><span class="selector-class">.AppiumAutoScan</span>.launchBrowser(AppiumAutoScan<span class="selector-class">.java</span>:<span class="number">78</span>)</span><br><span class="line">  at sun<span class="selector-class">.reflect</span><span class="selector-class">.NativeMethodAccessorImpl</span>.invoke0(Native Method)</span><br><span class="line">  at sun<span class="selector-class">.reflect</span><span class="selector-class">.NativeMethodAccessorImpl</span>.invoke(NativeMethodAccessorImpl<span class="selector-class">.java</span>:<span class="number">62</span>)</span><br><span class="line">  at sun<span class="selector-class">.reflect</span><span class="selector-class">.DelegatingMethodAccessorImpl</span>.invoke(DelegatingMethodAccessorImpl<span class="selector-class">.java</span>:<span class="number">43</span>)</span><br><span class="line">  at java<span class="selector-class">.lang</span><span class="selector-class">.reflect</span><span class="selector-class">.Method</span>.invoke(Method<span class="selector-class">.java</span>:<span class="number">498</span>)</span><br><span class="line">  at org<span class="selector-class">.junit</span><span class="selector-class">.runners</span><span class="selector-class">.model</span>.FrameworkMethod$<span class="number">1</span>.runReflectiveCall(FrameworkMethod<span class="selector-class">.java</span>:<span class="number">45</span>)</span><br><span class="line">  at org<span class="selector-class">.junit</span><span class="selector-class">.internal</span><span class="selector-class">.runners</span><span class="selector-class">.model</span><span class="selector-class">.ReflectiveCallable</span>.run(ReflectiveCallable<span class="selector-class">.java</span>:<span class="number">15</span>)</span><br><span class="line">  at org<span class="selector-class">.junit</span><span class="selector-class">.runners</span><span class="selector-class">.model</span><span class="selector-class">.FrameworkMethod</span>.invokeExplosively(FrameworkMethod<span class="selector-class">.java</span>:<span class="number">42</span>)</span><br><span class="line">  at org<span class="selector-class">.junit</span><span class="selector-class">.internal</span><span class="selector-class">.runners</span><span class="selector-class">.statements</span><span class="selector-class">.InvokeMethod</span>.evaluate(InvokeMethod<span class="selector-class">.java</span>:<span class="number">20</span>)</span><br><span class="line">  at org<span class="selector-class">.junit</span><span class="selector-class">.runners</span><span class="selector-class">.ParentRunner</span>.runLeaf(ParentRunner<span class="selector-class">.java</span>:<span class="number">263</span>)</span><br><span class="line">  at org<span class="selector-class">.junit</span><span class="selector-class">.runners</span><span class="selector-class">.BlockJUnit4ClassRunner</span>.runChild(BlockJUnit4ClassRunner<span class="selector-class">.java</span>:<span class="number">68</span>)</span><br><span class="line">  at org<span class="selector-class">.junit</span><span class="selector-class">.runners</span><span class="selector-class">.BlockJUnit4ClassRunner</span>.runChild(BlockJUnit4ClassRunner<span class="selector-class">.java</span>:<span class="number">47</span>)</span><br><span class="line">  at org<span class="selector-class">.junit</span><span class="selector-class">.runners</span>.ParentRunner$<span class="number">3</span>.run(ParentRunner<span class="selector-class">.java</span>:<span class="number">231</span>)</span><br><span class="line">  at org<span class="selector-class">.junit</span><span class="selector-class">.runners</span>.ParentRunner$<span class="number">1</span>.schedule(ParentRunner<span class="selector-class">.java</span>:<span class="number">60</span>)</span><br><span class="line">  at org<span class="selector-class">.junit</span><span class="selector-class">.runners</span><span class="selector-class">.ParentRunner</span>.runChildren(ParentRunner<span class="selector-class">.java</span>:<span class="number">229</span>)</span><br><span class="line">  at org<span class="selector-class">.junit</span><span class="selector-class">.runners</span><span class="selector-class">.ParentRunner</span>.access$<span class="number">000</span>(ParentRunner<span class="selector-class">.java</span>:<span class="number">50</span>)</span><br><span class="line">  at org<span class="selector-class">.junit</span><span class="selector-class">.runners</span>.ParentRunner$<span class="number">2</span>.evaluate(ParentRunner<span class="selector-class">.java</span>:<span class="number">222</span>)</span><br><span class="line">  at org<span class="selector-class">.junit</span><span class="selector-class">.runners</span><span class="selector-class">.ParentRunner</span>.run(ParentRunner<span class="selector-class">.java</span>:<span class="number">300</span>)</span><br><span class="line">  at org<span class="selector-class">.junit</span><span class="selector-class">.runner</span><span class="selector-class">.JUnitCore</span>.run(JUnitCore<span class="selector-class">.java</span>:<span class="number">157</span>)</span><br><span class="line">  at com<span class="selector-class">.intellij</span><span class="selector-class">.junit4</span><span class="selector-class">.JUnit4IdeaTestRunner</span>.startRunnerWithArgs(JUnit4IdeaTestRunner<span class="selector-class">.java</span>:<span class="number">117</span>)</span><br><span class="line">  at com<span class="selector-class">.intellij</span><span class="selector-class">.junit4</span><span class="selector-class">.JUnit4IdeaTestRunner</span>.startRunnerWithArgs(JUnit4IdeaTestRunner<span class="selector-class">.java</span>:<span class="number">42</span>)</span><br><span class="line">  at com<span class="selector-class">.intellij</span><span class="selector-class">.rt</span><span class="selector-class">.execution</span><span class="selector-class">.junit</span><span class="selector-class">.JUnitStarter</span>.prepareStreamsAndStart(JUnitStarter<span class="selector-class">.java</span>:<span class="number">262</span>)</span><br><span class="line">  at com<span class="selector-class">.intellij</span><span class="selector-class">.rt</span><span class="selector-class">.execution</span><span class="selector-class">.junit</span><span class="selector-class">.JUnitStarter</span>.main(JUnitStarter<span class="selector-class">.java</span>:<span class="number">84</span>)</span><br><span class="line">  at sun<span class="selector-class">.reflect</span><span class="selector-class">.NativeMethodAccessorImpl</span>.invoke0(Native Method)</span><br><span class="line">  at sun<span class="selector-class">.reflect</span><span class="selector-class">.NativeMethodAccessorImpl</span>.invoke(NativeMethodAccessorImpl<span class="selector-class">.java</span>:<span class="number">62</span>)</span><br><span class="line">  at sun<span class="selector-class">.reflect</span><span class="selector-class">.DelegatingMethodAccessorImpl</span>.invoke(DelegatingMethodAccessorImpl<span class="selector-class">.java</span>:<span class="number">43</span>)</span><br><span class="line">  at java<span class="selector-class">.lang</span><span class="selector-class">.reflect</span><span class="selector-class">.Method</span>.invoke(Method<span class="selector-class">.java</span>:<span class="number">498</span>)</span><br><span class="line">  at com<span class="selector-class">.intellij</span><span class="selector-class">.rt</span><span class="selector-class">.execution</span><span class="selector-class">.application</span><span class="selector-class">.AppMain</span>.main(AppMain<span class="selector-class">.java</span>:<span class="number">147</span>)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>在Appium端输出的异常信息如下：</p>
                  <figure class="highlight sql">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">[debug] [AndroidDriver] Found webviews: ["WEBVIEW_com.tencent.mm:tools","WEBVIEW_com.tencent.mm"]</span><br><span class="line">[debug] [AndroidDriver] Available contexts: ["NATIVE_APP","WEBVIEW_com.tencent.mm:tools","WEBVIEW_com.tencent.mm"]</span><br><span class="line">[debug] [AndroidDriver] Connecting to chrome-backed webview context 'WEBVIEW_com.tencent.mm:tools'</span><br><span class="line">[debug] [Chromedriver] Changed state to 'starting'</span><br><span class="line">[Chromedriver] <span class="keyword">Set</span> chromedriver <span class="built_in">binary</span> <span class="keyword">as</span>: /Applications/Appium.app/<span class="keyword">Contents</span>/Resources/node_modules/appium/node_modules/appium-android-driver/node_modules/appium-chromedriver/chromedriver/mac/chromedriver</span><br><span class="line">[Chromedriver] Killing <span class="keyword">any</span> <span class="keyword">old</span> chromedrivers, running: pkill <span class="number">-15</span> -f <span class="string">"/Applications/Appium.app/Contents/Resources/node_modules/appium/node_modules/appium-android-driver/node_modules/appium-chromedriver/chromedriver/mac/chromedriver.*--port=9515"</span></span><br><span class="line">[Chromedriver] <span class="keyword">No</span> <span class="keyword">old</span> chromedrivers seemed <span class="keyword">to</span> exist</span><br><span class="line">[Chromedriver] Spawning chromedriver <span class="keyword">with</span>: /Applications/Appium.app/<span class="keyword">Contents</span>/Resources/node_modules/appium/node_modules/appium-android-driver/node_modules/appium-chromedriver/chromedriver/mac/chromedriver <span class="comment">--url-base=wd/hub --port=9515 --adb-port=5037</span></span><br><span class="line">[Chromedriver] [STDOUT] <span class="keyword">Starting</span> ChromeDriver <span class="number">2.21</span><span class="number">.371459</span> (<span class="number">36</span>d3d07f660ff2bc1bf28a75d1cdabed0983e7c4) <span class="keyword">on</span> port <span class="number">9515</span></span><br><span class="line"><span class="keyword">Only</span> <span class="keyword">local</span> connections <span class="keyword">are</span> allowed.</span><br><span class="line">[JSONWP Proxy] Proxying [<span class="keyword">GET</span> /<span class="keyword">status</span>] <span class="keyword">to</span> [<span class="keyword">GET</span> <span class="keyword">http</span>://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">9515</span>/wd/hub/<span class="keyword">status</span>] <span class="keyword">with</span> <span class="keyword">no</span> <span class="keyword">body</span></span><br><span class="line">[Chromedriver] [STDERR] [warn] kq_init: detected broken kqueue; not using.: Undefined error: 0</span><br><span class="line">[JSONWP Proxy] Got response <span class="keyword">with</span> <span class="keyword">status</span> <span class="number">200</span>: <span class="string">"&#123;\"</span>sessionId\<span class="string">":\"</span>\<span class="string">",\"</span>stat...</span><br><span class="line">[JSONWP Proxy] Proxying [POST /<span class="keyword">session</span>] <span class="keyword">to</span> [POST <span class="keyword">http</span>://<span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">9515</span>/wd/hub/<span class="keyword">session</span>] <span class="keyword">with</span> <span class="keyword">body</span>: &#123;<span class="string">"desiredCapabilities"</span>:&#123;<span class="string">"ch...</span></span><br><span class="line"><span class="string">[JSONWP Proxy] Got response with status 200: &#123;"</span>sessionId<span class="string">":"</span><span class="number">166</span>cee263fc87...</span><br><span class="line">[debug] [Chromedriver] <span class="keyword">Changed</span> state <span class="keyword">to</span> <span class="string">'online'</span></span><br><span class="line"> [MJSONWP] Responding <span class="keyword">to</span> <span class="keyword">client</span> <span class="keyword">with</span> driver.setContext() <span class="keyword">result</span>: <span class="literal">null</span></span><br><span class="line"> [<span class="keyword">HTTP</span>] &lt;<span class="comment">-- POST /wd/hub/session/82b9d81c-f725-473d-8d55-ddbc1f92c100/context 200 903 ms - 76 </span></span><br><span class="line"> [<span class="keyword">HTTP</span>] <span class="comment">--&gt; GET /wd/hub/session/82b9d81c-f725-473d-8d55-ddbc1f92c100/context &#123;&#125;</span></span><br><span class="line"> [MJSONWP] <span class="keyword">Calling</span> AppiumDriver.getCurrentContext() <span class="keyword">with</span> args: [<span class="string">"82b9d81c-f725-473d-8d55-d...</span></span><br><span class="line"><span class="string"> [MJSONWP] Responding to client with driver.getCurrentContext() result: "</span>WEBVIEW_com.tencent.mm:tools<span class="string">"</span></span><br><span class="line"><span class="string"> [HTTP] &lt;-- GET /wd/hub/session/82b9d81c-f725-473d-8d55-ddbc1f92c100/context 200 2 ms - 102 </span></span><br><span class="line"><span class="string"> [HTTP] --&gt; GET /wd/hub/session/82b9d81c-f725-473d-8d55-ddbc1f92c100/source &#123;&#125;</span></span><br><span class="line"><span class="string"> [MJSONWP] Driver proxy active, passing request on via HTTP proxy</span></span><br><span class="line"><span class="string"> [JSONWP Proxy] Proxying [GET /wd/hub/session/82b9d81c-f725-473d-8d55-ddbc1f92c100/source] to [GET http://127.0.0.1:9515/wd/hub/session/166cee263fc8757cbcb5576a52f7229e/source] with body: &#123;&#125;</span></span><br><span class="line"><span class="string"> [JSONWP Proxy] Got response with status 200: "</span>&#123;\<span class="string">"sessionId\"</span>:\<span class="string">"166cee263...</span></span><br><span class="line"><span class="string"> [JSONWP Proxy] Replacing sessionId 166cee263fc8757cbcb5576a52f7229e with 82b9d81c-f725-473d-8d55-ddbc1f92c100</span></span><br><span class="line"><span class="string"> [HTTP] &lt;-- GET /wd/hub/session/82b9d81c-f725-473d-8d55-ddbc1f92c100/source 200 8 ms - 220</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>如果要替换chromedriver的版本，可以从Appium上输出的Log信息找到chromedriver的路径，在终端依次执行如下命令打开chromedriver所在的文件夹。</p>
                  <figure class="highlight groovy">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">cd <span class="regexp">/Applications/</span>Appium.app<span class="regexp">/Contents/</span>Resources<span class="regexp">/node_modules/</span>appium<span class="regexp">/node_modules/</span>appium-android-driver<span class="regexp">/node_modules/</span>appium-chromedriver<span class="regexp">/chromedriver/</span>mac/</span><br><span class="line">open .</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>相应的chromedriver和Chrome版本对应信息和下载地址可以参考： <a href="https://blog.csdn.net/huilan_same/article/details/51896672" target="_blank" rel="noopener">selenium之 chromedriver与chrome版本映射表</a></p>
                  <h5 id="5）程序使用的JAR包"><a href="#5）程序使用的JAR包" class="headerlink" title="5）程序使用的JAR包"></a>5）程序使用的JAR包</h5>
                  <p>自动化脚本程序要跑起来需要两个压缩包，java-client-3.1.0.jar 和 selenium-server-standalone-2.44.0.jar ，试过使用这两个JAR包的最新版本，会有一些奇奇怪怪的问题，这两个版本的JAR包够用了。 java-client-3.1.0.jar 可以从Appium官网下载：</p>
                  <figure class="highlight markdown">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">[<span class="string">http://appium.io/downloads.html</span>](<span class="link">http://appium.io/downloads.html</span>)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>selenium-server-standalone-2.44.0.jar 可以从selenium官网下载：</p>
                  <figure class="highlight markdown">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">[<span class="string">http://selenium-release.storage.googleapis.com/index.html</span>](<span class="link">http://selenium-release.storage.googleapis.com/index.html</span>)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <h5 id="6）虚拟机"><a href="#6）虚拟机" class="headerlink" title="6）虚拟机"></a>6）虚拟机</h5>
                  <p>我这边使用的是网易MuMu虚拟机，基于Android 4.4.4平台，在我自己的Mac上跑着没问题，同一个版本安装到公司的Mac上就跑不起来，一打开就崩。后面虚拟机自动升级到了Android6.0.1，脚本跑了就有异常，而且每次打开的时候经常卡死在加载页面，system so库报异常。所以最好还是基于Android4.X的版本上运行脚本，Mac上没有一个通用稳定的虚拟机，自己下几个看看是否能用，个人测试各类型的虚拟机结果如下： 1）网易MuMu：在Mac上还是比较好用的，但是最新的版本是6.0.1，初始化经常卡死，无法回退到4.4.4平台版本，脚本在Android6.0平台上切换到WebView的上下文环境异常，升级ChromeDriver版本和Appium版本也无法解决此问题。 2）GenyMotion：微信安装之后无法打开，一直闪退，页面滑动在Mac上巨难操作。 3）天天模拟器：下载的DMG安装文件根本无法打开。 4）夜神模拟器：还是比较好用的，但是Appium adb无法连上虚拟机，从Log来看一直在重启adb， 最后程序中断。 5）逍遥安卓：没有Mac版本。 6）BlueStack：无法安装，安装过程中异常退出，多次重试还是一样。 综上，如果是在Mac上运行虚拟机，目前测试有效的是网易MuMu 基于Android 4.4.4 平台的版本，其他版本和虚拟机都有各种问题。 另：附上Android WebView 历史版本下载地址（需要翻墙）：</p>
                  <figure class="highlight markdown">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">[<span class="string">https://cn.apkhere.com/app/com.google.android.webview</span>](<span class="link">https://cn.apkhere.com/app/com.google.android.webview</span>)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>WebView 和对应的ChromeDriver版本见Appium GitHub chromedriver说明文档：</p>
                  <figure class="highlight awk">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">[https:<span class="regexp">//gi</span>thub.com<span class="regexp">/appium/</span>appium<span class="regexp">/blob/m</span>aster<span class="regexp">/docs/</span>en<span class="regexp">/writing-running-appium/</span>web<span class="regexp">/chromedriver.md](https:/</span><span class="regexp">/github.com/</span>appium<span class="regexp">/appium/</span>blob<span class="regexp">/master/</span>docs<span class="regexp">/en/</span>writing-running-appium<span class="regexp">/web/</span>chromedriver.md)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <h5 id="7）编译IDE"><a href="#7）编译IDE" class="headerlink" title="7）编译IDE"></a>7）编译IDE</h5>
                  <p>不做Android开发的可以下载Eclipse IDE，在Eclipse下运行Java程序还比较方便，拷贝工程源码中的三份文件即可</p>
                  <figure class="highlight angelscript">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">java-client<span class="number">-3.1</span><span class="number">.0</span>.jar </span><br><span class="line">selenium-server-standalone<span class="number">-2.44</span><span class="number">.0</span>.jar  </span><br><span class="line">AppiumWeChatAuto/appiumauto/src/main/java/com/example/AppiumAutoScan.java</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>Eclipse IDE下载地址：</p>
                  <figure class="highlight markdown">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">[<span class="string">http://www.eclipse.org/downloads/packages/</span>](<span class="link">http://www.eclipse.org/downloads/packages/</span>)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>Java版本和对应的Eclipse IDE版本参考：</p>
                  <figure class="highlight markdown">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">[<span class="string">http://wiki.eclipse.org/Eclipse/Installation</span>](<span class="link">http://wiki.eclipse.org/Eclipse/Installation</span>)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <h5 id="8）GitHub工程源码"><a href="#8）GitHub工程源码" class="headerlink" title="8）GitHub工程源码"></a>8）GitHub工程源码</h5>
                  <p><strong>源码GitHub地址：</strong></p>
                  <figure class="highlight markdown">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">[<span class="string">https://github.com/wenguan0927/AppiumWeChatAuto</span>](<span class="link">https://github.com/wenguan0927/AppiumWeChatAuto</span>)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>运行Android工程查看设备信息的时候Edit Configurations切换到app，运行自动化脚本的时候切换到AppiumAutoScan。支持按最近一周，一个月，一年或爬取所有历史文章，checkTimeLimit()传入不同限制时间类型的参数即可。</p>
                  <h3 id="四、参考资料"><a href="#四、参考资料" class="headerlink" title="四、参考资料"></a>四、参考资料</h3>
                  <p>Appium 官方文档：<a href="http://appium.io/docs/cn/about-appium/intro/" target="_blank" rel="noopener">http://appium.io/docs/cn/about-appium/intro/</a></p>
                  <p><a href="https://www.cnblogs.com/7chentest/p/6396551.html" target="_blank" rel="noopener">Appium 常用API</a></p>
                  <p><a href="https://blog.csdn.net/qq_19636353/article/details/53731254" target="_blank" rel="noopener">Appium自动化测试–使用Chrome调试模式获取App混合应用H5界面元素</a></p>
                  <p><a href="https://testerhome.com/topics/6954" target="_blank" rel="noopener">Appium 微信 webview 的自动化技术</a></p>
                  <p><a href="https://anikikun.gitbooks.io/appium-girls-tutorial/content/index.html" target="_blank" rel="noopener">Appium Girls 学习手册</a></p>
                  <p><a href="https://cloud.tencent.com/developer/article/1007014" target="_blank" rel="noopener">Appium：轻松玩转app+webview混合应用自动化测试</a></p>
                  <p><a href="https://testerhome.com/topics/8990" target="_blank" rel="noopener">Appium 微信小程序，driver.context (“WEBVIEW_com.tencent.mm:tools”) 切换 webview 报错</a></p>
                  <p><a href="https://blog.csdn.net/TalorSwfit20111208/article/details/71050135" target="_blank" rel="noopener">Appium 事件监听</a></p>
                  <p><a href="https://juejin.im/post/5acb49126fb9a028cc6186f1" target="_blank" rel="noopener">妙用AccessibilityService黑科技实现微信自动加好友拉人进群聊</a></p>
                  <p><a href="https://blog.csdn.net/damnivictory/article/details/54629305" target="_blank" rel="noopener">Appium自动化测试Android</a></p>
                  <p><a href="https://my.oschina.net/outcat/blog/491529?p=2" target="_blank" rel="noopener">Windows下部署Appium教程（Android App自动化测试框架搭建）</a></p>
                  <p><a href="http://bbs.mb.qq.com/thread-243399-1-1.html" target="_blank" rel="noopener">微信、手Q、Qzone之x5内核inspect调试解决方案</a></p>
                  <p><a href="https://blog.csdn.net/huilan_same/article/details/51896672" target="_blank" rel="noopener">selenium之 chromedriver与chrome版本映射表</a></p>
                  <p><a href="https://blog.csdn.net/smallHorseDaDa/article/details/72865685?locationNum=12&amp;fps=1" target="_blank" rel="noopener">（Android开发自测）在Mac OS 10.12 上安装配置appium</a></p>
                  <p><a href="https://www.jianshu.com/p/ef01ce654302" target="_blank" rel="noopener">辅助功能 AccessibilityService笔记</a></p>
                  </p>
                </div>
              </div>
              <div class="post-meta">
                <span class="post-meta-item">
                  <span class="post-meta-item-icon">
                    <i class="far fa-user"></i>
                  </span>
                  <span class="post-meta-item-text">作者</span>
                  <span><a href="/authors/崔庆才" class="author" itemprop="url" rel="index">崔庆才</a></span>
                </span>
                <span class="post-meta-item">
                  <span class="post-meta-item-icon">
                    <i class="far fa-calendar"></i>
                  </span>
                  <span class="post-meta-item-text">发表于</span>
                  <time title="创建时间：2019-07-02 11:08:21" itemprop="dateCreated datePublished" datetime="2019-07-02T11:08:21+08:00">2019-07-02</time>
                </span>
                <span id="/6763.html" class="post-meta-item leancloud_visitors" data-flag-title="微信公众号文章爬取之：微信自动化" title="阅读次数">
                  <span class="post-meta-item-icon">
                    <i class="fa fa-eye"></i>
                  </span>
                  <span class="post-meta-item-text">阅读次数：</span>
                  <span class="leancloud-visitors-count"></span>
                </span>
                <span class="post-meta-item" title="本文字数">
                  <span class="post-meta-item-icon">
                    <i class="far fa-file-word"></i>
                  </span>
                  <span class="post-meta-item-text">本文字数：</span>
                  <span>30k</span>
                </span>
                <span class="post-meta-item" title="阅读时长">
                  <span class="post-meta-item-icon">
                    <i class="far fa-clock"></i>
                  </span>
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                  <span>28 分钟</span>
                </span>
              </div>
            </article>
            <article itemscope itemtype="http://schema.org/Article" class="post-block index" lang="zh-CN">
              <link itemprop="mainEntityOfPage" href="https://cuiqingcai.com/6761.html">
              <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
                <meta itemprop="image" content="/images/avatar.png">
                <meta itemprop="name" content="崔庆才">
                <meta itemprop="description" content="崔庆才的个人站点，记录生活的瞬间，分享学习的心得。">
              </span>
              <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
                <meta itemprop="name" content="静觅">
              </span>
              <header class="post-header">
                <h2 class="post-title" itemprop="name headline">
                  <a class="label"> Python <i class="label-arrow"></i>
                  </a>
                  <a href="/6761.html" class="post-title-link" itemprop="url">微信公众号文章爬取之：服务端数据采集</a>
                </h2>
              </header>
              <div class="post-body" itemprop="articleBody">
                <div class="thumb">
                  <img itemprop="contentUrl" class="random">
                </div>
                <div class="excerpt">
                  <p>
                  <p>本文转载自：<a href="https://www.chenwenguan.com/wechat-spider-server/" target="_blank" rel="noopener">陈文管的博客-微信公众号文章爬取之：服务端数据采集</a> 本篇内容介绍微信公众号文章服务端数据爬取的实现，配合上一篇<a href="https://www.chenwenguan.com/wechat-browse-automation/" target="_blank" rel="noopener">微信公众号文章采集之：微信自动化</a>，构成完整的微信公众号文章数据采集系统。</p>
                  <p><a href="https://www.chenwenguan.com/wechat-spider-server/" target="_blank" rel="noopener"><img src="https://www.chenwenguan.com/wp-content/uploads/2018/06/wechat-gzh-spider-system.png" alt="公众号文章爬取系统架构图"></a></p>
                  <p>公众号文章爬取系统架构图</p>
                  <h3 id="一、AnyProxy-配置（Mac）"><a href="#一、AnyProxy-配置（Mac）" class="headerlink" title="一、AnyProxy 配置（Mac）"></a>一、AnyProxy 配置（Mac）</h3>
                  <p>AnyProxy是一个开放式的HTTP代理服务器，官方文档：<a href="http://anyproxy.io/cn/" target="_blank" rel="noopener">http://anyproxy.io/cn/</a> Github主页：<a href="https://github.com/alibaba/anyproxy" target="_blank" rel="noopener">https://github.com/alibaba/anyproxy</a> 主要特性包括： 基于Node.js，开放二次开发能力，允许自定义请求处理逻辑 支持Https的解析 提供GUI界面，用以观察请求</p>
                  <h4 id="1、安装NodeJS"><a href="#1、安装NodeJS" class="headerlink" title="1、安装NodeJS"></a>1、安装NodeJS</h4>
                  <p>在安装Anyproxy之前，需要先安装Nodejs。Nodejs下载地址：<a href="http://nodejs.cn/download/" target="_blank" rel="noopener">http://nodejs.cn/download/</a>。 下载安装完之后可以在终端执行以下命令查看所安装的版本：</p>
                  <figure class="highlight crmsh">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"> <span class="keyword">node</span> <span class="title">--version</span>       查看<span class="keyword">node</span><span class="title">安装版本</span></span><br><span class="line"><span class="title">npm</span> -v               查看npm安装版本</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <h4 id="2、AnyProxy安装配置"><a href="#2、AnyProxy安装配置" class="headerlink" title="2、AnyProxy安装配置"></a>2、AnyProxy安装配置</h4>
                  <h5 id="1-Mac端的安装配置"><a href="#1-Mac端的安装配置" class="headerlink" title="1) Mac端的安装配置"></a>1) Mac端的安装配置</h5>
                  <p>AnyProxy 不要安装最新的版本，因为接口变动较大，不便于在原来的基础上重写接口，如果已经安装最新的版本，先执行以下命令卸载：</p>
                  <figure class="highlight coffeescript">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">sudo <span class="built_in">npm</span> uninstall -g anyproxy</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>之后安装3.X版本：</p>
                  <figure class="highlight angelscript">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">sudo npm install  <span class="symbol">anyproxy@</span><span class="number">3.</span>x  -g</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>接着安装相应的证书：</p>
                  <figure class="highlight ada">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">anyproxy <span class="comment">--root</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <h5 id="2-AnyProxy-rule-default-js-文件的配置"><a href="#2-AnyProxy-rule-default-js-文件的配置" class="headerlink" title="2) AnyProxy rule_default.js 文件的配置"></a>2) AnyProxy rule_default.js 文件的配置</h5>
                  <p>直接拷贝如下的配置覆盖AnyProxy rule_default.js配置文件即可，具体可参考知乎大神的文章：<a href="https://zhuanlan.zhihu.com/c_65943221" target="_blank" rel="noopener">微信公众号内容的批量采集与应用</a> ，其中关于图片的优化，配置的fs.readFileSync()参数替换成自己的图片放置路径。将公众号里面的所有图片替换成本地图片的目的是减轻网络传输压力和浏览器占用的内存，有效的提高运行效率，可以自己制作一张1×1像素的png透明图片。 这边跟知乎文章不同的是，在replaceServerResDataAsync中只需要把拦截的微信文章URL地址转发到自己的服务器，因为自动化浏览脚本是直接进入到公众号文章的详情页面，就不需要像知乎文章介绍的那样那么麻烦。 TIPS： 在2019.5.6-2019.5.12时间段之间，微信公众号更新了公众号文章的请求加载方式。 在replaceServerResDataAsync接口中拦截URL的方式已经行不通， 通过AnyProxy拦截的URL参数可以看到已经没有了”/s?__biz=”开头的URL， 但是从</p>
                  <figure class="highlight awk">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">“<span class="regexp">/mp/g</span>etappmsgext?”和“<span class="regexp">/mp/g</span>etappmsgad?“</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>开头的请求链接点击进去还是可以看到文章的请求链接地址。 如果是2019.5.12号之前的时间点，拦截URL接口在replaceServerResDataAsync，对应的AnyProxy rule_default.js配置文件为：<a href="https://github.com/wenguan0927/WechatSpider/blob/master/rule_default_js/rule_default_before20190512.js" target="_blank" rel="noopener">rule_default_before20190512.js</a> 在2019.5.12号之后的时间点，拦截URL的接口变动到shouldUseLocalResponse : function(req,reqBody)，只要把request body发送到后台服务器，再加上”<a href="https://mp.weixin.qq.com/s?”前缀进行拼接就行，对应的AnyProxy" target="_blank" rel="noopener">https://mp.weixin.qq.com/s?”前缀进行拼接就行，对应的AnyProxy</a> rule_default.js配置文件应该改为：<a href="https://github.com/wenguan0927/WechatSpider/blob/master/rule_default_js/rule_default_after20190512.js" target="_blank" rel="noopener">rule_default_after20190512.js</a> 如果忘记了AnyProxy的安装路径，用命令查找rule_default.js文件即可：</p>
                  <figure class="highlight nginx">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="attribute">find</span> <span class="regexp">~ -iname</span> <span class="string">"rule_default.js"</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <h5 id="3）AnyProxy启动"><a href="#3）AnyProxy启动" class="headerlink" title="3）AnyProxy启动"></a>3）AnyProxy启动</h5>
                  <p>在终端执行命令启动AnyProxy：</p>
                  <figure class="highlight ebnf">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="attribute">anyproxy -i</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>如果遇到如下的异常说明缺少写文件夹的权限：</p>
                  <figure class="highlight crystal">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">the default rule <span class="keyword">for</span> AnyProxy.</span><br><span class="line">Anyproxy rules initialize finished, have <span class="function"><span class="keyword">fun</span>!</span></span><br><span class="line"><span class="function"><span class="title">The</span></span> WebSocket will not work properly in the https intercept mode :(</span><br><span class="line">fs.<span class="symbol">js:</span><span class="number">885</span></span><br><span class="line">  <span class="keyword">return</span> binding.mkdir(pathModule._makeLong(path),</span><br><span class="line">                 ^</span><br><span class="line"><span class="symbol">Error:</span> <span class="symbol">EACCES:</span> permission denied, mkdir <span class="string">'/Users/chenwenguan/.anyproxy/cache_r929590'</span></span><br><span class="line">     at Object.fs.mkdirSync (fs.<span class="symbol">js:</span><span class="number">885</span>:<span class="number">18</span>)</span><br><span class="line">     at Object<span class="class">.<span class="keyword">module</span>.<span class="title">exports</span>.<span class="title">generateCacheDir</span> (/<span class="title">Users</span>/<span class="title">chenwenguan</span>/.<span class="title">nvm</span>/<span class="title">versions</span>/<span class="title">node</span>/<span class="title">v8</span>.9.3/<span class="title">lib</span>/<span class="title">node_modules</span>/<span class="title">anyproxy</span>/<span class="title">lib</span>/<span class="title">util</span>.<span class="title">js</span>:54:8)</span></span><br><span class="line">     at new Recorder (<span class="regexp">/Users/chenwenguan</span><span class="regexp">/.nvm/versions</span><span class="regexp">/node/v</span>8.<span class="number">9.3</span>/<span class="class"><span class="keyword">lib</span>/<span class="title">node_modules</span>/<span class="title">anyproxy</span>/<span class="title">lib</span>/<span class="title">recorder</span>.<span class="title">js</span>:16:31)</span></span><br><span class="line">     at /Users/chenwenguan/.nvm/versions/node/v8.<span class="number">9.3</span>/<span class="class"><span class="keyword">lib</span>/<span class="title">node_modules</span>/<span class="title">anyproxy</span>/<span class="title">proxy</span>.<span class="title">js</span>:116:43</span></span><br><span class="line">     at ChildProcess.exithandler (child_process.<span class="symbol">js:</span><span class="number">282</span>:<span class="number">5</span>)</span><br><span class="line">     at emitTwo (events.<span class="symbol">js:</span><span class="number">126</span>:<span class="number">13</span>)</span><br><span class="line">     at ChildProcess.emit (events.<span class="symbol">js:</span><span class="number">214</span>:<span class="number">7</span>)</span><br><span class="line">     at maybeClose (internal/child_process.<span class="symbol">js:</span><span class="number">925</span>:<span class="number">16</span>)</span><br><span class="line">     at Socket.stream.socket.on (internal/child_process.<span class="symbol">js:</span><span class="number">346</span>:<span class="number">11</span>)</span><br><span class="line">    at emitOne (events.<span class="symbol">js:</span><span class="number">116</span>:<span class="number">13</span>)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>用以下命令修改下文件夹权限即可：</p>
                  <figure class="highlight autohotkey">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">sudo chown -R `whoami` /Users/chenwenguan/.anyproxy</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <h5 id="4）Android虚拟机上的配置"><a href="#4）Android虚拟机上的配置" class="headerlink" title="4）Android虚拟机上的配置"></a>4）Android虚拟机上的配置</h5>
                  <p>AnyProxy启动完成后，访问GUI地址：<a href="http://192.168.1.101:8002/" target="_blank" rel="noopener">http://192.168.1.101:8002</a></p>
                  <p><a href="https://www.chenwenguan.com/wechat-spider-server/" target="_blank" rel="noopener"><img src="https://www.chenwenguan.com/wp-content/uploads/2018/10/anyproxy-download-rootca-1024x168.png" alt="下载AnyProxy证书文件"></a></p>
                  <p>下载AnyProxy证书文件</p>
                  <p>点击下载rootCA.crt文件，可以在虚拟机SD卡根目录下新建一个rootCA文件夹，把文件用adb命令的方式Push到虚拟机的sdcard目录下：</p>
                  <figure class="highlight gradle">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">adb <span class="keyword">push</span> rootCA.crt <span class="regexp">/sdcard/</span>rootCA<span class="regexp">/</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>之后进入Android虚拟机系统设置界面，进入安全设置项，选择从SD卡安装（从SD卡安装证书）设置项，选择Push到sd卡下的证书文件安装，如果没有做这个操作，在微信加载WebView的时候会不断地弹出警告弹窗。 如果没有在模拟器找到系统设置或WI-FI网络设置的入口，可用adb命令调用进入，直接进入网络设置页面命令如下：</p>
                  <figure class="highlight stylus">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">adb shell am start -<span class="selector-tag">a</span> android<span class="selector-class">.intent</span><span class="selector-class">.action</span><span class="selector-class">.MAIN</span> -n com<span class="selector-class">.android</span>.settings/<span class="selector-class">.wifi</span>.WifiSettings</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>进入模拟器系统设置页面命令：</p>
                  <figure class="highlight vim">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">adb <span class="keyword">shell</span> <span class="keyword">am</span> start <span class="keyword">com</span>.android.settings/<span class="keyword">com</span>.android.settings.Settings</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>在Android模拟器上还要设置网络代理，长按WIFI网络设置项，弹窗选择修改网络选项，IP地址就写电脑的IP，端口填8001。</p>
                  <p><a href="https://www.chenwenguan.com/wechat-spider-server/" target="_blank" rel="noopener"><img src="https://www.chenwenguan.com/wp-content/uploads/2018/10/android-device-monitor-network-proxy-1024x646.png" alt="安卓虚拟机网络代理设置"></a></p>
                  <p>安卓虚拟机网络代理设置</p>
                  <p>在以上都配置完毕之后，进入微信应用查看公众号文章，就可以在GUI界面上看到AnyProxy拦截到的所有请求URL地址信息。 如文章前面的说明，在2019.5.12时间点之前还可以看到”/s?__biz=”开头的URL请求参数。</p>
                  <p><a href="https://www.chenwenguan.com/wechat-spider-server/" target="_blank" rel="noopener"><img src="https://www.chenwenguan.com/wp-content/uploads/2018/10/anyproxy-gui-wechat-proxy-url-1024x567.png" alt="AnyProxy 拦截的URL信息"></a></p>
                  <p>AnyProxy 拦截的URL信息</p>
                  <p>上面/s?__biz=开头的URL就是微信公众号文章详细的URL地址，可以点击查看具体的详细信息：</p>
                  <p><a href="https://www.chenwenguan.com/wechat-spider-server/" target="_blank" rel="noopener"><img src="https://www.chenwenguan.com/wp-content/uploads/2018/10/anyproxy-gui-wechat-proxy-url-detail-1024x567.png" alt="微信公众号文章URL详细信息"></a></p>
                  <p>微信公众号文章URL详细信息</p>
                  <p>页面往下滑动，查看请求到的公众号文章详细字段信息，服务端爬虫就是从这些字段参数定义的值来截取需要的信息。</p>
                  <p><a href="https://www.chenwenguan.com/wechat-spider-server/" target="_blank" rel="noopener"><img src="https://www.chenwenguan.com/wp-content/uploads/2018/10/anyproxy-gui-wechat-post-detail-1024x567.png" alt="AnyProxy解析的公众号文章详细信息"></a></p>
                  <p>AnyProxy解析的公众号文章详细信息</p>
                  <p>目前在服务端实现保存的字段只是一些基本的信息，如标题、作者、文章发布时间等，如果需要其他信息可以参考上图的一些字段做正则匹配。 在2015.5.12时间点，微信变动公众号文章加载方式之后，文章的实际地址参数在“/mp/getappmsgext?”开头的请求链接里面，包括点赞和阅读数据也在这个请求返回的结构体里面。在“ /mp/getappmsgad?“开头的请求链接request body也是文章的链接地址，但选择“/mp/getappmsgext?”开头的URL来拦截处理比较好。</p>
                  <p><a href="https://www.chenwenguan.com/wechat-spider-server/" target="_blank" rel="noopener"><img src="https://www.chenwenguan.com/wp-content/uploads/2019/04/wechat-spider-getappmsgext-intercept-request-body-1024x481.jpg" alt="拦截getappmsgext的请求结构体就是文章实际地址"></a></p>
                  <p>拦截getappmsgext的请求结构体就是文章实际地址</p>
                  <p>在getappmsgext拦截的页面往下滑动到response body就可以看到文章的阅读和点赞数据，因为这边没有阅读和点赞的数据解析需求，有需要的自行研究下从rule_default.js配置文件哪个接口拦截转发数据。</p>
                  <p><a href="https://www.chenwenguan.com/wechat-spider-server/" target="_blank" rel="noopener"><img src="https://www.chenwenguan.com/wp-content/uploads/2019/04/wechat-spider-getappmsgext-intercept-read-like-1024x488.jpg" alt="拦截getappmsgext的请求返回的数据包括阅读和点赞数"></a></p>
                  <p>拦截getappmsgext的请求返回的数据包括阅读和点赞数</p>
                  <h3 id="二、JavaWeb-服务端实现"><a href="#二、JavaWeb-服务端实现" class="headerlink" title="二、JavaWeb 服务端实现"></a>二、JavaWeb 服务端实现</h3>
                  <h4 id="1、运行环境配置"><a href="#1、运行环境配置" class="headerlink" title="1、运行环境配置"></a>1、运行环境配置</h4>
                  <p>Intellij IDEA 官网下载地址：<a href="https://www.jetbrains.com/idea/" target="_blank" rel="noopener">https://www.jetbrains.com/idea/</a> 破解方法参考：<a href="https://blog.csdn.net/u013673242/article/details/72243066?utm_source=itdadao&amp;utm_medium=referral" target="_blank" rel="noopener">IntelliJ IDEA 2017 完美注册方法</a> <strong>TIPS</strong>：要先打开IDEA之后再做如下配置，否则会被识别为文件已损坏</p>
                  <figure class="highlight groovy">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">-<span class="string">javaagent:</span><span class="regexp">/Applications/</span>IntelliJ IDEA.app<span class="regexp">/Contents/</span>bin/JetbrainsCrack<span class="number">-2.7</span>-release-str.jar</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <h4 id="2、服务端实现"><a href="#2、服务端实现" class="headerlink" title="2、服务端实现"></a>2、服务端实现</h4>
                  <p><strong>爬虫服务端实现GitHub源码地址：</strong></p>
                  <figure class="highlight markdown">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">[<span class="string">https://github.com/wenguan0927/WechatSpider</span>](<span class="link">https://github.com/wenguan0927/WechatSpider</span>)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <h5 id="1）实现类说明"><a href="#1）实现类说明" class="headerlink" title="1）实现类说明"></a>1）实现类说明</h5>
                  <p><a href="https://www.chenwenguan.com/wechat-spider-server/" target="_blank" rel="noopener"><img src="https://www.chenwenguan.com/wp-content/uploads/2018/10/intellij-idea-wechat-spider-class-254x300.png" alt="公众号爬虫服务端实现源码类说明"></a></p>
                  <p>公众号爬虫服务端实现源码类说明</p>
                  <p>WechatController类做AnyProxy转发的文章链接接收和JSP页面显示的逻辑处理。 mapper文件夹下的两个类是数据库操作的映射操作类，通过配置文件自动生成，只是手动加了几个数据查询方法的实现，PostKeyWordMapper用来操作存储公众号文章关键词的数据，WechatPostMapper用来操作存储公众号文章详细数据。 model文件夹下PostJSP只是用来JSP页面显示数据的一个中间类，在JSP页面中去拼接包含较多特殊字符的文本内容容易出问题，我这边的实现是要直接生成MarkDown文档的格式，所以做了一层转化处理。PostKeyWord是公众号关键字的类，WechatPost是公众号文章详细数据类。 spider文件夹下的类就是公众号文章关键字和公众号文章详细信息的爬取解析处理类。 util文件夹下放的是工具类，SimHash只是用来测试通过关键字计算公众号文章关联性实现类，有兴趣可以自己做下挖掘。</p>
                  <h5 id="2）配置文件说明"><a href="#2）配置文件说明" class="headerlink" title="2）配置文件说明"></a>2）配置文件说明</h5>
                  <p><a href="https://www.chenwenguan.com/wechat-spider-server/" target="_blank" rel="noopener"><img src="https://www.chenwenguan.com/wp-content/uploads/2018/10/intellij-idea-wechat-spider-resources-288x300.png" alt="公众号爬虫服务端实现配置文件说明"></a></p>
                  <p>公众号爬虫服务端实现配置文件说明</p>
                  <p>mybatis-mapper文件夹下的两个文件是数据库映射XML资源文件，通过generator.properties和generatorConfig.xml两个配置文件自动生成，具体可参考：<a href="https://www.cnblogs.com/kangoroo/p/7495873.html" target="_blank" rel="noopener">数据库表反向生成(一) MyBatis-generator与IDEA的集成</a> 。 这边需要注意的是，如果要在反向生成的数据库映射操作文件中增加方法实现，不要在Mapper.xml文件里面添加方法，要加的话在Mapper.java的类中加，可参考WechatPostMapper.java 类中末尾几个方法，通过在函数上添加注解的方式实现。 generator.properties文件中的jdbc.driverLocation改成自己电脑的connector实际路径，jdbc.userId和jdbc.password改成自己数据库的用户名和密码。 jdbc.properties文件中的数据库参数也改成自己配置的值。 其他文件只是常规的Web实现配置，此处不做多余赘述。</p>
                  <h5 id="3）实现过程中遇到的问题"><a href="#3）实现过程中遇到的问题" class="headerlink" title="3）实现过程中遇到的问题"></a>3）实现过程中遇到的问题</h5>
                  <p>1）@Autowired注解的Mapper类报NullPointException异常</p>
                  <figure class="highlight aspectj">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> WechatPostMapper wechatPostMapper;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">     <span class="keyword">private</span> PostKeywordMapper postKeywordMapper;</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>这边需要注意的是通过@Autowired注解声明的类不能在一个new出来的类中使用，@Autowired只能在通过框架注解生成的类中使用，在一个new出来的类中使用注解在框架生成的类中是找不到的，所以会报空指针异常。其他异常可参考：<a href="https://www.jianshu.com/p/0e0421c81e6a" target="_blank" rel="noopener">@Autowired注解和静态方法</a> 2）Intellj（IDEA） warning no artifacts configured 异常 参考文章：<a href="https://blog.csdn.net/small_mouse0/article/details/77506060" target="_blank" rel="noopener">【错误解决】Intellj（IDEA） warning no artifacts configured</a> 3）Intellij 代理端口占用异常</p>
                  <figure class="highlight routeros">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">错误: 代理抛出异常错误: </span><br><span class="line">java.rmi.server.ExportException:<span class="built_in"> Port </span>already <span class="keyword">in</span> use: 1099; nested exception is: </span><br><span class="line">java.net.BindException:<span class="built_in"> Address </span>already <span class="keyword">in</span> use</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>终端输入命令查看端口所在进程：</p>
                  <figure class="highlight angelscript">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">sudo lsof -i :<span class="number">1099</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>之后可看到如下类似的结果：</p>
                  <figure class="highlight routeros">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">COMMAND PID       <span class="built_in"> USER </span>  FD  <span class="built_in"> TYPE </span>            DEVICE SIZE/OFF NODE NAME</span><br><span class="line">java    582 chenwenguan   23u <span class="built_in"> IPv6 </span>0x38b6c6251709a7d3      0t0  TCP *:rmiregistry (LISTEN)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>终端输命令杀进程：kill 582 4）<a href="http://java.sun.com/jsp/jstl/core" target="_blank" rel="noopener">http://java.sun.com/jsp/jstl/core</a> cannot be resolved 如果配置的jstl版本是1.2， 不需要通过导入jstl.jar和standard.jar包的方式，如果配置的是1.2以下的版本，可参考文章： <a href="https://blog.csdn.net/BlueBlueSkyZ/article/details/54926096" target="_blank" rel="noopener">core cannot be resolved</a>。 jar包的下载地址：</p>
                  <figure class="highlight markdown">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">[<span class="string">http://archive.apache.org/dist/jakarta/taglibs/standard/binaries/</span>](<span class="link">http://archive.apache.org/dist/jakarta/taglibs/standard/binaries/</span>)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>5） Warning:The/usr/local/mysql/data directory is not owned by the ‘mysql’ or ‘_mysql’</p>
                  <p>如果因Mac系统更新导致MySQL提示以上异常，执行以下命令解决：</p>
                  <figure class="highlight groovy">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">sudo chown -R  <span class="string">_mysql:</span>wheel  <span class="regexp">/usr/</span>local<span class="regexp">/mysql/</span>data</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>参考博文：<a href="https://blog.csdn.net/lvsijian8/article/details/60779386" target="_blank" rel="noopener">Mac在偏好设置启动MySQL失败</a> 6）注解中的数据库IN查询语句实现</p>
                  <figure class="highlight less">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="variable">@Select</span>(&#123;<span class="string">"&lt;script&gt;"</span>,</span><br><span class="line">          <span class="string">"select"</span>,</span><br><span class="line">          <span class="string">"id, biz, appmsgid, title, digest, contenturl, sourceurl, cover, datetime, readnum, "</span>,</span><br><span class="line">          <span class="string">"likenum, isspider, author, nickname, weight, posttype, content"</span>,</span><br><span class="line">          <span class="string">"from postTable where nickname in "</span>,</span><br><span class="line">          <span class="string">"&lt;foreach item='item' collection='nickname' open='(' close=')' separator=','&gt;"</span>,</span><br><span class="line">          <span class="string">"#&#123;item&#125;"</span>,</span><br><span class="line">          <span class="string">"&lt;/foreach&gt;"</span>,</span><br><span class="line">          <span class="string">" and datetime &gt;=#&#123;datetime,jdbcType=TIMESTAMP&#125;"</span>,</span><br><span class="line">          <span class="string">"order by weight DESC"</span>,</span><br><span class="line">          <span class="string">"&lt;/script&gt;"</span></span><br><span class="line"> &#125;)</span><br><span class="line"> <span class="variable">@ResultMap</span>(<span class="string">"ResultMapWithBLOBs"</span>)</span><br><span class="line">List&lt;WechatPost&gt; getATAPosts(<span class="variable">@Param</span>(<span class="string">"nickname"</span>) List&lt;String&gt; nickname, <span class="variable">@Param</span>(<span class="string">"datetime"</span>) Date time);</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>如果是要在注解中实现IN多条件查询，需要如上面的方式去实现，直接按照原生SQL语句的方式实现是行不通的。 参考博文：<a href="https://www.cnblogs.com/a8457013/p/9097742.html" target="_blank" rel="noopener">SpringBoot使用Mybatis注解开发教程-分页-动态sql</a></p>
                  <h5 id="4-数据库实现"><a href="#4-数据库实现" class="headerlink" title="4) 数据库实现"></a>4) 数据库实现</h5>
                  <p>公众号文章详情数据表实现：</p>
                  <figure class="highlight routeros">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">CREATE TABLE `postTable` (</span><br><span class="line">  `id` int(11) <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  `biz` tinytext,</span><br><span class="line">  `appmsgid` tinytext,</span><br><span class="line">  `title` tinytext,</span><br><span class="line">  `digest` longtext,</span><br><span class="line">  `contenturl` longtext,</span><br><span class="line">  `sourceurl` longtext,</span><br><span class="line">  `cover` longtext,</span><br><span class="line">  `datetime` datetime<span class="built_in"> DEFAULT </span><span class="literal">NULL</span>,</span><br><span class="line">  `readnum` int(11)<span class="built_in"> DEFAULT </span><span class="literal">NULL</span>,</span><br><span class="line">  `likenum` int(11)<span class="built_in"> DEFAULT </span><span class="literal">NULL</span>,</span><br><span class="line">  `isspider` int(11)<span class="built_in"> DEFAULT </span><span class="literal">NULL</span>,</span><br><span class="line">  `author` tinytext,</span><br><span class="line">  `nickname` tinytext,</span><br><span class="line">  `weight` int(11)<span class="built_in"> DEFAULT </span><span class="literal">NULL</span>,</span><br><span class="line">  `posttype` int(11)<span class="built_in"> DEFAULT </span><span class="literal">NULL</span>,</span><br><span class="line">  `content` longtext,</span><br><span class="line">  PRIMARY KEY (`id`)</span><br><span class="line">) <span class="attribute">ENGINE</span>=InnoDB <span class="attribute">AUTO_INCREMENT</span>=199<span class="built_in"> DEFAULT </span><span class="attribute">CHARSET</span>=utf8</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>公众号关键字数据表实现：</p>
                  <figure class="highlight routeros">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">CREATE TABLE `keywordTable` (</span><br><span class="line">  `id` int(11) <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  `wordtext` varchar(45)<span class="built_in"> DEFAULT </span><span class="literal">NULL</span>,</span><br><span class="line">  `wordfrequency` int(11)<span class="built_in"> DEFAULT </span><span class="literal">NULL</span>,</span><br><span class="line">  `wordtype` int(11)<span class="built_in"> DEFAULT </span><span class="literal">NULL</span>,</span><br><span class="line">  PRIMARY KEY (`id`)</span><br><span class="line">) <span class="attribute">ENGINE</span>=InnoDB <span class="attribute">AUTO_INCREMENT</span>=3525<span class="built_in"> DEFAULT </span><span class="attribute">CHARSET</span>=utf8</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <h5 id="5）遗留问题"><a href="#5）遗留问题" class="headerlink" title="5）遗留问题"></a>5）遗留问题</h5>
                  <p>公众号文章的分类目前没有很好地实现，也就是，目前爬取的公众号文章我要分为三大类，新闻类、Android开发、技术扩展，一开始的想法是根据以往发布的每周技术周报文章内容，提取每个类别文章的关键词数据，生成一个关键词数据库，之后爬取的文章，可以通过提取文章的关键词跟历史记录文章的关键词词库进行对比，计算它们的相关性来进行归类。 目前用HanLP开源代码来做测试，提取的关键词都是中文的关键词，在做关联性计算的时候并不能达到理想的效果，因为开发类的文章有很多英文的词汇，HanLP里面并不包括英文词汇的词库，所以下一步要做的是做一个技术类文章的分词词库来实现文章的归类处理。 这边给出一些参考文章的链接资源，有兴趣可以自己做一下深挖。 <a href="http://www.hankcs.com/nlp/textrank-algorithm-to-extract-the-keywords-java-implementation.html" target="_blank" rel="noopener">TextRank算法提取关键词的Java实现</a> <a href="http://xiaosheng.me/2017/04/08/article49/" target="_blank" rel="noopener">TextRank算法提取关键词和摘要</a> <a href="https://blog.csdn.net/whzhaochao/article/details/50637300" target="_blank" rel="noopener">计算两组标签/关键词相似度算法</a> <a href="http://www.hankcs.com/nlp/hanlp.html" target="_blank" rel="noopener">HanLP自然语言处理包开源</a> <a href="https://zhuanlan.zhihu.com/p/33605700" target="_blank" rel="noopener">文本关键词提取算法解析</a> <a href="https://www.cnblogs.com/xlturing/p/6136690.html" target="_blank" rel="noopener">NLP点滴——文本相似度</a> <a href="https://www.cnblogs.com/shaosks/p/9121774.html" target="_blank" rel="noopener">文本相似性计算总结（余弦定理，simhash）及代码</a> <a href="https://segmentfault.com/a/1190000013466886" target="_blank" rel="noopener">如何实现一个基本的微信文章分类器</a> <a href="https://github.com/hankcs/HanLP" target="_blank" rel="noopener">HanLP GitHub开源代码</a></p>
                  <h3 id="三、其他参考资料"><a href="#三、其他参考资料" class="headerlink" title="三、其他参考资料"></a>三、其他参考资料</h3>
                  <p><a href="https://www.cnblogs.com/guogangj/p/3725371.html" target="_blank" rel="noopener">Mac OS X上IntelliJ IDEA 13与Tomcat 8的Java Web开发环境搭建</a> <a href="https://www.cnblogs.com/wql025/p/5215570.html" target="_blank" rel="noopener">IntelliJ IDEA 15 创建maven项目</a> <a href="http://www.mybatis.org/mybatis-3/zh/index.html" target="_blank" rel="noopener">MyBatis官网</a> <a href="http://www.runoob.com/w3cnote/intellij-idea-usage.html" target="_blank" rel="noopener">Intellij IDEA 使用教程</a> <a href="https://liuxufei.com/weblog/jishu/71.html" target="_blank" rel="noopener">HTML语言中括号(尖括号)的字符编码</a> <a href="https://segmentfault.com/a/1190000010383923" target="_blank" rel="noopener">mac下mongodb的安装与配置</a> <a href="https://www.jianshu.com/p/2d0a1ecd0c82" target="_blank" rel="noopener">mac下mongodb的安装和使用(使用终端操作)</a> <a href="https://github.com/dboissier/mongo4idea" target="_blank" rel="noopener">Intellij Mongo配置</a> <a href="https://www.cnblogs.com/lwy19998273333/p/5793141.html" target="_blank" rel="noopener">Java连接MongoDB进行增删改查</a> <a href="https://www.cnblogs.com/jeffen/p/6027970.html" target="_blank" rel="noopener">IntelliJ IDEA手动配置连接MySQL数据库</a> <a href="http://www.mongodb.org.cn/" target="_blank" rel="noopener">MongoDB中文教程</a> <a href="https://docs.mongodb.com/manual/core/document/" target="_blank" rel="noopener">MongoDB官方文档</a> <a href="http://webmagic.io/docs/zh/" target="_blank" rel="noopener">WebMagic 爬虫框架</a></p>
                  </p>
                </div>
              </div>
              <div class="post-meta">
                <span class="post-meta-item">
                  <span class="post-meta-item-icon">
                    <i class="far fa-user"></i>
                  </span>
                  <span class="post-meta-item-text">作者</span>
                  <span><a href="/authors/崔庆才" class="author" itemprop="url" rel="index">崔庆才</a></span>
                </span>
                <span class="post-meta-item">
                  <span class="post-meta-item-icon">
                    <i class="far fa-calendar"></i>
                  </span>
                  <span class="post-meta-item-text">发表于</span>
                  <time title="创建时间：2019-07-02 11:06:34" itemprop="dateCreated datePublished" datetime="2019-07-02T11:06:34+08:00">2019-07-02</time>
                </span>
                <span id="/6761.html" class="post-meta-item leancloud_visitors" data-flag-title="微信公众号文章爬取之：服务端数据采集" title="阅读次数">
                  <span class="post-meta-item-icon">
                    <i class="fa fa-eye"></i>
                  </span>
                  <span class="post-meta-item-text">阅读次数：</span>
                  <span class="leancloud-visitors-count"></span>
                </span>
                <span class="post-meta-item" title="本文字数">
                  <span class="post-meta-item-icon">
                    <i class="far fa-file-word"></i>
                  </span>
                  <span class="post-meta-item-text">本文字数：</span>
                  <span>8.4k</span>
                </span>
                <span class="post-meta-item" title="阅读时长">
                  <span class="post-meta-item-icon">
                    <i class="far fa-clock"></i>
                  </span>
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                  <span>8 分钟</span>
                </span>
              </div>
            </article>
            <article itemscope itemtype="http://schema.org/Article" class="post-block index" lang="zh-CN">
              <link itemprop="mainEntityOfPage" href="https://cuiqingcai.com/6759.html">
              <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
                <meta itemprop="image" content="/images/avatar.png">
                <meta itemprop="name" content="崔庆才">
                <meta itemprop="description" content="崔庆才的个人站点，记录生活的瞬间，分享学习的心得。">
              </span>
              <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
                <meta itemprop="name" content="静觅">
              </span>
              <header class="post-header">
                <h2 class="post-title" itemprop="name headline">
                  <a class="label"> 技术杂谈 <i class="label-arrow"></i>
                  </a>
                  <a href="/6759.html" class="post-title-link" itemprop="url">2019 WordPress 必备插件推荐</a>
                </h2>
              </header>
              <div class="post-body" itemprop="articleBody">
                <div class="thumb">
                  <img itemprop="contentUrl" class="random">
                </div>
                <div class="excerpt">
                  <p>
                  <p>本文转载自：<a href="https://www.chenwenguan.com/best-wordpress-plugins-this-year/" target="_blank" rel="noopener">陈文管的博客-2019 WordPress必备插件推荐</a> 推荐下 WordPress 必备的插件，插件的使用主要从 SEO、安全、营销、UI设计、访问数据分析几个方面去考虑，当然并不是插件安装越多越好，过多的插件会拖慢网站加载速度，只在满足需求的前提下安装必要的一些插件。 此外在安装插件启用之前最好先备份下网站数据，很可能因为版本不兼容的原因导致数据库读写异常，这样整个网站就挂了，以防万一，每次安装或者更新插件之前先备份下网站数据。</p>
                  <h3 id="1、Yoast-SEO"><a href="#1、Yoast-SEO" class="headerlink" title="1、Yoast SEO"></a>1、<a href="https://wordpress.org/plugins/wordpress-seo/" target="_blank" rel="noopener">Yoast SEO</a></h3>
                  <p><a href="https://www.chenwenguan.com/best-wordpress-plugins-this-year/" target="_blank" rel="noopener"><img src="https://www.chenwenguan.com/wp-content/uploads/2019/02/wordpress-plugin-yoast-seo-300x119.png" alt="Yoast SEO插件"></a></p>
                  <p>Yoast SEO插件</p>
                  <p>做网站SEO必不可少的插件， 可以设置谷歌、Bing、百度、Yandex 的验证码，可以检测文章可读性和SEO的好坏等等，但要记得把分类和TAG的索引关闭，避免内部链接的内容重复。</p>
                  <p><a href="https://www.chenwenguan.com/best-wordpress-plugins-this-year/" target="_blank" rel="noopener"><img src="https://www.chenwenguan.com/wp-content/uploads/2019/02/plugin-yoast-seo-category-noindex-300x193.jpg" alt="Yoast SEO分类目录声明成noindex,nofollow"></a></p>
                  <p>Yoast SEO分类目录声明成noindex,nofollow</p>
                  <p><a href="https://www.chenwenguan.com/best-wordpress-plugins-this-year/" target="_blank" rel="noopener"><img src="https://www.chenwenguan.com/wp-content/uploads/2019/02/plugin-yoast-seo-tag-noindex-300x222.jpg" alt="Yoast SEO 标签目录声明成noindex,nofollow"></a></p>
                  <p>Yoast SEO 标签目录声明成noindex,nofollow</p>
                  <p>如果是要编辑robot.txt，入口在工具=&gt;文件编辑器里面，记得在一个网站没有建好之前要robots.txt设置成：</p>
                  <p>User-agent: *</p>
                  <p>Disallow: /</p>
                  <h3 id="2、WP-Fastest-Cache"><a href="#2、WP-Fastest-Cache" class="headerlink" title="2、WP Fastest Cache"></a>2、<a href="https://wordpress.org/plugins/wp-fastest-cache/" target="_blank" rel="noopener">WP Fastest Cache</a></h3>
                  <p><a href="https://www.chenwenguan.com/best-wordpress-plugins-this-year/" target="_blank" rel="noopener"><img src="https://www.chenwenguan.com/wp-content/uploads/2019/02/wordpress-plugin-wp-fastest-cache-300x118.jpg" alt="WP Fastest Cache插件"></a></p>
                  <p>WP Fastest Cache插件</p>
                  <p>压缩HTML，合并CSS，提高网站加载速度，可以直接在插件里面设置CDN加速等等，缓存的设置按照下面截图照搬就行。</p>
                  <p><a href="https://www.chenwenguan.com/best-wordpress-plugins-this-year/" target="_blank" rel="noopener"><img src="https://www.chenwenguan.com/wp-content/uploads/2019/02/wp-fastest-cache-setting-guide-1024x788.jpg" alt="WP Fastest Cache 缓存设置"></a></p>
                  <p>WP Fastest Cache 缓存设置</p>
                  <h3 id="3、Smush-Image-Compression-and-Optimization"><a href="#3、Smush-Image-Compression-and-Optimization" class="headerlink" title="3、Smush Image Compression and Optimization"></a>3、<a href="https://wordpress.org/plugins/wp-smushit/" target="_blank" rel="noopener">Smush Image Compression and Optimization</a></h3>
                  <p><a href="https://www.chenwenguan.com/best-wordpress-plugins-this-year/" target="_blank" rel="noopener"><img src="https://www.chenwenguan.com/wp-content/uploads/2019/02/wordpress-plugin-smush-image-compression-300x124.jpg" alt="Smush Image Compression and Optimization插件"></a></p>
                  <p>Smush Image Compression and Optimization插件</p>
                  <p>帮助自动压缩网站的图片，避免图片过大拖慢网站的加载速度，配合TinyPNG(<a href="https://tinypng.com/" target="_blank" rel="noopener">https://tinypng.com/</a>)一起使用更好，每次上传图片之前最好先经过<a href="https://tinypng.com/" target="_blank" rel="noopener">TinyPNG</a>压缩一遍之后再上传，不得不说目前在图片的压缩方面，<a href="https://tinypng.com/" target="_blank" rel="noopener">TinyPNG</a>无疑是最好的。</p>
                  <h3 id="4、Google-XML-Sitemaps"><a href="#4、Google-XML-Sitemaps" class="headerlink" title="4、Google XML Sitemaps"></a>4、<a href="https://wordpress.org/plugins/google-sitemap-generator/" target="_blank" rel="noopener">Google XML Sitemaps</a></h3>
                  <p><a href="https://www.chenwenguan.com/best-wordpress-plugins-this-year/" target="_blank" rel="noopener"><img src="https://www.chenwenguan.com/wp-content/uploads/2019/02/wordpress-plugin-google-xml-sitemaps-300x118.jpg" alt="Google XML Sitemaps插件"></a></p>
                  <p>Google XML Sitemaps插件</p>
                  <p>虽然Yoast SEO插件自带网站地图的设置，但是如果要提高配置的可控性，使用Google XML Sitemaps会好点，在提交到Google Search Console收录之后出现一些链接地址无法索引的情况，后面就把HTML网站地图功能关闭掉就好了。</p>
                  <h3 id="5、Clicky-for-WordPress"><a href="#5、Clicky-for-WordPress" class="headerlink" title="5、Clicky for WordPress"></a>5、<a href="https://wordpress.org/plugins/clicky/" target="_blank" rel="noopener">Clicky for WordPress</a></h3>
                  <p><a href="https://www.chenwenguan.com/best-wordpress-plugins-this-year/" target="_blank" rel="noopener"><img src="https://www.chenwenguan.com/wp-content/uploads/2019/02/wordpress-plugin-clicky-by-yoast-300x118.jpg" alt="Clicky by Yoast插件"></a></p>
                  <p>Clicky by Yoast插件</p>
                  <p>虽然在网站访问数据分析工具上已经有<a href="https://search.google.com/search-console/about" target="_blank" rel="noopener">Google Search Console</a>和<a href="https://analytics.google.com/" target="_blank" rel="noopener">Google Analytics</a>，但是Clicky(<a href="https://clicky.com/" target="_blank" rel="noopener">https://clicky.com/</a>)工具更能实时地记录反馈网站的访问数据。在<a href="https://clicky.com/" target="_blank" rel="noopener">Clicky</a>注册账号之后，把使用偏好里面的Site ID、Site Key和Admin site key参数填到<a href="https://wordpress.org/plugins/clicky/" target="_blank" rel="noopener">Clicky插件</a>设置里面，之后就可以记录网站的数据。</p>
                  <h3 id="6、Shortcodes-Ultimate"><a href="#6、Shortcodes-Ultimate" class="headerlink" title="6、Shortcodes Ultimate"></a>6、<a href="https://wordpress.org/plugins/shortcodes-ultimate/" target="_blank" rel="noopener">Shortcodes Ultimate</a></h3>
                  <p><a href="https://www.chenwenguan.com/best-wordpress-plugins-this-year/" target="_blank" rel="noopener"><img src="https://www.chenwenguan.com/wp-content/uploads/2019/02/wordpress-plugin-shortcodes-ultimate-300x118.jpg" alt="Shortcodes Ultimate插件"></a></p>
                  <p>Shortcodes Ultimate插件</p>
                  <p>对于WordPress里面自定义的样式，简码插件提供了很多样例，省去了手动编辑的麻烦。</p>
                  <p><a href="https://www.chenwenguan.com/best-wordpress-plugins-this-year/" target="_blank" rel="noopener"><img src="https://www.chenwenguan.com/wp-content/uploads/2019/02/shortcodes-ultimate-plugin-samples-2-300x130.jpg" alt="终极简码样例"></a></p>
                  <p>终极简码样例</p>
                  <h3 id="7、Genesis-Simple-Edits和Genesis-Super-Customizer"><a href="#7、Genesis-Simple-Edits和Genesis-Super-Customizer" class="headerlink" title="7、Genesis Simple Edits和Genesis Super Customizer"></a>7、<a href="https://wordpress.org/plugins/genesis-simple-edits/" target="_blank" rel="noopener">Genesis Simple Edits</a>和<a href="https://wordpress.org/plugins/genesis-super-customizer/" target="_blank" rel="noopener">Genesis Super Customizer</a></h3>
                  <p><a href="https://www.chenwenguan.com/best-wordpress-plugins-this-year/" target="_blank" rel="noopener"><img src="https://www.chenwenguan.com/wp-content/uploads/2019/02/wordpress-plugin-genesis-simple-edits-300x117.jpg" alt="Genesis Simple Edits插件"></a></p>
                  <p>Genesis Simple Edits插件</p>
                  <p>如果是使用<a href="https://my.studiopress.com/themes/" target="_blank" rel="noopener">Genesis Framework</a>主题 ，Genesis Simple Edits是必不可少的插件，如果手动修改Genesis Framework主题代码会出异常，甚至会导致WordPress账户后台无法登陆，之前尝试过在主题类中增加几行代码修改样式，后面导致整个服务异常，无法登陆，所以，最好不要手动修改Genesis Framework主题的代码，通过插件去修改保险点。</p>
                  <p><a href="https://www.chenwenguan.com/best-wordpress-plugins-this-year/" target="_blank" rel="noopener"><img src="https://www.chenwenguan.com/wp-content/uploads/2019/02/genesis-simple-edits-custom-new-footer-1024x94.jpg" alt="Simple Edits实现的自定义底部栏"></a></p>
                  <p>Simple Edits实现的自定义底部栏</p>
                  <p>如果是要实现上面的底部栏效果，可以在插件Footer Output输入框中贴上以下代码来实现，xxxxxxx替换成自己网站的名称。</p>
                  <p><a href="https://www.chenwenguan.com/best-wordpress-plugins-this-year/" target="_blank" rel="noopener"><img src="https://www.chenwenguan.com/wp-content/uploads/2019/02/genesis-simple-edits-custom-footer-html-code-1024x210.jpg" alt="Genesis Simple Edits自定义底部栏HTML代码"></a></p>
                  <p>Genesis Simple Edits自定义底部栏HTML代码</p>
                  <p><a href="https://www.chenwenguan.com/best-wordpress-plugins-this-year/" target="_blank" rel="noopener"><img src="https://www.chenwenguan.com/wp-content/uploads/2019/02/wordpress-plugin-genesis-super-customizer-300x117.jpg" alt="Genesis Super Customizer插件"></a></p>
                  <p>Genesis Super Customizer插件</p>
                  <p>使用Genesis Framework主题之后发现评论的字体偏大了，通过<a href="https://wordpress.org/plugins/genesis-super-customizer/" target="_blank" rel="noopener">Super Customizer插件</a>可以修改文章和评论默认的字体大小，还有主题的各种自定义样式修改。 另：如果是做境外网站，文章和评论的字体一般选Georgia Font。Genesis主题的分享插件推荐<a href="https://wordpress.org/plugins/genesis-simple-share/" target="_blank" rel="noopener">Genesis Simple Share</a>。</p>
                  <h3 id="8、Really-Simple-SSL"><a href="#8、Really-Simple-SSL" class="headerlink" title="8、Really Simple SSL"></a>8、<a href="https://wordpress.org/plugins/really-simple-ssl/" target="_blank" rel="noopener">Really Simple SSL</a></h3>
                  <p><a href="https://www.chenwenguan.com/best-wordpress-plugins-this-year/" target="_blank" rel="noopener"><img src="https://www.chenwenguan.com/wp-content/uploads/2019/02/wordpress-plugin-really-simple-ssl-300x118.jpg" alt="Really Simple SSL插件"></a></p>
                  <p>Really Simple SSL插件</p>
                  <p>网站从HTTP切换成HTTPS必备的插件，切换的过程中涉及到301重定向，URL参数的修改等等，如果手动修改难免出错，这个在<a href="https://www.chenwenguan.com/aliyun-wordpress-hosting-ssl" target="_blank" rel="noopener">阿里云免费SSL证书申请和WordPress服务器配置</a> 文章中已经有提及过。</p>
                  <h3 id="9、WP-Mail-SMTP和WPForms-Lite"><a href="#9、WP-Mail-SMTP和WPForms-Lite" class="headerlink" title="9、WP Mail SMTP和WPForms Lite"></a>9、<a href="https://wordpress.org/plugins/wp-mail-smtp/" target="_blank" rel="noopener">WP Mail SMTP</a>和<a href="https://wordpress.org/plugins/wpforms-lite/" target="_blank" rel="noopener">WPForms Lite</a></h3>
                  <p><a href="https://www.chenwenguan.com/best-wordpress-plugins-this-year/" target="_blank" rel="noopener"><img src="https://www.chenwenguan.com/wp-content/uploads/2019/02/wordpress-plugin-wp-mail-smtp-by-wpforms-300x117.jpg" alt="WP Mail SMTP by WPForms插件"></a></p>
                  <p>WP Mail SMTP by WPForms插件</p>
                  <p><a href="https://www.chenwenguan.com/best-wordpress-plugins-this-year/" target="_blank" rel="noopener"><img src="https://www.chenwenguan.com/wp-content/uploads/2019/02/wordpress-plugin-contact-form-by-wpforms-300x136.jpg" alt="WPForms Lite插件"></a></p>
                  <p>WPForms Lite插件</p>
                  <p>博客中的联系页面功能可以使用上面两个插件配合实现。 WPForms Lite插件用来自定义联系人表格、注册表格等，WP Mail SMTP 插件用来设置接收邮件的参数，比如设置QQ邮箱作为博客的接收邮箱，可以参考这篇文章：<a href="http://help.websoft9.com/wordpress-practise/paas/wp/smtp.html" target="_blank" rel="noopener">WordPress如何发送邮件？</a></p>
                  <p><a href="https://www.chenwenguan.com/best-wordpress-plugins-this-year/" target="_blank" rel="noopener"><img src="https://www.chenwenguan.com/wp-content/uploads/2019/02/wordpress-blog-contact-form-page-1024x611.jpg" alt="Wordpress博客联系表格页面"></a></p>
                  <p>WordPress博客联系表格页面</p>
                  <p>如果需要弹窗邮件注册功能可以使用<a href="https://wordpress.org/plugins/optinmonster/" target="_blank" rel="noopener">OptinMonster</a>插件。</p>
                  <p><a href="https://www.chenwenguan.com/best-wordpress-plugins-this-year/" target="_blank" rel="noopener"><img src="https://www.chenwenguan.com/wp-content/uploads/2019/02/wordpress-plugin-popups-by-optinmonster-300x123.jpg" alt="Popups by OptinMonster插件"></a></p>
                  <p>Popups by OptinMonster插件</p>
                  <h3 id="10、Akismet"><a href="#10、Akismet" class="headerlink" title="10、Akismet"></a>10、<a href="https://wordpress.org/plugins/akismet/" target="_blank" rel="noopener">Akismet</a></h3>
                  <p><a href="https://www.chenwenguan.com/best-wordpress-plugins-this-year/" target="_blank" rel="noopener"><img src="https://www.chenwenguan.com/wp-content/uploads/2019/02/wordpress-plugin-akismet-anti-spam-300x129.jpg" alt="Akismet Anti-Spam插件"></a></p>
                  <p>Akismet Anti-Spam插件</p>
                  <p>垃圾评论拦截插件，避免恶意的评论。</p>
                  <h3 id="11、Easyazon"><a href="#11、Easyazon" class="headerlink" title="11、Easyazon"></a>11、<a href="https://wordpress.org/plugins/easyazon/" target="_blank" rel="noopener">Easyazon</a></h3>
                  <p><a href="https://www.chenwenguan.com/best-wordpress-plugins-this-year/" target="_blank" rel="noopener"><img src="https://www.chenwenguan.com/wp-content/uploads/2019/02/wordpress-plugin-easyazon-300x124.jpg" alt="EasyAzon 插件"></a></p>
                  <p>EasyAzon 插件</p>
                  <p>做境外Affiliate必备插件，EasyaAzon一个很重要的功能是可以根据地理位置设置不同的跳转链接，比如在澳大利亚可以跳转到澳大利亚区域的亚马逊店铺，加拿大可以跳转到加拿大区域的亚马逊店铺。比如网站默认的地理位置设置在美国，如果加拿大或者澳大利亚区域的用户点击链接跳转到的是美国区域的店铺，很容易就放弃购买，这样会损失一部分转化率。 10Beasts的博主曾使用geniuslink (<a href="https://www.geni.us/" target="_blank" rel="noopener">https://www.geni.us/</a>)来本地化购买链接，后面出现一个Bug，导致返利成了geniuslink的收益，后面他就弃用了。</p>
                  <p>EasyAzon设置对应区域的链接地址</p>
                  <h3 id="12、TinyMCE-Advanced"><a href="#12、TinyMCE-Advanced" class="headerlink" title="12、TinyMCE Advanced"></a>12、<a href="https://wordpress.org/plugins/tinymce-advanced/" target="_blank" rel="noopener">TinyMCE Advanced</a></h3>
                  <p><a href="https://www.chenwenguan.com/best-wordpress-plugins-this-year/" target="_blank" rel="noopener"><img src="https://www.chenwenguan.com/wp-content/uploads/2019/02/wordpress-plugin-tinymce-advanced-300x119.jpg" alt="TinyMCE Advanced插件"></a></p>
                  <p>TinyMCE Advanced插件</p>
                  <p>编辑插件推荐在WordPress自带的编辑工具上，安装TinyMCE Advanced插件，WordPress自带的插件功能太简陋了，覆盖安装第三方插件多多少少会有点问题。TinyMCE Advanced插件可以提供字体大小设置功能，可以在插件设置页面拖动在编辑栏上要显示的功能模块。 一定不要安装Kindeditor For WordPress插件，这个插件很久没更新了，而且是覆盖安装，最大的一个问题是在上下滑动编辑区域的时候无法悬浮编辑工具栏，这样要编辑设置文本属性的时候每次都要滑动到文章头部设置，非常麻烦。而且插入媒体内容的时候每次都是把内容加到文章末尾，不是在输入光标的位置插入内容，每次都要从文章末尾剪切黏贴到插入的位置。</p>
                  <p><a href="https://www.chenwenguan.com/best-wordpress-plugins-this-year/" target="_blank" rel="noopener"><img src="https://www.chenwenguan.com/wp-content/uploads/2019/02/wordpress-plugin-kindeditor-for-wordpress-300x117.jpg" alt="Kindeditor For WordPress插件"></a></p>
                  <p>Kindeditor For WordPress插件</p>
                  <h3 id="13、Rel-Nofollow-Checkbox"><a href="#13、Rel-Nofollow-Checkbox" class="headerlink" title="13、Rel Nofollow Checkbox"></a>13、<a href="https://wordpress.org/plugins/rel-nofollow-checkbox/" target="_blank" rel="noopener">Rel Nofollow Checkbox</a></h3>
                  <p><a href="https://www.chenwenguan.com/best-wordpress-plugins-this-year/" target="_blank" rel="noopener"><img src="https://www.chenwenguan.com/wp-content/uploads/2019/02/wordpress-plugin-rel-nofollow-checkbox-300x119.jpg" alt="Rel Nofollow Checkbox插件"></a></p>
                  <p>Rel Nofollow Checkbox插件</p>
                  <p>文章中的出站链接一般都要设置成nofollow属性，避免权重传递。其他的Nofollow插件会有这样那样的问题，试了几个插件只有这个没有Bug。</p>
                  <p><a href="https://www.chenwenguan.com/best-wordpress-plugins-this-year/" target="_blank" rel="noopener"><img src="https://www.chenwenguan.com/wp-content/uploads/2019/02/wordpress-plugin-rel-nofollow-checkbox-setting-300x300.jpg" alt="文章链接nofollow属性设置"></a></p>
                  <p>文章链接nofollow属性设置</p>
                  <h3 id="14、Google-Analytics-for-WordPress-by-MonsterInsights"><a href="#14、Google-Analytics-for-WordPress-by-MonsterInsights" class="headerlink" title="14、Google Analytics for WordPress by MonsterInsights"></a>14、<a href="https://wordpress.org/plugins/google-analytics-for-wordpress/" target="_blank" rel="noopener">Google Analytics for WordPress by MonsterInsights</a></h3>
                  <p><a href="https://www.chenwenguan.com/best-wordpress-plugins-this-year/" target="_blank" rel="noopener"><img src="https://www.chenwenguan.com/wp-content/uploads/2019/02/wordpress-plugin-google-analytics-dashboard-plugin-for-wordpress-by-monsterinfights-300x138.jpg" alt="Google Analytics Dashboard Plugin for WordPress by MonsterInsights插件"></a></p>
                  <p>Google Analytics Dashboard Plugin for WordPress by MonsterInsights插件</p>
                  <p>为了避免每次单独登陆Google Analytics的麻烦，可以集成Google Analytics到WordPress操作面板中，但似乎在阿里云服务器上的防火墙会屏蔽Google Analytics链接的访问，境外网站的使用没问题。 这边不建议使用WP Statistics插件，虽然用这个插件可以看到很多详细的访问数据，但在集成之后发现网站页面的加载速度明显变长了，而且会产生大量的Log记录。</p>
                  <p><a href="https://www.chenwenguan.com/best-wordpress-plugins-this-year/" target="_blank" rel="noopener"><img src="https://www.chenwenguan.com/wp-content/uploads/2019/02/wordpress-plugin-wp-statistics-300x117.jpg" alt="WP Statistics插件"></a></p>
                  <p>WP Statistics插件</p>
                  <p>15、<a href="https://wordpress.org/plugins/wp-downgrade/" target="_blank" rel="noopener">WP Downgrade</a></p>
                  <p><a href="https://www.chenwenguan.com/best-wordpress-plugins-this-year/" target="_blank" rel="noopener"><img src="https://www.chenwenguan.com/wp-content/uploads/2019/03/wordpress-plugin-wp-downgrade-300x131.jpg" alt="WordPress WP Downgrade插件"></a></p>
                  <p>WordPress WP Downgrade插件</p>
                  <p>如果WordPress版本被服务器自动升级到5.0，之后就容易出现很多WordPress插件不兼容的情况，这就需要对WordPress版本进行降级，使用这个插件输入要降级或升级的版本号操作即可。使用完之后可以关闭此插件，需要的时候再激活。 </p>
                  <h3 id="TIPS"><a href="#TIPS" class="headerlink" title="TIPS:"></a>TIPS:</h3>
                  <h4 id="1、怎么下载旧版本WordPress插件？"><a href="#1、怎么下载旧版本WordPress插件？" class="headerlink" title="1、怎么下载旧版本WordPress插件？"></a>1、怎么下载旧版本WordPress插件？</h4>
                  <p>有的时候会出现升级WordPress版本或者插件自更新到高版本出现插件不兼容的异常，这个时候就需要回退安装旧版本的插件。首先进入WordPress网站主页<a href="https://wordpress.org/" target="_blank" rel="noopener">https://wordpress.org/</a>，比如要下载Jetpack旧版本插件，先进入Jetpack插件主页，在插件页面右侧有一个Advanced View入口。</p>
                  <p><a href="https://www.chenwenguan.com/best-wordpress-plugins-this-year/" target="_blank" rel="noopener"><img src="https://www.chenwenguan.com/wp-content/uploads/2019/04/wordpress-plugin-advanced-view-1024x483.jpg" alt="插件历史版本下载入口"></a></p>
                  <p>插件历史版本下载入口</p>
                  <p>点击进入Advanced View页面，在PREVIOUS VERSIONS模块就可以选择历史插件版本，之后进行下载。</p>
                  <p><a href="https://www.chenwenguan.com/best-wordpress-plugins-this-year/" target="_blank" rel="noopener"><img src="https://www.chenwenguan.com/wp-content/uploads/2019/04/wordpress-plugin-previous-versions-download-1024x486.jpg" alt="插件历史版本下载"></a></p>
                  <p>插件历史版本下载</p>
                  </p>
                </div>
              </div>
              <div class="post-meta">
                <span class="post-meta-item">
                  <span class="post-meta-item-icon">
                    <i class="far fa-user"></i>
                  </span>
                  <span class="post-meta-item-text">作者</span>
                  <span><a href="/authors/崔庆才" class="author" itemprop="url" rel="index">崔庆才</a></span>
                </span>
                <span class="post-meta-item">
                  <span class="post-meta-item-icon">
                    <i class="far fa-calendar"></i>
                  </span>
                  <span class="post-meta-item-text">发表于</span>
                  <time title="创建时间：2019-07-02 11:04:40" itemprop="dateCreated datePublished" datetime="2019-07-02T11:04:40+08:00">2019-07-02</time>
                </span>
                <span id="/6759.html" class="post-meta-item leancloud_visitors" data-flag-title="2019 WordPress 必备插件推荐" title="阅读次数">
                  <span class="post-meta-item-icon">
                    <i class="fa fa-eye"></i>
                  </span>
                  <span class="post-meta-item-text">阅读次数：</span>
                  <span class="leancloud-visitors-count"></span>
                </span>
                <span class="post-meta-item" title="本文字数">
                  <span class="post-meta-item-icon">
                    <i class="far fa-file-word"></i>
                  </span>
                  <span class="post-meta-item-text">本文字数：</span>
                  <span>3.7k</span>
                </span>
                <span class="post-meta-item" title="阅读时长">
                  <span class="post-meta-item-icon">
                    <i class="far fa-clock"></i>
                  </span>
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                  <span>3 分钟</span>
                </span>
              </div>
            </article>
            <article itemscope itemtype="http://schema.org/Article" class="post-block index" lang="zh-CN">
              <link itemprop="mainEntityOfPage" href="https://cuiqingcai.com/6730.html">
              <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
                <meta itemprop="image" content="/images/avatar.png">
                <meta itemprop="name" content="崔庆才">
                <meta itemprop="description" content="崔庆才的个人站点，记录生活的瞬间，分享学习的心得。">
              </span>
              <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
                <meta itemprop="name" content="静觅">
              </span>
              <header class="post-header">
                <h2 class="post-title" itemprop="name headline">
                  <a class="label"> JavaScript <i class="label-arrow"></i>
                  </a>
                  <a href="/6730.html" class="post-title-link" itemprop="url">滑动验证码的原理并利用 Vue 实现滑动验证码</a>
                </h2>
              </header>
              <div class="post-body" itemprop="articleBody">
                <div class="thumb">
                  <img itemprop="contentUrl" class="random">
                </div>
                <div class="excerpt">
                  <p>
                  <p>做网络爬虫的同学肯定见过各种各样的验证码，比较高级的有滑动、点选等样式，看起来好像挺复杂的，但实际上它们的核心原理还是还是很清晰的，本文章大致说明下这些验证码的原理以及带大家实现一个滑动验证码。 我之前做过 Web 相关开发，尝试对接过 Lavavel 的极验验证，当时还开发了一个 Lavavel 包：<a href="https://github.com/Germey/LaravelGeetest" target="_blank" rel="noopener">https://github.com/Germey/LaravelGeetest</a>，在开发包的过程中了解到了验证码的两步校验规则。 实际上这类验证码的校验是分为两个步骤的：</p>
                  <ol>
                    <li>第一步就是前端的校验。一般来说，登录注册页面在点击提交的时候都会伴随着一个表单提交，在表单提交的时候会有 JavaScript 事件的触发。如果加入了验证码，那么在表单提交的时候会多加一个额外的验证，判断这个验证码是否已经成功完成了操作。如果没有的话，那就直接取消表单的提交，然后顺便提示说”您的验证没通过，请重新验证“，诸如此类的话。所以这一步就能防范”君子“只为了。</li>
                    <li>第二步就是服务端的校验。意思就是说表单提交之后，会有请求发送到服务器，这个请求中包含了很多数据，比如用户名、密码，如果对接了验证码的话，还会有额外的验证码的值，或者更复杂的加密后的 Token 值，服务器会对发过来的信息进行校验，如果验证通过，那么整个请求就成功了，返回正常的响应，否则返回错误的响应。所以如果想要通过程序来直接构造表单提交的时候，服务端就可以做进一步的校验，由于提交的验证码相关的信息都是和服务端的 Session 相关联的，另外再加上一些 CSRF 等的校验，所以这一步就能防范”小人“之为了。</li>
                  </ol>
                  <p>上面就是验证码校验的两个阶段，一般来说为了安全性，在开发一个网站时需要客户端和服务端都加上校验，这样才能保证安全性。 本文章主要来介绍一下第一个阶段，也就是前端校验的验证码的实现，下面来介绍一下拖动验证码的具体实现。</p>
                  <h2 id="需求"><a href="#需求" class="headerlink" title="需求"></a>需求</h2>
                  <p>那么前端完成一个合格的验证码，究竟需要做成什么样子呢？</p>
                  <ol>
                    <li>首先验证码有个大体的雏形，既然是拖动验证码，那就要拖动块和目标块，我们需要把拖动块拖动到目标块上就算校验成功。</li>
                    <li>验证码的一个功能就是来规避机器的自动操作，所以我们需要通过轨迹来判断这个拖动过程是真实的人还是机器，因此我们需要记录拖动的路径，路径经过计算之后可以发送到后端进行进一步的分类，比如对接深度学习模型来分类拖动轨迹是否是人。</li>
                  </ol>
                  <p>以上就是验证码的两个基本要求，所以我们这里就来实现一下看看。</p>
                  <h2 id="结果"><a href="#结果" class="headerlink" title="结果"></a>结果</h2>
                  <p>这里就先给大家看看结果吧： <img src="https://qiniu.cuiqingcai.com/2019-06-26-061556.gif" alt="拖动验证码示例"> 可以看到图中有一个初始滑块，有一个目标滑块，如果把初始滑块拖动到目标滑块上才能校验成功，然后下方再打印拖动的轨迹，包含它的 x、y 坐标。 有了这些内容之后，就可以放到表单里面进行提交了，轨迹数据可以自行加密处理并校验来判断其是否合法。</p>
                  <h2 id="具体实现"><a href="#具体实现" class="headerlink" title="具体实现"></a>具体实现</h2>
                  <p>下面就具体讲解下这个是怎么实现的，实际上核心代码只有 200 行，下面对整个核心流程进行说明。 既然 Vue 这么火，那我这里就用 Vue 来实现啦，具体的环境配置这里就不再赘述了，需要安装的有：</p>
                  <ul>
                    <li>Node.js：<a href="https://nodejs.org/en/" target="_blank" rel="noopener">https://nodejs.org/en/</a></li>
                    <li>Vue-Cli：<a href="https://cli.vuejs.org/zh/" target="_blank" rel="noopener">https://cli.vuejs.org/zh/</a></li>
                  </ul>
                  <p>安装完成之后便可以使用 vue 命令了，新建个项目：</p>
                  <figure class="highlight ebnf">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="attribute">vue create drag-captcha</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>然后找一张不错的风景图，放到 public 目录下，后面我们会引用它。 另外这里需要一个核心的包叫做 vue-drag-drop，其 GitHub 地址为：<a href="https://github.com/cameronhimself/vue-drag-drop" target="_blank" rel="noopener">https://github.com/cameronhimself/vue-drag-drop</a>，在目录下使用此命令安装：</p>
                  <figure class="highlight gauss">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">npm install --<span class="keyword">save</span> vue-drag-<span class="built_in">drop</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>安装好了之后我们就可以利用它来实现验证码了。 首先 vue-drag-drop 提供了两个组件，一个叫做 Drag，一个叫做 Drop。前者是被拖动对象，后者是放置目标，我们利用这两个组件构建两个滑块，将 Drag 滑块拖动到 Drop 滑块上就成功了。因此，我们要做的仅仅是把它们两个声明出来并添加几个检测方法就好了，至于拖动的功能，vue-drag-drop 这个组件已经给我们封装好了。 这里我们就直接在 App.vue 里面修改内容就好了，在 <code>&lt;template&gt;</code> 里面先声明一下两个组件：</p>
                  <figure class="highlight applescript">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;<span class="keyword">div</span> <span class="built_in">id</span>=<span class="string">"app"</span>&gt;</span><br><span class="line">    &lt;<span class="keyword">div</span> <span class="built_in">id</span>=<span class="string">"wrapper"</span> :style=<span class="string">"wrapperStyle"</span>&gt;</span><br><span class="line">      &lt;drop <span class="built_in">class</span>=<span class="string">"drop"</span> <span class="built_in">id</span>=<span class="string">"target"</span></span><br><span class="line">            :<span class="built_in">class</span>=<span class="string">"&#123; 'over': state.over &#125;"</span></span><br><span class="line">            @dragover=<span class="string">"onDragOver"</span></span><br><span class="line">            @dragleave=<span class="string">"onDragLeave"</span></span><br><span class="line">            :style=<span class="string">"targetStyle"</span>&gt;</span><br><span class="line">      &lt;/drop&gt;</span><br><span class="line">      &lt;drag <span class="built_in">class</span>=<span class="string">"drag"</span> <span class="built_in">id</span>=<span class="string">"source"</span></span><br><span class="line">            :transfer-data=<span class="string">"true"</span></span><br><span class="line">            @dragstart=<span class="string">"onDragStart"</span></span><br><span class="line">            @dragend=<span class="string">"onDragEnd"</span></span><br><span class="line">            @drag=<span class="string">"onDrag"</span> v-<span class="keyword">if</span>=<span class="string">"!state.dragged"</span></span><br><span class="line">            :style=<span class="string">"sourceStyle"</span>&gt;</span><br><span class="line">        &lt;<span class="keyword">div</span> slot=<span class="string">"image"</span> <span class="built_in">id</span>=<span class="string">"float"</span> :style=<span class="string">"sourceStyle"</span>&gt;</span><br><span class="line">        &lt;/<span class="keyword">div</span>&gt;</span><br><span class="line">      &lt;/drag&gt;</span><br><span class="line">    &lt;/<span class="keyword">div</span>&gt;</span><br><span class="line">  &lt;/<span class="keyword">div</span>&gt;</span><br><span class="line">&lt;/template&gt;</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>很清晰了，一个 <code>&lt;drop&gt;</code> 和一个 <code>&lt;drag&gt;</code> 组件，里面绑定了一些属性，下面对这两个组件的常用属性作一下说明。</p>
                  <h3 id="Drop"><a href="#Drop" class="headerlink" title="Drop"></a>Drop</h3>
                  <p>对于 Drop 组件来说，它是一个被放置的对象，被拖动滑块会放到这个 Drop 滑块上，这就代表拖动成功了。它有两个主要的事件需要监听，一个叫做 dragover，一个叫做 dragleave，分别用来监听 Drag 对象拖上和拖开的事件。 在这里，分别对两个事件设置了 onDragOver 和 onDragLeave 的回调函数，当 Drag 对象放到 Drop 对象上面的时候，就会触发 onDragOver 对象，当拖开的时候就会触发 onDragLeave 事件。 那这样的话我们只需要一个全局变量来记录是否已经将滑块拖动到目标位置即可，比如可以定一个全局变量 state，我们用 over 属性来代表是否拖动到目标位置。 因此 onDragOver 和 onDragLeave 事件可以这么实现：</p>
                  <figure class="highlight pf">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">on</span>DragOver() &#123;</span><br><span class="line">    this.<span class="keyword">state</span>.over = true</span><br><span class="line">&#125;,</span><br><span class="line"><span class="keyword">on</span>DragLeave() &#123;</span><br><span class="line">    this.<span class="keyword">state</span>.over = false</span><br><span class="line">&#125;</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <h3 id="Drag"><a href="#Drag" class="headerlink" title="Drag"></a>Drag</h3>
                  <p>对于 Drag 组件来说，它是一个被拖动的对象，我们需要将这个 Drag 滑块拖动到 Drop 滑块上，就代表拖动成功了。它有三个主要的时间需要监听：dragstart、drag、dragend，分别代表拖动开始、拖动中、拖动结束三个事件，我们这里也分别设置了三个回调方法 onDragStart、onDrag、onDragEnd。 对于 onDragStart 方法来说，应该怎么实现呢？这里应该处理刚拖动的一瞬间的动作，由于我们需要记录拖动的轨迹，所以声明一个 trace 全局变量来保存轨迹信息，onDragStart 要做的就是初始化 trace 对象为空，另外记录一下初始的拖动位置，以便后续计算拖动路径，所以可以实现如下：</p>
                  <figure class="highlight stylus">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="function"><span class="title">onDragStart</span><span class="params">(data, event)</span></span> &#123;</span><br><span class="line">    this<span class="selector-class">.init</span> = &#123;</span><br><span class="line">        x: event<span class="selector-class">.offsetX</span>,</span><br><span class="line">        y: event<span class="selector-class">.offsetY</span>,</span><br><span class="line">    &#125;</span><br><span class="line">    this<span class="selector-class">.trace</span> = []</span><br><span class="line">&#125;</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>对于 onDrag 方法来说，就是处理拖动过程中的一系列拖动动作，这里其实就是计算当前拖动的偏移位置，然后把它保存到 trace 变量里面，所以可以实现如下：</p>
                  <figure class="highlight stylus">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="function"><span class="title">onDrag</span><span class="params">(data, event)</span></span> &#123;</span><br><span class="line">    let offsetX = event<span class="selector-class">.offsetX</span> - this<span class="selector-class">.init</span>.x</span><br><span class="line">    let offsetY = event<span class="selector-class">.offsetY</span> - this<span class="selector-class">.init</span>.y</span><br><span class="line">    this<span class="selector-class">.trace</span>.push(&#123;</span><br><span class="line">        x: offsetX,</span><br><span class="line">        y: offsetY,</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>对于 onDragEnd 方法来说，其实就是检测最后的结果了，刚才我们用 state 变量里面的 over 属性来代表是否拖动到目标位置上，这里我们也定义了另外的 dragged 属性来代表是否已经拖动完成，dragging 属性来代表是否正在拖动，所以整个方法的逻辑上是检测 over 属性，然后对 dragging、dragged 属性做赋值，然后做一些相应的提示，实现如下：</p>
                  <figure class="highlight pf">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">on</span>DragEnd() &#123;</span><br><span class="line">  if (this.<span class="keyword">state</span>.over) &#123;</span><br><span class="line">    this.<span class="keyword">state</span>.dragging = false</span><br><span class="line">    this.<span class="keyword">state</span>.dragged = true</span><br><span class="line">    this.<span class="variable">$message</span>.success('拖动成功')</span><br><span class="line">  &#125;</span><br><span class="line">  else &#123;</span><br><span class="line">    this.<span class="keyword">state</span>.dragging = false</span><br><span class="line">    this.<span class="keyword">state</span>.dragged = false</span><br><span class="line">    this.<span class="variable">$message</span>.error('拖动失败')</span><br><span class="line">  &#125;</span><br><span class="line">  this.<span class="keyword">state</span>.over = false</span><br><span class="line"> &#125;</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>OK 了，以上便是主要的逻辑实现，这样我们就可以完成拖动滑块的定义以及拖动的监听了。 接下来就是一些样式上的问题了，对于图片的呈现，这里直接使用 CSS 的 background-image 样式来设置的，如果想显示图片的某一个范围，那就用 background-position 来设置，这是几个核心的要点。 好，这里的样式设置其实也可以用 JavaScript 来实现，我们把它们定义为一些计算属性：</p>
                  <figure class="highlight kotlin">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">wrapperStyle() &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    width: <span class="keyword">this</span>.size.width + <span class="string">'px'</span>,</span><br><span class="line">    height: <span class="keyword">this</span>.size.height + <span class="string">'px'</span>,</span><br><span class="line">    backgroundImage: <span class="string">'url('</span> + <span class="keyword">this</span>.image + <span class="string">')'</span>,</span><br><span class="line">    backgroundSize: <span class="string">'cover'</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br><span class="line">targetStyle() &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    left: <span class="keyword">this</span>.block.x + <span class="string">'px'</span>,</span><br><span class="line">    top: <span class="keyword">this</span>.block.y + <span class="string">'px'</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;,</span><br><span class="line">sourceStyle() &#123;</span><br><span class="line">  <span class="keyword">return</span> &#123;</span><br><span class="line">    backgroundImage: <span class="string">'url('</span> + <span class="keyword">this</span>.image + <span class="string">')'</span>,</span><br><span class="line">    backgroundSize: <span class="keyword">this</span>.size.width + <span class="string">'px '</span> + <span class="keyword">this</span>.size.height + <span class="string">'px'</span>,</span><br><span class="line">    backgroundPosition: -<span class="keyword">this</span>.block.x + <span class="string">'px '</span> + -<span class="keyword">this</span>.block.y + <span class="string">'px'</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>另外这里还有一个值得注意的地方，就是 Drag 组件的 slot 部分：</p>
                  <figure class="highlight elixir">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">&lt;div slot=<span class="string">"image"</span> id=<span class="string">"float"</span> <span class="symbol">:style=<span class="string">"sourceStyle"</span>&gt;&lt;/div&gt;</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>这部分定义了在拖动过程中随鼠标移动的图片样式，这里也和 Drag 滑块一样定义了一样的样式，这样在拖动的过程中，就会显示一个和 Drag 滑块一样的滑块随鼠标移动。 最后，就是拖拽完成之后，将滑动轨迹输出出来，这里我就直接呈现在页面上了，<code>&lt;template&gt;</code> 区域加入如下定义即可：</p>
                  <figure class="highlight django">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;<span class="name">p</span> <span class="attr">v-if</span>=<span class="string">"state.dragged"</span> <span class="attr">id</span>=<span class="string">"trace"</span>&gt;</span></span></span><br><span class="line"><span class="xml">    拖动轨迹：</span><span class="template-variable">&#123;&#123; trace &#125;&#125;</span></span><br><span class="line"><span class="xml">  <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>好，以上就是一些核心代码的介绍，还有一些细节的问题可以完善下，比如滑块随机初始化位置，以及拖动样式设置。 最后再看一遍效果： <img src="https://qiniu.cuiqingcai.com/2019-06-26-061556.gif" alt="拖动验证码示例"> 可以看到我们首先拖动了 Drag 滑块，当 Drag 滑块拖动到 Drop 滑块上时，出现了白色描边，证明已经拖动到目标位置了。然后松手之后，触发 onDragEnd 方法，呈现拖动轨迹，整个验证码就验证成功了。 当然这只是前端部分，如果在这个基础上添加表单验证，然后再添加后端校验，并加上轨迹识别，那可谓是一个完整的验证码系统了，在这里就点到为止啦。 最后如果大家想也仿照实现一下的话，可以参考这个组件：<a href="https://github.com/cameronhimself/vue-drag-drop" target="_blank" rel="noopener">https://github.com/cameronhimself/vue-drag-drop</a>，里面也介绍了其他的一些属性和事件，在某些情况下还是很有用的。 最后如果想获取本节代码，可以在「进击的Coder」公众号回复「验证码」获取。</p>
                  </p>
                </div>
              </div>
              <div class="post-meta">
                <span class="post-meta-item">
                  <span class="post-meta-item-icon">
                    <i class="far fa-user"></i>
                  </span>
                  <span class="post-meta-item-text">作者</span>
                  <span><a href="/authors/崔庆才" class="author" itemprop="url" rel="index">崔庆才</a></span>
                </span>
                <span class="post-meta-item">
                  <span class="post-meta-item-icon">
                    <i class="far fa-calendar"></i>
                  </span>
                  <span class="post-meta-item-text">发表于</span>
                  <time title="创建时间：2019-06-26 22:52:59" itemprop="dateCreated datePublished" datetime="2019-06-26T22:52:59+08:00">2019-06-26</time>
                </span>
                <span id="/6730.html" class="post-meta-item leancloud_visitors" data-flag-title="滑动验证码的原理并利用 Vue 实现滑动验证码" title="阅读次数">
                  <span class="post-meta-item-icon">
                    <i class="fa fa-eye"></i>
                  </span>
                  <span class="post-meta-item-text">阅读次数：</span>
                  <span class="leancloud-visitors-count"></span>
                </span>
                <span class="post-meta-item" title="本文字数">
                  <span class="post-meta-item-icon">
                    <i class="far fa-file-word"></i>
                  </span>
                  <span class="post-meta-item-text">本文字数：</span>
                  <span>5.2k</span>
                </span>
                <span class="post-meta-item" title="阅读时长">
                  <span class="post-meta-item-icon">
                    <i class="far fa-clock"></i>
                  </span>
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                  <span>5 分钟</span>
                </span>
              </div>
            </article>
            <article itemscope itemtype="http://schema.org/Article" class="post-block index" lang="zh-CN">
              <link itemprop="mainEntityOfPage" href="https://cuiqingcai.com/6721.html">
              <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
                <meta itemprop="image" content="/images/avatar.png">
                <meta itemprop="name" content="崔庆才">
                <meta itemprop="description" content="崔庆才的个人站点，记录生活的瞬间，分享学习的心得。">
              </span>
              <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
                <meta itemprop="name" content="静觅">
              </span>
              <header class="post-header">
                <h2 class="post-title" itemprop="name headline">
                  <a class="label"> Python <i class="label-arrow"></i>
                  </a>
                  <a href="/6721.html" class="post-title-link" itemprop="url">Python 深度学习脚手架 ModelZoo</a>
                </h2>
              </header>
              <div class="post-body" itemprop="articleBody">
                <div class="thumb">
                  <img itemprop="contentUrl" class="random">
                </div>
                <div class="excerpt">
                  <p>
                  <p>想必大家都或多或少听过 TensorFlow 的大名，这是 Google 开源的一个深度学习框架，里面的模型和 API 可以说基本是一应俱全，但 TensorFlow 其实有很多让人吐槽的地方，比如 TensorFlow 早期是只支持静态图的，你要调试和查看变量的值的话就得一个个变量运行查看它的结果，这是极其不友好的，而 PyTorch、Chainer 等框架就天生支持动态图，可以直接进行调试输出，非常方便。另外 TensorFlow 的 API 各个版本之间经常会出现不兼容的情况，比如 1.4 升到 1.7，里面有相当一部分 API 都被改了，里面有的是 API 名，有的直接改参数名，有的还给你改参数的顺序，如果要做版本兼容升级，非常痛苦。还有就是用 TensorFlow 写个模型，其实相对还是比较繁琐的，需要定义模型图，配置 Loss Function，配置 Optimizer，配置模型保存位置，配置 Tensor Summary 等等，其实并没有那么简洁。 然而为啥这么多人用 TensorFlow？因为它是 Google 家的，社区庞大，还有一个原因就是 API 你别看比较杂，但是确实比较全，contrib 模块里面你几乎能找到你想要的所有实现，而且更新确实快，一些前沿论文现在基本都已经在新版本里面实现了，所以，它的确是有它自己的优势。 然后再说说 Keras，这应该是除了 TensorFlow 之外，用的第二广泛的框架了，如果你用过 TensorFlow，再用上 Keras，你会发现用 Keras 搭模型实在是太方便了，而且如果你仔细研究下它的 API 设计，你会发现真的封装的非常科学，我感觉如果要搭建一个简易版的模型，Keras 起码得节省一半时间吧。 一个好消息是 TensorFlow 现在已经把 Keras 包进来了，也就是说如果你装了 TensorFlow，那就能同时拥有 TensorFlow 和 Keras 两个框架，哈哈，所以你最后还是装个 TensorFlow 就够了。 还有另一个好消息，刚才我不是吐槽了 TensorFlow 的静态图嘛？这的确是个麻烦的东西，不过现在的 TensorFlow 不一样了，它支持了 Eager 模式，也就是支持了动态图，有了它，我们可以就像写 Numpy 操作一样来搭建模型了，要看某个变量的值，很简单，直接 print 就 OK 了，不需要再去调用各种 run 方法了，可以直接抛弃 Session 这些繁琐的东西，所以基本上和 PyTorch 是一个套路的了，而且这个 Eager 模式在后续的 TensorFlow 2.0 版本将成为主打模式。简而言之，TensorFlow 比之前好用多了！ 好，以上说了这么多，我今天的要说的正题是什么呢？嗯，就是我基于 TensorFlow Eager 模式和 Keras 写了一个深度学习的框架。说框架也不能说框架，更准确地说应该叫脚手架，项目名字叫做 ModelZoo，中文名字可以理解成模型动物园。 有了这个脚手架，我们可以更加方便地实现一个深度学习模型，进一步提升模型开发的效率。 另外，既然是 ModelZoo，模型必不可少，我也打算以后把一些常用的模型来基于这个脚手架的架构实现出来，开源供大家使用。</p>
                  <h2 id="动机"><a href="#动机" class="headerlink" title="动机"></a>动机</h2>
                  <p>有人说，你这不是闲的蛋疼吗？人家 Keras 已经封装得很好了，你还写个啥子哦？嗯，没错，它的确是封装得很好了，但是我觉得某些地方是可以写得更精炼的。比如说，Keras 里面在模型训练的时候可以自定义 Callback，比如可以实现 Tensor Summary 的记录，可以保存 Checkpoint，可以配置 Early Stop 等等，但基本上，你写一个模型就要配一次吧，即使没几行代码，但这些很多情况都是需要配置的，所以何必每个项目都要再去写一次呢？所以，这时候就可以把一些公共的部分抽离出来，做成默认的配置，省去不必要的麻烦。 另外，我在使用过程中发现 Keras 的某些类并没有提供我想要的某些功能，所以很多情况下我需要重写某个功能，然后自己做封装，这其实也是一个可抽离出来的组件。 另外还有一个比较重要的一点就是，Keras 里面默认也不支持 Eager 模式，而 TensorFlow 新的版本恰恰又有了这一点，所以二者的兼并必然是一个绝佳的组合。 所以我写这个框架的目的是什么呢？</p>
                  <ul>
                    <li>第一，模型存在很多默认配置且可复用的地方，可以将默认的一些配置在框架中进行定义，这样我们只需要关注模型本身就好了。</li>
                    <li>第二，TensorFlow 的 Eager 模式便于 TensorFlow 的调试，Keras 的高层封装 API 便于快速搭建模型，取二者之精华。</li>
                    <li>第三，现在你可以看到要搜一个模型，会有各种花式的实现，有的用的这个框架，有的用的那个框架，而且参数、数据输入输出方式五花八门，实在是让人头大，定义这个脚手架可以稍微提供一些规范化的编写模式。</li>
                    <li>第四，框架名称叫做 ModelZoo，但我的理想也并不仅仅于实现一个简单的脚手架，我的愿景是把当前业界流行的模型都用这个框架实现出来，格式规范，API 统一，开源之后分享给所有人用，给他人提供便利。</li>
                  </ul>
                  <p>所以，ModelZoo 诞生了！</p>
                  <h2 id="开发过程"><a href="#开发过程" class="headerlink" title="开发过程"></a>开发过程</h2>
                  <p>开发的时候，我自己首先先实现了一些基本的模型，使用的是 TensorFlow Eager 和 Keras，然后试着抽离出来一些公共部分，将其封装成基础类，同时把模型独有的实现放开，供子类复写。然后在使用过程中自己还封装和改写过一些工具类，这部分也集成进来。另外就是把一些配置都规范化，将一些常用参数配置成默认参数，同时放开重写开关，在外部可以重定义。 秉承着上面的思想，我大约是在 10 月 6 日 那天完成了框架的搭建，然后在后续的几天基于这个框架实现了几个基础模型，最终打磨成了现在的样子。</p>
                  <h2 id="框架介绍"><a href="#框架介绍" class="headerlink" title="框架介绍"></a>框架介绍</h2>
                  <p>GitHub 地址：<a href="https://github.com/ModelZoo/ModelZoo" target="_blank" rel="noopener">https://github.com/ModelZoo/ModelZoo</a> 框架我已经发布到 PyPi，直接使用 pip 安装即可，目前支持 Python3，Python 2 尚未做测试，安装方式：</p>
                  <figure class="highlight sql">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">pip3 <span class="keyword">install</span> <span class="keyword">model</span>-zoo</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>其实我是很震惊，这个名字居然没有被注册！GitHub 和 PyPi 都没有！不过现在已经被我注册了。 OK，接下来让我们看看用了它能怎样快速搭建一个模型吧！ 我们就以基本的线性回归模型为例来说明吧，这里有一组数据，是波士顿房价预测数据，输入是影响房价的各个因素，输出是房价本身，具体的数据集可以搜 Boston housing price regression dataset 了解一下。 总之，我们只需要知道这是一个回归模型就好了，输入 x 是一堆 Feature，输出 y 是一个数值，房价。好，那么我们就开始定义模型吧，模型的定义我们继承 ModelZoo 里面的 BaseModel 就好了，实现 model.py 如下：</p>
                  <figure class="highlight haskell">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="title">from</span> model_zoo.model <span class="keyword">import</span> BaseModel</span><br><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="type">BostonHousingModel</span>(<span class="type">BaseModel</span>):</span></span><br><span class="line"><span class="class">    def __init__(<span class="title">self</span>, <span class="title">config</span>):</span></span><br><span class="line"><span class="class">        super(<span class="type">BostonHousingModel</span>, <span class="title">self</span>).__init__(<span class="title">config</span>)</span></span><br><span class="line"><span class="class">        self.dense = tf.keras.layers.<span class="type">Dense</span>(1)</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">    def call(<span class="title">self</span>, <span class="title">inputs</span>, <span class="title">training</span>=<span class="type">None</span>, <span class="title">mask</span>=<span class="type">None</span>):</span></span><br><span class="line"><span class="class">        o = self.dense(<span class="title">inputs</span>)</span></span><br><span class="line"><span class="class">        return o</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>好了，这就定义完了！有人会说，你的 Loss Function 呢？你的 Optimizer 呢？你的 Checkpoint 保存呢？你的 Tensor Summary 呢？不需要！因为我已经把这些配置封装到 BaseModel 了，有默认的 Loss Function、Optimizer、Checkpoint、Early Stop、Tensor Summary，这里只需要关注模型本身即可。 有人说，要是想自定义 Loss Function 咋办呢？自定义 Optimizer 咋办呢？很简单，只需要复写一些基本的配置或复写某个方法就好了。 如改写 Optimizer，只需要重写 optimizer 方法即可：</p>
                  <figure class="highlight ruby">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">optimizer</span><span class="params">(<span class="keyword">self</span>)</span></span><span class="symbol">:</span></span><br><span class="line">    <span class="keyword">return</span> tf.train.AdamOptimizer(<span class="number">0</span>.<span class="number">001</span>)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>好，定义了模型之后怎么办？那当然是拿数据训练了，又要写数据加载，数据标准化，数据切分等等操作了吧，写到什么方法里？定义成什么样比较科学？现在，我们只需要实现一个 Trainer 就好了，然后复写 prepare_data 方法就好了，实现 train.py 如下：</p>
                  <figure class="highlight python">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"><span class="keyword">from</span> model_zoo.trainer <span class="keyword">import</span> BaseTrainer</span><br><span class="line"><span class="keyword">from</span> model_zoo.preprocess <span class="keyword">import</span> standardize</span><br><span class="line"></span><br><span class="line">tf.flags.DEFINE_integer(<span class="string">'epochs'</span>, <span class="number">100</span>, <span class="string">'Max epochs'</span>)</span><br><span class="line">tf.flags.DEFINE_string(<span class="string">'model_class'</span>, <span class="string">'BostonHousingModel'</span>, <span class="string">'Model class name'</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Trainer</span><span class="params">(BaseTrainer)</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">prepare_data</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">from</span> tensorflow.python.keras.datasets <span class="keyword">import</span> boston_housing</span><br><span class="line">        (x_train, y_train), (x_eval, y_eval) = boston_housing.load_data()</span><br><span class="line">        x_train, x_eval = standardize(x_train, x_eval)</span><br><span class="line">        train_data, eval_data = (x_train, y_train), (x_eval, y_eval)</span><br><span class="line">        <span class="keyword">return</span> train_data, eval_data</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    Trainer().run()</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>好了，完事了，模型现在已经全部搭建完成！在这里只需要实现 prepare_data 方法，返回训练集和验证集即可，其他的什么都不需要！ 数据标准化在哪做的？这里我也封装好了方法。 运行在哪运行的？这里我也做好了封装。 模型保存在哪里做的？同样做好了封装。 Batch 切分怎么做的？这里也做好了封装。 我们只需要按照格式，返回这两组数据就好了，其他的什么都不用管！ 那同样的，模型保存位置，模型名称，Batch Size 多大，怎么设置？还是简单改下配置就好了。 如要修改模型保存位置，只需要复写一个 Flag 就好了：</p>
                  <figure class="highlight reasonml">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">tf.flags.<span class="constructor">DEFINE_string('<span class="params">checkpoint_dir</span>', '<span class="params">checkpoints</span>', <span class="params">help</span>='Data <span class="params">source</span> <span class="params">dir</span>')</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>好了，现在模型可以训练了！直接运行上面的代码就好了：</p>
                  <figure class="highlight vim">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">python3</span> train.<span class="keyword">py</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>结果是这样子的：</p>
                  <figure class="highlight routeros">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">Epoch 1/100</span><br><span class="line"> 1/13 [=&gt;<span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span>] - ETA: 0s - loss: 816.1798</span><br><span class="line">13/13 [==============================] - 0s 4ms/<span class="keyword">step</span> - loss: 457.9925 - val_loss: 343.2489</span><br><span class="line"></span><br><span class="line">Epoch 2/100</span><br><span class="line"> 1/13 [=&gt;<span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span>] - ETA: 0s - loss: 361.5632</span><br><span class="line">13/13 [==============================] - 0s 3ms/<span class="keyword">step</span> - loss: 274.7090 - val_loss: 206.7015</span><br><span class="line">Epoch 00002: saving model <span class="keyword">to</span> checkpoints/model.ckpt</span><br><span class="line"></span><br><span class="line">Epoch 3/100</span><br><span class="line"> 1/13 [=&gt;<span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span>] - ETA: 0s - loss: 163.5308</span><br><span class="line">13/13 [==============================] - 0s 3ms/<span class="keyword">step</span> - loss: 172.4033 - val_loss: 128.0830</span><br><span class="line"></span><br><span class="line">Epoch 4/100</span><br><span class="line"> 1/13 [=&gt;<span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span>] - ETA: 0s - loss: 115.4743</span><br><span class="line">13/13 [==============================] - 0s 3ms/<span class="keyword">step</span> - loss: 112.6434 - val_loss: 85.0848</span><br><span class="line">Epoch 00004: saving model <span class="keyword">to</span> checkpoints/model.ckpt</span><br><span class="line"></span><br><span class="line">Epoch 5/100</span><br><span class="line"> 1/13 [=&gt;<span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span>] - ETA: 0s - loss: 149.8252</span><br><span class="line">13/13 [==============================] - 0s 3ms/<span class="keyword">step</span> - loss: 77.0281 - val_loss: 57.9716</span><br><span class="line"><span class="built_in">..</span><span class="built_in">..</span></span><br><span class="line"></span><br><span class="line">Epoch 42/100</span><br><span class="line"> 7/13 [===============&gt;<span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span><span class="built_in">..</span>] - ETA: 0s - loss: 20.5911</span><br><span class="line">13/13 [==============================] - 0s 8ms/<span class="keyword">step</span> - loss: 22.4666 - val_loss: 23.7161</span><br><span class="line">Epoch 00042: saving model <span class="keyword">to</span> checkpoints/model.ckpt</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>可以看到模型每次运行都会实时输出训练集和验证集的 Loss 的变化，另外还会自动保存模型，自动进行 Early Stop，自动保存 Tensor Summary。 可以看到这里运行了 42 个 Epoch 就完了，为什么？因为 Early Stop 的存在，当验证集经过了一定的 Epoch 一直不见下降，就直接停了，继续训练下去也没什么意义了。Early Stop 哪里配置的？框架也封装好了。 然后我们还可以看到当前目录下还生成了 events 和 checkpoints 文件夹，这一个是 TensorFlow Summary，供 TensorBoard 看的，另一个是保存的模型文件。 现在可以打开 TensorBoard 看看有什么情况，运行命令：</p>
                  <figure class="highlight ebnf">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="attribute">cd events</span></span><br><span class="line"><span class="attribute">tensorboard --logdir</span>=.</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p><img src="https://qiniu.cuiqingcai.com/2019-06-25-115250.jpg" alt=""> 可以看到训练和验证的 Loss 都被记录下来，并化成了图表展示。而这些东西我们配置过吗？没有，因为框架封装好了。 好，现在模型有了，我们要拿来做预测咋做呢？又得构建一边图，又得重新加载模型，又得准备数据，又得切分数据等等，还是麻烦，并没有，这里只需要这么定义就好了，定义 infer.py 如下：</p>
                  <figure class="highlight python">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">from</span> model_zoo.inferer <span class="keyword">import</span> BaseInferer</span><br><span class="line"><span class="keyword">from</span> model_zoo.preprocess <span class="keyword">import</span> standardize</span><br><span class="line"><span class="keyword">import</span> tensorflow <span class="keyword">as</span> tf</span><br><span class="line"></span><br><span class="line">tf.flags.DEFINE_string(<span class="string">'checkpoint_name'</span>, <span class="string">'model.ckpt-20'</span>, help=<span class="string">'Model name'</span>)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Inferer</span><span class="params">(BaseInferer)</span>:</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">prepare_data</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="keyword">from</span> tensorflow.python.keras.datasets <span class="keyword">import</span> boston_housing</span><br><span class="line">        (x_train, y_train), (x_test, y_test) = boston_housing.load_data()</span><br><span class="line">        _, x_test = standardize(x_train, x_test)</span><br><span class="line">        <span class="keyword">return</span> x_test</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    result = Inferer().run()</span><br><span class="line">    print(result)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>这里只需要继承 BaseInferer，实现 prepare_data 方法就好了，返回的就是 test 数据集的 x 部分，其他的还是什么都不用干！ 另外这里额外定义了一个 Flag，就是 checkpoint_name，这个是必不可少的，毕竟要用哪个 Checkpoint 需要指定一下。 这里我们还是那数据集中的数据当测试数据，来看下它的输出结果：</p>
                  <figure class="highlight json">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">[[ <span class="number">9.637125</span> ]</span><br><span class="line"> [<span class="number">21.368305</span> ]</span><br><span class="line"> [<span class="number">20.898445</span> ]</span><br><span class="line"> [<span class="number">33.832504</span> ]</span><br><span class="line"> [<span class="number">25.756516</span> ]</span><br><span class="line"> [<span class="number">21.264557</span> ]</span><br><span class="line"> [<span class="number">29.069794</span> ]</span><br><span class="line"> [<span class="number">24.968184</span> ]</span><br><span class="line"> ...</span><br><span class="line"> [<span class="number">36.027283</span> ]</span><br><span class="line"> [<span class="number">39.06852</span>  ]</span><br><span class="line"> [<span class="number">25.728745</span> ]</span><br><span class="line"> [<span class="number">41.62165</span>  ]</span><br><span class="line"> [<span class="number">34.340042</span> ]</span><br><span class="line"> [<span class="number">24.821484</span> ]]</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>就这样，预测房价结果就计算出来了，这个和输入的 x 内容都是一一对应的。 那有人又说了，我如果想拿到模型中的某个变量结果怎么办？还是很简单，因为有了 Eager 模式，直接输出就好。我要自定义预测函数怎么办？也很简单，复写 infer 方法就好了。 好，到现在为止，我们通过几十行代码就完成了这些内容：</p>
                  <ul>
                    <li>数据加载和预处理</li>
                    <li>模型图的搭建</li>
                    <li>Optimizer 的配置</li>
                    <li>运行结果的保存</li>
                    <li>Early Stop 的配置</li>
                    <li>Checkpoint 的保存</li>
                    <li>Summary 的生成</li>
                    <li>预测流程的实现</li>
                  </ul>
                  <p>总而言之，用了这个框架可以省去很多不必要的麻烦，同时相对来说比较规范，另外灵活可扩展。 以上就是 ModelZoo 的一些简单介绍。</p>
                  <h2 id="愿景"><a href="#愿景" class="headerlink" title="愿景"></a>愿景</h2>
                  <p>现在这个框架刚开发出来几天，肯定存在很多不成熟的地方，另外文档也还没有来得及写，不过我肯定是准备长期优化和维护下去的。另外既然取名叫做 ModelZoo，我后面也会把一些常用的深度学习模型基于该框架实现出来并发布，包括 NLP、CV 等各大领域，同时在实现过程中，也会发现框架本身的一些问题，并不断迭代优化。 比如基于该框架实现的人脸情绪识别的项目：<a href="https://github.com/ModelZoo/EmotionRecognition" target="_blank" rel="noopener">https://github.com/ModelZoo/EmotionRecognition</a> 其识别准确率还是可以的，比如输入这些图片： <img src="https://qiniu.cuiqingcai.com/2019-06-25-115311.jpg" alt=""> 模型便可以输出对应的情绪类型和情绪分布：</p>
                  <figure class="highlight yaml">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="attr">Image Path:</span> <span class="string">test1.png</span></span><br><span class="line"><span class="attr">Predict Result:</span> <span class="string">Happy</span></span><br><span class="line"><span class="attr">Emotion Distribution:</span> <span class="string">&#123;'Angry':</span> <span class="number">0.0</span><span class="string">,</span> <span class="attr">'Disgust':</span> <span class="number">0.0</span><span class="string">,</span> <span class="attr">'Fear':</span> <span class="number">0.0</span><span class="string">,</span> <span class="attr">'Happy':</span> <span class="number">1.0</span><span class="string">,</span> <span class="attr">'Sad':</span> <span class="number">0.0</span><span class="string">,</span> <span class="attr">'Surprise':</span> <span class="number">0.0</span><span class="string">,</span> <span class="attr">'Neutral':</span> <span class="number">0.0</span><span class="string">&#125;</span></span><br><span class="line"><span class="string">====================</span></span><br><span class="line"><span class="attr">Image Path:</span> <span class="string">test2.png</span></span><br><span class="line"><span class="attr">Predict Result:</span> <span class="string">Happy</span></span><br><span class="line"><span class="attr">Emotion Distribution:</span> <span class="string">&#123;'Angry':</span> <span class="number">0.0</span><span class="string">,</span> <span class="attr">'Disgust':</span> <span class="number">0.0</span><span class="string">,</span> <span class="attr">'Fear':</span> <span class="number">0.0</span><span class="string">,</span> <span class="attr">'Happy':</span> <span class="number">0.998</span><span class="string">,</span> <span class="attr">'Sad':</span> <span class="number">0.0</span><span class="string">,</span> <span class="attr">'Surprise':</span> <span class="number">0.0</span><span class="string">,</span> <span class="attr">'Neutral':</span> <span class="number">0.002</span><span class="string">&#125;</span></span><br><span class="line"><span class="string">====================</span></span><br><span class="line"><span class="attr">Image Path:</span> <span class="string">test3.png</span></span><br><span class="line"><span class="attr">Predict Result:</span> <span class="string">Surprise</span></span><br><span class="line"><span class="attr">Emotion Distribution:</span> <span class="string">&#123;'Angry':</span> <span class="number">0.0</span><span class="string">,</span> <span class="attr">'Disgust':</span> <span class="number">0.0</span><span class="string">,</span> <span class="attr">'Fear':</span> <span class="number">0.0</span><span class="string">,</span> <span class="attr">'Happy':</span> <span class="number">0.0</span><span class="string">,</span> <span class="attr">'Sad':</span> <span class="number">0.0</span><span class="string">,</span> <span class="attr">'Surprise':</span> <span class="number">1.0</span><span class="string">,</span> <span class="attr">'Neutral':</span> <span class="number">0.0</span><span class="string">&#125;</span></span><br><span class="line"><span class="string">====================</span></span><br><span class="line"><span class="attr">Image Path:</span> <span class="string">test4.png</span></span><br><span class="line"><span class="attr">Predict Result:</span> <span class="string">Angry</span></span><br><span class="line"><span class="attr">Emotion Distribution:</span> <span class="string">&#123;'Angry':</span> <span class="number">1.0</span><span class="string">,</span> <span class="attr">'Disgust':</span> <span class="number">0.0</span><span class="string">,</span> <span class="attr">'Fear':</span> <span class="number">0.0</span><span class="string">,</span> <span class="attr">'Happy':</span> <span class="number">0.0</span><span class="string">,</span> <span class="attr">'Sad':</span> <span class="number">0.0</span><span class="string">,</span> <span class="attr">'Surprise':</span> <span class="number">0.0</span><span class="string">,</span> <span class="attr">'Neutral':</span> <span class="number">0.0</span><span class="string">&#125;</span></span><br><span class="line"><span class="string">====================</span></span><br><span class="line"><span class="attr">Image Path:</span> <span class="string">test5.png</span></span><br><span class="line"><span class="attr">Predict Result:</span> <span class="string">Fear</span></span><br><span class="line"><span class="attr">Emotion Distribution:</span> <span class="string">&#123;'Angry':</span> <span class="number">0.04</span><span class="string">,</span> <span class="attr">'Disgust':</span> <span class="number">0.002</span><span class="string">,</span> <span class="attr">'Fear':</span> <span class="number">0.544</span><span class="string">,</span> <span class="attr">'Happy':</span> <span class="number">0.03</span><span class="string">,</span> <span class="attr">'Sad':</span> <span class="number">0.036</span><span class="string">,</span> <span class="attr">'Surprise':</span> <span class="number">0.31</span><span class="string">,</span> <span class="attr">'Neutral':</span> <span class="number">0.039</span><span class="string">&#125;</span></span><br><span class="line"><span class="string">====================</span></span><br><span class="line"><span class="attr">Image Path:</span> <span class="string">test6.png</span></span><br><span class="line"><span class="attr">Predict Result:</span> <span class="string">Sad</span></span><br><span class="line"><span class="attr">Emotion Distribution:</span> <span class="string">&#123;'Angry':</span> <span class="number">0.005</span><span class="string">,</span> <span class="attr">'Disgust':</span> <span class="number">0.0</span><span class="string">,</span> <span class="attr">'Fear':</span> <span class="number">0.027</span><span class="string">,</span> <span class="attr">'Happy':</span> <span class="number">0.002</span><span class="string">,</span> <span class="attr">'Sad':</span> <span class="number">0.956</span><span class="string">,</span> <span class="attr">'Surprise':</span> <span class="number">0.0</span><span class="string">,</span> <span class="attr">'Neutral':</span> <span class="number">0.009</span><span class="string">&#125;</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>如果大家对这个框架感兴趣，或者也想加入实现一些有趣的模型的话，可以在框架主页提 Issue 留言，我非常欢迎你的加入！另外如果大家感觉框架有不足的地方，也非常欢迎提 Issue 或发 PR，非常非常感谢！ 最后，如果你喜欢的话，还望能赠予它一个 Star，这样我也更有动力去维护下去。 项目的 GitHub 地址：<a href="https://github.com/ModelZoo/ModelZoo" target="_blank" rel="noopener">https://github.com/ModelZoo/ModelZoo</a>。 谢谢！</p>
                  </p>
                </div>
              </div>
              <div class="post-meta">
                <span class="post-meta-item">
                  <span class="post-meta-item-icon">
                    <i class="far fa-user"></i>
                  </span>
                  <span class="post-meta-item-text">作者</span>
                  <span><a href="/authors/崔庆才" class="author" itemprop="url" rel="index">崔庆才</a></span>
                </span>
                <span class="post-meta-item">
                  <span class="post-meta-item-icon">
                    <i class="far fa-calendar"></i>
                  </span>
                  <span class="post-meta-item-text">发表于</span>
                  <time title="创建时间：2019-06-25 20:00:54" itemprop="dateCreated datePublished" datetime="2019-06-25T20:00:54+08:00">2019-06-25</time>
                </span>
                <span id="/6721.html" class="post-meta-item leancloud_visitors" data-flag-title="Python 深度学习脚手架 ModelZoo" title="阅读次数">
                  <span class="post-meta-item-icon">
                    <i class="fa fa-eye"></i>
                  </span>
                  <span class="post-meta-item-text">阅读次数：</span>
                  <span class="leancloud-visitors-count"></span>
                </span>
                <span class="post-meta-item" title="本文字数">
                  <span class="post-meta-item-icon">
                    <i class="far fa-file-word"></i>
                  </span>
                  <span class="post-meta-item-text">本文字数：</span>
                  <span>8.6k</span>
                </span>
                <span class="post-meta-item" title="阅读时长">
                  <span class="post-meta-item-icon">
                    <i class="far fa-clock"></i>
                  </span>
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                  <span>8 分钟</span>
                </span>
              </div>
            </article>
            <article itemscope itemtype="http://schema.org/Article" class="post-block index" lang="zh-CN">
              <link itemprop="mainEntityOfPage" href="https://cuiqingcai.com/6485.html">
              <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
                <meta itemprop="image" content="/images/avatar.png">
                <meta itemprop="name" content="崔庆才">
                <meta itemprop="description" content="崔庆才的个人站点，记录生活的瞬间，分享学习的心得。">
              </span>
              <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
                <meta itemprop="name" content="静觅">
              </span>
              <header class="post-header">
                <h2 class="post-title" itemprop="name headline">
                  <a class="label"> Python <i class="label-arrow"></i>
                  </a>
                  <a href="/6485.html" class="post-title-link" itemprop="url">Python 机器学习算法二之逻辑回归的推导及实战</a>
                </h2>
              </header>
              <div class="post-body" itemprop="articleBody">
                <div class="thumb">
                  <img itemprop="contentUrl" class="random">
                </div>
                <div class="excerpt">
                  <p>
                  <p>在线性回归模型中，我们实际上是建立了一个模型来拟合自变量和因变量之间的线性关系，但是在某些时候，我们要做的可能是一个分类模型，那么这里就可能用到线性回归模型的变种——逻辑回归，本节我们就逻辑回归来做一个详细的说明。</p>
                  <h2 id="实例引入"><a href="#实例引入" class="headerlink" title="实例引入"></a>实例引入</h2>
                  <p>我们还是以上一节的例子为例，张三、李四、王五、赵六都要贷款了，贷款时银行调查了他们的月薪和住房面积等因素，两个因素决定了贷款款项是否可以立即到账，下面列出来了他们四个人的工资情况、住房面积和到账的具体情况：</p>
                  <p>姓名</p>
                  <p>工资(元)</p>
                  <p>房屋面积(平方)</p>
                  <p>是否可立即到账</p>
                  <p>张三</p>
                  <p>6000</p>
                  <p>58</p>
                  <p>否</p>
                  <p>李四</p>
                  <p>9000</p>
                  <p>77</p>
                  <p>否</p>
                  <p>王五</p>
                  <p>11000</p>
                  <p>89</p>
                  <p>是</p>
                  <p>赵六</p>
                  <p>15000</p>
                  <p>54</p>
                  <p>是</p>
                  <p>看到了这样的数据，又来了一位孙七，他工资是 12000 元，房屋面积是 60 平，那的贷款可以立即到账吗？</p>
                  <h2 id="思路探索"><a href="#思路探索" class="headerlink" title="思路探索"></a>思路探索</h2>
                  <p>在这个例子中，我们不再是预测贷款金额具体是多少了，而是要对款项是否可以立即到账做一个分类，分类的结果要么是“否”要么是“是”，所以输出结果我们需要将其映射到一个区间内，让 0 代表“否”，1 代表“是”，这里我们就需要用一个函数来帮助我们实现这个功能，它的名字叫做 Sigmoid 函数，它的表达式是这样的： <script type="math/tex">g(z) = \\dfrac{1}{1+e^{-z}}</script> 它的函数图像是这样的： <img src="https://qiniu.cuiqingcai.com/2019-05-07-171241.jpg" alt=""> 它的定义域是全体实数，值域是 (0, 1)，当自变量小于 -5 的时候，其值就趋近于 0，当自变量大于 5 的时候，其值就趋近于 1，当自变量为 0 的时候，其值就等于 1/2。 所以我们如果在线性回归模型的基础上加一层 Sigmoid 函数，结果不就可以被转化为 0 到 1 了吗？这就很自然而然地转化为了一个分类模型。 我们知道，线性回归模型的表达形式是这样的： <script type="math/tex">h_{\\theta}(x) = \\sum_{i=0}^{n}\\theta_ix_i = \\theta^Tx</script> 如果我们在它的基础上加一层 Sigmoid 函数，其表达式就变成了： <script type="math/tex">h_{\\theta}(x) = g(\\theta^Tx) = \\dfrac{1}{1+e^{-\\theta^Tx}}</script> 好，现在我们来考虑下这个表达式表达的什么意思。 我们举例来说吧，如果这个函数的输出结果为 1，那么我们肯定认为结果为“是”。如果输出结果为 0 呢？我们就当然认为结果为 “否”了，但如果输出结果为 0.5 呢？我们只能模棱两可，此时我们既可以判断为“是”，也可以判断为“否”，但恰好为 0.5 的概率太小了，多多少少也有点偏差吧。所以如果输出结果为 0.51，那么我们怎么认为？我们认为“是”的概率会更大，否的概率更小，概率是多少？0.49。如果输出结果是 0.95 呢？“是”的概率是多少？不用多说，必然是 0.95。 因此，我们可以看出来，函数输出的结果就代表了预测为“是”的概率，也就是真实结果为 1 的概率。我们用公式表达下，这里我们用 $ h<em>{theta}(x) $ 表示预测结果，因此对于输入 x，分类类别为 1 和 0 的概率分别为： $$ \begin{cases} P(y = 1|x;\theta) = h</em>{\theta}(x) \\\\ P(y = 0|x;\theta) = 1 - h<em>{\theta}(x) \end{cases} <script type="math/tex">还是像线性回归一样，我们需要定义一个代价函数，让模型来优化这个代价函数。 在线性回归中，我们的代价函数是这样的：</script> J(\theta) = \dfrac{1}{2m}\sum</em>{i=1}^{m}(h<em>\theta(x^{(i)}) - y^{(i)})^2 <script type="math/tex">为什么是这样呢？是因为模型的输出结果和真实结果有一定的偏差，我们用它们的距离差的平方来定义了代价函数。 但是逻辑回归不一样啊，它又不是预测一个具体的数值，而是预测一个分类的概率，所以这里的代价函数我们可以写成这样子：</script> Cost(h</em>\theta(x), y) = \begin{cases} -log(h<em>\theta(x)), y = 1 \\\\ -log(1- h</em>\theta(x)), y = 0 \end{cases} <script type="math/tex">这里我们用了对数函数来定义它的损失值。比如当真实值 y 等于 1 的时候，如果我们的函数预测为 1，即 $ h_theta(x) $ 趋近于 1，这就代表预测对了，取对数再取反，结果趋近于 0，代表损失非常小。假如此时我们的函数预测结果趋近于 0，这就代表预测错了，取对数再取反，结果趋近于正无穷，代表损失特别大。所以，这个代价函数使用对数对预测错的结果进行了惩罚，偏离越大，其损失越大。 但是这个代价函数不好表示啊，我们想要把它写成一个表达式该怎么写？是这样的：</script> Cost(h<em>\theta(x), y) = -ylog(h</em>\theta(x)) - (1-y)log(1-h<em>\theta(x)) <script type="math/tex">这个式子和上面的式子是完全等价的。 好了，接下来我们计算所有样本的总的损失函数：</script> J(\theta) = \dfrac{1}{m}\sum</em>{i=1}^{m}Cost(h<em>\theta(x^{(i)}), y^{(i)})\\\\ = -\dfrac{1}{m}\sum</em>{i=1}^{m}[y^{(i)}log(h<em>\theta(x^{(i)})) + (1-y^{(i)})log(1-h</em>\theta(x^{(i)}))] $$ 和线性回归类似，这次我们的目的就是找到 $ theta $，使得 $ J(theta) $ 最小。</p>
                  <h2 id="推导过程"><a href="#推导过程" class="headerlink" title="推导过程"></a>推导过程</h2>
                  <p>这次我们就不能向上次一样用直接求偏导数，然后将偏导数置 0 的方法来求解 $ theta $ 了，这样是无法求解出具体的值的。 我们可以使用梯度下降法来进行求解，也就是一步步地求出 $theta$ 的更新过程，公式如下： <script type="math/tex">\\theta_j := \\theta_j - \\alpha\\dfrac{\\partial{J(\\theta)}}{\\partial(\\theta_j)}</script> 这里面最主要的就是求偏导，过程如下： <script type="math/tex">\\dfrac{\\partial{J(\\theta)}}{\\partial(\\theta_j)} \\\\\\\\ =-\\dfrac{1}{m}\\dfrac{\\partial{\\sum_{i=1}^{n}(y^{(i)}\\mathop{log}h_{\\theta}(x^{(i)}) + (1-y^{(i)})\\mathop{log}(1-h_{\\theta}(x^{(i)})))}}{\\partial(\\theta_j)} \\\\\\\\ =-\\dfrac{1}{m}\\sum_{i=1}^{n}(y^{(i)}\\dfrac{1}{h_{\\theta}(x^{(i)})}\\dfrac{\\partial{h_{\\theta}(x^{(i)})}}{\\partial{\\theta_j}} + (1-y^{(i)})\\dfrac{1}{1-h_{\\theta}(x^{(i)})}\\dfrac{\\partial{h_{\\theta}(x^{(i)})}}{\\partial{\\theta_j}}) \\\\\\\\ =-\\dfrac{1}{m}\\sum_{i=1}^{n}[y^{(i)}\\dfrac{1}{h_{\\theta}(x^{(i)})} + (1-y^{(i)})\\dfrac{1}{1-h_{\\theta}(x^{(i)})}] \\dfrac{\\partial{h_{\\theta}(x^{(i)})}}{\\partial{\\theta_j}} \\\\\\\\ =-\\dfrac{1}{m}\\sum_{i=1}^{n}[y^{(i)}\\dfrac{1}{h_{\\theta}(x^{(i)})} + (1-y^{(i)})\\dfrac{1}{1-h_{\\theta}(x^{(i)})}] h_{\\theta}(x^{(i)})(1-h_{\\theta}(x^{(i)}))\\dfrac{\\partial{\\theta^Tx^{(i)}}}{\\partial{\\theta_j}} \\\\\\\\ =-\\dfrac{1}{m}\\sum_{i=1}^{n}[y^{(i)}(1-h_{\\theta}(x^{(i)})) - (1-y^{(i)})h_{\\theta}(x^{(i)})]x_j^{(i)} \\\\\\\\ =-\\dfrac{1}{m}\\sum_{i=1}^{n}(y^{(i)} - h_{\\theta}(x^{(i)}))x_j^{(i)}</script> 因此： <script type="math/tex">\\theta_j := \\theta_j + \\dfrac{\\alpha}{m}\\sum_{i=1}^{n}(y^{(i)} - h_{\\theta}(x^{(i)}))x_j^{(i)}</script> 这时候我们发现，其梯度下降的推导结果和线性回归是一样的！</p>
                  <h2 id="编程实现"><a href="#编程实现" class="headerlink" title="编程实现"></a>编程实现</h2>
                  <p>下面我们还是用 Sklearn 中的 API 来实现逻辑回归模型，使用的库为 LogisticRegression，其 API 如下：</p>
                  <figure class="highlight routeros">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">class sklearn.linear_model.LogisticRegression(<span class="attribute">penalty</span>=’l2’, <span class="attribute">dual</span>=<span class="literal">False</span>, <span class="attribute">tol</span>=0.0001, <span class="attribute">C</span>=1.0, <span class="attribute">fit_intercept</span>=<span class="literal">True</span>, <span class="attribute">intercept_scaling</span>=1, <span class="attribute">class_weight</span>=None, <span class="attribute">random_state</span>=None, <span class="attribute">solver</span>=’liblinear’, <span class="attribute">max_iter</span>=100, <span class="attribute">multi_class</span>=’ovr’, <span class="attribute">verbose</span>=0, <span class="attribute">warm_start</span>=<span class="literal">False</span>, <span class="attribute">n_jobs</span>=1)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>参数说明如下：</p>
                  <ul>
                    <li>penalty：惩罚项，str 类型，可选参数为 l1 和 l2，默认为 l2。用于指定惩罚项中使用的规范。newton-cg、sag 和 lbfgs 求解算法只支持 L2 规范。L1G 规范假设的是模型的参数满足拉普拉斯分布，L2 假设的模型参数满足高斯分布，所谓的范式就是加上对参数的约束，使得模型更不会过拟合(overfit)，但是如果要说是不是加了约束就会好，这个没有人能回答，只能说，加约束的情况下，理论上应该可以获得泛化能力更强的结果。</li>
                    <li>dual：对偶或原始方法，bool 类型，默认为False。对偶方法只用在求解线性多核(liblinear)的 L2惩 罚项上。当样本数量 &gt; 样本特征的时候，dual 通常设置为 False。</li>
                    <li>tol：停止求解的标准，float类型，默认为1e-4。就是求解到多少的时候，停止，认为已经求出最优解。</li>
                    <li>c：正则化系数 λ 的倒数，float 类型，默认为 1.0。必须是正浮点型数。像 SVM 一样，越小的数值表示越强的正则化。</li>
                    <li>fit_intercept：是否存在截距或偏差，bool 类型，默认为 True。</li>
                    <li>intercept_scaling：仅在正则化项为”liblinear”，且fit_intercept 设置为 True 时有用。float 类型，默认为 1。</li>
                    <li>class_weight：用于标示分类模型中各种类型的权重，可以是一个字典或者’balanced’字符串，默认为不输入，也就是不考虑权重，即为 None。如果选择输入的话，可以选择 balanced 让类库自己计算类型权重，或者自己输入各个类型的权重。举个例子，比如对于0,1的二元模型，我们可以定义 class_weight={0:0.9,1:0.1}，这样类型0的权重为 90%，而类型 1 的权重为 10%。如果 class_weight选择 balanced，那么类库会根据训练样本量来计算权重。某种类型样本量越多，则权重越低，样本量越少，则权重越高。</li>
                    <li>random_state：随机数种子，int类型，可选参数，默认为无，仅在正则化优化算法为 sag，liblinear时有用。</li>
                    <li>solver：优化算法选择参数，只有五个可选参数，即newton-cg, lbfgs, liblinear, sag, saga。默认为liblinear。solver 参数决定了我们对逻辑回归损失函数的优化方法，有四种算法可以选择，分别是：<ul>
                        <li>liblinear：使用了开源的 liblinear 库实现，内部使用了坐标轴下降法来迭代优化损失函数。</li>
                        <li>lbfgs：拟牛顿法的一种，利用损失函数二阶导数矩阵即海森矩阵来迭代优化损失函数。</li>
                        <li>newton-cg：也是牛顿法家族的一种，利用损失函数二阶导数矩阵即海森矩阵来迭代优化损失函数。</li>
                        <li>sag：即随机平均梯度下降，是梯度下降法的变种，和普通梯度下降法的区别是每次迭代仅仅用一部分的样本来计算梯度，适合于样本数据多的时候。</li>
                        <li>saga：线性收敛的随机优化算法的的变重。</li>
                      </ul>
                    </li>
                    <li>max_iter：算法收敛最大迭代次数，int 类型，默认为10。仅在正则化优化算法为 newton-cg, sag 和 lbfgs 才有用，算法收敛的最大迭代次数。</li>
                    <li>multi_class：分类方式选择参数，str 类型，可选参数为 ovr 和 multinomial，默认为 ovr。ovr 即前面提到的one-vs-rest(OvR)，而 multinomial 即前面提到的 many-vs-many(MvM)。如果是二元逻辑回归，ovr 和 multinomial 并没有任何区别，区别主要在多元逻辑回归上。</li>
                    <li>verbose：日志冗长度，int 类型。默认为 0。就是不输出训练过程，1 的时候偶尔输出结果，大于 1，对于每个子模型都输出。</li>
                    <li>warm_start：热启动参数，bool 类型。默认为 False。如果为 True，则下一次训练是以追加树的形式进行（重新使用上一次的调用作为初始化）。</li>
                    <li>n_jobs：并行数。int 类型，默认为 1。1 的时候，用 CPU 的一个内核运行程序，2 的时候，用 CPU 的 2 个内核运行程序。为 -1 的时候，用所有 CPU 的内核运行程序。</li>
                  </ul>
                  <p>属性说明如下：</p>
                  <ul>
                    <li>coef_：斜率</li>
                    <li>intercept_：截距项</li>
                  </ul>
                  <p>我们现在来解决上面的示例，代码如下：</p>
                  <figure class="highlight angelscript">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LogisticRegression</span><br><span class="line"></span><br><span class="line">x_data = [</span><br><span class="line">    [<span class="number">6000</span>, <span class="number">58</span>],</span><br><span class="line">    [<span class="number">9000</span>, <span class="number">77</span>],</span><br><span class="line">    [<span class="number">11000</span>, <span class="number">89</span>],</span><br><span class="line">    [<span class="number">15000</span>, <span class="number">54</span>]</span><br><span class="line">]</span><br><span class="line">y_data = [</span><br><span class="line">    <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">lr = LogisticRegression()</span><br><span class="line">lr.fit(x_data, y_data)</span><br><span class="line">x_test = [[<span class="number">12000</span>, <span class="number">60</span>]]</span><br><span class="line">print(<span class="string">'Intercept'</span>, lr.<span class="built_in">int</span>ercept_)</span><br><span class="line">print(<span class="string">'Coef'</span>, lr.coef_)</span><br><span class="line">print(<span class="string">'款项是否可以立即到账'</span>, lr.predict(x_test)[<span class="number">0</span>])</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>这里我们的 y_data 数据就变了，变成了是非判断，这里 0 代表“否”，1 代表“是”。这里做逻辑回归时使用了 LogisticRegression 对象，然后调用 fit() 方法进行拟合，拟合完毕之后，使用 [12000, 60] 这条数据作为输入，让模型输出它的预测值。 运行结果：</p>
                  <figure class="highlight lua">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">Intercept [<span class="number">-0.03142387</span>]</span><br><span class="line">Coef <span class="string">[[ 0.00603919 -0.72587703]]</span></span><br><span class="line">款项是否可以立即到账 <span class="number">1</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>结果中输出了截距项和系数项，然后预测了是否可以立即到账，结果为 1，这表明孙七进行贷款，款项可以立即到账。 以上就是逻辑回归的基本推导和代码应用实现。</p>
                  </p>
                </div>
              </div>
              <div class="post-meta">
                <span class="post-meta-item">
                  <span class="post-meta-item-icon">
                    <i class="far fa-user"></i>
                  </span>
                  <span class="post-meta-item-text">作者</span>
                  <span><a href="/authors/崔庆才" class="author" itemprop="url" rel="index">崔庆才</a></span>
                </span>
                <span class="post-meta-item">
                  <span class="post-meta-item-icon">
                    <i class="far fa-calendar"></i>
                  </span>
                  <span class="post-meta-item-text">发表于</span>
                  <time title="创建时间：2019-06-21 10:54:19" itemprop="dateCreated datePublished" datetime="2019-06-21T10:54:19+08:00">2019-06-21</time>
                </span>
                <span id="/6485.html" class="post-meta-item leancloud_visitors" data-flag-title="Python 机器学习算法二之逻辑回归的推导及实战" title="阅读次数">
                  <span class="post-meta-item-icon">
                    <i class="fa fa-eye"></i>
                  </span>
                  <span class="post-meta-item-text">阅读次数：</span>
                  <span class="leancloud-visitors-count"></span>
                </span>
                <span class="post-meta-item" title="本文字数">
                  <span class="post-meta-item-icon">
                    <i class="far fa-file-word"></i>
                  </span>
                  <span class="post-meta-item-text">本文字数：</span>
                  <span>6.1k</span>
                </span>
                <span class="post-meta-item" title="阅读时长">
                  <span class="post-meta-item-icon">
                    <i class="far fa-clock"></i>
                  </span>
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                  <span>6 分钟</span>
                </span>
              </div>
            </article>
            <article itemscope itemtype="http://schema.org/Article" class="post-block index" lang="zh-CN">
              <link itemprop="mainEntityOfPage" href="https://cuiqingcai.com/6645.html">
              <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
                <meta itemprop="image" content="/images/avatar.png">
                <meta itemprop="name" content="崔庆才">
                <meta itemprop="description" content="崔庆才的个人站点，记录生活的瞬间，分享学习的心得。">
              </span>
              <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
                <meta itemprop="name" content="静觅">
              </span>
              <header class="post-header">
                <h2 class="post-title" itemprop="name headline">
                  <a class="label"> Python <i class="label-arrow"></i>
                  </a>
                  <a href="/6645.html" class="post-title-link" itemprop="url">推荐给大家一个我整理的 Python 书单</a>
                </h2>
              </header>
              <div class="post-body" itemprop="articleBody">
                <div class="thumb">
                  <img itemprop="contentUrl" class="random">
                </div>
                <div class="excerpt">
                  <p>
                  <p>六一八来了，现在各大平台都开始促销了，作为一名程序员，除了自己买一些大件和帮女朋友疯狂抢购，最好的选择就是买书好好学习技术了。 关注我的朋友可能很多都是学习 <strong>Python、爬虫、Web、数据分析、机器学习</strong>相关的。当然大家可能接触某个方向的时间不一样，可能有的同学已经对某个方向特别精通，有的同学在某个方向还处于入门阶段。 所以我花时间调研了一些大佬的推荐书单，同时结合我个人所看的一些书籍，另外参考了豆瓣、京东等排行榜和一些书评，选取了一些经典好评书籍和近期上市且反响不错的书籍，推荐给大家，内容涉及 <strong>Python 基础、**</strong>数据分析、机器学习、Web 开发<strong>等方向。 另外当当这边也有相当大力度的折扣，我也联系了当当获取了两个优惠码，大家可以用起来！这里也没有推销的意思，也没有用官方推荐的书单，是单纯根据书的内容来推荐的。 现在当当的书是</strong>每满 100 减 50<strong>，下面给大家两个优惠码，可以直接在满减的基础上</strong>继续折扣<strong>。 全品类优惠码： </strong>Y6NDPP<strong> 这个码买什么书都可以享受优惠，可享受</strong>满 200 减 40<strong> 优惠，叠加后相当于</strong>满 400 减 240<strong>，即 160 元可以购买 400 元的书籍，在</strong>当当 App 或小程序<strong>上下单有效。 计算机类： </strong>P6HFCE<strong> 这个码只能买计算机类的图书，可享受满 </strong>100 减 20<strong> 优惠，叠加后相当于</strong>满 200 减 120<strong>，在</strong>当当 App 或小程序上下单<strong>有效。 注意这两个优惠码</strong>有效期到 2019.06.20<strong>，过期就不能用了，而且</strong>数量是有限**的，多人共享，到了一定的使用次数就不能用了，后面我也没有办法补了，所以还是先到先得。 好，下面是我挑选的一些书籍，大家可以自行选购。也由于个人水平有限，很可能大家觉得优秀的书籍没有列出，如果大家有觉得不错的书籍，欢迎大家留言，大家也可以参考留言区的书籍来购买，谢谢大家支持。</p>
                  <h2 id="Python-编程"><a href="#Python-编程" class="headerlink" title="Python 编程"></a>Python 编程</h2>
                  <p>这一部分书籍是单纯讲解 Python 编程的，有入门的有进阶的，大家可以参考评分和出版时间选购。</p>
                  <h3 id="Python-入门"><a href="#Python-入门" class="headerlink" title="Python 入门"></a>Python 入门</h3>
                  <p>《Python编程：从入门到实践》/ 豆瓣 9.1 / 2016-7-1 出版 / [美] 埃里克·马瑟斯 <img src="https://qiniu.cuiqingcai.com/wp-content/uploads/2019/06/Python编程：从入门到实践.jpg" alt=""> 《Python基础教程（第3版）》/ 豆瓣 8.0 / 2018-2-1 出版 / [挪] 海特兰德 <img src="https://qiniu.cuiqingcai.com/wp-content/uploads/2019/06/Python基础教程（第3版）.jpg" alt=""> 《Python编程快速上手》/ 豆瓣 9.0 / 2016-7-1 出版 / [美] 思维加特 <img src="https://qiniu.cuiqingcai.com/wp-content/uploads/2019/06/Python编程快速上手.jpg" alt=""> 《笨办法学Python3》/ 豆瓣 8.4 / 2018-6-1 出版 / [美] 泽德 <img src="https://qiniu.cuiqingcai.com/wp-content/uploads/2019/06/笨办法学Python3.jpg" alt=""></p>
                  <h3 id="Python-进阶"><a href="#Python-进阶" class="headerlink" title="Python 进阶"></a>Python 进阶</h3>
                  <p>《流畅的Python》/ 豆瓣 9.4 / 2017-5-15 出版 / [巴西] 拉马略 <img src="https://qiniu.cuiqingcai.com/wp-content/uploads/2019/06/流畅的Python.jpg" alt=""> 《Python Cookbook 中文版》/ 豆瓣 9.2 / 2015-5-1 出版 / [美] 比斯利 <img src="https://qiniu.cuiqingcai.com/wp-content/uploads/2019/06/Python-Cookbook-中文版.jpg" alt=""> 《Effective Python》/ 豆瓣 9.0 / 2016-1-18 出版 / [美] 斯拉特金 <img src="https://qiniu.cuiqingcai.com/wp-content/uploads/2019/06/Effective-Python.jpg" alt=""> 《Python编程之美》/ 豆瓣 8.4 / 2018-8-1 出版 / [美] 肯尼思·赖茨 Kenneth Reitz <img src="https://qiniu.cuiqingcai.com/wp-content/uploads/2019/06/Python编程之美.jpg" alt=""> 《Python高性能编程》/ 豆瓣 7.2 / 2017-7-1 出版 / [美] 戈雷利克 <img src="https://qiniu.cuiqingcai.com/wp-content/uploads/2019/06/Python高性能编程.jpg" alt=""></p>
                  <h2 id="数据及算法"><a href="#数据及算法" class="headerlink" title="数据及算法"></a>数据及算法</h2>
                  <h3 id="网络爬虫"><a href="#网络爬虫" class="headerlink" title="网络爬虫"></a>网络爬虫</h3>
                  <p>《Python网络爬虫权威指南（第2版）》/ 新书 / 2019-4-1 出版 / [美] 米切尔 <img src="https://qiniu.cuiqingcai.com/wp-content/uploads/2019/06/Python网络爬虫权威指南（第2版）.jpg" alt=""> 《Python3网络爬虫开发实战》/ 豆瓣 9.0 / 2018-4-1 出版 / 崔庆才 <img src="https://qiniu.cuiqingcai.com/wp-content/uploads/2019/06/Python3网络爬虫开发实战.jpg" alt=""> 数据分析 《利用Python进行数据分析（第2版）》/ 豆瓣 8.5 / 2018-7-30 出版 / [美] 麦金尼 <img src="https://qiniu.cuiqingcai.com/wp-content/uploads/2019/06/利用Python进行数据分析（第2版）.jpg" alt=""> 《对比Excel，轻松学习Python数据分析》/ 豆瓣 7.8 / 2019-2-1 出版 / 张俊红 <img src="https://qiniu.cuiqingcai.com/wp-content/uploads/2019/06/对比Excel，轻松学习Python数据分析.jpg" alt=""> 《Python数据分析与挖掘实战》/ 豆瓣 7.8 / 2016-1-1 出版 / 张良均 <img src="https://qiniu.cuiqingcai.com/wp-content/uploads/2019/06/Python数据分析与挖掘实战.jpg" alt=""></p>
                  <h3 id="机器学习"><a href="#机器学习" class="headerlink" title="机器学习"></a>机器学习</h3>
                  <p>《统计学习方法（第2版）》/ 豆瓣 9.5 / 2018-5-5 出版 / 李航 <img src="https://qiniu.cuiqingcai.com/wp-content/uploads/2019/06/统计学习方法（第2版）.jpg" alt=""> 《白话深度学习与TensorFlow》/ 豆瓣 7.1 / 2017-7-31 出版 / 高扬 <img src="https://qiniu.cuiqingcai.com/wp-content/uploads/2019/06/白话深度学习与TensorFlow.jpg" alt=""> 《机器学习》/ 豆瓣 8.7 / 2016-1-1 出版 / 周志华 <img src="https://qiniu.cuiqingcai.com/wp-content/uploads/2019/06/机器学习.jpg" alt=""> 《Python机器学习基础教程》/ 豆瓣 8.2 / 2018-1-1 出版 / [德] 穆勒 <img src="https://qiniu.cuiqingcai.com/wp-content/uploads/2019/06/Python机器学习基础教程.jpg" alt=""> 《Python深度学习》/ 豆瓣 9.6 / 2018-8-1 出版 / [美] 肖莱 <img src="https://qiniu.cuiqingcai.com/wp-content/uploads/2019/06/Python深度学习.jpg" alt=""> 《Python神经网络编程》/ 豆瓣 9.0 / 2018-4-1 出版 / [英] 拉希德 <img src="https://qiniu.cuiqingcai.com/wp-content/uploads/2019/06/Python神经网络编程.jpg" alt=""></p>
                  <h2 id="前后端技术"><a href="#前后端技术" class="headerlink" title="前后端技术"></a>前后端技术</h2>
                  <h3 id="前端"><a href="#前端" class="headerlink" title="前端"></a>前端</h3>
                  <p>《你不知道的JavaScript》/ 豆瓣 9.3 / 2018-1-1 出版 / [美] 辛普森 <img src="https://qiniu.cuiqingcai.com/wp-content/uploads/2019/06/你不知道的JavaScript.jpg" alt=""> 《深入浅出Vue.js》/ 新书 / 2018-3-1 出版 / 刘博文 <img src="https://qiniu.cuiqingcai.com/wp-content/uploads/2019/06/深入浅出Vue.js.jpg" alt=""></p>
                  <h3 id="后端"><a href="#后端" class="headerlink" title="后端"></a>后端</h3>
                  <p>《Django企业开发实战》/ 豆瓣 7.7 / 2019-2-1 出版 / 胡阳 <img src="https://qiniu.cuiqingcai.com/wp-content/uploads/2019/06/Django企业开发实战.jpg" alt=""> 《Flask Web开发（第2版）》/ 豆瓣 9.4 / 2018-8-1 出版 / [美] 格雷贝格 <img src="https://qiniu.cuiqingcai.com/wp-content/uploads/2019/06/Flask-Web开发（第2版）.jpg" alt=""> 《深入浅出Docker》/ 豆瓣 8.4 / 2019-4-1 出版 / [英] 波尔顿 <img src="https://qiniu.cuiqingcai.com/wp-content/uploads/2019/06/深入浅出Docker.jpg" alt=""> 《深入理解Kafka》/ 新书 / 2019-1-1 出版 / 朱忠华 <img src="https://qiniu.cuiqingcai.com/wp-content/uploads/2019/06/深入理解Kafka.jpg" alt=""> 《Kubernetes权威指南（第4版）》/ 新书 / 2018-5-1 出版 / 龚正 <img src="https://qiniu.cuiqingcai.com/wp-content/uploads/2019/06/Kubernetes权威指南（第4版）.jpg" alt=""></p>
                  <h2 id="程序员经典"><a href="#程序员经典" class="headerlink" title="程序员经典"></a>程序员经典</h2>
                  <p>这是一些程序员通用的技能书，非常经典而且有用，几乎是必备书籍，强烈推荐。 《集体智慧编程》/ 豆瓣 9.0 / 2015-3-1 出版 / 西格兰 <img src="https://qiniu.cuiqingcai.com/wp-content/uploads/2019/06/集体智慧编程.jpg" alt=""> 《程序员的数学》/ 豆瓣 8.6 / 2016-6-25 出版 / [日] 结城浩 <img src="https://qiniu.cuiqingcai.com/wp-content/uploads/2019/06/程序员的数学.jpg" alt=""> 《程序员修炼之道》/ 豆瓣 8.6 / 2011-1-1 出版 / [美] 亨特 <img src="https://qiniu.cuiqingcai.com/wp-content/uploads/2019/06/程序员修炼之道.jpg" alt=""> 《代码整洁之道》/ 豆瓣 8.6 / 2016-9-1 出版 / [美] 罗伯特 <img src="https://qiniu.cuiqingcai.com/wp-content/uploads/2019/06/代码整洁之道.jpg" alt=""> 《持续交付2.0》/ 豆瓣 9.4 / 2019-1-1 出版 / 乔梁 <img src="https://qiniu.cuiqingcai.com/wp-content/uploads/2019/06/持续交付2.0.jpg" alt=""> 《鸟哥的Linux私房菜（第4版）》/ 豆瓣 8.0 / 2018-11-1 出版 / 鸟哥 <img src="https://qiniu.cuiqingcai.com/wp-content/uploads/2019/06/鸟哥的Linux私房菜（第4版）.jpg" alt=""> 《颈椎病康复指南》/ 豆瓣 8.6 / 2012-4-1 出版 / 陈选宁 <img src="https://qiniu.cuiqingcai.com/wp-content/uploads/2019/06/颈椎病康复指南.jpg" alt=""> 以上便是我所推荐的书籍，数量有限，如果大家还有推荐的书籍，欢迎留言~</p>
                  </p>
                </div>
              </div>
              <div class="post-meta">
                <span class="post-meta-item">
                  <span class="post-meta-item-icon">
                    <i class="far fa-user"></i>
                  </span>
                  <span class="post-meta-item-text">作者</span>
                  <span><a href="/authors/崔庆才" class="author" itemprop="url" rel="index">崔庆才</a></span>
                </span>
                <span class="post-meta-item">
                  <span class="post-meta-item-icon">
                    <i class="far fa-calendar"></i>
                  </span>
                  <span class="post-meta-item-text">发表于</span>
                  <time title="创建时间：2019-06-19 18:55:49" itemprop="dateCreated datePublished" datetime="2019-06-19T18:55:49+08:00">2019-06-19</time>
                </span>
                <span id="/6645.html" class="post-meta-item leancloud_visitors" data-flag-title="推荐给大家一个我整理的 Python 书单" title="阅读次数">
                  <span class="post-meta-item-icon">
                    <i class="fa fa-eye"></i>
                  </span>
                  <span class="post-meta-item-text">阅读次数：</span>
                  <span class="leancloud-visitors-count"></span>
                </span>
                <span class="post-meta-item" title="本文字数">
                  <span class="post-meta-item-icon">
                    <i class="far fa-file-word"></i>
                  </span>
                  <span class="post-meta-item-text">本文字数：</span>
                  <span>2.2k</span>
                </span>
                <span class="post-meta-item" title="阅读时长">
                  <span class="post-meta-item-icon">
                    <i class="far fa-clock"></i>
                  </span>
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                  <span>2 分钟</span>
                </span>
              </div>
            </article>
            <article itemscope itemtype="http://schema.org/Article" class="post-block index" lang="zh-CN">
              <link itemprop="mainEntityOfPage" href="https://cuiqingcai.com/6613.html">
              <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
                <meta itemprop="image" content="/images/avatar.png">
                <meta itemprop="name" content="崔庆才">
                <meta itemprop="description" content="崔庆才的个人站点，记录生活的瞬间，分享学习的心得。">
              </span>
              <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
                <meta itemprop="name" content="静觅">
              </span>
              <header class="post-header">
                <h2 class="post-title" itemprop="name headline">
                  <a class="label"> Python <i class="label-arrow"></i>
                  </a>
                  <a href="/6613.html" class="post-title-link" itemprop="url">Python 机器学习算法一之线性回归的推导及实战</a>
                </h2>
              </header>
              <div class="post-body" itemprop="articleBody">
                <div class="thumb">
                  <img itemprop="contentUrl" class="random">
                </div>
                <div class="excerpt">
                  <p>
                  <p>线性回归是机器学习中最基本的算法了，一般要学习机器学习都要从线性回归开始讲起，本节就对线性回归做一个详细的解释。</p>
                  <h2 id="实例引入"><a href="#实例引入" class="headerlink" title="实例引入"></a>实例引入</h2>
                  <p>在讲解线性回归之前，我们首先引入一个实例，张三、李四、王五、赵六都要贷款了，贷款时银行调查了他们的月薪和住房面积等因素，月薪越高，住房面积越大，可贷款金额越多，下面列出来了他们四个人的工资情况、住房面积和可贷款金额的具体情况：</p>
                  <p>姓名</p>
                  <p>工资(元)</p>
                  <p>房屋面积(平方)</p>
                  <p>可贷款金额(元)</p>
                  <p>张三</p>
                  <p>6000</p>
                  <p>58</p>
                  <p>30000</p>
                  <p>李四</p>
                  <p>9000</p>
                  <p>77</p>
                  <p>55010</p>
                  <p>王五</p>
                  <p>11000</p>
                  <p>89</p>
                  <p>73542</p>
                  <p>赵六</p>
                  <p>15000</p>
                  <p>54</p>
                  <p>63201</p>
                  <p>看到了这样的数据，又来了一位孙七，他工资是 12000 元，房屋面积是 60 平，那他大约能贷款多少呢？</p>
                  <h2 id="思路探索"><a href="#思路探索" class="headerlink" title="思路探索"></a>思路探索</h2>
                  <p>那这时候应该往哪方面考虑呢？如果我们假定可贷款金额和工资、房屋面积都是线性相关的，要解决这个问题，首先我们想到的应该就是初高中所学的一次函数吧，它的一般表达方式是 $ y = wx + b $，$ x $ 就是自变量，$ y $ 就是因变量，$ w $ 是自变量的系数，$ b $ 是偏移量，这个式子表明 $ y $ 和 $ x $ 是线性相关的，$ y $ 会随着 $ x $ 的变化而呈现线性变化。 现在回到我们的问题中，情况稍微不太一样，这个例子中是可贷款金额会随着工资和房屋面积而呈现线性变化，此时如果我们将工资定义为 $ x<em>1 $，房屋面积定义为 $ x_2 $，可贷款金额定义为 $ y $，那么它们三者的关系就可以表示为： $ y = w_1x_1 + w_2x_2 + b $，这里的自变量就不再是一个了，而是两个，分别是 $ x_1 $ 和 $ x_2 $，自变量系数就表示为了 $ w_1 $ 和 $ w_2 $，我们将其转化为表达的形式，同时将变量的名字换一下，就成了这个样子： $$ h</em>{\theta}(x) = \theta_0 + \theta_1x_1 + \theta_2x_2 $$ 这里只不过是将原表达式转为函数形式，换了个表示名字，另外参数名称从 $ w $ 换成了 $ \theta $，$ b $ 换成了 $ \theta_0 $，为什么要换？因为在机器学习算法中 $ \theta $ 用的更广泛一些，约定俗成。 然后这个问题怎么解？我们只需要求得一组近似的 $ \theta $ 参数使得我们的函数可以拟合已有的数据，然后整个函数表达式就可以表示出来了，然后再将孙七的工资和房屋面积代入进去，就求出来他可以贷款的金额了。</p>
                  <h2 id="思路拓展"><a href="#思路拓展" class="headerlink" title="思路拓展"></a>思路拓展</h2>
                  <p>那假如此时情景变一变，变得更复杂一些，可贷款金额不仅仅和工资、房屋面积有关，还有当前存款数、年龄等等因素有关，那我们的表达式应该怎么写？不用担心，我们有几个影响因素，就写定义几个变量，比如我们可以将存款数定义为 $ x<em>3 $，年龄定义为 $ x_4 $，如果还有其他影响因素我们可以继续接着定义，如果一共有 $ n $ 个影响因素，我们就定义到 $ x_n $，这时候函数表达式就可以变成这样子了： $$ h</em>{\theta}(x) = \theta<em>0 + \theta_1x_1 + \theta_2x_2 + … + \theta_nx_n <script type="math/tex">这个式子看起来挺长的不好写的吧，我们可以使用求和公式写成如下形式：</script> h</em>{\theta}(x) = \sum_{i=0}^{n}\theta_ix_i = \theta^Tx $$ 如果要使得这个公式成立，这里需要满足一个条件就是 $ x_0 = 1 $，其实在实际场景中 $ x_0 $ 是不存在的，因为第一个影响因素我们用 $ x_1 $ 来表示了，第二个影响因素我们用 $ x_2 $ 来表示了，依次类推。所以这里我们直接指定 $ x_0 = 1 $ 即可。 后来我们又将公式简化为线性代数的向量表示，这里 $ \theta^T $ 是 $ \theta $ 向量转置的结果，而 $ \theta $ 向量又表示为 $ (\theta_0, \theta_1, …, \theta_n) $，同样地，$ x $ 向量可以表示为 $ (x_0, x_1, …, x_n) $，总之，表达成后面的式子，看起来更简洁明了。 好了，这就是最基本的线性判别解析函数的写法，是不是很简单。</p>
                  <h2 id="实际求解"><a href="#实际求解" class="headerlink" title="实际求解"></a>实际求解</h2>
                  <p>那接下来我们怎样实际求解这个问题呢？比如拿张三的数据代入到这个函数表达式中，这里还是假设有两个影响因素，张三的数据我们可以表示为 $ x<em>1^{(1)} = 6000, x_2^{(1)} = 58, y^{(1)} = 30000 $，注意这里我们在数据的右上角加了一个小括号，里面带有数字，如果我们把张三的数据看成一个条目，那么这个数字就代表了这个条目的序号，1 就代表第一条数据，2 就代表第二条数据，为啥这么写？也是约定俗成，以后也会经常采用这样的写法，记住就好了。 所以，我们的愿景是要使得我们的函数能够拟合当前的这条数据，所以我们希望是这样的情况： $$ y^{(1)} = \sum</em>{i=0}^{n}\theta<em>{i}x</em>{i}^{(1)} = \theta^Tx^{(1)} <script type="math/tex">其中 $ y^{(1)} $ 是真实值，但我们知道，哪有那么容易十全十美，丝毫不差的拟合函数，所以上面的式子一般来说是不成立的，函数计算值和真实值还是多少还是有一定的误差的吧，如果我们想知道函数真实拟合的结果的话，我们需要把 $ x $ 变量代入函数，会得到一个函数本身拟合的结果，是这样的：</script> h<em>{\theta}(x^{(1)}) = \sum</em>{i=0}^{n}\theta<em>{i}x</em>{i}^{(1)} = \theta^Tx^{(1)} <script type="math/tex">这里的 $ h_{\\theta}(x^{(1)}) $ 就是我们函数得到的结果了。一般来说，二者是会存在一定的误差的，所以误差我们一般可以写成他们的差的绝对值或平方的形式，使用绝对值或平方的目的是消去正负号的影响，比如写成平方的形式就是这样子：</script> (h<em>{\theta}(x^{(1)}) - y^{(1)})^2 <script type="math/tex">这个式子就是我们函数真实拟合值和真实值之间的差距，没问题吧。 相应的，如果是李四的数据，误差就可以写为：</script> (h</em>{\theta}(x^{(2)}) - y^{(2)})^2 <script type="math/tex">依次类推，如果是第 $ i $ 条数据，误差就可以写成：</script> (h<em>{\theta}(x^{(i)}) - y^{(i)})^2 <script type="math/tex">要使得我们的函数对所有的数据都能尽量很好地拟合，我们可以把这些误差加起来求个平均，假设一共 $ m $ 条数据，那么所有数据的误差可以写成如下形式：</script> J(\theta) = \dfrac{1}{2m}\sum</em>{i=1}^{m}(h_\theta(x^{(i)}) - y^{(i)})^2 $$ 注意这里 $ i $ 指的是第几条数据，是从 1 开始的，一直到 $ m $ 为止，然后使用了求和公式对每一条数据的误差进行累加和，最后除以了 $ 2m $，我们的最终目的就是找出合适的 $ \theta $，使得这个 $ J(\theta ) $ 的值最小，即误差最小，在机器学习中，我们就把 $ J(\theta) $ 称为损失函数（Loss Function），即我们要使得损失值最小。 有的小伙伴可能好奇损失函数前面为什么是 $ 2m $，而不是 $ m $？因为我们后面要用到这个算式的导数，所以这里多了个 2 是为了便于求导计算。况且一个表达式要求最小值，前面乘一个常数是对结果没影响的。</p>
                  <h2 id="求解过程"><a href="#求解过程" class="headerlink" title="求解过程"></a>求解过程</h2>
                  <p>由于我们求解的是线性回归问题，所以整个损失函数的图像非常简单清晰，如果只有 $ \theta<em>1 $ 和 $ \theta_2 $ 两个参数，我们甚至可以直接画出其图像，整个损失函数大小随 $ \theta_1 $ 和 $ \theta_2 $ 的变化实际上类似于这样子： <img src="https://qiniu.cuiqingcai.com/2019-06-12-074355.jpg" alt=""> 可以看到这是一个凸函数，竖轴代表损失函数的大小，横纵两轴代表 $ \theta_1 $ 和 $ \theta_2 $ 的变化，可见在中间的最低谷损失函数取得最小值，这时候损失函数在 $ \theta_1 $ 和 $ \theta_2 $ 上的导数都是 0，因此我们可以一步到位，直接用偏导置零的方式来求解损失函数取得最小值时的 $ \theta $ 值的大小。 所以我们可以先对每个 $ \theta $ 求解其偏导结果，这里 $ \theta $ 表示为 $ \theta_j $，代表 $ \theta $ 中的某一维： $$ \dfrac{\partial{J(\theta)}}{\partial{\theta_j}} = \dfrac{1}{2m} \dfrac{\partial({\sum</em>{i=1}^{m}{(y^{(i)} - h<em>{\theta}(x^{(i)}))^2}})}{\partial{\theta_j}} \\\\ =\dfrac{1}{m}\sum</em>{i=1}^{m}((h<em>{\theta}(x^{(i)}) - y^{(i)})x_j^{(i)}) <script type="math/tex">直接将偏导置零即可直接求解 $ \\theta_j $： ​</script> \sum</em>{i=1}^{m} {h<em>{\theta}(x^{(i)})x_j^{(i)}} - \sum</em>{i=1}^{m}y^{(i)}x<em>j^{(i)} = 0 <script type="math/tex">这里将所有数据代入，即可通过求解方程组的形式直接解出 $ \\theta_j $ 的值，但这些方程组里面其实 $ \\theta_j $ 之间存在彼此依赖关系，需要联立求解出来。 如果不用这种求解方式，我们可以使用梯度下降的方式来进行求解，在这里 $ \\theta_j $ 只需要逐步更新即可：</script> \theta_j = \theta_j - \alpha\dfrac{\partial{J(\theta)}}{\partial{\theta_j}} \\\\ = \theta_j - \dfrac{\alpha}{m}\sum</em>{i=1}^{m}((h_{\theta}(x^{(i)}) - y^{(i)})x_j^{(i)}) $$ 这里 $ \alpha $ 就是学习率，$ \theta_j $ 每经过一步都会进行一次更新，得到新的结果，经过梯度下降过程，$ \theta_j $ 都会更新为使得梯度最小化的数值，最后就完成了 $ \theta $ 的求解。 以上便是线性回归的整个推导和求解过程。</p>
                  <h2 id="实战操作"><a href="#实战操作" class="headerlink" title="实战操作"></a>实战操作</h2>
                  <p>现在呢，我们想要根据前面的数据来求解这个真实的问题，为了解决这个问题，我们在这里用 Python 的 Sklearn 库来实现。 对于线性回归来说，Sklearn 已经做好了封装，直接使用 LinearRegression 即可。 它的 API 如下：</p>
                  <figure class="highlight routeros">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">class sklearn.linear_model.LinearRegression(<span class="attribute">fit_intercept</span>=<span class="literal">True</span>, <span class="attribute">normalize</span>=<span class="literal">False</span>, <span class="attribute">copy_X</span>=<span class="literal">True</span>, <span class="attribute">n_jobs</span>=None)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>参数解释如下：</p>
                  <ul>
                    <li>fit_intercept : 布尔值，是否使用偏置项，默认是 True。</li>
                    <li>normalize : 布尔值，是否启用归一化，默认是 False。当 fit_intercept 被置为 False 的时候，这个参数会被忽略。当该参数为 True 时，数据会被归一化处理。</li>
                    <li>copy_X : 布尔值，默认是 True，如果为 True，x 参数会被拷贝不会影响原来的值，否则会被复写。</li>
                    <li>n_jobs：数值或者布尔，如果设置了，则多核并行处理。</li>
                  </ul>
                  <p>属性如下：</p>
                  <ul>
                    <li>coef_：x 的权重系数大小</li>
                    <li>intercept_：偏置项大小</li>
                  </ul>
                  <p>代码实现如下：</p>
                  <figure class="highlight angelscript">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LinearRegression</span><br><span class="line"></span><br><span class="line">x_data = [</span><br><span class="line">    [<span class="number">6000</span>, <span class="number">58</span>],</span><br><span class="line">    [<span class="number">9000</span>, <span class="number">77</span>],</span><br><span class="line">    [<span class="number">11000</span>, <span class="number">89</span>],</span><br><span class="line">    [<span class="number">15000</span>, <span class="number">54</span>]</span><br><span class="line">]</span><br><span class="line">y_data = [</span><br><span class="line">    <span class="number">30000</span>, <span class="number">55010</span>, <span class="number">73542</span>, <span class="number">63201</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">lr = LinearRegression()</span><br><span class="line">lr.fit(x_data, y_data)</span><br><span class="line">print(<span class="string">'方程为：y=&#123;w1&#125;x1+&#123;w2&#125;x2+&#123;b&#125;'</span>.format(w1=round(lr.coef_[<span class="number">0</span>], <span class="number">2</span>),</span><br><span class="line">                                       w2=round(lr.coef_[<span class="number">1</span>], <span class="number">2</span>),</span><br><span class="line">                                       b=lr.<span class="built_in">int</span>ercept_))</span><br><span class="line">x_test = [[<span class="number">12000</span>, <span class="number">60</span>]]</span><br><span class="line">print(<span class="string">'贷款金额为：'</span>, lr.predict(x_test)[<span class="number">0</span>])</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>运行结果：</p>
                  <figure class="highlight angelscript">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">方程为：y=<span class="number">4.06</span>x1+<span class="number">743.15</span>x2+<span class="number">-37831.862532707615</span></span><br><span class="line">贷款金额为：<span class="number">55484.33779181102</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>在这里我们首先声明了 LinearRegression 对象，然后将数据整合成 x<em>data 和 y_data 的形式，然后通过调用 fit() 方法来对数据进行拟合。 拟合完毕之后，LinearRegression 的 coef</em> 对象就是各个 x 变量的权重大小，即对应着 $ \theta<em>1, \theta_2 $，intercept</em> 则是偏移量，对应着 $ \theta_0 $，这样我们就可以得到一个线性回归表达式了。 然后我们再调用 predict() 方法，将新的测试数据传入，便可以得到其预测结果，最终结果为 55484.34，即孙七的可贷款额度为 55484.34 元。 以上便是机器学习中线性回归算法的推导解析和相关调用实现。</p>
                  </p>
                </div>
              </div>
              <div class="post-meta">
                <span class="post-meta-item">
                  <span class="post-meta-item-icon">
                    <i class="far fa-user"></i>
                  </span>
                  <span class="post-meta-item-text">作者</span>
                  <span><a href="/authors/崔庆才" class="author" itemprop="url" rel="index">崔庆才</a></span>
                </span>
                <span class="post-meta-item">
                  <span class="post-meta-item-icon">
                    <i class="far fa-calendar"></i>
                  </span>
                  <span class="post-meta-item-text">发表于</span>
                  <time title="创建时间：2019-06-19 11:30:36" itemprop="dateCreated datePublished" datetime="2019-06-19T11:30:36+08:00">2019-06-19</time>
                </span>
                <span id="/6613.html" class="post-meta-item leancloud_visitors" data-flag-title="Python 机器学习算法一之线性回归的推导及实战" title="阅读次数">
                  <span class="post-meta-item-icon">
                    <i class="fa fa-eye"></i>
                  </span>
                  <span class="post-meta-item-text">阅读次数：</span>
                  <span class="leancloud-visitors-count"></span>
                </span>
                <span class="post-meta-item" title="本文字数">
                  <span class="post-meta-item-icon">
                    <i class="far fa-file-word"></i>
                  </span>
                  <span class="post-meta-item-text">本文字数：</span>
                  <span>5.1k</span>
                </span>
                <span class="post-meta-item" title="阅读时长">
                  <span class="post-meta-item-icon">
                    <i class="far fa-clock"></i>
                  </span>
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                  <span>5 分钟</span>
                </span>
              </div>
            </article>
            <article itemscope itemtype="http://schema.org/Article" class="post-block index" lang="zh-CN">
              <link itemprop="mainEntityOfPage" href="https://cuiqingcai.com/6552.html">
              <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
                <meta itemprop="image" content="/images/avatar.png">
                <meta itemprop="name" content="崔庆才">
                <meta itemprop="description" content="崔庆才的个人站点，记录生活的瞬间，分享学习的心得。">
              </span>
              <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
                <meta itemprop="name" content="静觅">
              </span>
              <header class="post-header">
                <h2 class="post-title" itemprop="name headline">
                  <a class="label"> Python <i class="label-arrow"></i>
                  </a>
                  <a href="/6552.html" class="post-title-link" itemprop="url">Python 使用 attrs 和 cattrs 实现面向对象编程</a>
                </h2>
              </header>
              <div class="post-body" itemprop="articleBody">
                <div class="thumb">
                  <img itemprop="contentUrl" class="random">
                </div>
                <div class="excerpt">
                  <p>
                  <p>Python 是支持面向对象的，很多情况下使用面向对象编程会使得代码更加容易扩展，并且可维护性更高，但是如果你写的多了或者某一对象非常复杂了，其中的一些写法会相当相当繁琐，而且我们会经常碰到对象和 JSON 序列化及反序列化的问题，原生的 Python 转起来还是很费劲的。 可能这么说大家会觉得有点抽象，那么这里举几个例子来感受一下。 首先让我们定义一个对象吧，比如颜色。我们常用 RGB 三个原色来表示颜色，R、G、B 分别代表红、绿、蓝三个颜色的数值，范围是 0-255，也就是每个原色有 256 个取值。如 RGB(0, 0, 0) 就代表黑色，RGB(255, 255, 255) 就代表白色，RGB(255, 0, 0) 就代表红色，如果不太明白可以具体看看 RGB 颜色的定义哈。 好，那么我们现在如果想定义一个颜色对象，那么正常的写法就是这样了，创建这个对象的时候需要三个参数，就是 R、G、B 三个数值，定义如下：</p>
                  <figure class="highlight python">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Color</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    Color Object of RGB</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, r, g, b)</span>:</span></span><br><span class="line">        self.r = r</span><br><span class="line">        self.g = g</span><br><span class="line">        self.b = b</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>其实对象一般就是这么定义的，初始化方法里面传入各个参数，然后定义全局变量并赋值这些值。其实挺多常用语言比如 Java、PHP 里面都是这么定义的。但其实这种写法是比较冗余的，比如 r、g、b 这三个变量一写就写了三遍。 好，那么我们初始化一下这个对象，然后打印输出下，看看什么结果：</p>
                  <figure class="highlight dos">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="built_in">color</span> = <span class="built_in">Color</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">color</span>)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>结果是什么样的呢？或许我们也就能看懂一个 Color 吧，别的都没有什么有效信息，像这样子：</p>
                  <figure class="highlight dos">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">&lt;__main__.<span class="built_in">Color</span> object <span class="built_in">at</span> <span class="number">0</span>x103436f60&gt;</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>我们知道，在 Python 里面想要定义某个对象本身的打印输出结果的时候，需要实现它的 <code>__repr__</code> 方法，所以我们比如我们添加这么一个方法：</p>
                  <figure class="highlight python">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">__repr__</span><span class="params">(self)</span>:</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">f'<span class="subst">&#123;self.__class__.__name__&#125;</span>(r=<span class="subst">&#123;self.r&#125;</span>, g=<span class="subst">&#123;self.g&#125;</span>, b=<span class="subst">&#123;self.b&#125;</span>)'</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>这里使用了 Python 中的 fstring 来实现了 <code>__repr__</code> 方法，在这里我们构造了一个字符串并返回，字符串中包含了这个 Color 类中的 r、g、b 属性，这个返回的结果就是 print 的打印结果，我们再重新执行一下，结果就变成这样子了：</p>
                  <figure class="highlight routeros">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">Color(<span class="attribute">r</span>=255, <span class="attribute">g</span>=255, <span class="attribute">b</span>=255)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>改完之后，这样打印的对象就会变成这样的字符串形式了，感觉看起来清楚多了吧？ 再继续，如果我们要想实现这个对象里面的 <code>__eq__</code>、<code>__lt__</code> 等各种方法来实现对象之间的比较呢？照样需要继续定义成类似这样子的形式：</p>
                  <figure class="highlight gml">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">def __lt__(<span class="literal">self</span>, <span class="literal">other</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> isinstance(<span class="literal">other</span>, <span class="literal">self</span>.__class__): <span class="keyword">return</span> NotImplemented</span><br><span class="line">    <span class="keyword">return</span> (<span class="literal">self</span>.r, <span class="literal">self</span>.g, <span class="literal">self</span>.b) &lt; (<span class="literal">other</span>.r, <span class="literal">other</span>.g, <span class="literal">other</span>.b)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>这里是 <code>__lt__</code> 方法，有了这个方法就可以使用比较符来对两个 Color 对象进行比较了，但这里又把这几个属性写了两遍。 最后再考虑考虑，如果我要把 JSON 转成 Color 对象，难道我要读完 JSON 然后一个个属性赋值吗？如果我想把 Color 对象转化为 JSON，又得把这几个属性写几遍呢？如果我突然又加了一个属性比如透明度 a 参数，那么整个类的方法和参数都要修改，这是极其难以扩展的。不知道你能不能忍，反正我不能忍！ 如果你用过 Scrapy、Django 等框架，你会发现 Scrapy 里面有一个 Item 的定义，只需要定义一些 Field 就可以了，Django 里面的 Model 也类似这样，只需要定义其中的几个字段属性就可以完成整个类的定义了，非常方便。 说到这里，我们能不能把 Scrapy 或 Django 里面的定义模式直接拿过来呢？能是能，但是没必要，因为我们还有专门为 Python 面向对象而专门诞生的库，没错，就是 attrs 和 cattrs 这两个库。 有了 attrs 库，我们就可以非常方便地定义各个对象了，另外对于 JSON 的转化，可以进一步借助 cattrs 这个库，非常有帮助。 说了这么多，还是没有介绍这两个库的具体用法，下面我们来详细介绍下。</p>
                  <h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2>
                  <p>安装这两个库非常简单，使用 pip 就好了，命令如下：</p>
                  <figure class="highlight cmake">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">pip3 <span class="keyword">install</span> attrs cattrs</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>安装好了之后我们就可以导入并使用这两个库了。</p>
                  <h2 id="简介与特性"><a href="#简介与特性" class="headerlink" title="简介与特性"></a>简介与特性</h2>
                  <p>首先我们来介绍下 attrs 这个库，其官方的介绍如下：</p>
                  <blockquote>
                    <p>attrs 是这样的一个 Python 工具包，它能将你从繁综复杂的实现上解脱出来，享受编写 Python 类的快乐。它的目标就是在不减慢你编程速度的前提下，帮助你来编写简洁而又正确的代码。</p>
                  </blockquote>
                  <p>其实意思就是用了它，定义和实现 Python 类变得更加简洁和高效。</p>
                  <h2 id="基本用法"><a href="#基本用法" class="headerlink" title="基本用法"></a>基本用法</h2>
                  <p>首先明确一点，我们现在是装了 attrs 和 cattrs 这两个库，但是实际导入的时候是使用 attr 和 cattr 这两个包，是不带 s 的。 在 attr 这个库里面有两个比较常用的组件叫做 attrs 和 attr，前者是主要用来修饰一个自定义类的，后者是定义类里面的一个字段的。有了它们，我们就可以将上文中的定义改写成下面的样子：</p>
                  <figure class="highlight angelscript">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">from</span> attr <span class="keyword">import</span> attrs, attrib</span><br><span class="line"></span><br><span class="line">@attrs</span><br><span class="line"><span class="keyword">class</span> <span class="symbol">Color</span>(<span class="symbol">object</span>):</span><br><span class="line">    <span class="symbol">r</span> = <span class="symbol">attrib</span>(<span class="symbol">type</span>=<span class="symbol">int, <span class="symbol">default</span></span>=<span class="symbol">0</span>)</span><br><span class="line">    <span class="symbol">g</span> = <span class="symbol">attrib</span>(<span class="symbol">type</span>=<span class="symbol">int, <span class="symbol">default</span></span>=<span class="symbol">0</span>)</span><br><span class="line">    <span class="symbol">b</span> = <span class="symbol">attrib</span>(<span class="symbol">type</span>=<span class="symbol">int, <span class="symbol">default</span></span>=<span class="symbol">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="symbol">if</span> <span class="symbol">__name__</span> == '<span class="symbol">__main__</span>':</span><br><span class="line">    <span class="symbol">color</span> = <span class="symbol">Color</span>(<span class="symbol">255, <span class="symbol">255</span>, <span class="symbol">255</span></span>)</span><br><span class="line">    <span class="symbol">print</span>(<span class="symbol">color</span>)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>看我们操作的，首先我们导入了刚才所说的两个组件，然后用 attrs 里面修饰了 Color 这个自定义类，然后用 attrib 来定义一个个属性，同时可以指定属性的类型和默认值。最后打印输出，结果如下：</p>
                  <figure class="highlight routeros">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">Color(<span class="attribute">r</span>=255, <span class="attribute">g</span>=255, <span class="attribute">b</span>=255)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>怎么样，达成了一样的输出效果！ 观察一下有什么变化，是不是变得更简洁了？r、g、b 三个属性都只写了一次，同时还指定了各个字段的类型和默认值，另外也不需要再定义 <code>__init__</code> 方法和 <code>__repr__</code> 方法了，一切都显得那么简洁。一个字，爽！ 实际上，主要是 attrs 这个修饰符起了作用，然后根据定义的 attrib 属性自动帮我们实现了 <code>__init__</code>、<code>__repr__</code>、<code>__eq__</code>、<code>__ne__</code>、<code>__lt__</code>、<code>__le__</code>、<code>__gt__</code>、<code>__ge__</code>、<code>__hash__</code> 这几个方法。 如使用 attrs 修饰的类定义是这样子：</p>
                  <figure class="highlight angelscript">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">from</span> attr <span class="keyword">import</span> attrs, attrib</span><br><span class="line"></span><br><span class="line">@attrs</span><br><span class="line"><span class="keyword">class</span> <span class="symbol">SmartClass</span>(<span class="symbol">object</span>):</span><br><span class="line">    <span class="symbol">a</span> = <span class="symbol">attrib</span>()</span><br><span class="line">    <span class="symbol">b</span> = <span class="symbol">attrib</span>()</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>其实就相当于已经实现了这些方法：</p>
                  <figure class="highlight ruby">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RoughClass</span>(<span class="title">object</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(<span class="keyword">self</span>, a, b)</span></span><span class="symbol">:</span></span><br><span class="line">        <span class="keyword">self</span>.a = a</span><br><span class="line">        <span class="keyword">self</span>.b = b</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__repr__</span><span class="params">(<span class="keyword">self</span>)</span></span><span class="symbol">:</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">"RoughClass(a=&#123;&#125;, b=&#123;&#125;)"</span>.format(<span class="keyword">self</span>.a, <span class="keyword">self</span>.b)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__eq__</span><span class="params">(<span class="keyword">self</span>, other)</span></span><span class="symbol">:</span></span><br><span class="line">        <span class="keyword">if</span> other.__class_<span class="number">_</span> is <span class="keyword">self</span>.<span class="symbol">__class__:</span></span><br><span class="line">            <span class="keyword">return</span> (<span class="keyword">self</span>.a, <span class="keyword">self</span>.b) == (other.a, other.b)</span><br><span class="line">        <span class="symbol">else:</span></span><br><span class="line">            <span class="keyword">return</span> NotImplemented</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__ne__</span><span class="params">(<span class="keyword">self</span>, other)</span></span><span class="symbol">:</span></span><br><span class="line">        result = <span class="keyword">self</span>.__eq_<span class="number">_</span>(other)</span><br><span class="line">        <span class="keyword">if</span> result is <span class="symbol">NotImplemented:</span></span><br><span class="line">            <span class="keyword">return</span> NotImplemented</span><br><span class="line">        <span class="symbol">else:</span></span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">not</span> result</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__lt__</span><span class="params">(<span class="keyword">self</span>, other)</span></span><span class="symbol">:</span></span><br><span class="line">        <span class="keyword">if</span> other.__class_<span class="number">_</span> is <span class="keyword">self</span>.<span class="symbol">__class__:</span></span><br><span class="line">            <span class="keyword">return</span> (<span class="keyword">self</span>.a, <span class="keyword">self</span>.b) &lt; (other.a, other.b)</span><br><span class="line">        <span class="symbol">else:</span></span><br><span class="line">            <span class="keyword">return</span> NotImplemented</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__le__</span><span class="params">(<span class="keyword">self</span>, other)</span></span><span class="symbol">:</span></span><br><span class="line">        <span class="keyword">if</span> other.__class_<span class="number">_</span> is <span class="keyword">self</span>.<span class="symbol">__class__:</span></span><br><span class="line">            <span class="keyword">return</span> (<span class="keyword">self</span>.a, <span class="keyword">self</span>.b) &lt;= (other.a, other.b)</span><br><span class="line">        <span class="symbol">else:</span></span><br><span class="line">            <span class="keyword">return</span> NotImplemented</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__gt__</span><span class="params">(<span class="keyword">self</span>, other)</span></span><span class="symbol">:</span></span><br><span class="line">        <span class="keyword">if</span> other.__class_<span class="number">_</span> is <span class="keyword">self</span>.<span class="symbol">__class__:</span></span><br><span class="line">            <span class="keyword">return</span> (<span class="keyword">self</span>.a, <span class="keyword">self</span>.b) &gt; (other.a, other.b)</span><br><span class="line">        <span class="symbol">else:</span></span><br><span class="line">            <span class="keyword">return</span> NotImplemented</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__ge__</span><span class="params">(<span class="keyword">self</span>, other)</span></span><span class="symbol">:</span></span><br><span class="line">        <span class="keyword">if</span> other.__class_<span class="number">_</span> is <span class="keyword">self</span>.<span class="symbol">__class__:</span></span><br><span class="line">            <span class="keyword">return</span> (<span class="keyword">self</span>.a, <span class="keyword">self</span>.b) &gt;= (other.a, other.b)</span><br><span class="line">        <span class="symbol">else:</span></span><br><span class="line">            <span class="keyword">return</span> NotImplemented</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__hash__</span><span class="params">(<span class="keyword">self</span>)</span></span><span class="symbol">:</span></span><br><span class="line">        <span class="keyword">return</span> hash((<span class="keyword">self</span>.__class_<span class="number">_</span>, <span class="keyword">self</span>.a, <span class="keyword">self</span>.b))</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>所以说，如果我们用了 attrs 的话，就可以不用再写这些冗余又复杂的代码了。 翻看源码可以发现，其内部新建了一个 ClassBuilder，通过一些属性操作来动态添加了上面的这些方法，如果想深入研究，建议可以看下 attrs 库的源码。</p>
                  <h2 id="别名使用"><a href="#别名使用" class="headerlink" title="别名使用"></a>别名使用</h2>
                  <p>这时候大家可能有个小小的疑问，感觉里面的定义好乱啊，库名叫做 attrs，包名叫做 attr，然后又导入了 attrs 和 attrib，这太奇怪了。为了帮大家解除疑虑，我们来梳理一下它们的名字。 首先库的名字就叫做 attrs，这个就是装 Python 包的时候这么装就行了。但是库的名字和导入的包的名字确实是不一样的，我们用的时候就导入 attr 这个包就行了，里面包含了各种各样的模块和组件，这是完全固定的。 好，然后接下来看看 attr 包里面包含了什么，刚才我们引入了 attrs 和 attrib。 首先是 attrs，它主要是用来修饰 class 类的，而 attrib 主要是用来做属性定义的，这个就记住它们两个的用法就好了。 翻了一下源代码，发现其实它还有一些别名：</p>
                  <figure class="highlight ini">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="attr">s</span> = attributes = attrs</span><br><span class="line"><span class="attr">ib</span> = attr = attrib</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>也就是说，attrs 可以用 s 或 attributes 来代替，attrib 可以用 attr 或 ib 来代替。 既然是别名，那么上面的类就可以改写成下面的样子：</p>
                  <figure class="highlight angelscript">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">from</span> attr <span class="keyword">import</span> s, ib</span><br><span class="line"></span><br><span class="line">@s</span><br><span class="line"><span class="keyword">class</span> <span class="symbol">Color</span>(<span class="symbol">object</span>):</span><br><span class="line">    <span class="symbol">r</span> = <span class="symbol">ib</span>(<span class="symbol">type</span>=<span class="symbol">int, <span class="symbol">default</span></span>=<span class="symbol">0</span>)</span><br><span class="line">    <span class="symbol">g</span> = <span class="symbol">ib</span>(<span class="symbol">type</span>=<span class="symbol">int, <span class="symbol">default</span></span>=<span class="symbol">0</span>)</span><br><span class="line">    <span class="symbol">b</span> = <span class="symbol">ib</span>(<span class="symbol">type</span>=<span class="symbol">int, <span class="symbol">default</span></span>=<span class="symbol">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="symbol">if</span> <span class="symbol">__name__</span> == '<span class="symbol">__main__</span>':</span><br><span class="line">    <span class="symbol">color</span> = <span class="symbol">Color</span>(<span class="symbol">255, <span class="symbol">255</span>, <span class="symbol">255</span></span>)</span><br><span class="line">    <span class="symbol">print</span>(<span class="symbol">color</span>)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>是不是更加简洁了，当然你也可以把 s 改写为 attributes，ib 改写为 attr，随你怎么用啦。 不过我觉得比较舒服的是 attrs 和 attrib 的搭配，感觉可读性更好一些，当然这个看个人喜好。 所以总结一下：</p>
                  <ul>
                    <li>库名：attrs</li>
                    <li>导入包名：attr</li>
                    <li>修饰类：s 或 attributes 或 attrs</li>
                    <li>定义属性：ib 或 attr 或 attrib</li>
                  </ul>
                  <p>OK，理清了这几部分内容，我们继续往下深入了解它的用法吧。</p>
                  <h2 id="声明和比较"><a href="#声明和比较" class="headerlink" title="声明和比较"></a>声明和比较</h2>
                  <p>在这里我们再声明一个简单一点的数据结构，比如叫做 Point，包含 x、y 的坐标，定义如下：</p>
                  <figure class="highlight angelscript">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">from</span> attr <span class="keyword">import</span> attrs, attrib</span><br><span class="line"></span><br><span class="line">@attrs</span><br><span class="line"><span class="keyword">class</span> <span class="symbol">Point</span>(<span class="symbol">object</span>):</span><br><span class="line">    <span class="symbol">x</span> = <span class="symbol">attrib</span>()</span><br><span class="line">    <span class="symbol">y</span> = <span class="symbol">attrib</span>()</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>其中 attrib 里面什么参数都没有，如果我们要使用的话，参数可以顺次指定，也可以根据名字指定，如：</p>
                  <figure class="highlight routeros">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">p1 = Point(1, 2)</span><br><span class="line"><span class="builtin-name">print</span>(p1)</span><br><span class="line">p2 = Point(<span class="attribute">x</span>=1, <span class="attribute">y</span>=2)</span><br><span class="line"><span class="builtin-name">print</span>(p2)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>其效果都是一样的，打印输出结果如下：</p>
                  <figure class="highlight routeros">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">Point(<span class="attribute">x</span>=1, <span class="attribute">y</span>=2)</span><br><span class="line">Point(<span class="attribute">x</span>=1, <span class="attribute">y</span>=2)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>OK，接下来让我们再验证下类之间的比较方法，由于使用了 attrs，相当于我们定义的类已经有了 <code>__eq__</code>、<code>__ne__</code>、<code>__lt__</code>、<code>__le__</code>、<code>__gt__</code>、<code>__ge__</code> 这几个方法，所以我们可以直接使用比较符来对类和类之间进行比较，下面我们用实例来感受一下：</p>
                  <figure class="highlight lisp">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">print('Equal:', Point(<span class="number">1</span>, <span class="number">2</span>) == Point(<span class="number">1</span>, <span class="number">2</span>))</span><br><span class="line">print('Not Equal(<span class="name">ne</span>):', Point(<span class="number">1</span>, <span class="number">2</span>) != Point(<span class="number">3</span>, <span class="number">4</span>))</span><br><span class="line">print('Less Than(<span class="name">lt</span>):', Point(<span class="number">1</span>, <span class="number">2</span>) &lt; Point(<span class="number">3</span>, <span class="number">4</span>))</span><br><span class="line">print('Less or Equal(<span class="name">le</span>):', Point(<span class="number">1</span>, <span class="number">2</span>) &lt;= Point(<span class="number">1</span>, <span class="number">4</span>), Point(<span class="number">1</span>, <span class="number">2</span>) &lt;= Point(<span class="number">1</span>, <span class="number">2</span>))</span><br><span class="line">print('Greater Than(<span class="name">gt</span>):', Point(<span class="number">4</span>, <span class="number">2</span>) &gt; Point(<span class="number">3</span>, <span class="number">2</span>), Point(<span class="number">4</span>, <span class="number">2</span>) &gt; Point(<span class="number">3</span>, <span class="number">1</span>))</span><br><span class="line">print('Greater or Equal(<span class="name">ge</span>):', Point(<span class="number">4</span>, <span class="number">2</span>) &gt;= Point(<span class="number">4</span>, <span class="number">1</span>))</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>运行结果如下：</p>
                  <figure class="highlight yaml">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="attr">Same:</span> <span class="literal">False</span></span><br><span class="line"><span class="attr">Equal:</span> <span class="literal">True</span></span><br><span class="line"><span class="string">Not</span> <span class="string">Equal(ne):</span> <span class="literal">True</span></span><br><span class="line"><span class="string">Less</span> <span class="string">Than(lt):</span> <span class="literal">True</span></span><br><span class="line"><span class="string">Less</span> <span class="string">or</span> <span class="string">Equal(le):</span> <span class="literal">True</span> <span class="literal">True</span></span><br><span class="line"><span class="string">Greater</span> <span class="string">Than(gt):</span> <span class="literal">True</span> <span class="literal">True</span></span><br><span class="line"><span class="string">Greater</span> <span class="string">or</span> <span class="string">Equal(ge):</span> <span class="literal">True</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>可能有的朋友不知道 ne、lt、le 什么的是什么意思，不过看到这里你应该明白啦，ne 就是 Not Equal 的意思，就是不相等，le 就是 Less or Equal 的意思，就是小于或等于。 其内部怎么实现的呢，就是把类的各个属性转成元组来比较了，比如 <code>Point(1, 2) &lt; Point(3, 4)</code> 实际上就是比较了 <code>(1, 2)</code> 和 <code>(3, 4)</code> 两个元组，那么元组之间的比较逻辑又是怎样的呢，这里就不展开了，如果不明白的话可以参考官方文档：<a href="https://docs.python.org/3/library/stdtypes.html#comparisons" target="_blank" rel="noopener">https://docs.python.org/3/library/stdtypes.html#comparisons</a>。</p>
                  <h2 id="属性定义"><a href="#属性定义" class="headerlink" title="属性定义"></a>属性定义</h2>
                  <p>现在看来，对于这个类的定义莫过于每个属性的定义了，也就是 attrib 的定义。对于 attrib 的定义，我们可以传入各种参数，不同的参数对于这个类的定义有非常大的影响。 下面我们就来详细了解一下每个属性的具体参数和用法吧。 首先让我们概览一下总共可能有多少可以控制一个属性的参数，我们用 attrs 里面的 fields 方法可以查看一下：</p>
                  <figure class="highlight angelscript">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">from</span> attr <span class="keyword">import</span> attrs, attrib, fields</span><br><span class="line"></span><br><span class="line">@attrs</span><br><span class="line"><span class="keyword">class</span> <span class="symbol">Point</span>(<span class="symbol">object</span>):</span><br><span class="line">    <span class="symbol">x</span> = <span class="symbol">attrib</span>()</span><br><span class="line">    <span class="symbol">y</span> = <span class="symbol">attrib</span>()</span><br><span class="line"></span><br><span class="line"><span class="symbol">print</span>(<span class="symbol">fields</span>(<span class="symbol">Point</span>))</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>这就可以输出 Point 的所有属性和对应的参数，结果如下：</p>
                  <figure class="highlight routeros">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">(Attribute(<span class="attribute">name</span>=<span class="string">'x'</span>, <span class="attribute">default</span>=<span class="literal">NOTHING</span>, <span class="attribute">validator</span>=None, <span class="attribute">repr</span>=<span class="literal">True</span>, <span class="attribute">cmp</span>=<span class="literal">True</span>, <span class="attribute">hash</span>=None, <span class="attribute">init</span>=<span class="literal">True</span>, <span class="attribute">metadata</span>=mappingproxy(&#123;&#125;), <span class="attribute">type</span>=None, <span class="attribute">converter</span>=None, <span class="attribute">kw_only</span>=<span class="literal">False</span>), Attribute(<span class="attribute">name</span>=<span class="string">'y'</span>, <span class="attribute">default</span>=<span class="literal">NOTHING</span>, <span class="attribute">validator</span>=None, <span class="attribute">repr</span>=<span class="literal">True</span>, <span class="attribute">cmp</span>=<span class="literal">True</span>, <span class="attribute">hash</span>=None, <span class="attribute">init</span>=<span class="literal">True</span>, <span class="attribute">metadata</span>=mappingproxy(&#123;&#125;), <span class="attribute">type</span>=None, <span class="attribute">converter</span>=None, <span class="attribute">kw_only</span>=<span class="literal">False</span>))</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>输出出来了，可以看到结果是一个元组，元组每一个元素都其实是一个 Attribute 对象，包含了各个参数，下面详细解释下几个参数的含义：</p>
                  <ul>
                    <li>name：属性的名字，是一个字符串类型。</li>
                    <li>default：属性的默认值，如果没有传入初始化数据，那么就会使用默认值。如果没有默认值定义，那么就是 NOTHING，即没有默认值。</li>
                    <li>validator：验证器，检查传入的参数是否合法。</li>
                    <li>init：是否参与初始化，如果为 False，那么这个参数不能当做类的初始化参数，默认是 True。</li>
                    <li>metadata：元数据，只读性的附加数据。</li>
                    <li>type：类型，比如 int、str 等各种类型，默认为 None。</li>
                    <li>converter：转换器，进行一些值的处理和转换器，增加容错性。</li>
                    <li>kw_only：是否为强制关键字参数，默认为 False。</li>
                  </ul>
                  <h3 id="属性名"><a href="#属性名" class="headerlink" title="属性名"></a>属性名</h3>
                  <p>对于属性名，非常清楚了，我们定义什么属性，属性名就是什么，例如上面的例子，定义了：</p>
                  <figure class="highlight ini">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="attr">x</span> = attrib()</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>那么其属性名就是 x。</p>
                  <h3 id="默认值"><a href="#默认值" class="headerlink" title="默认值"></a>默认值</h3>
                  <p>对于默认值，如果在初始化的时候没有指定，那么就会默认使用默认值进行初始化，我们看下面的一个实例：</p>
                  <figure class="highlight angelscript">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">from</span> attr <span class="keyword">import</span> attrs, attrib, fields</span><br><span class="line"></span><br><span class="line">@attrs</span><br><span class="line"><span class="keyword">class</span> <span class="symbol">Point</span>(<span class="symbol">object</span>):</span><br><span class="line">    <span class="symbol">x</span> = <span class="symbol">attrib</span>()</span><br><span class="line">    <span class="symbol">y</span> = <span class="symbol">attrib</span>(<span class="symbol">default</span>=<span class="symbol">100</span>)</span><br><span class="line"></span><br><span class="line"><span class="symbol">if</span> <span class="symbol">__name__</span> == '<span class="symbol">__main__</span>':</span><br><span class="line">    <span class="symbol">print</span>(<span class="symbol">Point</span>(<span class="symbol">x</span>=<span class="symbol">1, <span class="symbol">y</span></span>=<span class="symbol">3</span>))</span><br><span class="line">    <span class="symbol">print</span>(<span class="symbol">Point</span>(<span class="symbol">x</span>=<span class="symbol">1</span>))</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>在这里我们将 y 属性的默认值设置为了 100，在初始化的时候，第一次都传入了 x、y 两个参数，第二次只传入了 x 这个参数，看下运行结果：</p>
                  <figure class="highlight routeros">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">Point(<span class="attribute">x</span>=1, <span class="attribute">y</span>=3)</span><br><span class="line">Point(<span class="attribute">x</span>=1, <span class="attribute">y</span>=100)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>可以看到结果，当设置了默认参数的属性没有被传入值时，他就会使用设置的默认值进行初始化。 那假如没有设置默认值但是也没有初始化呢？比如执行下：</p>
                  <figure class="highlight stylus">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="function"><span class="title">Point</span><span class="params">()</span></span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>那么就会报错了，错误如下：</p>
                  <figure class="highlight groovy">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="string">TypeError:</span> __init__() missing <span class="number">1</span> required positional <span class="string">argument:</span> <span class="string">'x'</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>所以说，如果一个属性，我们一旦没有设置默认值同时没有传入的话，就会引起错误。所以，一般来说，为了稳妥起见，设置一个默认值比较好，即使是 None 也可以的。</p>
                  <h3 id="初始化"><a href="#初始化" class="headerlink" title="初始化"></a>初始化</h3>
                  <p>如果一个类的某些属性不想参与初始化，比如想直接设置一个初始值，一直固定不变，我们可以将属性的 init 参数设置为 False，看一个实例：</p>
                  <figure class="highlight angelscript">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">from</span> attr <span class="keyword">import</span> attrs, attrib</span><br><span class="line"></span><br><span class="line">@attrs</span><br><span class="line"><span class="keyword">class</span> <span class="symbol">Point</span>(<span class="symbol">object</span>):</span><br><span class="line">    <span class="symbol">x</span> = <span class="symbol">attrib</span>(<span class="symbol">init</span>=<span class="symbol">False, <span class="symbol">default</span></span>=<span class="symbol">10</span>)</span><br><span class="line">    <span class="symbol">y</span> = <span class="symbol">attrib</span>()</span><br><span class="line"></span><br><span class="line"><span class="symbol">if</span> <span class="symbol">__name__</span> == '<span class="symbol">__main__</span>':</span><br><span class="line">    <span class="symbol">print</span>(<span class="symbol">Point</span>(<span class="symbol">3</span>))</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>比如 x 我们只想在初始化的时候设置固定值，不想初始化的时候被改变和设定，我们将其设置了 init 参数为 False，同时设置了一个默认值，如果不设置默认值，默认为 NOTHING。然后初始化的时候我们只传入了一个值，其实也就是为 y 这个属性赋值。 这样的话，看下运行结果：</p>
                  <figure class="highlight routeros">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">Point(<span class="attribute">x</span>=10, <span class="attribute">y</span>=3)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>没什么问题，y 被赋值为了我们设置的值 3。 那假如我们非要设置 x 呢？会发生什么，比如改写成这样子：</p>
                  <figure class="highlight stylus">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="function"><span class="title">Point</span><span class="params">(<span class="number">1</span>, <span class="number">2</span>)</span></span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>报错了，错误如下：</p>
                  <figure class="highlight yaml">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="attr">TypeError:</span> <span class="string">__init__()</span> <span class="string">takes</span> <span class="number">2</span> <span class="string">positional</span> <span class="string">arguments</span> <span class="string">but</span> <span class="number">3</span> <span class="string">were</span> <span class="string">given</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>参数过多，也就是说，已经将 init 设置为 False 的属性就不再被算作可以被初始化的属性了。</p>
                  <h3 id="强制关键字"><a href="#强制关键字" class="headerlink" title="强制关键字"></a>强制关键字</h3>
                  <p>强制关键字是 Python 里面的一个特性，在传入的时候必须使用关键字的名字来传入，如果不太理解可以再了解下 Python 的基础。 设置了强制关键字参数的属性必须要放在后面，其后面不能再有非强制关键字参数的属性，否则会报这样的错误：</p>
                  <figure class="highlight pgsql">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">ValueError: Non keyword-<span class="keyword">only</span> attributes are <span class="keyword">not</span> allowed <span class="keyword">after</span> a keyword-<span class="keyword">only</span> <span class="keyword">attribute</span> (unless they are init=<span class="keyword">False</span>)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>好，我们来看一个例子，我们将最后一个属性设置 kw_only 参数为 True：</p>
                  <figure class="highlight angelscript">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">from</span> attr <span class="keyword">import</span> attrs, attrib, fields</span><br><span class="line"></span><br><span class="line">@attrs</span><br><span class="line"><span class="keyword">class</span> <span class="symbol">Point</span>(<span class="symbol">object</span>):</span><br><span class="line">    <span class="symbol">x</span> = <span class="symbol">attrib</span>(<span class="symbol">default</span>=<span class="symbol">0</span>)</span><br><span class="line">    <span class="symbol">y</span> = <span class="symbol">attrib</span>(<span class="symbol">kw_only</span>=<span class="symbol">True</span>)</span><br><span class="line"></span><br><span class="line"><span class="symbol">if</span> <span class="symbol">__name__</span> == '<span class="symbol">__main__</span>':</span><br><span class="line">    <span class="symbol">print</span>(<span class="symbol">Point</span>(<span class="symbol">1, <span class="symbol">y</span></span>=<span class="symbol">3</span>))</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>如果设置了 kw_only 参数为 True，那么在初始化的时候必须传入关键字的名字，这里就必须指定 y 这个名字，运行结果如下：</p>
                  <figure class="highlight routeros">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">Point(<span class="attribute">x</span>=1, <span class="attribute">y</span>=3)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>如果没有指定 y 这个名字，像这样调用：</p>
                  <figure class="highlight stylus">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="function"><span class="title">Point</span><span class="params">(<span class="number">1</span>, <span class="number">3</span>)</span></span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>那么就会报错：</p>
                  <figure class="highlight angelscript">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">TypeError: __init__() takes <span class="keyword">from</span> <span class="number">1</span> to <span class="number">2</span> positional arguments but <span class="number">3</span> were given</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>所以，这个参数就是设置初始化传参必须要用名字来传，否则会出现错误。 注意，如果我们将一个属性设置了 init 为 False，那么 kw_only 这个参数会被忽略。</p>
                  <h3 id="验证器"><a href="#验证器" class="headerlink" title="验证器"></a>验证器</h3>
                  <p>有时候在设置一个属性的时候必须要满足某个条件，比如性别必须要是男或者女，否则就不合法。对于这种情况，我们就需要有条件来控制某些属性不能为非法值。 下面我们看一个实例：</p>
                  <figure class="highlight angelscript">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">from</span> attr <span class="keyword">import</span> attrs, attrib</span><br><span class="line"></span><br><span class="line">def is_valid_gender(instance, attribute, value):</span><br><span class="line">    <span class="keyword">if</span> value <span class="keyword">not</span> <span class="keyword">in</span> [<span class="string">'male'</span>, <span class="string">'female'</span>]:</span><br><span class="line">        raise ValueError(f<span class="string">'gender &#123;value&#125; is not valid'</span>)</span><br><span class="line"></span><br><span class="line">@attrs</span><br><span class="line"><span class="keyword">class</span> <span class="symbol">Person</span>(<span class="symbol">object</span>):</span><br><span class="line">    <span class="symbol">name</span> = <span class="symbol">attrib</span>()</span><br><span class="line">    <span class="symbol">gender</span> = <span class="symbol">attrib</span>(<span class="symbol">validator</span>=<span class="symbol">is_valid_gender</span>)</span><br><span class="line"></span><br><span class="line"><span class="symbol">if</span> <span class="symbol">__name__</span> == '<span class="symbol">__main__</span>':</span><br><span class="line">    <span class="symbol">print</span>(<span class="symbol">Person</span>(<span class="symbol">name</span>='<span class="symbol">Mike</span>', <span class="symbol">gender</span>='<span class="symbol">male</span>'))</span><br><span class="line">    <span class="symbol">print</span>(<span class="symbol">Person</span>(<span class="symbol">name</span>='<span class="symbol">Mike</span>', <span class="symbol">gender</span>='<span class="symbol">mlae</span>'))</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>在这里我们定义了一个验证器 Validator 方法，叫做 is_valid_gender。然后定义了一个类 Person 还有它的两个属性 name 和 gender，其中 gender 定义的时候传入了一个参数 validator，其值就是我们定义的 Validator 方法。 这个 Validator 定义的时候有几个固定的参数：</p>
                  <ul>
                    <li>instance：类对象</li>
                    <li>attribute：属性名</li>
                    <li>value：属性值</li>
                  </ul>
                  <p>这是三个参数是固定的，在类初始化的时候，其内部会将这三个参数传递给这个 Validator，因此 Validator 里面就可以接受到这三个值，然后进行判断即可。在 Validator 里面，我们判断如果不是男性或女性，那么就直接抛出错误。 下面做了两个实验，一个就是正常传入 male，另一个写错了，写的是 mlae，观察下运行结果：</p>
                  <figure class="highlight routeros">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">Person(<span class="attribute">name</span>=<span class="string">'Mike'</span>, <span class="attribute">gender</span>=<span class="string">'male'</span>)</span><br><span class="line">TypeError: __init__() missing 1 required positional argument: <span class="string">'gender'</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>OK，结果显而易见了，第二个报错了，因为其值不是正常的性别，所以程序直接报错终止。 注意在 Validator 里面返回 True 或 False 是没用的，错误的值还会被照常复制。所以，一定要在 Validator 里面 raise 某个错误。 另外 attrs 库里面还给我们内置了好多 Validator，比如判断类型，这里我们再增加一个属性 age，必须为 int 类型：</p>
                  <figure class="highlight lisp">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">age = attrib(<span class="name">validator=validators</span>.instance_of(<span class="name">int</span>))</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>这时候初始化的时候就必须传入 int 类型，如果为其他类型，则直接抛错：</p>
                  <figure class="highlight less">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="attribute">TypeError</span>: ("<span class="string">'age'</span> must be &lt;class <span class="string">'int'</span>&gt; (got <span class="string">'x'</span> that is a &lt;class <span class="string">'str'</span>&gt;).</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>另外还有其他的一些 Validator，比如与或运算、可执行判断、可迭代判断等等，可以参考官方文档：<a href="https://www.attrs.org/en/stable/api.html#validators" target="_blank" rel="noopener">https://www.attrs.org/en/stable/api.html#validators</a>。 另外 validator 参数还支持多个 Validator，比如我们要设置既要是数字，又要小于 100，那么可以把几个 Validator 放到一个列表里面并传入：</p>
                  <figure class="highlight reasonml">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">from attr import attrs, attrib, validators</span><br><span class="line"></span><br><span class="line">def is<span class="constructor">_less_than_100(<span class="params">instance</span>, <span class="params">attribute</span>, <span class="params">value</span>)</span>:</span><br><span class="line">    <span class="keyword">if</span> value &gt; <span class="number">100</span>:</span><br><span class="line">        raise <span class="constructor">ValueError(<span class="params">f</span>'<span class="params">age</span> &#123;<span class="params">value</span>&#125; <span class="params">must</span> <span class="params">less</span> <span class="params">than</span> 100')</span></span><br><span class="line"></span><br><span class="line">@attrs</span><br><span class="line"><span class="keyword">class</span> <span class="constructor">Person(<span class="params">object</span>)</span>:</span><br><span class="line">    name = attrib<span class="literal">()</span></span><br><span class="line">    gender = attrib(validator=is_valid_gender)</span><br><span class="line">    age = attrib(validator=<span class="literal">[<span class="identifier">validators</span>.<span class="identifier">instance_of</span>(<span class="identifier">int</span>), <span class="identifier">is_less_than_100</span>]</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__<span class="operator"> == </span>'__main__':</span><br><span class="line">    print(<span class="constructor">Person(<span class="params">name</span>='Mike', <span class="params">gender</span>='<span class="params">male</span>', <span class="params">age</span>=500)</span>)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>这样就会将所有的 Validator 都执行一遍，必须每个 Validator 都满足才可以。这里 age 传入了 500，那么不符合第二个 Validator，直接抛错：</p>
                  <figure class="highlight yaml">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="attr">ValueError:</span> <span class="string">age</span> <span class="number">500</span> <span class="string">must</span> <span class="string">less</span> <span class="string">than</span> <span class="number">100</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <h3 id="转换器"><a href="#转换器" class="headerlink" title="转换器"></a>转换器</h3>
                  <p>其实很多时候我们会不小心传入一些形式不太标准的结果，比如本来是 int 类型的 100，我们传入了字符串类型的 100，那这时候直接抛错应该不好吧，所以我们可以设置一些转换器来增强容错机制，比如将字符串自动转为数字等等，看一个实例：</p>
                  <figure class="highlight angelscript">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">from</span> attr <span class="keyword">import</span> attrs, attrib</span><br><span class="line"></span><br><span class="line">def to_int(value):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">int</span>(value)</span><br><span class="line">    except:</span><br><span class="line">        <span class="keyword">return</span> None</span><br><span class="line"></span><br><span class="line">@attrs</span><br><span class="line"><span class="keyword">class</span> <span class="symbol">Point</span>(<span class="symbol">object</span>):</span><br><span class="line">    <span class="symbol">x</span> = <span class="symbol">attrib</span>(<span class="symbol">converter</span>=<span class="symbol">to_int</span>)</span><br><span class="line">    <span class="symbol">y</span> = <span class="symbol">attrib</span>()</span><br><span class="line"></span><br><span class="line"><span class="symbol">if</span> <span class="symbol">__name__</span> == '<span class="symbol">__main__</span>':</span><br><span class="line">    <span class="symbol">print</span>(<span class="symbol">Point</span>('<span class="symbol">100</span>', <span class="symbol">3</span>))</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>看这里，我们定义了一个方法，可以将值转化为数字类型，如果不能转，那么就返回 None，这样保证了任何可以被转数字的值都被转为数字，否则就留空，容错性非常高。 运行结果如下：</p>
                  <figure class="highlight routeros">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">Point(<span class="attribute">x</span>=100, <span class="attribute">y</span>=3)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <h3 id="类型"><a href="#类型" class="headerlink" title="类型"></a>类型</h3>
                  <p>为什么把这个放到最后来讲呢，因为 Python 中的类型是非常复杂的，有原生类型，有 typing 类型，有自定义类的类型。 首先我们来看看原生类型是怎样的，这个很容易理解了，就是普通的 int、float、str 等类型，其定义如下：</p>
                  <figure class="highlight angelscript">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">from</span> attr <span class="keyword">import</span> attrs, attrib</span><br><span class="line"></span><br><span class="line">@attrs</span><br><span class="line"><span class="keyword">class</span> <span class="symbol">Point</span>(<span class="symbol">object</span>):</span><br><span class="line">    <span class="symbol">x</span> = <span class="symbol">attrib</span>(<span class="symbol">type</span>=<span class="symbol">int</span>)</span><br><span class="line">    <span class="symbol">y</span> = <span class="symbol">attrib</span>()</span><br><span class="line"></span><br><span class="line"><span class="symbol">if</span> <span class="symbol">__name__</span> == '<span class="symbol">__main__</span>':</span><br><span class="line">    <span class="symbol">print</span>(<span class="symbol">Point</span>(<span class="symbol">100, <span class="symbol">3</span></span>))</span><br><span class="line">    <span class="symbol">print</span>(<span class="symbol">Point</span>('<span class="symbol">100</span>', <span class="symbol">3</span>))</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>这里我们将 x 属性定义为 int 类型了，初始化的时候传入了数值型 100 和字符串型 100，结果如下：</p>
                  <figure class="highlight routeros">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">Point(<span class="attribute">x</span>=100, <span class="attribute">y</span>=3)</span><br><span class="line">Point(<span class="attribute">x</span>=<span class="string">'100'</span>, <span class="attribute">y</span>=3)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>但我们发现，虽然定义了，但是不会被自动转类型的。 另外我们还可以自定义 typing 里面的类型，比如 List，另外 attrs 里面也提供了类型的定义：</p>
                  <figure class="highlight elm">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="title">from</span> attr <span class="keyword">import</span> attrs, attrib, Factory</span><br><span class="line"><span class="keyword">import</span> typing</span><br><span class="line"></span><br><span class="line">@attrs</span><br><span class="line"><span class="title">class</span> <span class="type">Point</span>(object):</span><br><span class="line">    x = attrib(<span class="keyword">type</span>=int)</span><br><span class="line">    y = attrib(<span class="keyword">type</span>=typing.<span class="type">List</span>[int])</span><br><span class="line">    z = attrib(<span class="keyword">type</span>=<span class="type">Factory</span>(list))</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>这里我们引入了 typing 这个包，定义了 y 为 int 数字组成的列表，z 使用了 attrs 里面定义的 Factory 定义了同样为列表类型。 另外我们也可以进行类型的嵌套，比如像这样子：</p>
                  <figure class="highlight pgsql">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">from</span> attr <span class="keyword">import</span> attrs, attrib, Factory</span><br><span class="line"><span class="keyword">import</span> typing</span><br><span class="line"></span><br><span class="line">@attrs</span><br><span class="line"><span class="keyword">class</span> <span class="type">Point</span>(<span class="keyword">object</span>):</span><br><span class="line">    x = attrib(<span class="keyword">type</span>=<span class="type">int</span>, default=<span class="number">0</span>)</span><br><span class="line">    y = attrib(<span class="keyword">type</span>=<span class="type">int</span>, default=<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">@attrs</span><br><span class="line"><span class="keyword">class</span> Line(<span class="keyword">object</span>):</span><br><span class="line">    <span class="type">name</span> = attrib()</span><br><span class="line">    points = attrib(<span class="keyword">type</span>=typing.List[<span class="type">Point</span>])</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    points = [<span class="type">Point</span>(i, i) <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">5</span>)]</span><br><span class="line">    print(points)</span><br><span class="line">    <span class="type">line</span> = Line(<span class="type">name</span>=<span class="string">'line1'</span>, points=points)</span><br><span class="line">    print(<span class="type">line</span>)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>在这里我们定义了 Point 类代表离散点，随后定义了线，其拥有 points 属性是 Point 组成的列表。在初始化的时候我们声明了五个点，然后用这五个点组成的列表声明了一条线，逻辑没什么问题。 运行结果：</p>
                  <figure class="highlight routeros">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">[Point(<span class="attribute">x</span>=0, <span class="attribute">y</span>=0), Point(<span class="attribute">x</span>=1, <span class="attribute">y</span>=1), Point(<span class="attribute">x</span>=2, <span class="attribute">y</span>=2), Point(<span class="attribute">x</span>=3, <span class="attribute">y</span>=3), Point(<span class="attribute">x</span>=4, <span class="attribute">y</span>=4)]</span><br><span class="line">Line(<span class="attribute">name</span>=<span class="string">'line1'</span>, points=[Point(<span class="attribute">x</span>=0, <span class="attribute">y</span>=0), Point(<span class="attribute">x</span>=1, <span class="attribute">y</span>=1), Point(<span class="attribute">x</span>=2, <span class="attribute">y</span>=2), Point(<span class="attribute">x</span>=3, <span class="attribute">y</span>=3), Point(<span class="attribute">x</span>=4, <span class="attribute">y</span>=4)])</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>可以看到这里我们得到了一个嵌套类型的 Line 对象，其值是 Point 类型组成的列表。 以上便是一些属性的定义，把握好这些属性的定义，我们就可以非常方便地定义一个类了。</p>
                  <h2 id="序列转换"><a href="#序列转换" class="headerlink" title="序列转换"></a>序列转换</h2>
                  <p>在很多情况下，我们经常会遇到 JSON 等字符串序列和对象互相转换的需求，尤其是在写 REST API、数据库交互的时候。 attrs 库的存在让我们可以非常方便地定义 Python 类，但是它对于序列字符串的转换功能还是比较薄弱的，cattrs 这个库就是用来弥补这个缺陷的，下面我们再来看看 cattrs 这个库。 cattrs 导入的时候名字也不太一样，叫做 cattr，它里面提供了两个主要的方法，叫做 structure 和 unstructure，两个方法是相反的，对于类的序列化和反序列化支持非常好。</p>
                  <h3 id="基本转换"><a href="#基本转换" class="headerlink" title="基本转换"></a>基本转换</h3>
                  <p>首先我们来看看基本的转换方法的用法，看一个基本的转换实例：</p>
                  <figure class="highlight angelscript">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">from</span> attr <span class="keyword">import</span> attrs, attrib</span><br><span class="line"><span class="keyword">from</span> cattr <span class="keyword">import</span> unstructure, structure</span><br><span class="line"></span><br><span class="line">@attrs</span><br><span class="line"><span class="keyword">class</span> <span class="symbol">Point</span>(<span class="symbol">object</span>):</span><br><span class="line">    <span class="symbol">x</span> = <span class="symbol">attrib</span>(<span class="symbol">type</span>=<span class="symbol">int, <span class="symbol">default</span></span>=<span class="symbol">0</span>)</span><br><span class="line">    <span class="symbol">y</span> = <span class="symbol">attrib</span>(<span class="symbol">type</span>=<span class="symbol">int, <span class="symbol">default</span></span>=<span class="symbol">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="symbol">if</span> <span class="symbol">__name__</span> == '<span class="symbol">__main__</span>':</span><br><span class="line">    <span class="symbol">point</span> = <span class="symbol">Point</span>(<span class="symbol">x</span>=<span class="symbol">1, <span class="symbol">y</span></span>=<span class="symbol">2</span>)</span><br><span class="line">    <span class="symbol">json</span> = <span class="symbol">unstructure</span>(<span class="symbol">point</span>)</span><br><span class="line">    <span class="symbol">print</span>('<span class="symbol">json:</span>', <span class="symbol">json</span>)</span><br><span class="line">    <span class="symbol">obj</span> = <span class="symbol">structure</span>(<span class="symbol">json, <span class="symbol">Point</span></span>)</span><br><span class="line">    <span class="symbol">print</span>('<span class="symbol">obj:</span>', <span class="symbol">obj</span>)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>在这里我们定义了一个 Point 对象，然后调用 unstructure 方法即可直接转换为 JSON 字符串。如果我们再想把它转回来，那就需要调用 structure 方法，这样就成功转回了一个 Point 对象。 看下运行结果：</p>
                  <figure class="highlight routeros">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">json: &#123;<span class="string">'x'</span>: 1, <span class="string">'y'</span>: 2&#125;</span><br><span class="line">obj: Point(<span class="attribute">x</span>=1, <span class="attribute">y</span>=2)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>当然这种基本的来回转用的多了就轻车熟路了。</p>
                  <h3 id="多类型转换"><a href="#多类型转换" class="headerlink" title="多类型转换"></a>多类型转换</h3>
                  <p>另外 structure 也支持一些其他的类型转换，看下实例：</p>
                  <figure class="highlight angelscript">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">\&gt;&gt;&gt; cattr.structure(<span class="number">1</span>, str)</span><br><span class="line"><span class="string">'1'</span></span><br><span class="line">&gt;&gt;&gt; cattr.structure(<span class="string">"1"</span>, <span class="built_in">float</span>)</span><br><span class="line"><span class="number">1.0</span></span><br><span class="line">&gt;&gt;&gt; cattr.structure([<span class="number">1.0</span>, <span class="number">2</span>, <span class="string">"3"</span>], Tuple[<span class="built_in">int</span>, <span class="built_in">int</span>, <span class="built_in">int</span>])</span><br><span class="line">(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line">&gt;&gt;&gt; cattr.structure((<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>), MutableSequence[<span class="built_in">int</span>])</span><br><span class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">&gt;&gt;&gt; cattr.structure((<span class="number">1</span>, None, <span class="number">3</span>), List[Optional[str]])</span><br><span class="line">[<span class="string">'1'</span>, None, <span class="string">'3'</span>]</span><br><span class="line">&gt;&gt;&gt; cattr.structure([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>], Set)</span><br><span class="line">&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>&#125;</span><br><span class="line">&gt;&gt;&gt; cattr.structure([[<span class="number">1</span>, <span class="number">2</span>], [<span class="number">3</span>, <span class="number">4</span>]], Set[FrozenSet[str]])</span><br><span class="line">&#123;frozenset(&#123;<span class="string">'4'</span>, <span class="string">'3'</span>&#125;), frozenset(&#123;<span class="string">'1'</span>, <span class="string">'2'</span>&#125;)&#125;</span><br><span class="line">&gt;&gt;&gt; cattr.structure(OrderedDict([(<span class="number">1</span>, <span class="number">2</span>), (<span class="number">3</span>, <span class="number">4</span>)]), Dict)</span><br><span class="line">&#123;<span class="number">1</span>: <span class="number">2</span>, <span class="number">3</span>: <span class="number">4</span>&#125;</span><br><span class="line">&gt;&gt;&gt; cattr.structure([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>], Tuple[<span class="built_in">int</span>, str, <span class="built_in">float</span>])</span><br><span class="line">(<span class="number">1</span>, <span class="string">'2'</span>, <span class="number">3.0</span>)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>这里面用到了 Tuple、MutableSequence、Optional、Set 等类，都属于 typing 这个模块，后面我会写内容详细介绍这个库的用法。 不过总的来说，大部分情况下，JSON 和对象的互转是用的最多的。</p>
                  <h3 id="属性处理"><a href="#属性处理" class="headerlink" title="属性处理"></a>属性处理</h3>
                  <p>上面的例子都是理想情况下使用的，但在实际情况下，很容易遇到 JSON 和对象不对应的情况，比如 JSON 多个字段，或者对象多个字段。 我们先看看下面的例子：</p>
                  <figure class="highlight angelscript">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">from</span> attr <span class="keyword">import</span> attrs, attrib</span><br><span class="line"><span class="keyword">from</span> cattr <span class="keyword">import</span> structure</span><br><span class="line"></span><br><span class="line">@attrs</span><br><span class="line"><span class="keyword">class</span> <span class="symbol">Point</span>(<span class="symbol">object</span>):</span><br><span class="line">    <span class="symbol">x</span> = <span class="symbol">attrib</span>(<span class="symbol">type</span>=<span class="symbol">int, <span class="symbol">default</span></span>=<span class="symbol">0</span>)</span><br><span class="line">    <span class="symbol">y</span> = <span class="symbol">attrib</span>(<span class="symbol">type</span>=<span class="symbol">int, <span class="symbol">default</span></span>=<span class="symbol">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="symbol">json</span> = &#123;<span class="string">'x'</span>: <span class="number">1</span>, <span class="string">'y'</span>: <span class="number">2</span>, <span class="string">'z'</span>: <span class="number">3</span>&#125;</span><br><span class="line">print(structure(json, Point))</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>在这里，JSON 多了一个字段 z，而 Point 类只有 x、y 两个字段，那么直接执行 structure 会出现什么情况呢？</p>
                  <figure class="highlight avrasm">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="symbol">TypeError:</span> __init__() got an unexpected keyword argument <span class="string">'z'</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>不出所料，报错了。意思是多了一个参数，这个参数并没有被定义。 这时候一般的解决方法的直接忽略这个参数，可以重写一下 structure 方法，定义如下：</p>
                  <figure class="highlight reasonml">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">def drop<span class="constructor">_nonattrs(<span class="params">d</span>, <span class="params">type</span>)</span>:</span><br><span class="line">    <span class="keyword">if</span> not isinstance(d, dict): return d</span><br><span class="line">    attrs_attrs = getattr(<span class="keyword">type</span>, '__attrs_attrs__', None)</span><br><span class="line">    <span class="keyword">if</span> attrs_attrs is None:</span><br><span class="line">        raise <span class="constructor">ValueError(<span class="params">f</span>'<span class="params">type</span> &#123;<span class="params">type</span>&#125; <span class="params">is</span> <span class="params">not</span> <span class="params">an</span> <span class="params">attrs</span> <span class="params">class</span>')</span></span><br><span class="line">    attrs: Set<span class="literal">[<span class="identifier">str</span>]</span> = &#123;attr.name for attr <span class="keyword">in</span> attrs_attrs&#125;</span><br><span class="line">    return &#123;key: <span class="keyword">val</span> for key, <span class="keyword">val</span> <span class="keyword">in</span> d.items<span class="literal">()</span> <span class="keyword">if</span> key <span class="keyword">in</span> attrs&#125;</span><br><span class="line"></span><br><span class="line">def structure(d, <span class="keyword">type</span>):</span><br><span class="line">    return cattr.structure(drop<span class="constructor">_nonattrs(<span class="params">d</span>, <span class="params">type</span>)</span>, <span class="keyword">type</span>)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>这里定义了一个 drop_nonattrs 方法，用于从 JSON 里面删除对象里面不存在的属性，然后调用新的 structure 方法即可，写法如下：</p>
                  <figure class="highlight angelscript">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> Set</span><br><span class="line"><span class="keyword">from</span> attr <span class="keyword">import</span> attrs, attrib</span><br><span class="line"><span class="keyword">import</span> cattr</span><br><span class="line"></span><br><span class="line">@attrs</span><br><span class="line"><span class="keyword">class</span> <span class="symbol">Point</span>(<span class="symbol">object</span>):</span><br><span class="line">    <span class="symbol">x</span> = <span class="symbol">attrib</span>(<span class="symbol">type</span>=<span class="symbol">int, <span class="symbol">default</span></span>=<span class="symbol">0</span>)</span><br><span class="line">    <span class="symbol">y</span> = <span class="symbol">attrib</span>(<span class="symbol">type</span>=<span class="symbol">int, <span class="symbol">default</span></span>=<span class="symbol">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="symbol">def</span> <span class="symbol">drop_nonattrs</span>(<span class="symbol">d, <span class="symbol">type</span></span>):</span><br><span class="line">    <span class="symbol">if</span> <span class="symbol">not</span> <span class="symbol">isinstance</span>(<span class="symbol">d, <span class="symbol">dict</span></span>): <span class="symbol">return</span> <span class="symbol">d</span></span><br><span class="line">    <span class="symbol">attrs_attrs</span> = <span class="symbol">getattr</span>(<span class="symbol">type, </span>'<span class="symbol">__attrs_attrs__</span>', <span class="symbol">None</span>)</span><br><span class="line">    <span class="symbol">if</span> <span class="symbol">attrs_attrs</span> <span class="symbol">is</span> <span class="symbol">None:</span></span><br><span class="line">        <span class="symbol">raise</span> <span class="symbol">ValueError</span>(<span class="symbol">f</span>'<span class="symbol">type</span> &#123;type&#125; <span class="keyword">is</span> <span class="keyword">not</span> an attrs <span class="keyword">class</span>')</span><br><span class="line">    <span class="symbol">attrs: <span class="symbol">Set</span></span>[<span class="symbol">str</span>] = &#123;attr.name <span class="keyword">for</span> attr <span class="keyword">in</span> attrs_attrs&#125;</span><br><span class="line">    <span class="keyword">return</span> &#123;key: val <span class="keyword">for</span> key, val <span class="keyword">in</span> d.items() <span class="keyword">if</span> key <span class="keyword">in</span> attrs&#125;</span><br><span class="line"></span><br><span class="line">def structure(d, type):</span><br><span class="line">    <span class="keyword">return</span> cattr.structure(drop_nonattrs(d, type), type)</span><br><span class="line"></span><br><span class="line">json = &#123;<span class="string">'x'</span>: <span class="number">1</span>, <span class="string">'y'</span>: <span class="number">2</span>, <span class="string">'z'</span>: <span class="number">3</span>&#125;</span><br><span class="line">print(structure(json, Point))</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>这样我们就可以避免 JSON 字段冗余导致的转换问题了。 另外还有一个常见的问题，那就是数据对象转换，比如对于时间来说，在对象里面声明我们一般会声明为 datetime 类型，但在序列化的时候却需要序列化为字符串。 所以，对于一些特殊类型的属性，我们往往需要进行特殊处理，这时候就需要我们针对某种特定的类型定义特定的 hook 处理方法，这里就需要用到 register_unstructure_hook 和 register_structure_hook 方法了。 下面这个例子是时间 datetime 转换的时候进行的处理：</p>
                  <figure class="highlight haskell">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">import</span> datetime</span><br><span class="line"><span class="title">from</span> attr <span class="keyword">import</span> attrs, attrib</span><br><span class="line"><span class="keyword">import</span> cattr</span><br><span class="line"></span><br><span class="line"><span class="type">TIME_FORMAT</span> = '%<span class="type">Y</span>-%m-%dT%<span class="type">H</span>:%<span class="type">M</span>:%<span class="type">S</span>.%fZ'</span><br><span class="line"></span><br><span class="line">@attrs</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="type">Event</span>(<span class="title">object</span>):</span></span><br><span class="line"><span class="class">    happened_at = attrib(<span class="title">type</span>=<span class="title">datetime</span>.<span class="title">datetime</span>)</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">cattr.register_unstructure_hook(<span class="title">datetime</span>.<span class="title">datetime</span>, <span class="title">lambda</span> <span class="title">dt</span>: <span class="title">dt</span>.<span class="title">strftime</span>(<span class="type">TIME_FORMAT</span>))</span></span><br><span class="line"><span class="class">cattr.register_structure_hook(<span class="title">datetime</span>.<span class="title">datetime</span>,</span></span><br><span class="line"><span class="class">                              <span class="title">lambda</span> <span class="title">string</span>, <span class="title">_</span>: <span class="title">datetime</span>.<span class="title">datetime</span>.<span class="title">strptime</span>(<span class="title">string</span>, <span class="type">TIME_FORMAT</span>))</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">event = <span class="type">Event</span>(<span class="title">happened_at</span>=<span class="title">datetime</span>.<span class="title">datetime</span>(2019, 6, 1))</span></span><br><span class="line"><span class="class">print('<span class="title">event</span>:', <span class="title">event</span>)</span></span><br><span class="line"><span class="class">json = cattr.unstructure(<span class="title">event</span>)</span></span><br><span class="line"><span class="class">print('<span class="title">json</span>:', <span class="title">json</span>)</span></span><br><span class="line"><span class="class">event = cattr.structure(<span class="title">json</span>, <span class="type">Event</span>)</span></span><br><span class="line"><span class="class">print('<span class="type">Event</span>:', <span class="title">event</span>)</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>在这里我们对 datetime 这个类型注册了两个 hook，当序列化的时候，就调用 strftime 方法转回字符串，当反序列化的时候，就调用 strptime 将其转回 datetime 类型。 看下运行结果：</p>
                  <figure class="highlight yaml">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="attr">event:</span> <span class="string">Event(happened_at=datetime.datetime(2019,</span> <span class="number">6</span><span class="string">,</span> <span class="number">1</span><span class="string">,</span> <span class="number">0</span><span class="string">,</span> <span class="number">0</span><span class="string">))</span></span><br><span class="line"><span class="attr">json:</span> <span class="string">&#123;'happened_at':</span> <span class="string">'2019-06-01T00:00:00.000000Z'</span><span class="string">&#125;</span></span><br><span class="line"><span class="attr">Event:</span> <span class="string">Event(happened_at=datetime.datetime(2019,</span> <span class="number">6</span><span class="string">,</span> <span class="number">1</span><span class="string">,</span> <span class="number">0</span><span class="string">,</span> <span class="number">0</span><span class="string">))</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>这样对于一些特殊类型的属性处理也得心应手了。</p>
                  <h3 id="嵌套处理"><a href="#嵌套处理" class="headerlink" title="嵌套处理"></a>嵌套处理</h3>
                  <p>最后我们再来看看嵌套类型的处理，比如类里面有个属性是另一个类的类型，如果遇到这种嵌套类的话，怎样类转转换呢？我们用一个实例感受下：</p>
                  <figure class="highlight angelscript">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">from</span> attr <span class="keyword">import</span> attrs, attrib</span><br><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> List</span><br><span class="line"><span class="keyword">from</span> cattr <span class="keyword">import</span> structure, unstructure</span><br><span class="line"></span><br><span class="line">@attrs</span><br><span class="line"><span class="keyword">class</span> <span class="symbol">Point</span>(<span class="symbol">object</span>):</span><br><span class="line">    <span class="symbol">x</span> = <span class="symbol">attrib</span>(<span class="symbol">type</span>=<span class="symbol">int, <span class="symbol">default</span></span>=<span class="symbol">0</span>)</span><br><span class="line">    <span class="symbol">y</span> = <span class="symbol">attrib</span>(<span class="symbol">type</span>=<span class="symbol">int, <span class="symbol">default</span></span>=<span class="symbol">0</span>)</span><br><span class="line"></span><br><span class="line">@<span class="symbol">attrs</span></span><br><span class="line"><span class="symbol">class</span> <span class="symbol">Color</span>(<span class="symbol">object</span>):</span><br><span class="line">    <span class="symbol">r</span> = <span class="symbol">attrib</span>(<span class="symbol">default</span>=<span class="symbol">0</span>)</span><br><span class="line">    <span class="symbol">g</span> = <span class="symbol">attrib</span>(<span class="symbol">default</span>=<span class="symbol">0</span>)</span><br><span class="line">    <span class="symbol">b</span> = <span class="symbol">attrib</span>(<span class="symbol">default</span>=<span class="symbol">0</span>)</span><br><span class="line"></span><br><span class="line">@<span class="symbol">attrs</span></span><br><span class="line"><span class="symbol">class</span> <span class="symbol">Line</span>(<span class="symbol">object</span>):</span><br><span class="line">    <span class="symbol">color</span> = <span class="symbol">attrib</span>(<span class="symbol">type</span>=<span class="symbol">Color</span>)</span><br><span class="line">    <span class="symbol">points</span> = <span class="symbol">attrib</span>(<span class="symbol">type</span>=<span class="symbol">List</span>[<span class="symbol">Point</span>])</span><br><span class="line"></span><br><span class="line"><span class="symbol">if</span> <span class="symbol">__name__</span> == '<span class="symbol">__main__</span>':</span><br><span class="line">    <span class="symbol">line</span> = <span class="symbol">Line</span>(<span class="symbol">color</span>=<span class="symbol">Color</span>(), <span class="symbol">points</span>=[<span class="symbol">Point</span>(<span class="symbol">i, <span class="symbol">i</span></span>) <span class="symbol">for</span> <span class="symbol">i</span> <span class="symbol">in</span> <span class="symbol">range</span>(<span class="symbol">5</span>)])</span><br><span class="line">    <span class="symbol">print</span>('<span class="symbol">Object:</span>', <span class="symbol">line</span>)</span><br><span class="line">    <span class="symbol">json</span> = <span class="symbol">unstructure</span>(<span class="symbol">line</span>)</span><br><span class="line">    <span class="symbol">print</span>('<span class="symbol">JSON:</span>', <span class="symbol">json</span>)</span><br><span class="line">    <span class="symbol">line</span> = <span class="symbol">structure</span>(<span class="symbol">json, <span class="symbol">Line</span></span>)</span><br><span class="line">    <span class="symbol">print</span>('<span class="symbol">Object:</span>', <span class="symbol">line</span>)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>这里我们定义了两个 Class，一个是 Point，一个是 Color，然后定义了 Line 对象，其属性类型一个是 Color 类型，一个是 Point 类型组成的列表，下面我们进行序列化和反序列化操作，转成 JSON 然后再由 JSON 转回来，运行结果如下：</p>
                  <figure class="highlight routeros">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">Object: Line(<span class="attribute">color</span>=Color(r=0, <span class="attribute">g</span>=0, <span class="attribute">b</span>=0), points=[Point(<span class="attribute">x</span>=0, <span class="attribute">y</span>=0), Point(<span class="attribute">x</span>=1, <span class="attribute">y</span>=1), Point(<span class="attribute">x</span>=2, <span class="attribute">y</span>=2), Point(<span class="attribute">x</span>=3, <span class="attribute">y</span>=3), Point(<span class="attribute">x</span>=4, <span class="attribute">y</span>=4)])</span><br><span class="line">JSON: &#123;<span class="string">'color'</span>: &#123;<span class="string">'r'</span>: 0, <span class="string">'g'</span>: 0, <span class="string">'b'</span>: 0&#125;, <span class="string">'points'</span>: [&#123;<span class="string">'x'</span>: 0, <span class="string">'y'</span>: 0&#125;, &#123;<span class="string">'x'</span>: 1, <span class="string">'y'</span>: 1&#125;, &#123;<span class="string">'x'</span>: 2, <span class="string">'y'</span>: 2&#125;, &#123;<span class="string">'x'</span>: 3, <span class="string">'y'</span>: 3&#125;, &#123;<span class="string">'x'</span>: 4, <span class="string">'y'</span>: 4&#125;]&#125;</span><br><span class="line">Object: Line(<span class="attribute">color</span>=Color(r=0, <span class="attribute">g</span>=0, <span class="attribute">b</span>=0), points=[Point(<span class="attribute">x</span>=0, <span class="attribute">y</span>=0), Point(<span class="attribute">x</span>=1, <span class="attribute">y</span>=1), Point(<span class="attribute">x</span>=2, <span class="attribute">y</span>=2), Point(<span class="attribute">x</span>=3, <span class="attribute">y</span>=3), Point(<span class="attribute">x</span>=4, <span class="attribute">y</span>=4)])</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>可以看到，我们非常方便地将对象转化为了 JSON 对象，然后也非常方便地转回了对象。 这样我们就成功实现了嵌套对象的序列化和反序列化，所有问题成功解决！</p>
                  <h2 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h2>
                  <p>本节介绍了利用 attrs 和 cattrs 两个库实现 Python 面向对象编程的实践，有了它们两个的加持，Python 面向对象编程不再是难事。</p>
                  </p>
                </div>
              </div>
              <div class="post-meta">
                <span class="post-meta-item">
                  <span class="post-meta-item-icon">
                    <i class="far fa-user"></i>
                  </span>
                  <span class="post-meta-item-text">作者</span>
                  <span><a href="/authors/崔庆才" class="author" itemprop="url" rel="index">崔庆才</a></span>
                </span>
                <span class="post-meta-item">
                  <span class="post-meta-item-icon">
                    <i class="far fa-calendar"></i>
                  </span>
                  <span class="post-meta-item-text">发表于</span>
                  <time title="创建时间：2019-06-18 17:21:02" itemprop="dateCreated datePublished" datetime="2019-06-18T17:21:02+08:00">2019-06-18</time>
                </span>
                <span id="/6552.html" class="post-meta-item leancloud_visitors" data-flag-title="Python 使用 attrs 和 cattrs 实现面向对象编程" title="阅读次数">
                  <span class="post-meta-item-icon">
                    <i class="fa fa-eye"></i>
                  </span>
                  <span class="post-meta-item-text">阅读次数：</span>
                  <span class="leancloud-visitors-count"></span>
                </span>
                <span class="post-meta-item" title="本文字数">
                  <span class="post-meta-item-icon">
                    <i class="far fa-file-word"></i>
                  </span>
                  <span class="post-meta-item-text">本文字数：</span>
                  <span>18k</span>
                </span>
                <span class="post-meta-item" title="阅读时长">
                  <span class="post-meta-item-icon">
                    <i class="far fa-clock"></i>
                  </span>
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                  <span>16 分钟</span>
                </span>
              </div>
            </article>
            <article itemscope itemtype="http://schema.org/Article" class="post-block index" lang="zh-CN">
              <link itemprop="mainEntityOfPage" href="https://cuiqingcai.com/6607.html">
              <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
                <meta itemprop="image" content="/images/avatar.png">
                <meta itemprop="name" content="崔庆才">
                <meta itemprop="description" content="崔庆才的个人站点，记录生活的瞬间，分享学习的心得。">
              </span>
              <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
                <meta itemprop="name" content="静觅">
              </span>
              <header class="post-header">
                <h2 class="post-title" itemprop="name headline">
                  <a class="label"> Python <i class="label-arrow"></i>
                  </a>
                  <a href="/6607.html" class="post-title-link" itemprop="url">代码整洁之道-编写 Pythonic 代码</a>
                </h2>
              </header>
              <div class="post-body" itemprop="articleBody">
                <div class="thumb">
                  <img itemprop="contentUrl" class="random">
                </div>
                <div class="excerpt">
                  <p>
                  <p>很多新手在开始学一门新的语言的时候，往往会忽视一些不应该忽视的细节，比如变量命名和函数命名以及注释等一些内容的规范性，久而久之养成了一种习惯。对此呢，我特意收集了一些适合所有学习 Python 的人，代码整洁之道。</p>
                  <h3 id="写出-Pythonic-代码"><a href="#写出-Pythonic-代码" class="headerlink" title="写出 Pythonic 代码"></a><strong>写出 Pythonic 代码</strong></h3>
                  <p>谈到规范首先想到就是 Python 有名的 PEP8 代码规范文档，它定义了编写 Pythonic 代码的最佳实践。可以在 <a href="https://link.zhihu.com/?target=https%3A//www.python.org/dev/peps/pep-0008/">https://www.python.org/dev/peps/pep-0008/</a> 上查看。但是真正去仔细研究学习这些规范的朋友并不是很多，对此呢这篇文章摘选一些比较常用的代码整洁和规范的技巧和方法，下面让我们一起来学习吧！</p>
                  <h3 id="命名"><a href="#命名" class="headerlink" title="命名"></a><strong>命名</strong></h3>
                  <p>所有的编程语言都有变量、函数、类等的命名约定，以美之称的 Python 当然更建议使用命名约定。 接下来就针对类、函数、方法等等内容进行学习。</p>
                  <h3 id="变量和函数"><a href="#变量和函数" class="headerlink" title="变量和函数"></a><strong>变量和函数</strong></h3>
                  <p>使用小写字母命名函数和变量，并用下划线分隔单词，提高代码可读性。</p>
                  <h3 id="变量的声明"><a href="#变量的声明" class="headerlink" title="变量的声明"></a><strong>变量的声明</strong></h3>
                  <figure class="highlight ini">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="attr">names</span> = <span class="string">"Python"</span> <span class="comment">#变量名 </span></span><br><span class="line"><span class="attr">namejob_title</span> = <span class="string">"Software Engineer"</span> <span class="comment">#带有下划线的变量名</span></span><br><span class="line"><span class="attr">populated_countries_list</span> = []  <span class="comment">#带有下划线的变量名</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>还应该考虑在代码中使用非 Python 内置方法名，如果使用 Python 中内置方法名请使用一个或两个下划线()。</p>
                  <figure class="highlight ini">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="attr">_books</span> = &#123;&#125;<span class="comment"># 变量名私有化</span></span><br><span class="line"><span class="attr">__dict</span> = []<span class="comment"># 防止python内置库中的名称混淆</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>那如何选择是用<em>还是__呢？ 如果不希望外部类访问该变量，应该使用一个下划线（</em>）作为类的内部变量的前缀。如果要定义的私有变量名称是 Python 中的关键字如 dict 就要使用(__)。</p>
                  <h3 id="函数的声明"><a href="#函数的声明" class="headerlink" title="函数的声明"></a><strong>函数的声明</strong></h3>
                  <figure class="highlight python">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_data</span><span class="params">()</span>:</span> </span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">calculate_tax_data</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">pass</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>函数的声明和变量一样也是通过小写字母和单下划线进行连接。 当然对于函数私有化也是和声明变量类似。</p>
                  <figure class="highlight python">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_get_data</span><span class="params">()</span>:</span></span><br><span class="line">   <span class="keyword">pass</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>函数的开头使用单下划线，将其进行私有化。对于使用 Pyton 中的关键字来进行命名的函数 要使用双下划线。</p>
                  <figure class="highlight python">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">__path</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">pass</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>除了遵循这些命名规则之外，使用清晰易懂的变量名和很重要。</p>
                  <h3 id="函数名规范"><a href="#函数名规范" class="headerlink" title="函数名规范"></a><strong>函数名规范</strong></h3>
                  <figure class="highlight routeros">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="comment"># Wrong Way</span></span><br><span class="line">def get_user_info(id):</span><br><span class="line">   db = get_db_connection()</span><br><span class="line">  <span class="built_in"> user </span>= execute_query_for_user(id)</span><br><span class="line">   return user</span><br><span class="line"></span><br><span class="line"><span class="comment"># Right way</span></span><br><span class="line">def get_user_by(user_id):</span><br><span class="line">    db = get_db_connection()</span><br><span class="line">   <span class="built_in"> user </span>= execute_user_query(user_id) </span><br><span class="line">    return user</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>这里，第二个函数 get_user_by 确保使用相同的参数来传递变量，从而为函数提供正确的上下文。 第一个函数 get_user_info 就不怎么不明确了，因为参数 id 意味着什么这里我们不能确定，它是用户 ID，还是用户付款ID或任何其他 ID？ 这种代码可能会对使用你的API的其他开发人员造成混淆。为了解决这个问题，我在第二个函数中更改了两个东西; 我更改了函数名称以及传递的参数名称，这使代码可读性更高。 作为开发人员，你有责任在命名变量和函数时仔细考虑，要写让人能够清晰易懂的代码。 当然也方便自己以后去维护。</p>
                  <h3 id="类的命名规范"><a href="#类的命名规范" class="headerlink" title="类的命名规范"></a><strong>类的命名规范</strong></h3>
                  <p>类的名称应该像大多数其他语言一样使用驼峰大小写。</p>
                  <figure class="highlight angelscript">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">class</span> <span class="symbol">UserInformation:</span></span><br><span class="line">     <span class="symbol">def</span> <span class="symbol">get_user</span>(<span class="symbol">id</span>):</span><br><span class="line">          <span class="symbol">db</span> = <span class="symbol">get_db_connection</span>()</span><br><span class="line">          <span class="symbol">user</span> = <span class="symbol">execute_query_for_user</span>(<span class="symbol">id</span>)</span><br><span class="line">          <span class="symbol">return</span> <span class="symbol">user</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <h3 id="常量的命名规范"><a href="#常量的命名规范" class="headerlink" title="常量的命名规范"></a><strong>常量的命名规范</strong></h3>
                  <p>通常应该用大写字母定义常量名称。</p>
                  <figure class="highlight ini">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="attr">TOTAL</span> = <span class="number">56</span></span><br><span class="line"><span class="attr">TIMOUT</span> = <span class="number">6</span></span><br><span class="line"><span class="attr">MAX_OVERFLOW</span> = <span class="number">7</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <h3 id="函数和方法的参数"><a href="#函数和方法的参数" class="headerlink" title="函数和方法的参数"></a><strong>函数和方法的参数</strong></h3>
                  <p>函数和方法的参数命名应遵循与变量和方法名称相同的规则。因为类方法将self作为第一个关键字参数。所以在函数中就不要使用 self 作为关键字作为参数，以免造成混淆 .</p>
                  <figure class="highlight angelscript">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">def calculate_tax(amount, yearly_tax):</span><br><span class="line">    passs</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="symbol">Player:</span></span><br><span class="line">    <span class="symbol">def</span> <span class="symbol">get_total_score</span>(<span class="symbol">self, <span class="symbol">player_name</span></span>):</span><br><span class="line">         <span class="symbol">pass</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>关于命名大概就强调这些，下面让我们看看表达式和语句中需要的问题。</p>
                  <h3 id="代码中的表达式和语句"><a href="#代码中的表达式和语句" class="headerlink" title="代码中的表达式和语句"></a><strong>代码中的表达式和语句</strong></h3>
                  <figure class="highlight routeros">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">users = [</span><br><span class="line">    &#123;<span class="string">"first_name"</span>:<span class="string">"Helen"</span>, <span class="string">"age"</span>:39&#125;,</span><br><span class="line">    &#123;<span class="string">"first_name"</span>:<span class="string">"Buck"</span>, <span class="string">"age"</span>:10&#125;,</span><br><span class="line">    &#123;<span class="string">"first_name"</span>:<span class="string">"anni"</span>, <span class="string">"age"</span>:9&#125;</span><br><span class="line">]</span><br><span class="line">users = sorted(users, <span class="attribute">key</span>=lambda user: user[<span class="string">"first_name"</span>].lower())</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>这段代码有什么问题? 乍一看并不容易理解这段代码，尤其是对于新开发人员来说，因为 lambdas 的语法很古怪，所以不容易理解。虽然这里使用 lambda 可以节省行，然而，这并不能保证代码的正确性和可读性。同时这段代码无法解决字典缺少键出现异常的问题。 让我们使用函数重写此代码，使代码更具可读性和正确性; 该函数将判断异常情况，编写起来要简单得多。</p>
                  <figure class="highlight python">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">users = [</span><br><span class="line">    &#123;<span class="string">"first_name"</span>:<span class="string">"Helen"</span>, <span class="string">"age"</span>:<span class="number">39</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"first_name"</span>:<span class="string">"Buck"</span>, <span class="string">"age"</span>:<span class="number">10</span>&#125;,</span><br><span class="line">    &#123;<span class="string">"name"</span>:<span class="string">"anni"</span>, <span class="string">"age"</span>:<span class="number">9</span>&#125;</span><br><span class="line">]</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_user_name</span><span class="params">(users)</span>:</span></span><br><span class="line">    <span class="string">"""Get name of the user in lower case"""</span></span><br><span class="line">    <span class="keyword">return</span> users[<span class="string">"first_name"</span>].lower()</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_sorted_dictionary</span><span class="params">(users)</span>:</span></span><br><span class="line">    <span class="string">"""Sort the nested dictionary"""</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> isinstance(users, dict):</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">"Not a correct dictionary"</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> len(users):</span><br><span class="line">       <span class="keyword">raise</span> ValueError(<span class="string">"Empty dictionary"</span>)</span><br><span class="line">    users_by_name = sorted(users, key=get_user_name)</span><br><span class="line">    <span class="keyword">return</span> users_by_name</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>如您所见，此代码检查了所有可能的意外值，并且比起以前的单行代码更具可读性。 单行代码虽然看起来很酷节省了行，但是会给代码添加很多复杂性。 但是这并不意味着单行代码就不好 这里提出的一点是，如果你的单行代码使代码变得更难阅读，那么就请避免使用它，记住写代码不是为了炫酷的，尤其在项目组中。 让我们再考虑一个例子，你试图读取 CSV 文件并计算 CSV 文件处理的行数。下面的代码展示使代码可读的重要性，以及命名如何在使代码可读中发挥重要作用。</p>
                  <figure class="highlight python">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">import</span> csv</span><br><span class="line"><span class="keyword">with</span> open(<span class="string">"employee.csv"</span>, mode=<span class="string">"r"</span>) <span class="keyword">as</span> csv_file:</span><br><span class="line">    csv_reader = csv.DictReader(csv_file)</span><br><span class="line">    line_count = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> csv_reader:</span><br><span class="line">        <span class="keyword">if</span> line_count == <span class="number">0</span>:</span><br><span class="line">            print(<span class="string">f'Column names are <span class="subst">&#123;<span class="string">", "</span>.join(row)&#125;</span>'</span>)</span><br><span class="line">            line_count += <span class="number">1</span></span><br><span class="line">            print(<span class="string">f'\\t<span class="subst">&#123;row[<span class="string">"name"</span>]&#125;</span> salary: <span class="subst">&#123;row[<span class="string">"salary"</span>]&#125;</span>'</span></span><br><span class="line">            <span class="string">f'and was born in <span class="subst">&#123;row[<span class="string">"birthday month"</span>]&#125;</span>.'</span>)</span><br><span class="line">        line_count += <span class="number">1</span></span><br><span class="line">    print(<span class="string">f'Processed <span class="subst">&#123;line_count&#125;</span> lines.'</span>)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>将代码分解为函数有助于使复杂的代码变的易于阅读和调试。 这里的代码在 with 语句中执行多项操作。为了提高可读性，您可以将带有 process salary 的代码从 CSV 文件中提取到另一个函数中，以降低出错的可能性。</p>
                  <figure class="highlight python">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">import</span> csv</span><br><span class="line"><span class="keyword">with</span> open(<span class="string">"employee.csv"</span>, mode=<span class="string">"r"</span>) <span class="keyword">as</span> csv_file:</span><br><span class="line">    csv_reader = csv.DictReader(csv_file)</span><br><span class="line">    line_count = <span class="number">0</span></span><br><span class="line">    process_salary(csv_reader)    </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">process_salary</span><span class="params">(csv_reader)</span>:</span></span><br><span class="line"><span class="string">"""Process salary of user from csv file."""</span></span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> csv_reader:</span><br><span class="line">            <span class="keyword">if</span> line_count == <span class="number">0</span>:</span><br><span class="line">                print(<span class="string">f'Column names are <span class="subst">&#123;<span class="string">", "</span>.join(row)&#125;</span>'</span>)</span><br><span class="line">                line_count += <span class="number">1</span></span><br><span class="line">                print(<span class="string">f'\\t<span class="subst">&#123;row[<span class="string">"name"</span>]&#125;</span> salary: <span class="subst">&#123;row[<span class="string">"salary"</span>]&#125;</span>'</span></span><br><span class="line">                <span class="string">f'and was born in <span class="subst">&#123;row[<span class="string">"birthday month"</span>]&#125;</span>.'</span>)</span><br><span class="line">            line_count += <span class="number">1</span></span><br><span class="line">        print(<span class="string">f'Processed <span class="subst">&#123;line_count&#125;</span> lines.'</span>)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>代码是不是变得容易理解了不少呢。 在这里，创建了一个帮助函数，而不是在with语句中编写所有内容。这使读者清楚地了解了函数的实际作用。如果想处理一个特定的异常或者想从CSV文件中读取更多的数据，可以进一步分解这个函数，以遵循单一职责原则，一个函数一做一件事。这个很重要</p>
                  <h3 id="return语句的类型尽量一致"><a href="#return语句的类型尽量一致" class="headerlink" title="return语句的类型尽量一致"></a><strong>return语句的类型尽量一致</strong></h3>
                  <p>如果希望函数返回一个值，请确保该函数的所有执行路径都返回该值。但是，如果期望函数只是在不返回值的情况下执行操作，则 Python 会隐式返回 None 作为函数的默认值。 先看一个错误示范</p>
                  <figure class="highlight ruby">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">calculate_interest</span><span class="params">(principle, time rate)</span></span>:    </span><br><span class="line">     <span class="keyword">if</span> principle &gt; <span class="number">0</span><span class="symbol">:</span></span><br><span class="line">         <span class="keyword">return</span> (principle * time * rate) / <span class="number">100</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">calculate_interest</span><span class="params">(principle, time rate)</span></span>:    </span><br><span class="line">    <span class="keyword">if</span> principle &lt; <span class="number">0</span><span class="symbol">:</span></span><br><span class="line">        <span class="keyword">return</span>    </span><br><span class="line">    <span class="keyword">return</span> (principle * time * rate) / <span class="number">100</span>ChaPTER <span class="number">1</span>  PyThonIC ThInkIng</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>正确的示范应该是下面这样</p>
                  <figure class="highlight python">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">calculate_interest</span><span class="params">(principle, time rate)</span>:</span>    </span><br><span class="line">     <span class="keyword">if</span> principle &gt; <span class="number">0</span>:</span><br><span class="line">         <span class="keyword">return</span> (principle * time * rate) / <span class="number">100</span></span><br><span class="line">     <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">calculate_interest</span><span class="params">(principle, time rate)</span>:</span>    </span><br><span class="line">    <span class="keyword">if</span> principle &lt; <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span>    </span><br><span class="line">    <span class="keyword">return</span> (principle * time * rate) / <span class="number">100</span>ChaPTER <span class="number">1</span>  PyThonIC ThInkIng</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>还是那句话写易读的代码，代码多写点没关系，可读性很重要。</p>
                  <h3 id="使用-isinstance-方法而不是-type-进行比较"><a href="#使用-isinstance-方法而不是-type-进行比较" class="headerlink" title="使用 isinstance() 方法而不是 type() 进行比较"></a><strong>使用 isinstance() 方法而不是 type() 进行比较</strong></h3>
                  <p>当比较两个对象类型时，请考虑使用 isinstance() 而不是 type，因为 isinstance() 判断一个对象是否为另一个对象的子类是 true。考虑这样一个场景：如果传递的数据结构是dict 的子类，比如 orderdict。type() 对于特定类型的数据结构将失败;然而，isinstance() 可以将其识别出它是 dict 的子类。 错误示范</p>
                  <figure class="highlight elm">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="title">user_ages</span> = &#123;<span class="string">"Larry"</span>: <span class="number">35</span>, <span class="string">"Jon"</span>: <span class="number">89</span>, <span class="string">"Imli"</span>: <span class="number">12</span>&#125;</span><br><span class="line"><span class="keyword">type</span>(user_ages) == dict:</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>正确选择</p>
                  <figure class="highlight yaml">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="string">user_ages</span> <span class="string">=</span> <span class="string">&#123;"Larry":</span> <span class="number">35</span><span class="string">,</span> <span class="attr">"Jon":</span> <span class="number">89</span><span class="string">,</span> <span class="attr">"Imli":</span> <span class="number">12</span><span class="string">&#125;</span></span><br><span class="line"><span class="string">if</span> <span class="string">isinstance(user_ages,</span> <span class="string">dict):</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <h3 id="比较布尔值"><a href="#比较布尔值" class="headerlink" title="比较布尔值"></a><strong>比较布尔值</strong></h3>
                  <p>在Python中有多种方法可以比较布尔值。 错误示范</p>
                  <figure class="highlight ada">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">if</span> is_empty = <span class="literal">False</span></span><br><span class="line"><span class="keyword">if</span> is_empty == <span class="literal">False</span>:</span><br><span class="line"><span class="keyword">if</span> is_empty <span class="keyword">is</span> <span class="literal">False</span>:</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>正确示范</p>
                  <figure class="highlight ceylon">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">is</span><span class="number">_</span>empty = False</span><br><span class="line"><span class="keyword">if</span> <span class="keyword">is</span><span class="number">_</span>empty</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <h3 id="使用文档字符串"><a href="#使用文档字符串" class="headerlink" title="使用文档字符串"></a><strong>使用文档字符串</strong></h3>
                  <p>Docstrings可以在 Python 中声明代码的功能的。通常在方法，类和模块的开头使用。 docstring是该对象的<strong>doc</strong>特殊属性。 Python 官方语言建议使用“”三重双引号“”来编写文档字符串。 你可以在 PEP8 官方文档中找到这些实践。 下面让我们简要介绍一下在 Python 代码中编写 docstrings 的一些最佳实践 。</p>
                  <h3 id="方法中使用docstring"><a href="#方法中使用docstring" class="headerlink" title="方法中使用docstring"></a><strong>方法中使用docstring</strong></h3>
                  <figure class="highlight python">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_prime_number</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="string">"""Get list of prime numbers between 1 to 100."""</span><span class="string">"</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>关于docstring的格式的写法，目前存在多种风格，但是这几种风格都有一些统一的标准。</p>
                  <ul>
                    <li>即使字符串符合一行，也会使用三重引号。当你想要扩展时，这种注释非常有用。‘</li>
                    <li>三重引号中的字符串前后不应有任何空行</li>
                    <li>使用句点（.）结束docstring中的语句 类似地，可以应用 Python 多行 docstring 规则来编写多行 docstring。在多行上编写文档字符串是用更具描述性的方式记录代码的一种方法。你可以利用 Python 多行文档字符串在 Python 代码中编写描述性文档字符串，而不是在每一行上编写注释。 <strong>多行的docstring</strong></li>
                  </ul>
                  <figure class="highlight python">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">call_weather_api</span><span class="params">(url, location)</span>:</span></span><br><span class="line">    <span class="string">"""Get the weather of specific location.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Calling weather api to check for weather by using weather api and </span></span><br><span class="line"><span class="string">    location. Make sure you provide city name only, country and county </span></span><br><span class="line"><span class="string">    names won't be accepted and will throw exception if not found the </span></span><br><span class="line"><span class="string">    city name.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    :param url:URL of the api to get weather.</span></span><br><span class="line"><span class="string">    :type url: str</span></span><br><span class="line"><span class="string">    :param location:Location of the city to get the weather.</span></span><br><span class="line"><span class="string">    :type location: str</span></span><br><span class="line"><span class="string">    :return: Give the weather information of given location.</span></span><br><span class="line"><span class="string">    :rtype: str"""</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>说一下上面代码的注意点</p>
                  <ul>
                    <li>第一行是函数或类的简要描述</li>
                    <li>每一行语句的末尾有一个句号</li>
                    <li>文档字符串中的简要描述和摘要之间有一行空白</li>
                  </ul>
                  <p>如果使用 Python3.6 可以使用类型注解对上面的docstring以及参数的声明进行修改。</p>
                  <figure class="highlight python">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">call_weather_api</span><span class="params">(url: str, location: str)</span> -&gt; str:</span></span><br><span class="line">    <span class="string">"""Get the weather of specific location.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Calling weather api to check for weather by using weather api and </span></span><br><span class="line"><span class="string">    location. Make sure you provide city name only, country and county </span></span><br><span class="line"><span class="string">    names won't be accepted and will throw exception if not found the </span></span><br><span class="line"><span class="string">    city name.</span></span><br><span class="line"><span class="string">    """</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>怎么样是不是简洁了不少，如果使用 Python 代码中的类型注解，则不需要再编写参数信息。 关于类型注解(type hint)的具体用法可以参考我之前写的<a href="https://link.zhihu.com/?target=http%3A//mp.weixin.qq.com/s%3F__biz%3DMzU0NDQ2OTkzNw%3D%3D%26mid%3D2247484258%26idx%3D1%26sn%3Db13db84dad8eccaec9cd4af618e812e4%26chksm%3Dfb7ae5bccc0d6caa8e145e9fd22d0395e68d618672ebbfe99794926c0b9e782974fb16321e32%26scene%3D21%23wechat_redirect">http://mp.weixin.qq.com/s?__biz=MzU0NDQ2OTkzNw==&amp;mid=2247484258&amp;idx=1&amp;sn=b13db84dad8eccaec9cd4af618e812e4&amp;chksm=fb7ae5bccc0d6caa8e145e9fd22d0395e68d618672ebbfe99794926c0b9e782974fb16321e32&amp;scene=21#wechat_redirect</a></p>
                  <h3 id="模块级别的docstring"><a href="#模块级别的docstring" class="headerlink" title="模块级别的docstring"></a><strong>模块级别的docstring</strong></h3>
                  <p>一般在文件的顶部放置一个模块级的 docstring 来简要描述模块的使用。 这些注释应该放在在导包之前，模块文档字符串应该表明模块的使用方法和功能。 如果觉得在使用模块之前客户端需要明确地知道方法或类，你还可以简要地指定特定方法或类。</p>
                  <figure class="highlight sql">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">"""This module contains all of the network related requests. </span><br><span class="line">This module will <span class="keyword">check</span> <span class="keyword">for</span> <span class="keyword">all</span> the <span class="keyword">exceptions</span> <span class="keyword">while</span> making the network </span><br><span class="line">calls <span class="keyword">and</span> <span class="keyword">raise</span> <span class="keyword">exceptions</span> <span class="keyword">for</span> <span class="keyword">any</span> <span class="literal">unknown</span> exception.</span><br><span class="line">Make sure that <span class="keyword">when</span> you <span class="keyword">use</span> this <span class="keyword">module</span>,</span><br><span class="line">you handle these <span class="keyword">exceptions</span> <span class="keyword">in</span> <span class="keyword">client</span> code <span class="keyword">as</span>:</span><br><span class="line">NetworkError <span class="keyword">exception</span> <span class="keyword">for</span> network calls.</span><br><span class="line">NetworkNotFound <span class="keyword">exception</span> <span class="keyword">if</span> network <span class="keyword">not</span> found.</span><br><span class="line"><span class="string">"""</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">import urllib3</span></span><br><span class="line"><span class="string">import json</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>在为模块编写文档字符串时，应考虑执行以下操作：</p>
                  <ul>
                    <li>对当前模块写一个简要的说明</li>
                    <li>如果想指定某些对读者有用的模块，如上面的代码，还可以添加异常信息，但是注意不要太详细。</li>
                  </ul>
                  <figure class="highlight routeros">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">NetworkError exception <span class="keyword">for</span><span class="built_in"> network </span>calls.</span><br><span class="line">NetworkNotFound exception <span class="keyword">if</span><span class="built_in"> network </span><span class="keyword">not</span> found.</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <ul>
                    <li>将模块的docstring看作是提供关于模块的描述性信息的一种方法，而不需要详细讨论每个函数或类具体操作方法。 <strong>类级别的docstring</strong> 类docstring主要用于简要描述类的使用及其总体目标。 让我们看一些示例，看看如何编写类文档字符串 <strong>单行类docstring</strong></li>
                  </ul>
                  <figure class="highlight python">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span>:</span></span><br><span class="line">   <span class="string">"""This class handle actions performed by a student."""</span></span><br><span class="line">   <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">      <span class="keyword">pass</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>这个类有一个一行的 docstring，它简要地讨论了学生类。如前所述，遵守了所以一行docstring 的编码规范。</p>
                  <h3 id="多行类docstring"><a href="#多行类docstring" class="headerlink" title="多行类docstring"></a><strong>多行类docstring</strong></h3>
                  <figure class="highlight python">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Student</span>:</span></span><br><span class="line">    <span class="string">"""Student class information.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    This class handle actions performed by a student.</span></span><br><span class="line"><span class="string">    This class provides information about student full name, age, </span></span><br><span class="line"><span class="string">    roll-number and other information.</span></span><br><span class="line"><span class="string">    Usage:</span></span><br><span class="line"><span class="string">        import student</span></span><br><span class="line"><span class="string">        student = student.Student()</span></span><br><span class="line"><span class="string">        student.get_name()</span></span><br><span class="line"><span class="string">        &gt;&gt;&gt; 678998</span></span><br><span class="line"><span class="string">   """</span></span><br><span class="line">   <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self)</span>:</span></span><br><span class="line">       <span class="keyword">pass</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>这个类 docstring 是多行的; 我们写了很多关于 Student 类的用法以及如何使用它。</p>
                  <h3 id="函数的docstring"><a href="#函数的docstring" class="headerlink" title="函数的docstring"></a><strong>函数的docstring</strong></h3>
                  <p>函数文档字符串可以写在函数之后，也可以写在函数的顶部。</p>
                  <figure class="highlight sql">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">def is_prime_number(number):</span><br><span class="line">    """<span class="keyword">Check</span> <span class="keyword">for</span> prime number.</span><br><span class="line"></span><br><span class="line">    <span class="keyword">Check</span> the given <span class="built_in">number</span> <span class="keyword">is</span> prime <span class="built_in">number</span> </span><br><span class="line">    <span class="keyword">or</span> <span class="keyword">not</span> <span class="keyword">by</span> checking against <span class="keyword">all</span> the numbers </span><br><span class="line">    <span class="keyword">less</span> the <span class="keyword">square</span> root <span class="keyword">of</span> given number.</span><br><span class="line"></span><br><span class="line">    :param <span class="built_in">number</span>:Given <span class="built_in">number</span> <span class="keyword">to</span> <span class="keyword">check</span> <span class="keyword">for</span> prime</span><br><span class="line">    :<span class="keyword">type</span> <span class="built_in">number</span>: <span class="built_in">int</span></span><br><span class="line">    :<span class="keyword">return</span>: <span class="literal">True</span> <span class="keyword">if</span> <span class="built_in">number</span> <span class="keyword">is</span> prime otherwise False.</span><br><span class="line">    :rtype: <span class="built_in">boolean</span></span><br><span class="line">    <span class="string">"""</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>如果我们使用类型注解对其进一步优化。</p>
                  <figure class="highlight python">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">is_prime_number</span><span class="params">(number: int)</span>-&gt;bool:</span></span><br><span class="line">    <span class="string">"""Check for prime number.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Check the given number is prime number </span></span><br><span class="line"><span class="string">    or not by checking against all the numbers </span></span><br><span class="line"><span class="string">    less the square root of given number.</span></span><br><span class="line"><span class="string">    """</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <h3 id="结语"><a href="#结语" class="headerlink" title="结语"></a><strong>结语</strong></h3>
                  <p>当然关于 Python 中的规范还有很多很多，建议大家参考 Python 之禅和 Pep8 对代码进行优化，养成编写 Pythonic 代码的良好习惯。 [caption id=”attachment_6600” align=”alignnone” width=”258”]<img src="https://qiniu.cuiqingcai.com/wp-content/uploads/2019/06/qrcode_for_gh_fedbc9cddff8_258.jpg" alt=""> 扫码关注[/caption] 更多精彩内容关注微信公众号:python学习开发</p>
                  </p>
                </div>
              </div>
              <div class="post-meta">
                <span class="post-meta-item">
                  <span class="post-meta-item-icon">
                    <i class="far fa-user"></i>
                  </span>
                  <span class="post-meta-item-text">作者</span>
                  <span><a href="/authors/陈祥安" class="author" itemprop="url" rel="index">陈祥安</a></span>
                </span>
                <span class="post-meta-item">
                  <span class="post-meta-item-icon">
                    <i class="far fa-calendar"></i>
                  </span>
                  <span class="post-meta-item-text">发表于</span>
                  <time title="创建时间：2019-06-13 15:00:05" itemprop="dateCreated datePublished" datetime="2019-06-13T15:00:05+08:00">2019-06-13</time>
                </span>
                <span id="/6607.html" class="post-meta-item leancloud_visitors" data-flag-title="代码整洁之道-编写 Pythonic 代码" title="阅读次数">
                  <span class="post-meta-item-icon">
                    <i class="fa fa-eye"></i>
                  </span>
                  <span class="post-meta-item-text">阅读次数：</span>
                  <span class="leancloud-visitors-count"></span>
                </span>
                <span class="post-meta-item" title="本文字数">
                  <span class="post-meta-item-icon">
                    <i class="far fa-file-word"></i>
                  </span>
                  <span class="post-meta-item-text">本文字数：</span>
                  <span>8.6k</span>
                </span>
                <span class="post-meta-item" title="阅读时长">
                  <span class="post-meta-item-icon">
                    <i class="far fa-clock"></i>
                  </span>
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                  <span>8 分钟</span>
                </span>
              </div>
            </article>
            <article itemscope itemtype="http://schema.org/Article" class="post-block index" lang="zh-CN">
              <link itemprop="mainEntityOfPage" href="https://cuiqingcai.com/6598.html">
              <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
                <meta itemprop="image" content="/images/avatar.png">
                <meta itemprop="name" content="崔庆才">
                <meta itemprop="description" content="崔庆才的个人站点，记录生活的瞬间，分享学习的心得。">
              </span>
              <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
                <meta itemprop="name" content="静觅">
              </span>
              <header class="post-header">
                <h2 class="post-title" itemprop="name headline">
                  <a class="label"> Python <i class="label-arrow"></i>
                  </a>
                  <a href="/6598.html" class="post-title-link" itemprop="url">Python3 中使用 Pathlib 模块进行文件操作</a>
                </h2>
              </header>
              <div class="post-body" itemprop="articleBody">
                <div class="thumb">
                  <img itemprop="contentUrl" class="random">
                </div>
                <div class="excerpt">
                  <p>
                  <p>在本教程中，你将了解如何使用 pathlib 模块操作目录和文件的名称。 学习如何读取和写入文件，拼接路径和操作底层文件系统的新方法，以及如何列出文件并迭代它们的一些示例。 大多人处理文件用的最多的还是 os 模快吧，比如下面这样的操作</p>
                  <figure class="highlight ruby">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="meta">&gt;&gt;</span>&gt; path.rsplit(<span class="string">'\\'</span>, maxsplit=<span class="number">1</span>)[<span class="number">0</span>]</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>或者写出下面这样长长的代码</p>
                  <figure class="highlight lua">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">&gt;&gt;&gt; <span class="built_in">os</span>.<span class="built_in">path</span>.isfile(<span class="built_in">os</span>.<span class="built_in">path</span>.join(<span class="built_in">os</span>.<span class="built_in">path</span>.expanduser(<span class="string">'~'</span>), <span class="string">'realpython.txt'</span>))</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>使用 pathlib 模块，可以使代码使用优雅，可读和 Pythonic 代码重写上面的两个示例，如：</p>
                  <figure class="highlight ruby">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="meta">&gt;&gt;</span>&gt; path.parent</span><br><span class="line"><span class="meta">&gt;&gt;</span>&gt; (pathlib.Path.home() / <span class="string">'realpython.txt'</span>).is_file()</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <h3 id="Python-文件路径处理问题"><a href="#Python-文件路径处理问题" class="headerlink" title="Python 文件路径处理问题"></a><strong>Python 文件路径处理问题</strong></h3>
                  <p>由于许多不同的原因，使用文件和与文件系统交互很重要。 最简单的情况可能只涉及读取或写入文件，但有时候会有更复杂的任务。 也许你需要列出给定类型的目录中的所有文件，查找给定文件的父目录，或者创建一个尚不存在的唯一文件名。 一般情况，Python 使用常规文本字符串表示文件路径。 一般在使用 os,glob 和 shutil 等库的时候会使用到路径拼接的操作，使用os模块拼接起来显得略显复杂，以下示例仅需要三个 import 语句来将所有文本文件移动到归档目录：</p>
                  <figure class="highlight haxe">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">import</span> glob</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> shutil</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> file_name <span class="keyword">in</span> glob.glob(<span class="string">'*.txt'</span>):<span class="type"></span></span><br><span class="line"><span class="type">    new_path </span>= os.path.join(<span class="string">'archive'</span>, file_name)</span><br><span class="line">    shutil.move(file_name, <span class="keyword">new</span><span class="type">_path</span>)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>使用常规的字符串去拼接路径是可以的，但是由于不同的操作系统使用的分隔符不同，这样就容易出现问题，所以一般我们使用最多的还是使用 os.path.join()。 Python 3.4 中引入了 pathlib 模块（PEP 428）再一次的优化了路径的拼接。使用 pathlib 库的 Path 方法，可以将一个普通的字符串转换为 pathlib.Path 对象类型的路径。 早期，其他软件包仍然使用字符串作为文件路径，但从 Python 3.6 开始，pathlib 模块在整个标准库中得到支持，部分原因是由于增加了文件系统路径协议。 如果你坚持使用传统的 Python，那么 Python 2 也有一个可用的向后移植。 ok，说了那么多下面让我们看看 pathlib 如何在实践中发挥作用。</p>
                  <h3 id="创建路径"><a href="#创建路径" class="headerlink" title="创建路径"></a><strong>创建路径</strong></h3>
                  <p>这里我们首先要知道两个用法，先看代码:</p>
                  <figure class="highlight pgsql">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">from</span> pathlib <span class="keyword">import</span> <span class="type">Path</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>你真正需要知道的是 pathlib.Path 类。 创建路径有几种不同的方式。 首先，有类方法，如 .cwd（当前工作目录）和 .home（用户的主目录）：</p>
                  <figure class="highlight elm">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="title">from</span> pathlib <span class="keyword">import</span> Path</span><br><span class="line"></span><br><span class="line"><span class="title">now_path</span> = <span class="type">Path</span>.cwd()</span><br><span class="line"><span class="title">home_path</span> = <span class="type">Path</span>.home()</span><br><span class="line"></span><br><span class="line"><span class="title">print</span>(<span class="string">"当前工作目录"</span>,now_path,<span class="keyword">type</span>(now_path))</span><br><span class="line"><span class="title">print</span>(<span class="string">"home目录"</span>,home_path,<span class="keyword">type</span>(home_path))</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>输出内容</p>
                  <figure class="highlight gradle">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">当前工作目录 <span class="regexp">/Users/</span>chennan<span class="regexp">/pythonproject/</span>demo &lt;<span class="keyword">class</span> <span class="string">'pathlib.PosixPath'</span>&gt;</span><br><span class="line">home目录 <span class="regexp">/Users/</span>chennan &lt;<span class="keyword">class</span> <span class="string">'pathlib.PosixPath'</span>&gt;</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>可以发现路径格式为 pathlib.PosixPath 这是在 unix 系统下的显示。在不同的系统上显示的格式也是不一样，在 windows 系统会显示为 WindowsPath。但是不管什么显示类型，都不影响后面的操作。 前面我们提到过可以通过把字符串类型的路径，转换为 Pathlib.Path 类型的路径，经过测试发现在 Python3.4 以后很多模块以及支持该格式的路径。不用转为成字符串使用了。比起 os.path.join 拼接路径的方式, pathlib 使用起来更加的方便,使用示例如下:</p>
                  <figure class="highlight elm">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">import</span> pathlib</span><br><span class="line"><span class="type">DIR_PATH</span> = pathlib.<span class="type">Path</span>(<span class="string">"/Users/chennan/CDM"</span>)</span><br><span class="line"><span class="title">print</span>(<span class="type">DIR_PATH</span>,<span class="keyword">type</span>(<span class="type">DIR_PATH</span>))</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>输出内容:</p>
                  <figure class="highlight ceylon">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">/Users/chennan/CDM &lt;<span class="keyword">class</span> <span class="string">'pathlib.PosixPath'</span>&gt;</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>通过 “/“ 我们就可以对路径进行拼接了，怎么样是不是很方便呢。</p>
                  <h3 id="读文件和写文件"><a href="#读文件和写文件" class="headerlink" title="读文件和写文件"></a><strong>读文件和写文件</strong></h3>
                  <p>在我们使用 open 来操作文件读写操作的时候,不仅可以使用字符串格式的路径，对于 pathlib 生成的路径完全可以直接使用:</p>
                  <figure class="highlight vim">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">path = pathlib.Path.cwd() / <span class="string">'test.md'</span></span><br><span class="line">with <span class="keyword">open</span>(path, <span class="keyword">mode</span>=<span class="string">'r'</span>) <span class="keyword">as</span> fid:</span><br><span class="line">    headers = [<span class="built_in">line</span>.strip() <span class="keyword">for</span> <span class="built_in">line</span> in fid <span class="keyword">if</span> <span class="built_in">line</span>.startswith(<span class="string">'#'</span>)]</span><br><span class="line"><span class="keyword">print</span>(<span class="string">'\n'</span>.<span class="keyword">join</span>(headers))</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>或者在 pathlib 的基础使用 open,我们推荐使用下面的方式</p>
                  <figure class="highlight haskell">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">import</span> pathlib</span><br><span class="line"><span class="type">DIR_PATH</span> = pathlib.<span class="type">Path</span>(<span class="string">"/Users/chennan/CDM"</span>) / <span class="string">"2000"</span> / <span class="string">"hehe.txt"</span></span><br><span class="line"><span class="title">with</span> <span class="type">DIR_PATH</span>.open(<span class="string">"r"</span>) <span class="keyword">as</span> fs:</span><br><span class="line">     <span class="class"><span class="keyword">data</span> = fs.read() </span></span><br><span class="line"><span class="title">print</span>(<span class="class"><span class="keyword">data</span>)</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>这样写的好处就是 open 里面我们不需要再去传入路径了，直接指定文件读写模式即可。实际上这里的 open 方法，底层也是调用了 os.open 的方法。使用哪种方式看个人的喜好。 pathlib 还提供几种文件的读写方式: 可以不用再使用 with open 的形式即可以进行读写。</p>
                  <figure class="highlight reasonml">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">.read<span class="constructor">_text()</span>: 找到对应的路径然后打开文件，读成str格式。等同<span class="keyword">open</span>操作文件的<span class="string">"r"</span>格式。</span><br><span class="line">.read<span class="constructor">_bytes()</span>: 读取字节流的方式。等同<span class="keyword">open</span>操作文件的<span class="string">"rb"</span>格式。</span><br><span class="line">.write<span class="constructor">_text()</span>: 文件的写的操作，等同<span class="keyword">open</span>操作文件的<span class="string">"w"</span>格式。</span><br><span class="line">.write<span class="constructor">_bytes()</span>: 文件的写的操作，等同<span class="keyword">open</span>操作文件的<span class="string">"wb"</span>格式。</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>使用 resolve 可以通过传入文件名，来返回文件的完整路径，使用方式如下</p>
                  <figure class="highlight stylus">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">import pathlib</span><br><span class="line">py_path =pathlib.Path(<span class="string">"superdemo.py"</span>)</span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(py_path.resolve()</span></span>)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>输出</p>
                  <figure class="highlight awk">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="regexp">/Users/</span>chennan<span class="regexp">/pythonproject/</span>demo<span class="regexp">/superdemo.py</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>需要注意的是 “superdemo.py” 文件要和我当前的程序文件在同一级目录。</p>
                  <h3 id="选择路径的不同组成部分"><a href="#选择路径的不同组成部分" class="headerlink" title="选择路径的不同组成部分"></a><strong>选择路径的不同组成部分</strong></h3>
                  <p>pathlib 还提供了很多路径操作的属性，这些属性可以选择路径的不用部位，如 <strong>.name</strong>: 可以获取文件的名字，包含拓展名。 <strong>.parent</strong>: 返回上级文件夹的名字 <strong>.stem</strong>: 获取文件名不包含拓展名 <strong>.suffix</strong>: 获取文件的拓展名 <strong>.anchor</strong>: 类似盘符的一个东西,</p>
                  <figure class="highlight stylus">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">import pathlib</span><br><span class="line"></span><br><span class="line">now_path = pathlib<span class="selector-class">.Path</span>.cwd() / <span class="string">"demo.txt"</span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(<span class="string">"name"</span>,now_path.name)</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(<span class="string">"stem"</span>,now_path.stem)</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(<span class="string">"suffix"</span>,now_path.suffix)</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(<span class="string">"parent"</span>,now_path.parent)</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(<span class="string">"anchor"</span>,now_path.anchor)</span></span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>输出内容如下</p>
                  <figure class="highlight pf">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">name demo.txt</span><br><span class="line">stem demo</span><br><span class="line">suffix .txt</span><br><span class="line">parent /Users/chennan/pythonproject/demo</span><br><span class="line"><span class="built_in">anchor</span> /</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <h3 id="移动和删除文件"><a href="#移动和删除文件" class="headerlink" title="移动和删除文件"></a><strong>移动和删除文件</strong></h3>
                  <p>当然 pathlib 还可以支持文件其他操作，像移动，更新，甚至删除文件，但是使用这些方法的时候要小心因为，使用过程不用有任何的错误提示即使文件不存在也不会出现等待的情况。 使用 replace 方法可以移动文件，如果文件存在则会覆盖。为避免文件可能被覆盖，最简单的方法是在替换之前测试目标是否存在。</p>
                  <figure class="highlight pgsql">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">import</span> pathlib</span><br><span class="line"></span><br><span class="line">destination = pathlib.Path.cwd() / "target" </span><br><span class="line">source = pathlib.Path.cwd() / "demo.txt"</span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> destination.<span class="keyword">exists</span>():</span><br><span class="line">    source.replace(destination)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>但是上面的方法存在问题就是，在多个进程多 destination 进行的操作的时候就会现问题，可以使用下面的方法避免这个问题。也就是说上面的方法适合单个文件的操作。</p>
                  <figure class="highlight reasonml">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">import pathlib</span><br><span class="line"></span><br><span class="line">destination = pathlib.<span class="module-access"><span class="module"><span class="identifier">Path</span>.</span></span>cwd<span class="literal">()</span><span class="operator"> / </span><span class="string">"target"</span> </span><br><span class="line">source = pathlib.<span class="module-access"><span class="module"><span class="identifier">Path</span>.</span></span>cwd<span class="literal">()</span><span class="operator"> / </span><span class="string">"demo.txt"</span></span><br><span class="line"><span class="keyword">with</span> destination.<span class="keyword">open</span>(mode='xb') <span class="keyword">as</span> fid: </span><br><span class="line">    #xb表示文件不存在才操作</span><br><span class="line">    fid.write(source.read<span class="constructor">_bytes()</span>)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>当 destination文件存在的时候上面的代码就会出现 FileExistsError 异常。 从技术上讲，这会复制一个文件。 要执行移动，只需在复制完成后删除源即可。 使用 with_name 和 with.shuffix 可以修改文件名字或者后缀。</p>
                  <figure class="highlight reasonml">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">import pathlib</span><br><span class="line">source = pathlib.<span class="module-access"><span class="module"><span class="identifier">Path</span>.</span></span>cwd<span class="literal">()</span><span class="operator"> / </span><span class="string">"demo.py"</span></span><br><span class="line">source.replace(source.<span class="keyword">with</span><span class="constructor">_suffix(<span class="string">".txt"</span>)</span>) #修改后缀并移动文件，即重命名</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>可以使用 .rmdir() 和 .unlink() 来删除文件。</p>
                  <figure class="highlight reasonml">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">import pathlib</span><br><span class="line"></span><br><span class="line">destination = pathlib.<span class="module-access"><span class="module"><span class="identifier">Path</span>.</span></span>cwd<span class="literal">()</span><span class="operator"> / </span><span class="string">"target"</span> </span><br><span class="line">source = pathlib.<span class="module-access"><span class="module"><span class="identifier">Path</span>.</span></span>cwd<span class="literal">()</span><span class="operator"> / </span><span class="string">"demo.txt"</span></span><br><span class="line">source.unlink<span class="literal">()</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <h3 id="几个-pathlib-的使用例子"><a href="#几个-pathlib-的使用例子" class="headerlink" title="几个 pathlib 的使用例子"></a><strong>几个 pathlib 的使用例子</strong></h3>
                  <h3 id="统计文件个数"><a href="#统计文件个数" class="headerlink" title="统计文件个数"></a><strong>统计文件个数</strong></h3>
                  <p>我们可以使用.iterdir方法获取当前文件下的所以文件.</p>
                  <figure class="highlight stylus">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">import pathlib</span><br><span class="line">from collections import Counter</span><br><span class="line">now_path = pathlib<span class="selector-class">.Path</span>.cwd()</span><br><span class="line">gen = (<span class="selector-tag">i</span><span class="selector-class">.suffix</span> <span class="keyword">for</span> <span class="selector-tag">i</span> <span class="keyword">in</span> now_path.iterdir())</span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(Counter(gen)</span></span>)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>输出内容</p>
                  <figure class="highlight stylus">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="function"><span class="title">Counter</span><span class="params">(&#123;<span class="string">'.py'</span>: <span class="number">16</span>, <span class="string">''</span>: <span class="number">11</span>, <span class="string">'.txt'</span>: <span class="number">1</span>, <span class="string">'.png'</span>: <span class="number">1</span>, <span class="string">'.csv'</span>: <span class="number">1</span>&#125;)</span></span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>通过配合使用 collections 模块的 Counter 方法，我们获取了当文件夹下文件类型情况。 前面我们说过 glob 模块点这里了解【<a href="https://link.zhihu.com/?target=https%3A//www.cnblogs.com/c-x-a/p/9261832.html">https://www.cnblogs.com/c-x-a/p/9261832.html</a>】，同样的 pathlib 也有 glob 方法和 rglob 方法，不同的是 glob 模块里的 glob 方法结果是列表形式的，iglob 是生成器类型，在这里 pathlib 的 glob 模块返回的是生成器类型，然后 pathlib 还有一个支持递归操作的 rglob 方法。 下面的这个操作我通过使用 glob 方法，设定规则进行文件的匹配。</p>
                  <figure class="highlight lisp">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">import pathlib</span><br><span class="line">from  collections import Counter</span><br><span class="line">gen =(<span class="name">p</span>.suffix for p in pathlib.Path.cwd().glob('*.py'))</span><br><span class="line">print(<span class="name">Counter</span>(<span class="name">gen</span>))</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <h3 id="展示目录树"><a href="#展示目录树" class="headerlink" title="展示目录树"></a><strong>展示目录树</strong></h3>
                  <p>下一个示例定义了一个函数 tree()，该函数的作用是打印一个表示文件层次结构的可视树，该树以一个给定目录为根。因为想列出其子目录，所以我们要使用 .rglob() 方法：</p>
                  <figure class="highlight python">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">import</span> pathlib</span><br><span class="line"><span class="keyword">from</span>  collections <span class="keyword">import</span> Counter</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">tree</span><span class="params">(directory)</span>:</span></span><br><span class="line">    print(<span class="string">f'+ <span class="subst">&#123;directory&#125;</span>'</span>)</span><br><span class="line">    <span class="keyword">for</span> path <span class="keyword">in</span> sorted(directory.rglob(<span class="string">'*'</span>)):</span><br><span class="line">        depth = len(path.relative_to(directory).parts)</span><br><span class="line">        spacer = <span class="string">'    '</span> * depth</span><br><span class="line">        print(<span class="string">f'<span class="subst">&#123;spacer&#125;</span>+ <span class="subst">&#123;path.name&#125;</span>'</span>)</span><br><span class="line"></span><br><span class="line">now_path = pathlib.Path.cwd()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    tree(now_path)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>其中 relative_to 的方法的作用是返回 path 相对于 directory 的路径。 parts 方法可以返回路径的各部分。例如</p>
                  <figure class="highlight coffeescript">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">import</span> pathlib</span><br><span class="line">now_path = pathlib.Path.cwd()</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    <span class="built_in">print</span>(now_path.parts)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>返回</p>
                  <figure class="highlight scheme">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">(<span class="symbol">'/</span>', <span class="symbol">'Users</span>', <span class="symbol">'chennan</span>', <span class="symbol">'pythonproject</span>', <span class="symbol">'demo</span>')</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <h3 id="获取文件最后一次修改时间"><a href="#获取文件最后一次修改时间" class="headerlink" title="获取文件最后一次修改时间"></a><strong>获取文件最后一次修改时间</strong></h3>
                  <p>iterdir(),.glob()和.rglob()方法非常适合于生成器表达式和列表理解。 使用stat()方法可以获取文件的一些基本信息，使用.stat().st_mtime可以获取文件最后一次修改的信息</p>
                  <figure class="highlight pgsql">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">import</span> pathlib</span><br><span class="line">now_path = pathlib.Path.cwd()</span><br><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line"><span class="type">time</span>, file_path = max((f.stat().st_mtime, f) <span class="keyword">for</span> f <span class="keyword">in</span> now_path.iterdir())</span><br><span class="line">print(datetime.fromtimestamp(<span class="type">time</span>), file_path)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>甚至可以使用类似的表达式获取上次修改的文件内容</p>
                  <figure class="highlight swift">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">import</span> pathlib</span><br><span class="line">from datetime <span class="keyword">import</span> datetime</span><br><span class="line">now_path =pathlib.<span class="type">Path</span>.cwd()</span><br><span class="line">result = <span class="built_in">max</span>((f.stat().st_mtime, f) <span class="keyword">for</span> f <span class="keyword">in</span> now_path.iterdir())[<span class="number">1</span>]</span><br><span class="line"><span class="built_in">print</span>(result.read_text())</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>.stat().st_mtime 会返回文件的时间戳，可以使用 datetime 或者 time 模块对时间格式进行进一步转换。</p>
                  <h3 id="其他内容"><a href="#其他内容" class="headerlink" title="其他内容"></a><strong>其他内容</strong></h3>
                  <h3 id="关于-pathlib-Path-格式路径转换为字符串类型"><a href="#关于-pathlib-Path-格式路径转换为字符串类型" class="headerlink" title="关于 pathlib.Path 格式路径转换为字符串类型"></a><strong>关于 pathlib.Path 格式路径转换为字符串类型</strong></h3>
                  <p>因为通过 pathlib 模块操作生成的路径，不能直接应用字符串的一些操作，所以需要转换成字符串，虽然可以使用 str() 函数进行转换，但是安全性不高，建议使用 os.fspath() 方法，因为如果路径格式非法的，可以抛出一个异常。str()就不能做到这一点。</p>
                  <h3 id="拼接符号”-“背后的秘密"><a href="#拼接符号”-“背后的秘密" class="headerlink" title="拼接符号”/“背后的秘密"></a><strong>拼接符号”/“背后的秘密</strong></h3>
                  <p>/ 运算符由 <strong>truediv</strong> 方法定义。 实际上，如果你看一下 pathlib 的源代码，你会看到类似的东西。</p>
                  <figure class="highlight ruby">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">PurePath</span>(<span class="title">object</span>):</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__truediv__</span><span class="params">(<span class="keyword">self</span>, key)</span></span><span class="symbol">:</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">self</span>._make_child((key,))</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <h3 id="后记"><a href="#后记" class="headerlink" title="后记"></a><strong>后记</strong></h3>
                  <p>从 Python 3.4 开始，pathlib 已在标准库中提供。 使用 pathlib，文件路径可以由适当的 Path 对象表示，而不是像以前一样用纯字符串表示。 这些对象使代码处理文件路径：</p>
                  <ul>
                    <li>更容易阅读，特别是可以使用“/”将路径连接在一起</li>
                    <li>更强大，直接在对象上提供最必要的方法和属性</li>
                    <li>在操作系统中更加一致，因为Path对象隐藏了不同系统的特性</li>
                  </ul>
                  <p>在本教程中，你已经了解了如何创建 Path 对象、读取和写入文件、操作路径和底层文件系统，以及如何遍历多个文件路径等一系列实例。 最后，建议下去自己多加练习，我对文章中的代码都进行了验证，不会出现运行错误的情况。 ————————————————————————————————————————————— 原文: <a href="https://realpython.com/python-pathlib/" target="_blank" rel="noopener">https://realpython.com/python-pathlib/</a> 译者: 陈祥安 [gallery ids=”6600”] 更多精彩内容，请关注微信公众号: python学习开发。</p>
                  </p>
                </div>
              </div>
              <div class="post-meta">
                <span class="post-meta-item">
                  <span class="post-meta-item-icon">
                    <i class="far fa-user"></i>
                  </span>
                  <span class="post-meta-item-text">作者</span>
                  <span><a href="/authors/陈祥安" class="author" itemprop="url" rel="index">陈祥安</a></span>
                </span>
                <span class="post-meta-item">
                  <span class="post-meta-item-icon">
                    <i class="far fa-calendar"></i>
                  </span>
                  <span class="post-meta-item-text">发表于</span>
                  <time title="创建时间：2019-06-13 14:48:34" itemprop="dateCreated datePublished" datetime="2019-06-13T14:48:34+08:00">2019-06-13</time>
                </span>
                <span id="/6598.html" class="post-meta-item leancloud_visitors" data-flag-title="Python3 中使用 Pathlib 模块进行文件操作" title="阅读次数">
                  <span class="post-meta-item-icon">
                    <i class="fa fa-eye"></i>
                  </span>
                  <span class="post-meta-item-text">阅读次数：</span>
                  <span class="leancloud-visitors-count"></span>
                </span>
                <span class="post-meta-item" title="本文字数">
                  <span class="post-meta-item-icon">
                    <i class="far fa-file-word"></i>
                  </span>
                  <span class="post-meta-item-text">本文字数：</span>
                  <span>6.6k</span>
                </span>
                <span class="post-meta-item" title="阅读时长">
                  <span class="post-meta-item-icon">
                    <i class="far fa-clock"></i>
                  </span>
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                  <span>6 分钟</span>
                </span>
              </div>
            </article>
            <article itemscope itemtype="http://schema.org/Article" class="post-block index" lang="zh-CN">
              <link itemprop="mainEntityOfPage" href="https://cuiqingcai.com/6533.html">
              <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
                <meta itemprop="image" content="/images/avatar.png">
                <meta itemprop="name" content="崔庆才">
                <meta itemprop="description" content="崔庆才的个人站点，记录生活的瞬间，分享学习的心得。">
              </span>
              <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
                <meta itemprop="name" content="静觅">
              </span>
              <header class="post-header">
                <h2 class="post-title" itemprop="name headline">
                  <a class="label"> JavaScript <i class="label-arrow"></i>
                  </a>
                  <a href="/6533.html" class="post-title-link" itemprop="url">中英文排版空格问题解决方案</a>
                </h2>
              </header>
              <div class="post-body" itemprop="articleBody">
                <div class="thumb">
                  <img itemprop="contentUrl" class="random">
                </div>
                <div class="excerpt">
                  <p>
                  <p>想写这篇文章很久了，也想做这件事很久了，我个人感觉自己是有强迫症的，所以一直有什么事让我看着不太舒服就想把它纠正过来。 文字，也不例外。 现在大家看各种新闻啊、文章啊，几乎每篇文章都会有点数字和英文的吧，比如就拿 Python 来说，看下面两句话：</p>
                  <ul>
                    <li>卧槽Python真牛逼啊排名第1了。</li>
                    <li>卧槽 Python 真牛逼啊排名第 1 了。</li>
                  </ul>
                  <p>Python 是不是第一先不说，就看看上面两句话的排版，哪个看起来更舒服？说实话我是真觉得第一句话太别扭了。因为我们大部分的文本编辑器和浏览器是没有对中文和外文的混排做排版优化的，所以如果写的时候如果二者之间不加个空格，二者就会紧紧贴在一起，然后就变成了上面第一句的样子。 当然如果你觉得第一句的排版更好看，好吧，那么本文后面的内容其实可以不必看了。OK，如果你觉得第二个好看，那不妨接着看下去哈。</p>
                  <h2 id="出发点"><a href="#出发点" class="headerlink" title="出发点"></a>出发点</h2>
                  <p>首先有一点需要明确的是，中英文排版的美学是在于 Readability，易读性。而为了易读性，中英文之间是需要留有”间距”的，注意这里是间距，不是说的”空格”。”空格”会造成间距，但是间距不一定非得需要”空格”。 好，所以，其实我们只需要留有适当的间距，就会显得美观易读，这个间距大约是一个半角空格的距离。 好明确了这一点，我们只要能留有间距，不一定非得加空格。 现在很多专业的排版软件，比如 Adobe InDesign、Microsoft Word 对中英文混排支持非常好，他们会有这么一个功能：可以设置中文西文之间留适当的间距。 所以，如果如果我们使用了这些软件，本身就可以做到 Readability，这就够了。 但是，为什么还会说空格的问题呢？这是因为现在绝大多数软件，不管是文本编辑器还是网页，都没有这个机制。 几乎所有的文本编辑器和浏览器中，只要我们中文和英文连续输入，它们之间是不会出现间距的，就像文章开头所示的样例中的第一句话，显得很别扭。但比如 Adobe InDesign、Microsoft Word、IE 浏览器会有这方面的支持。 所以，怎么解决？手动加空格。 因此，总结下：</p>
                  <ul>
                    <li>间距要有，但不一定是空格。</li>
                    <li>部分软件能自动呈现间距，那就不必加空格。</li>
                    <li>绝大多数软件不能自动呈现间距，那就需要手动加空格。</li>
                  </ul>
                  <p>所以，作为强迫症的我，一定是会为了这个间距而去敲下一个空格的。 <strong>「有研究显示，打字的时候不喜欢在中文和英文之间加空格的人，感情路都走得很辛苦，有七成的比例会在 34 岁的时候跟自己不爱的人结婚，而其余三成的人最后只能把遗产留给自己的猫。毕竟爱情跟书写都需要适时地留白。与大家共勉之。」</strong> <img src="https://qiniu.cuiqingcai.com/2019-05-07-165210.jpg" alt="盘古之白"> 所以，求求你加个空格吧（逃。</p>
                  <h2 id="规范"><a href="#规范" class="headerlink" title="规范"></a>规范</h2>
                  <p>好，下面就说到规范的问题了，到底什么时候应该加空格什么时候不加，这也是有讲究的。下面的内容摘自 GitHub 上的一个中英文混排规范，网址为：<a href="https://github.com/mzlogin/chinese-copywriting-guidelines" target="_blank" rel="noopener">https://github.com/mzlogin/chinese-copywriting-guidelines</a>，下面转述一下。</p>
                  <h3 id="1-中英文之间需要增加空格"><a href="#1-中英文之间需要增加空格" class="headerlink" title="1. 中英文之间需要增加空格"></a>1. 中英文之间需要增加空格</h3>
                  <p>中英文之间是需要添加空格的，不论是普通英文还是引用的英文，下面给个示例： 正确：</p>
                  <ul>
                    <li>在 LeanCloud 上，数据存储是围绕 <code>AVObject</code> 进行的。</li>
                  </ul>
                  <p>错误：</p>
                  <ul>
                    <li>在LeanCloud上，数据存储是围绕<code>AVObject</code>进行的。</li>
                    <li>在 LeanCloud上，数据存储是围绕<code>AVObject</code> 进行的。</li>
                  </ul>
                  <p>完整的正确用法：</p>
                  <ul>
                    <li>在 LeanCloud 上，数据存储是围绕 <code>AVObject</code> 进行的。每个 <code>AVObject</code> 都包含了与 JSON 兼容的 key-value 对应的数据。数据是 schema-free 的，你不需要在每个 <code>AVObject</code> 上提前指定存在哪些键，只要直接设定对应的 key-value 即可。</li>
                  </ul>
                  <p>但有例外，比如「豆瓣FM」等产品名词，按照官方所定义的格式书写。 再比如，我的公众号为「进击的Coder」，那么这里面就不要加空格，按照其本身的形式书写即可。</p>
                  <h3 id="中文与数字之间需要增加空格"><a href="#中文与数字之间需要增加空格" class="headerlink" title="中文与数字之间需要增加空格"></a>中文与数字之间需要增加空格</h3>
                  <p>中文和数字之间也是需要的，下面给个示例： 正确：</p>
                  <ul>
                    <li>今天出去买菜花了 5000 元。</li>
                  </ul>
                  <p>错误：</p>
                  <ul>
                    <li>今天出去买菜花了 5000元。</li>
                    <li>今天出去买菜花了5000元。</li>
                  </ul>
                  <h3 id="数字与单位之间无需增加空格"><a href="#数字与单位之间无需增加空格" class="headerlink" title="数字与单位之间无需增加空格"></a>数字与单位之间无需增加空格</h3>
                  <p>但是数字和单位之间不需要再加额外的空格了，下面给个 正确：</p>
                  <ul>
                    <li>我家的光纤入户宽带有 10Gbps，SSD 一共有 10TB。</li>
                  </ul>
                  <p>错误：</p>
                  <ul>
                    <li>我家的光纤入户宽带有 10 Gbps，SSD 一共有 20 TB。</li>
                  </ul>
                  <p>另外，度／百分比与数字之间不需要增加空格： 正确：</p>
                  <ul>
                    <li>今天是 233° 的高温。</li>
                    <li>新 MacBook Pro 有 15% 的 CPU 性能提升。</li>
                  </ul>
                  <p>错误：</p>
                  <ul>
                    <li>今天是 233 ° 的高温。</li>
                    <li>新 MacBook Pro 有 15 % 的 CPU 性能提升。</li>
                  </ul>
                  <h3 id="全角标点与其他字符之间不加空格"><a href="#全角标点与其他字符之间不加空格" class="headerlink" title="全角标点与其他字符之间不加空格"></a>全角标点与其他字符之间不加空格</h3>
                  <p>标点是分全角和半角的，全角标点一般是在中文状态下输出来的，比如 <code>，</code>、<code>。</code>、<code>！</code>，半角标点一般是在英文状态下输出来的，比如 <code>,</code>、<code>.</code>、<code>!</code>，两个看起来不一样吧？所以，如果是中文标点，即全角标点，那不需要加空格。 正确：</p>
                  <ul>
                    <li>刚刚买了一部 iPhone，好开心！</li>
                  </ul>
                  <p>错误：</p>
                  <ul>
                    <li>刚刚买了一部 iPhone ，好开心！</li>
                  </ul>
                  <p>嗯，基本就是以上的几个规范，只要明白了这些规范，中英文混排就 OK 了！</p>
                  <h2 id="网页"><a href="#网页" class="headerlink" title="网页"></a>网页</h2>
                  <p>有人说，我就是不想打空格，在网页中，我能像 Microsoft Word 一样不打空格而直接显示间距吗？ 也就是说，我能不能设置一个 CSS 样式，就能使得中英文之间自动留有间距呢？ 其实，只有 IE 有这样的支持。这个 CSS 样式叫做 <code>\-ms-text-autospace</code> ，可以在这里了解下：<a href="https://msdn.microsoft.com/library/ms531164(v=vs.85" target="_blank" rel="noopener">https://msdn.microsoft.com/library/ms531164(v=vs.85).aspx</a>.aspx)。 但是很遗憾的是，几乎所有其他的浏览器都不支持这个，Chrome、Firefox 统统都不支持这个特性。放弃吧。 <img src="https://qiniu.cuiqingcai.com/2019-05-07-165207.png" alt="image-20190507220822252"> 这里提供一些手动的解决方案，比如使用 JavaScript 添加标记，然后 CSS 控制标记的间距，解决方案可以参考：<a href="http://mastermay.github.io/text-autospace.js/" target="_blank" rel="noopener">http://mastermay.github.io/text-autospace.js/</a>。</p>
                  <h2 id="编辑器"><a href="#编辑器" class="headerlink" title="编辑器"></a>编辑器</h2>
                  <p>那么有编辑器支持这个吗？有，Microsoft Word，用它我们不用加空格，会自动给我们加好间距。 有人说，我平时不想用 Word，我就想用 Markdown，有编辑器吗？有，叫做 MarkEditor，它的 2.0 Pro 版本可以在打字的时候自动给我们添加空格。注意，这里是自动添加空格，不是自动留间距，是用空格的方式实现了间距。但是这个只能在你一个个打字的时候自动添加空格，如果把一个不带空格的话粘贴进去是不行的。另外 MarkEditor 解锁这个功能需要付费，所以我个人感觉其实不太划算的。 所以，平时还是自己手动加空格吧，经济实惠方便。 其他的编辑器如有好用的欢迎大家推荐哈。</p>
                  <h2 id="类库"><a href="#类库" class="headerlink" title="类库"></a>类库</h2>
                  <p>好吧，看到现在，你是不是现在都想把自己的中英文笔记加上空格了？难道要手调吗？不需要。 有现成的工具了，名字叫做 pangu，它支持各种语言，另外还有浏览器插件可以用，列表如下：</p>
                  <h3 id="浏览器插件"><a href="#浏览器插件" class="headerlink" title="浏览器插件"></a>浏览器插件</h3>
                  <ul>
                    <li><a href="https://chrome.google.com/webstore/detail/paphcfdffjnbcgkokihcdjliihicmbpd" target="_blank" rel="noopener">Google Chrome</a></li>
                    <li><a href="https://github.com/vinta/pangu.js/blob/master/browser_extensions/firefox/paranoid-auto-spacing.user.js" target="_blank" rel="noopener">Mozilla Firefox</a></li>
                  </ul>
                  <h3 id="开发工具包"><a href="#开发工具包" class="headerlink" title="开发工具包"></a>开发工具包</h3>
                  <ul>
                    <li>Official supports:<ul>
                        <li><a href="https://github.com/vinta/pangu" target="_blank" rel="noopener">pangu.go</a> (Go)</li>
                        <li><a href="https://github.com/vinta/pangu.java" target="_blank" rel="noopener">pangu.java</a> (Java)</li>
                        <li><a href="https://github.com/vinta/pangu.js" target="_blank" rel="noopener">pangu.js</a> (JavaScript)</li>
                        <li><a href="https://github.com/vinta/pangu.py" target="_blank" rel="noopener">pangu.py</a> (Python)</li>
                        <li><a href="https://github.com/vinta/pangu.space" target="_blank" rel="noopener">pangu.space</a> (Web API)</li>
                      </ul>
                    </li>
                    <li>Community supports:<ul>
                        <li><a href="https://github.com/coldnew/pangu.clj" target="_blank" rel="noopener">pangu.clj</a> (Clojure)</li>
                        <li><a href="https://github.com/SemonCat/pangu.dart" target="_blank" rel="noopener">pangu.dart</a> (Dart)</li>
                        <li><a href="https://github.com/cataska/pangu.ex" target="_blank" rel="noopener">pangu.ex</a> (Elixir)</li>
                        <li><a href="https://github.com/Cee/pangu.objective-c" target="_blank" rel="noopener">pangu.objective-c</a> (Objective-C)</li>
                        <li><a href="https://github.com/Kunr/pangu.php" target="_blank" rel="noopener">pangu.php</a> (PHP)</li>
                        <li><a href="https://github.com/dlackty/pangu.rb" target="_blank" rel="noopener">pangu.rb</a> (Ruby)</li>
                        <li><a href="https://github.com/airt/pangu.rs" target="_blank" rel="noopener">pangu.rs</a> (Rust)</li>
                        <li><a href="https://github.com/X140Yu/pangu.Swift" target="_blank" rel="noopener">pangu.swift</a> (Swift)</li>
                      </ul>
                    </li>
                  </ul>
                  <p>比如 Python 的话，就可以使用 pangu.py 这个包，GitHub 地址为：<a href="https://github.com/vinta/pangu.py，安装方式如下" target="_blank" rel="noopener">https://github.com/vinta/pangu.py，安装方式如下</a>：</p>
                  <figure class="highlight cmake">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">pip3 <span class="keyword">install</span> -U pangu</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>这么用就好了：</p>
                  <figure class="highlight stylus">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">import pangu</span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(pangu.spacing_text(<span class="string">'當你凝視著bug，bug也凝視著你'</span>)</span></span>)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>运行结果如下：</p>
                  <figure class="highlight armasm">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">當你凝視著 <span class="keyword">bug，bug </span>也凝視著你</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>嗯，它自动给我们添加好了空格，非常不错。 不过这有点费劲，有简单一点的工具吗？ 有，我为此专门做了一个网页，功能很简单。 在左侧输入源文本，右侧就会显示添加空格之后的文本，页面如下： <img src="https://qiniu.cuiqingcai.com/2019-05-07-165203.png" alt="image-20190507222427295"> 这个是我用 Vue.js 开发的，实际上就是用了 pangu.js 这个库实现的，原理非常简单，主要目的就是为了方便空格排版。 另外这个网站我也部署了一下，叫做：<a href="http://space.cuiqingcai.com/" target="_blank" rel="noopener">http://space.cuiqingcai.com/</a>，大家以后也可以直接访问使用，以后我有想调整的文本，直接就用它了。 如果大家想获取源码，可以在公众号「进击的Coder」回复”空格”。 希望对大家有所帮助。 最后，为了世界的美好与和平，加个空格吧！</p>
                  </p>
                </div>
              </div>
              <div class="post-meta">
                <span class="post-meta-item">
                  <span class="post-meta-item-icon">
                    <i class="far fa-user"></i>
                  </span>
                  <span class="post-meta-item-text">作者</span>
                  <span><a href="/authors/崔庆才" class="author" itemprop="url" rel="index">崔庆才</a></span>
                </span>
                <span class="post-meta-item">
                  <span class="post-meta-item-icon">
                    <i class="far fa-calendar"></i>
                  </span>
                  <span class="post-meta-item-text">发表于</span>
                  <time title="创建时间：2019-05-08 00:53:14" itemprop="dateCreated datePublished" datetime="2019-05-08T00:53:14+08:00">2019-05-08</time>
                </span>
                <span id="/6533.html" class="post-meta-item leancloud_visitors" data-flag-title="中英文排版空格问题解决方案" title="阅读次数">
                  <span class="post-meta-item-icon">
                    <i class="fa fa-eye"></i>
                  </span>
                  <span class="post-meta-item-text">阅读次数：</span>
                  <span class="leancloud-visitors-count"></span>
                </span>
                <span class="post-meta-item" title="本文字数">
                  <span class="post-meta-item-icon">
                    <i class="far fa-file-word"></i>
                  </span>
                  <span class="post-meta-item-text">本文字数：</span>
                  <span>3.5k</span>
                </span>
                <span class="post-meta-item" title="阅读时长">
                  <span class="post-meta-item-icon">
                    <i class="far fa-clock"></i>
                  </span>
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                  <span>3 分钟</span>
                </span>
              </div>
            </article>
            <article itemscope itemtype="http://schema.org/Article" class="post-block index" lang="zh-CN">
              <link itemprop="mainEntityOfPage" href="https://cuiqingcai.com/6519.html">
              <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
                <meta itemprop="image" content="/images/avatar.png">
                <meta itemprop="name" content="崔庆才">
                <meta itemprop="description" content="崔庆才的个人站点，记录生活的瞬间，分享学习的心得。">
              </span>
              <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
                <meta itemprop="name" content="静觅">
              </span>
              <header class="post-header">
                <h2 class="post-title" itemprop="name headline">
                  <a class="label"> Python <i class="label-arrow"></i>
                  </a>
                  <a href="/6519.html" class="post-title-link" itemprop="url">Python 中拼音库 PyPinyin 的用法</a>
                </h2>
              </header>
              <div class="post-body" itemprop="articleBody">
                <div class="thumb">
                  <img itemprop="contentUrl" class="random">
                </div>
                <div class="excerpt">
                  <p>
                  <p>最近碰到了一个问题，项目中很多文件都是接手过来的中文命名的一些素材，结果在部署的时候文件名全都乱码了，导致项目无法正常运行。 后来请教了一位大佬怎么解决文件名乱码的问题，他说这个需要正面解决吗？不需要，把文件名全部改掉，文件名永远不要用中文，永远不要。 我想他这么说的话，一定也是凭经验得出来的。 这里也友情提示大家，项目里面文件永远不要用中文，永远不要！ 好，那不用中文用啥？平时来看，一般我们都会用英文来命名，一般也不会出现中文，比如 resource, controller, result, view, spider 等等，所以绝大多数情况下，是不会出现什么问题的。但是也有个别的情况，比如一些素材、资源文件可能的中文命名的，那么这时候该咋办呢？ 首先像，因为是中文资源文件，我们要改成非中文命名的，无非两种，一种是英文，一种是拼音。 如果改英文，当然可以翻译、我们想翻译的话，逐个人工翻译成本太高，机器翻译的话，翻译完可能有些文不对题了，而且我们自己也不知道一些奇怪的资源英语应该叫什么，所以到时候真的找起来都找不到了。 所以第二种解决方案，那就是拼音了。中文转拼音，很自然，而且一个字就对应一串拼音，而且也非常容易从拼音看懂是什么意思，所以这确实是一个不错的方案。 那么问题就来了，怎样把一批中文文件转拼音命名呢？下面就让我们来了解 Python 的一个库 PyPinyin 吧！</p>
                  <h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2>
                  <p>Python 中提供了汉字转拼音的库，名字叫做 PyPinyin，可以用于汉字注音、排序、检索等等场合，是基于 hotto/pinyin 这个库开发的，一些站点链接如下：</p>
                  <ul>
                    <li>GitHub: <a href="https://github.com/mozillazg/python-pinyin" target="_blank" rel="noopener">https://github.com/mozillazg/python-pinyin</a></li>
                    <li>文档：<a href="https://pypinyin.readthedocs.io/zh_CN/master/" target="_blank" rel="noopener">https://pypinyin.readthedocs.io/zh_CN/master/</a></li>
                    <li>PyPi：<a href="https://pypi.org/project/pypinyin/" target="_blank" rel="noopener">https://pypi.org/project/pypinyin/</a></li>
                  </ul>
                  <p>它有这么几个特性：</p>
                  <ul>
                    <li>根据词组智能匹配最正确的拼音。</li>
                    <li>支持多音字。</li>
                    <li>简单的繁体支持, 注音支持。</li>
                    <li>支持多种不同拼音/注音风格。</li>
                  </ul>
                  <p>是不是等不及了呢？那就让我们来了解一下它的用法吧！</p>
                  <h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2>
                  <p>首先就是这个库的安装了，通过 pip 安装即可：</p>
                  <figure class="highlight cmake">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">pip3 <span class="keyword">install</span> pypinyin</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>安装完成之后导入一下这个库，如果不报错，那就说明安装成功了。</p>
                  <figure class="highlight elm">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">\&gt;&gt;&gt; <span class="keyword">import</span> pypinyin</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>好，接下来我们看下它的具体功能。</p>
                  <h2 id="基本拼音"><a href="#基本拼音" class="headerlink" title="基本拼音"></a>基本拼音</h2>
                  <p>首先我们进行一下基本的拼音转换，方法非常简单，直接调用 pinyin 方法即可：</p>
                  <figure class="highlight coffeescript">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">from</span> pypinyin <span class="keyword">import</span> pinyin</span><br><span class="line"><span class="built_in">print</span>(pinyin(<span class="string">'中心'</span>))</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>运行结果：</p>
                  <figure class="highlight json">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">[['zhōng'], ['xīn']]</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>可以看到结果会是一个二维的列表，每个元素都另外成了一个列表，其中包含了每个字的读音。 那么如果这个词是多音字咋办呢？比如 “朝阳”，它有两个读音，我们拿来试下：</p>
                  <figure class="highlight coffeescript">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">from</span> pypinyin <span class="keyword">import</span> pinyin</span><br><span class="line"><span class="built_in">print</span>(pinyin(<span class="string">'朝阳'</span>))</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>运行结果：</p>
                  <figure class="highlight json">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">[['zhāo'], ['yáng']]</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>好吧，它只给出来了一个读音，但是如果我们想要另外一种读音咋办呢？ 其实很简单，只需添加 heteronym 参数并设置为 True 就好了，我们试下：</p>
                  <figure class="highlight routeros">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">from</span> pypinyin import pinyin</span><br><span class="line"><span class="builtin-name">print</span>(pinyin(<span class="string">'朝阳'</span>, <span class="attribute">heteronym</span>=<span class="literal">True</span>))</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>运行结果：</p>
                  <figure class="highlight scheme">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">[[<span class="symbol">'zhāo</span>', <span class="symbol">'cháo</span>'], [<span class="symbol">'yáng</span>']]</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>OK 了，这下子就显示出来了两个读音了，而且我们也明白了结果为什么是一个二维列表，因为里面的一维的结果可能是多个，比如多音字的情况就是这样。 但这个多少解析起来有点麻烦，很多情况下我们是不需要管多音字的，我们只是用它来转换一下名字而已，而处理上面的二维数组又比较麻烦。 所以有没有一个方法直接给我们一个一维列表呢？有！ 我们可以使用 lazy_pinyin 这个方法来生成，尝试一下：</p>
                  <figure class="highlight coffeescript">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">from</span> pypinyin <span class="keyword">import</span> lazy_pinyin</span><br><span class="line"><span class="built_in">print</span>(lazy_pinyin(<span class="string">'聪明的小兔子'</span>))</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>运行结果：</p>
                  <figure class="highlight scheme">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">[<span class="symbol">'cong</span>', <span class="symbol">'ming</span>', <span class="symbol">'de</span>', <span class="symbol">'xiao</span>', <span class="symbol">'tu</span>', <span class="symbol">'zi</span>']</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>这时候观察到得到的是一个列表，并且不再包含音调了。 这里我们就有一个疑问了，为啥 pinyin 方法返回的结果默认是带音调的，而 lazy_pinyin 是不带的，这里面就涉及到一个风格转换的问题了。</p>
                  <h2 id="风格转换"><a href="#风格转换" class="headerlink" title="风格转换"></a>风格转换</h2>
                  <p>我们可以对结果进行一些风格转换，比如不带声调风格、标准声调风格、声调在拼音之后、声调在韵母之后、注音风格等等，比如我们想要声调放在拼音后面，可以这么来实现：</p>
                  <figure class="highlight routeros">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">from</span> pypinyin import lazy_pinyin, Style</span><br><span class="line"></span><br><span class="line">style = Style.TONE3</span><br><span class="line"><span class="builtin-name">print</span>(lazy_pinyin(<span class="string">'聪明的小兔子'</span>, <span class="attribute">style</span>=style))</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>运行结果：</p>
                  <figure class="highlight scheme">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">[<span class="symbol">'cong1</span>', <span class="symbol">'ming2</span>', <span class="symbol">'de</span>', <span class="symbol">'xiao3</span>', <span class="symbol">'tu4</span>', <span class="symbol">'zi</span>']</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>可以看到运行结果每个拼音后面就多了一个声调，这就是其中的一个风格，叫做 TONE3，其实还有很多风格，下面是我从源码里面找出来的定义：</p>
                  <figure class="highlight ini">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="comment">#: 普通风格，不带声调。如： 中国 -&gt; ``zhong guo``</span></span><br><span class="line"><span class="attr">NORMAL</span> = <span class="number">0</span></span><br><span class="line"><span class="comment">#: 标准声调风格，拼音声调在韵母第一个字母上（默认风格）。如： 中国 -&gt; ``zhōng guó``</span></span><br><span class="line"><span class="attr">TONE</span> = <span class="number">1</span></span><br><span class="line"><span class="comment">#: 声调风格2，即拼音声调在各个韵母之后，用数字 [1-4] 进行表示。如： 中国 -&gt; ``zho1ng guo2``</span></span><br><span class="line"><span class="attr">TONE2</span> = <span class="number">2</span></span><br><span class="line"><span class="comment">#: 声调风格3，即拼音声调在各个拼音之后，用数字 [1-4] 进行表示。如： 中国 -&gt; ``zhong1 guo2``</span></span><br><span class="line"><span class="attr">TONE3</span> = <span class="number">8</span></span><br><span class="line"><span class="comment">#: 声母风格，只返回各个拼音的声母部分（注：有的拼音没有声母，详见 `#27`_）。如： 中国 -&gt; ``zh g``</span></span><br><span class="line"><span class="attr">INITIALS</span> = <span class="number">3</span></span><br><span class="line"><span class="comment">#: 首字母风格，只返回拼音的首字母部分。如： 中国 -&gt; ``z g``</span></span><br><span class="line"><span class="attr">FIRST_LETTER</span> = <span class="number">4</span></span><br><span class="line"><span class="comment">#: 韵母风格，只返回各个拼音的韵母部分，不带声调。如： 中国 -&gt; ``ong uo``</span></span><br><span class="line"><span class="attr">FINALS</span> = <span class="number">5</span></span><br><span class="line"><span class="comment">#: 标准韵母风格，带声调，声调在韵母第一个字母上。如：中国 -&gt; ``ōng uó``</span></span><br><span class="line"><span class="attr">FINALS_TONE</span> = <span class="number">6</span></span><br><span class="line"><span class="comment">#: 韵母风格2，带声调，声调在各个韵母之后，用数字 [1-4] 进行表示。如： 中国 -&gt; ``o1ng uo2``</span></span><br><span class="line"><span class="attr">FINALS_TONE2</span> = <span class="number">7</span></span><br><span class="line"><span class="comment">#: 韵母风格3，带声调，声调在各个拼音之后，用数字 [1-4] 进行表示。如： 中国 -&gt; ``ong1 uo2``</span></span><br><span class="line"><span class="attr">FINALS_TONE3</span> = <span class="number">9</span></span><br><span class="line"><span class="comment">#: 注音风格，带声调，阴平（第一声）不标。如： 中国 -&gt; ``ㄓㄨㄥ ㄍㄨㄛˊ``</span></span><br><span class="line"><span class="attr">BOPOMOFO</span> = <span class="number">10</span></span><br><span class="line"><span class="comment">#: 注音风格，仅首字母。如： 中国 -&gt; ``ㄓ ㄍ``</span></span><br><span class="line"><span class="attr">BOPOMOFO_FIRST</span> = <span class="number">11</span></span><br><span class="line"><span class="comment">#: 汉语拼音与俄语字母对照风格，声调在各个拼音之后，用数字 [1-4] 进行表示。如： 中国 -&gt; ``чжун1 го2``</span></span><br><span class="line"><span class="attr">CYRILLIC</span> = <span class="number">12</span></span><br><span class="line"><span class="comment">#: 汉语拼音与俄语字母对照风格，仅首字母。如： 中国 -&gt; ``ч г``</span></span><br><span class="line"><span class="attr">CYRILLIC_FIRST</span> = <span class="number">13</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>有了这些，我们就可以轻松地实现风格转换了。 好，再回到原来的问题，为什么 pinyin 的方法默认带声调，而 lazy_pinyin 方法不带声调，答案就是：它们二者使用的默认风格不同，我们看下它的函数定义就知道了： pinyin 方法的定义如下：</p>
                  <figure class="highlight routeros">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">def pinyin(hans, <span class="attribute">style</span>=Style.TONE, <span class="attribute">heteronym</span>=<span class="literal">False</span>, <span class="attribute">errors</span>=<span class="string">'default'</span>, <span class="attribute">strict</span>=<span class="literal">True</span>)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>lazy_pinyin 方法的定义如下：</p>
                  <figure class="highlight routeros">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">def lazy_pinyin(hans, <span class="attribute">style</span>=Style.NORMAL, <span class="attribute">errors</span>=<span class="string">'default'</span>, <span class="attribute">strict</span>=<span class="literal">True</span>)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>这下懂了吧，因为 pinyin 方法默认使用了 TONE 的风格，而 lazy_pinyin 方法默认使用了 NORMAL 的风格，所以就导致二者返回风格不同了。 好了，有了这两个函数的定义，我们再来研究下其他的参数，比如定义里面的 errors 和 strict 参数又怎么用呢？</p>
                  <h2 id="错误处理"><a href="#错误处理" class="headerlink" title="错误处理"></a>错误处理</h2>
                  <p>在这里我们先做一个测试，比如我们传入无法转拼音的字，比如：</p>
                  <figure class="highlight coffeescript">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">from</span> pypinyin <span class="keyword">import</span> lazy_pinyin</span><br><span class="line"><span class="built_in">print</span>(lazy_pinyin(<span class="string">'你好☆☆，我是xxx'</span>))</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>其中包含了星号两个，还有标点一个，另外还包含了一个 xxx 英文字符，结果会是什么呢？</p>
                  <figure class="highlight scheme">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">[<span class="symbol">'ni</span>', <span class="symbol">'hao</span>', <span class="symbol">'☆☆，</span>', <span class="symbol">'wo</span>', <span class="symbol">'shi</span>', <span class="symbol">'xxx</span>']</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>可以看到结果中星号和英文字符都作为一个整体并原模原样返回了。 那么这种特殊字符可以单独进行处理吗？当然可以，这里就用到刚才提到的 errors 参数了。 errors 参数是有几种模式的：</p>
                  <ul>
                    <li>default：默认行为，不处理，原木原样返回</li>
                    <li>ignore：忽略字符，直接抛掉</li>
                    <li>replace：直接替换为去掉 <code>u</code> 的 unicode 编码</li>
                    <li>callable 对象：当传入一个可调用的对象的时候，则可以自定义处理方式。</li>
                  </ul>
                  <p>下面是 errors 这个参数的源码实现逻辑：</p>
                  <figure class="highlight python">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">_handle_nopinyin_char</span><span class="params">(chars, errors=<span class="string">'default'</span>)</span>:</span></span><br><span class="line">    <span class="string">"""处理没有拼音的字符"""</span></span><br><span class="line">    <span class="keyword">if</span> callable_check(errors):</span><br><span class="line">        <span class="keyword">return</span> errors(chars)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> errors == <span class="string">'default'</span>:</span><br><span class="line">        <span class="keyword">return</span> chars</span><br><span class="line">    <span class="keyword">elif</span> errors == <span class="string">'ignore'</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line">    <span class="keyword">elif</span> errors == <span class="string">'replace'</span>:</span><br><span class="line">        <span class="keyword">if</span> len(chars) &gt; <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">''</span>.join(text_type(<span class="string">'%x'</span> % ord(x)) <span class="keyword">for</span> x <span class="keyword">in</span> chars)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> text_type(<span class="string">'%x'</span> % ord(chars))</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>当处理没有拼音的字符的时候，errors 的不同参数会有不同的处理结果，更详细的逻辑可以翻看源码。 好了，下面我们来尝试一下，比如我们想将不能转拼音的字符去掉，则可以这么设置：</p>
                  <figure class="highlight routeros">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">from</span> pypinyin import lazy_pinyin</span><br><span class="line"><span class="builtin-name">print</span>(lazy_pinyin(<span class="string">'你好☆☆，我是xxx'</span>, <span class="attribute">errors</span>=<span class="string">'ignore'</span>))</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>运行结果：</p>
                  <figure class="highlight scheme">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">[<span class="symbol">'ni</span>', <span class="symbol">'hao</span>', <span class="symbol">'wo</span>', <span class="symbol">'shi</span>']</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>如果我们想要自定义处理，比如把 <code>☆</code> 转化为 <code>※</code>，则可以这么设置：</p>
                  <figure class="highlight reasonml">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">print(<span class="keyword">lazy</span><span class="constructor">_pinyin('你好☆☆，我是<span class="params">xxx</span>', <span class="params">errors</span>=<span class="params">lambda</span> <span class="params">item</span>: ''.<span class="params">join</span>(['※' <span class="params">if</span> <span class="params">c</span> <span class="operator">==</span> '☆' <span class="params">else</span> <span class="params">c</span> <span class="params">for</span> <span class="params">c</span> <span class="params">in</span> <span class="params">item</span>])</span>))</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>运行结果：</p>
                  <figure class="highlight scheme">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">[<span class="symbol">'ni</span>', <span class="symbol">'hao</span>', <span class="symbol">'※※，</span>', <span class="symbol">'wo</span>', <span class="symbol">'shi</span>', <span class="symbol">'xxx</span>']</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>如上便是一些相关异常处理的操作，我们可以随心所欲地处理自己想处理的字符了。</p>
                  <h2 id="严格模式"><a href="#严格模式" class="headerlink" title="严格模式"></a>严格模式</h2>
                  <p>最后再看下 strict 模式，这个参数用于控制处理声母和韵母时是否严格遵循 <a href="http://www.moe.edu.cn/s78/A19/yxs_left/moe_810/s230/195802/t19580201_186000.html" target="_blank" rel="noopener">《汉语拼音方案》</a> 标准。 下面的一些说明来源于官方文档： 当 strict 参数为 True 时根据 <a href="http://www.moe.edu.cn/s78/A19/yxs_left/moe_810/s230/195802/t19580201_186000.html" target="_blank" rel="noopener">《汉语拼音方案》</a> 的如下规则处理声母、在韵母相关风格下还原正确的韵母：</p>
                  <ul>
                    <li>21 个声母： <code>b p m f d t n l g k h j q x zh ch sh r z c s</code> （<strong>y, w 不是声母</strong>）</li>
                    <li>i行的韵母，前面没有声母的时候，写成yi(衣)，ya(呀)，ye(耶)，yao(腰)，you(忧)，yan(烟)， yin(因)，yang(央)，ying(英)，yong(雍)。（<strong>y 不是声母</strong>）</li>
                    <li>u行的韵母，前面没有声母的时候，写成wu(乌)，wa(蛙)，wo(窝)，wai(歪)，wei(威)，wan(弯)， wen(温)，wang(汪)，weng(翁)。（<strong>w 不是声母</strong>）</li>
                    <li>ü行的韵母，前面没有声母的时候，写成yu(迂)，yue(约)，yuan(冤)，yun(晕)；ü上两点省略。 （<strong>韵母相关风格下还原正确的韵母 ü</strong>）</li>
                    <li>ü行的韵跟声母j，q，x拼的时候，写成ju(居)，qu(区)，xu(虚)，ü上两点也省略； 但是跟声母n，l拼的时候，仍然写成nü(女)，lü(吕)。（<strong>韵母相关风格下还原正确的韵母 ü</strong>）</li>
                    <li>iou，uei，uen前面加声母的时候，写成iu，ui，un。例如niu(牛)，gui(归)，lun(论)。 （<strong>韵母相关风格下还原正确的韵母 iou，uei，uen</strong>）</li>
                  </ul>
                  <p>当 strict 为 False 时就是不遵守上面的规则来处理声母和韵母， 比如：<code>y</code>, <code>w</code> 会被当做声母，yu(迂) 的韵母就是一般认为的 <code>u</code> 等。 具体差异可以查看源码中 <a href="https://github.com/mozillazg/python-pinyin/blob/master/tests/test_standard.py" target="_blank" rel="noopener">tests/test_standard.py</a> 中的对比结果测试用例。</p>
                  <h2 id="自定义拼音"><a href="#自定义拼音" class="headerlink" title="自定义拼音"></a>自定义拼音</h2>
                  <p>如果对库返回的结果不满意，我们还可以自定义自己的拼音库，这里用到的方法就有 load_single_dict 和 load_phrases_dict 方法了。 比如刚才我们看到 “朝阳” 两个字的发音默认返回的是 zhao yang，我们想默认返回 chao yang，那可以这么做：</p>
                  <figure class="highlight stylus">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">from pypinyin import lazy_pinyin, load_phrases_dict</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(lazy_pinyin(<span class="string">'朝阳'</span>)</span></span>)</span><br><span class="line">personalized_dict = &#123;</span><br><span class="line">    <span class="string">'朝阳'</span>: [[<span class="string">'cháo'</span>], [<span class="string">'yáng'</span>]]</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="title">load_phrases_dict</span><span class="params">(personalized_dict)</span></span></span><br><span class="line"><span class="function"><span class="title">print</span><span class="params">(lazy_pinyin(<span class="string">'朝阳'</span>)</span></span>)</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>这里我们自定义了一个词典，然后使用 load_phrases_dict 方法设置了一下就可以了。 运行结果：</p>
                  <figure class="highlight scheme">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">[<span class="symbol">'zhao</span>', <span class="symbol">'yang</span>']</span><br><span class="line">[<span class="symbol">'chao</span>', <span class="symbol">'yang</span>']</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>这样就可以完成自定义的设置了。 在一些项目里面我们可以自定义很多拼音库，然后加载就可以了。 另外我们还可以注册样式实现自定义，比如将某个拼音前面加上 Emoji 表情，样例：</p>
                  <figure class="highlight python">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">from</span> pypinyin.style <span class="keyword">import</span> register</span><br><span class="line"><span class="keyword">from</span> pypinyin <span class="keyword">import</span> lazy_pinyin</span><br><span class="line"></span><br><span class="line"><span class="meta">@register('kiss')</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">kiss</span><span class="params">(pinyin, **kwargs)</span>:</span></span><br><span class="line">    <span class="keyword">if</span> pinyin == <span class="string">'me'</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">f'?<span class="subst">&#123;pinyin&#125;</span>'</span></span><br><span class="line">    <span class="keyword">return</span> pinyin</span><br><span class="line"></span><br><span class="line">print(lazy_pinyin(<span class="string">'么么哒'</span>, style=<span class="string">'kiss'</span>))</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>运行结果：</p>
                  <figure class="highlight scheme">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">[<span class="symbol">'?me</span>', <span class="symbol">'?me</span>', <span class="symbol">'dá</span>']</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>这里我们调用 register 方法注册了一个样式 style，然后转换的时候指定即可，通过观察运行结果我们可以发现，这样我们就可以将 me 字的拼音前面加上 ? 这个 Emoji 表情了。 以上就是 PyPinyin 这个库的基本用法，更多的用法建议大家看看源码或者看 API 文档：<a href="https://pypinyin.readthedocs.io/zh_CN/master/api.html" target="_blank" rel="noopener">https://pypinyin.readthedocs.io/zh_CN/master/api.html</a>。</p>
                  </p>
                </div>
              </div>
              <div class="post-meta">
                <span class="post-meta-item">
                  <span class="post-meta-item-icon">
                    <i class="far fa-user"></i>
                  </span>
                  <span class="post-meta-item-text">作者</span>
                  <span><a href="/authors/崔庆才" class="author" itemprop="url" rel="index">崔庆才</a></span>
                </span>
                <span class="post-meta-item">
                  <span class="post-meta-item-icon">
                    <i class="far fa-calendar"></i>
                  </span>
                  <span class="post-meta-item-text">发表于</span>
                  <time title="创建时间：2019-04-04 17:06:50" itemprop="dateCreated datePublished" datetime="2019-04-04T17:06:50+08:00">2019-04-04</time>
                </span>
                <span id="/6519.html" class="post-meta-item leancloud_visitors" data-flag-title="Python 中拼音库 PyPinyin 的用法" title="阅读次数">
                  <span class="post-meta-item-icon">
                    <i class="fa fa-eye"></i>
                  </span>
                  <span class="post-meta-item-text">阅读次数：</span>
                  <span class="leancloud-visitors-count"></span>
                </span>
                <span class="post-meta-item" title="本文字数">
                  <span class="post-meta-item-icon">
                    <i class="far fa-file-word"></i>
                  </span>
                  <span class="post-meta-item-text">本文字数：</span>
                  <span>6k</span>
                </span>
                <span class="post-meta-item" title="阅读时长">
                  <span class="post-meta-item-icon">
                    <i class="far fa-clock"></i>
                  </span>
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                  <span>5 分钟</span>
                </span>
              </div>
            </article>
            <article itemscope itemtype="http://schema.org/Article" class="post-block index" lang="zh-CN">
              <link itemprop="mainEntityOfPage" href="https://cuiqingcai.com/6511.html">
              <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
                <meta itemprop="image" content="/images/avatar.png">
                <meta itemprop="name" content="崔庆才">
                <meta itemprop="description" content="崔庆才的个人站点，记录生活的瞬间，分享学习的心得。">
              </span>
              <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
                <meta itemprop="name" content="静觅">
              </span>
              <header class="post-header">
                <h2 class="post-title" itemprop="name headline">
                  <a class="label"> 个人随笔 <i class="label-arrow"></i>
                  </a>
                  <a href="/6511.html" class="post-title-link" itemprop="url">从学校迈入职场</a>
                </h2>
              </header>
              <div class="post-body" itemprop="articleBody">
                <div class="thumb">
                  <img itemprop="contentUrl" class="random">
                </div>
                <div class="excerpt">
                  <p>
                  <p>正式入职微软，提交了第一个 PR 之后，我坐在椅子上思考人生。终于我也变成了一名正式的企业员工，变成了一名正式的踏入社会的职业人士，从此我的学生生涯也算是画上了一个句号，不，更确切的说应该是画上了一个引号。 和同事租了房子，生活条件算是还不错，有了属于自己的房间，有了专属自己的衣柜、书橱、办公桌，想要的硬件、软件、日常用品想配就配，算是应有尽有了。首先日常生活上最大的感受就是自己的生活条件变得更好、更自由，不再像学校一样有各种限制了，虽然日常花销变多了，但总体上来说我更喜欢现在的生活环境。</p>
                  <h2 id="回顾"><a href="#回顾" class="headerlink" title="回顾"></a>回顾</h2>
                  <p>先回想一下自己的学生生活吧，初高中就不说了，就天天上课为了高考，后来在大学基本上就是三点一线，宿舍——食堂——教室/实验室，然后读研，研究生模式也差不多，宿舍——食堂——实验室/公司。</p>
                  <h3 id="编程入门"><a href="#编程入门" class="headerlink" title="编程入门"></a>编程入门</h3>
                  <p>我大学的时候选的就是计算机科学与技术这个专业，当时学校开的第一门入门课就是 Java，当时可以说是对编程一窍不通，什么 print？打印机吗？控制台是什么？控制谁？什么面向对象？我对象在哪里？都是些什么玩意。就这样，随着老师的课堂洗脑和一些并不怎么感兴趣的编程作业，我慢慢理解了原来 print 是这么个玩意，对象原来不是那个对象，就慢慢对编程建立了一个概念。插句话，其实我感觉编程的一些概念和思维还是很重要的，有人说编程学不会，可能就是脑中没有形成一个比较清晰的概念，想清楚它能做到什么，怎样从用双手解决一件事的思维转换成用编程解决一件事的思维。 扯远了，但那时候仅仅 Java 是一门课而已，虽然最后考试考得还不错，但是还是不是很懂它能为我带来些什么东西。后来大学就开了一个叫做课程设计的课，意思就是说让自己动手编程实现一个可以操作的项目。我们当时学校要求的就是实现一个黑白棋在线对战系统，当时可把我为难坏了。后来了解到了这里面还挺复杂的，又得编写界面又得搞一些算法，还得搞一个在线 WebSocket 通信，当时可以说是毫无思路，然后就去网上搜一些 Java 的教程，当时是搜到了马士兵的 Java 课就顺着看了起来，可以说马士兵是我的 Java 最重要的启蒙老师了，慢慢地把一些原理和基础学会了之后就有了基本的编程思路了，开始上手编，做界面，做服务器等等。另外还有一些小插曲，有的界面还得抠图，当时为了打造一个完美的棋盘效果还学了 PS 来花了一个木质棋盘和黑白棋子，估计得花了好几个月的时间终于做出来了一个像样点的系统，虽然现在源码已经找不到了，但真的说这个课程设计真的让我理解了编程的一些思维和理念以及它能为我带来些什么，我能够用它做到什么，脑中的一些概念变得更加清晰了，收获非常大。 后来学校开了数据结构和算法的一些课，慢慢地我又对一些基础的算法和 C++ 的一些编程语言有了一定的了解。再后来就是一些基础专业课了，比如操作系统，计算机组成原理，计算机网络等等，总体来说其实我没太感觉出具体有多大作用，但你要假设我没学过，我可能有很多东西都不知其理。人就是这样，有些东西在拥有的时候觉不出有什么好的，但一旦没有才会有明显的感觉。</p>
                  <h3 id="加实验室"><a href="#加实验室" class="headerlink" title="加实验室"></a>加实验室</h3>
                  <p>好吧又扯远了，然后就可以说迈入了我人生中一个比较重要的点了，那就是加入学校的一个实验室。之前许多东西我和室友自己瞎倒腾，比如当时进行版本控制的话，就是自己手动压缩一下，命名项目的时候添加一个版本号并用下划线分割，后来进了实验室才知道还有 Git 这么牛逼的东西，于是乎就跟着学习了 Git，了解了 GitHub，觉得整个代码世界都光明了。当时我加入的是后台组，一开始是从 PHP 开始学起的，从原生的 PHP，到普通的 CodeIgniter 框架，到高级的 Laravel 框架，当时写的时候主要用是 MVC 模式，所以前端的东西也难免需要用到的，所以那会儿又学习了前端的一些知识，慢慢地就变成了 Web 前后端通吃，自己也可以逐渐完成一些大型项目的开发工作。当时还自己开通了博客来记录自己学习的一些经验，然后跟着实验室一起接外包做外包，做了不下十个门户及商业网站的开发。</p>
                  <h3 id="学习爬虫"><a href="#学习爬虫" class="headerlink" title="学习爬虫"></a>学习爬虫</h3>
                  <p>再往后可能就是临近大学毕业的时候了，那会儿实验室的一位学长写了一些爬虫的入门文章，当时也跟着学了起来，边学边记录，学的整理的一些知识点都放在了自己的博客上。后来又探索了一些新的爬取方案，也一并整理到博客上了，形成了一个入门到进阶的一套简易版教程，后来随着写的越来越多，来看的人也越来越多了，后来访问量也逐渐上来了，现在的话日均访问量可以达到 15000+。 再往后可能就差不多大学毕业了，当时由于是保研到北航的，所以就提前来到了北京开始了研究生的预备工作，也节省了不少时间。那会儿就有充足的时间来做自己的事情，比如学习一些网络课程，继续做一些关于爬虫的研究工作。当时随着我的博客访问量越来越大，图灵便联系我看能不能写一本关于爬虫的书，当时想的一个是可以把自己学习的知识好好整理一下，还可以作为自己的一部个人作品出版出来，的确是一件非常不错的事情，所以当时就答应下来了。不得不说写书的过程是非常艰辛的，舍去了好多平时的休息时间，同时还发现了自己的很多不足的地方去查漏补缺，最终也不得不延期了好几个月才交上稿。后来又审校了非常久的时间，到去年五月份才出版出来，定名字叫《Python3网络爬虫开发实战》。不过后来的销量还算不错，现在已经重印了 10 次，50000 本了。现在还在继续撰写第二版中，把一些过期的案例和知识点更新，再把一些新的技术加进去。</p>
                  <h3 id="研究生生活"><a href="#研究生生活" class="headerlink" title="研究生生活"></a>研究生生活</h3>
                  <p>OK，当然研究生阶段也不是都写书了。研究生阶段其实一开始是比较迷茫的，其实当时并不知道自己毕业之后要做什么方面的工作以及想去哪里。最初读的时候是选了网络安全的方向，做一些 Web 渗透方面的研究，后来觉得研究得差不多了，就又转了自然语言处理的方向，从吴恩达的机器学习开始学起，然后了解了深度学习的一些模型，又了解了自然语言处理的一些知识。与此同时，我也在微软这边当实习生，从最初的爬虫、 Platform 再到 Science NLP 研究，慢慢地也认识了一些大佬，和他们一起交流的确让我学习到了不少。 由于我在微软这边实习时间不短，所以当时也参加了实习生转正的面试。微软整个的面试流程还是很规范和严格的，包括多面技术面，另外每一面的要求也都不低的。首先最基础的要求就是算法，给你几道题目，来白纸上把这道题的代码写出来，面试官会非常注重边界处理和细节把握，如果要写不出来，基本上也离凉凉不远了。接下来还有一些基本的公式推导，比如如果要面试机器学习算法工程师的话，可能会让手写推导 SVM、LR 等算法。另外还有一些系统设计题，来看看你的思维和架构是不是能达到要求。最后我记得还有一些智力题，看看反应得快不快。再往后的面试也是谈谈自己对行业的一些理解和看法，谈得还是比较深入的。总之考察得非常综合，当时准备面试的期间真的是无比焦虑，感觉人心惶惶的，当时在疯狂地刷题，复习各种算法推导，准备了也差不多有一两个月。最后得知 Offer 的那一刻，一块石头终于落地了。最后我也如愿入职了微软小冰，今年三月刚刚入职，也希望能为小冰带来更多的贡献，也希望大家可以多多关注微软小冰。 其实我已经在微软这边实习了一年多的时间了，平时很多时间也都呆在公司里，自己也算提前一步迈入职场了，经过我个人实习的体验和感受，同时也结合自己平时的了解，总结出来了一些经验。当然这仅仅是我个人的一些看法，仁者见仁智者见智，在这里仅仅做一些经验总结和分享，总结一些从学生迈入职场之后，我会注重的一些地方。如果对你有些启发，那是再好不过了。</p>
                  <h2 id="工作相关"><a href="#工作相关" class="headerlink" title="工作相关"></a>工作相关</h2>
                  <p>首先就是工作相关的一些东西了，由学生到工作，我个人觉得还是有一些需要调整的地方的，下面稍微这里说一下。</p>
                  <h3 id="转换思维"><a href="#转换思维" class="headerlink" title="转换思维"></a>转换思维</h3>
                  <p>学生到职场的转换，第一个重要的就是转变自己看待事情的思维。迈入职场，就别再有一种”我是学生“、”我刚刚毕业“ 这样的想法，在职场里别人才不管我们是不是刚毕业的学生，他们看的基本上都是我们能不能完成工作或者配合他们完成工作。 另外也别总有一种”努力必有回报“这样的思维。学生时代，可能一道题解不出来，一个项目做不出来，努努力很大程度上还是可以能解的。但是到了职场，这个很不一样，很多事情并不是一定存在因果这样的线性关系的。比如说某个项目你辛辛苦苦做了很久，可能就因为领导不想要这个功能而直接砍掉了。比如说你辛辛苦苦写了稿子，可能因为和某个评阅人的想法不一致而被直接拒掉了。想开点，有时候就是这么操蛋。 还有一个就是别把一件事想的太简单，在工作中，其实很多事上牵扯的东西是很多的。学生的一件事可能就是一件事，一道题可能就是一套题。工作中一件事可能不仅仅是一件事，它所关系到的东西要复杂的多。我们可能会考虑到对公司、对领导、对同事、对绩效、对家人的很多事情，多考虑考虑。 总之，思维的转换是第一步，别再像之前当学生的时候一样了。</p>
                  <h3 id="靠真本事"><a href="#靠真本事" class="headerlink" title="靠真本事"></a>靠真本事</h3>
                  <p>首先得考虑清楚啊，公司把我们招来是为了让我们来发挥价值的。 而我们的价值在哪里发挥？当然是体现在工作成果中。那成果哪里来的？那当然是把自己的能力转化过来的。 不同职位有不同的要求，首先确保的是要利用自己的能力把本职工作做好。当然我是做技术的，我所专注的就是技术这个领域了，技术能力是必不可少的，当然做这份工作需要的其实也不仅仅是技术能力，还有一些非表面意义上的能力，如学习探索能力、沟通合作能力等等。 而这些吧，归根结底还是要靠自己的真本事的。别想着投机取巧，别想着耍点小聪明，虽然一时方便了，但是长远来看，吃亏的还是自己。 当然这例子很多，比如明明不是自己做的，却要为了某些目的非要伪装自己，被看穿之后，不少人其实是看破不说破的，慢慢地自己就会知道后果了。比如为了某些目标，背地里各种跟领导各种小恩小惠等，其实领导基本不会 Care 你这种小聪明，甚至还觉得这个人有点靠不住，自己的受信任度也会大打折扣，另外自己不会感到心虚吗？ 最好的办法是什么，其实就是把该做完的工作保质保量完成，靠自己的真本事，实打实做好要求的每一件事就好了，领导看重的就是这个。</p>
                  <h3 id="利益为先"><a href="#利益为先" class="headerlink" title="利益为先"></a>利益为先</h3>
                  <p>职场上面啊，你说人情，当然也是会有的，但是更多的人关注的其实是工作本身以及自己的利益。这和学校的差距还是很大的。比如你要是个学生的话，有些人可能觉得你的身份而稍微谅解一下，而踏入社会之后，基本就不会了。 比如你要跟某个人交流和合作，就别总是寒暄以此来套近乎，不是说这个一点用都没有，多少可能还是有点用的，如果你有价值，靠这个可能能快速拉近他与你的距离。但很多情况下，这个的效果可能真的作用不大。 到了职场，大家都很忙的，比如找人谈事情，稍微介绍几句，开口直接谈正事、谈利益就好了。如果不能为对方提供有价值的信息，或者提供的价值并不是对方想要的，对方会觉得比较浪费时间。这种时候就别掺杂什么别的什么交情之类的东西了，虽说我认为成年人只看利益不够准确，但基本上是没错的。 比如跟人谈个合作的时候，讲清楚两点，第一是我们能提供什么价值和服务，第二是他能得到什么利益。当然第二点有的情况下是不需要说的，因为我们本身提供的价值就是给对方的利益，对方觉得值，自然会跟我们合作的。其中也不乏一些沟通的小技巧，还需要在这个过程中慢慢摸索。</p>
                  <h3 id="保持交流"><a href="#保持交流" class="headerlink" title="保持交流"></a>保持交流</h3>
                  <p>领导给了一个要求，如果有疑问，要多问多交流，别偏离了方向，别是自作主张。 之前的时候，我接到了一个任务，了解了基本的需求时候就开始开工干。在做的过程中其实有不少不确定的地方，但是当时我也不知道是不好意思还是什么原因，就没有跟领导交流，按照自己的想法做了出来。最后演示的时候，领导说你怎么做成这样了？我本意不是这样的，你有疑问怎么不跟我讨论呢？ 我就意识到了，这其实也可以多少印证”选择比努力更重要“，方向性或方案性的东西是很重要的。 所以，遇到什么不确定的点，要多多沟通交流。当然这并不是说突然想到了某个点就去找对方讨论，把自己的疑问以及可能解决方案和结果梳理清楚再好好交流一下，效果一定好上太多。</p>
                  <h3 id="工作日志"><a href="#工作日志" class="headerlink" title="工作日志"></a>工作日志</h3>
                  <p>做好工作日志，时间长了，会发现这个非常有用，它的有用不仅仅是体现在它仅仅是做了总结，它也会潜移默化地影响我们自己。 比如每天可以找个时间简单记录一下自己今天做了什么事情，收获了什么，还需要做什么。这个记录的过程就是一个思考的过程，它会让我们反思自己的一些不足和需要做的更好的地方，会变成一种激励的。 另外工作日志，等某天你打开的时候，会发现成就感满满，同时写什么总计和汇报也就不用愁了。</p>
                  <h2 id="个人相关"><a href="#个人相关" class="headerlink" title="个人相关"></a>个人相关</h2>
                  <p>刚才所说的挺多都是和工作相关的，另外还有一些和个人相关的我觉得也应该好好注意下。</p>
                  <h3 id="迈出第一步"><a href="#迈出第一步" class="headerlink" title="迈出第一步"></a>迈出第一步</h3>
                  <p>我曾经尝试过很多坚持每天做点什么的事情，发现有的挺难坚持下来的，一而再再而三地累积，就变得越来越多，后来整个坚持的事情就失败了，这就是拖延症的一种现象。 拖延症应该很多人都会有，当然我也是。我平时分析拖延症的一个很大的原因就是迈不出第一步，进而一件事就搁置了。就比如说要去健身房，我觉得最难的就是出家门；比如说要每天刷一道算法题，最难的可能就是打开LeetCode界面。不知道你们什么意见，我至少是这么认为的。 因此，迈出第一步非常重要，迈出了第一步，可以说就成功了一半。</p>
                  <h3 id="言多必失"><a href="#言多必失" class="headerlink" title="言多必失"></a>言多必失</h3>
                  <p>的确是，言多必失，这话没毛病。 可能我们仅仅是刚入职的新人，很多情况下不该说的就别说。你永远也不知道你说了某些话之后，你在别人耳中会变成什么样的版本。另外如果我们突然说错了什么话，被人揪住了把柄，那可是很难的。所以，一些场景中，我们一些没必要说的就不要去说，不知道该说不该说的也不要说。 另外我个人比较反感的是明一套暗一套。我们不可能让所有人都认同我们自己，不认同我们的，他们表现出来，我们道不同不相为谋。认同我们的支持我们的，我们可以与他们成为朋友。但表面上显得非常友好，然而在背地里面却说坏话，这是非常令人反感的。</p>
                  <h3 id="终身学习"><a href="#终身学习" class="headerlink" title="终身学习"></a>终身学习</h3>
                  <p>虽然表面上看学生生涯结束了，但实际上迈入职场恰恰是一个新的开始，其实人与人之间的差距就是因为工作后的这些年逐渐拉开的，所以不论什么时候都不能放弃学习。 当然迈入职场以后，学习的一些侧重点可能就不太一样了。工作后学习的第一肯定是能用在岗位之上的专业知识，我们所掌握的知识一定至少要能够让我们顺利地专业地完成自己的任务。其次可以扩宽一下知识面，比如可以关注下经济、理财、交际等知识。 总之还是一句话，学习到的本事是别人所偷不走的，做一个终身学习者。</p>
                  <h3 id="做好记录"><a href="#做好记录" class="headerlink" title="做好记录"></a>做好记录</h3>
                  <p>很多事情是确实很有必要记录下来的。首先不瞒说，随着事情的增多，工作的忙碌，我发现比原来更加”忘事“了。后来我看了一篇报道，说其实并不是脑子记忆力下降了多少，而是集中的注意力变得更少了。 一件事如果注意力分配得少了，自然很多事情就不容易被我们记住。想想确实是这样的，现在我每天都把自己的计划安排得满满当当，现在连拿出时间好好读一本书的时间都不多了，因此就别提那些日常小事了。那咋办？随手记录下来，比如记到手机的备忘录或者自己的 TodoList 软件里面，然后再进一步安排如何执行就好。 当然记录并不仅仅局限于这个记录下来平时的闪念，平时的一些工作总结、学习笔记也可以时刻记录下来。我有记录学习笔记的习惯，当然肯定也有的时候有一些内容没有及时记录下来。过了一段时间，我发现唯一记得的就是自己曾经整理过笔记甚至发表博客的那些内容，没写过的或者没发过的基本都忘干净了。 记录，成为更好的自己。</p>
                  <h3 id="作息调整"><a href="#作息调整" class="headerlink" title="作息调整"></a>作息调整</h3>
                  <p>良好的作息还是非常有必要的。现在肯定非常多的朋友会倾向于熬夜，十二点之后才睡。我之前实习的时候，比这个更狠，经常一两点钟睡觉，睡到将近中午，就直接吃中午饭得了，然后一上午就没有了，当时就有一种半天已经被我浪费的感觉，会有一种负罪感。 后来我开始逐步调整我的作息，尽量早睡早起，从之前的九点多慢慢地调整到八点，甚至是七点多，醒来之后整理一些东西，开始全新的一天，整体的体验确实是比之前睡到中午好太多了。另外我个人也参加了一个早起打卡活动，现在已经坚持每天打卡将近一个月了，基本上也养成了早起的习惯。 另外工作之后，下班的时间也可以好好利用起来，比如晚上稍微拉伸一下，睡前记得喝水等等，由于我平时也每天对着电脑，所以也需要定期地起来活动一下。我把它们设置到滴答清单里面，每天都有软件的定时提醒，到了时间就做，一天天坚持下来。总体来说，感觉也比之前好多了。 所以从现在起，拿起笔好好规划下自己的目标和平时的作息吧。 另外可能大家听说过，某个老板每天只睡五个多小时，晚上工作到很晚才走，早上一大早就在了。我当时也比较好奇这到底是怎么做到的？难道有什么特殊的睡眠技巧？经过我的一阵搜罗，结果是，没有。BOSS 们并没有我们这么忙，可能早上开完会，我们去干活了，而人家去补觉了。所以，保证充足的睡眠还是很有必要的。</p>
                  <h3 id="合理分配时间"><a href="#合理分配时间" class="headerlink" title="合理分配时间"></a>合理分配时间</h3>
                  <p>从学生到工作，其实就相当于我们的事情又多了一部分，工作日大部分为工作时间，非工作日则大部分是自己的时间。另外工作之后，相比学生时代来说，事情可能也会变得更多更繁琐。那么如何合理分配自己的时间呢？ 我这边采用了目前比较流行的四象限时间管理法，他就是把处理的事按“重要”和“紧急”两个维度划分，并对应到四种待处理状态中，分别叫做”重要不紧急“，”重要紧急“，”不重要紧急“，”不重要不紧急“四个类别。 通常来说，我们需要马上执行“急事”，确保它们不会延期。但长远来看，我们最好将重心放在“要事”上。可能有一些紧急的小事，它确实是不重要的，但我们能比较快的做完，然后把它勾掉，所以现在很多人可能更加优先处理的是紧急的事情而不是重要事情，最后紧急的事情做完了，剩下重要的事情没做完，所以要么加班熬夜，要么就延期。回想起来，其实这是很得不偿失的，忙活了一天，重要的事情还是没完成。 所以，我们需要尽量减少”不重要紧急“事件的忙碌，尽早处理”重要不紧急“的事情，合理分配时间，去做对我们而言重要的事情，才是四象限理论的核心。 我自己使用了滴答清单这款软件，之前使用的是 Todoist，这两款软件都非常不错，但是由于滴答清单多了番茄时钟的功能，我就改用了滴答清单，我利用它建立了四个智能清单，分别叫做”重要不紧急“，”重要紧急“，”不重要紧急“，”不重要不紧急“，然后建立筛选条件，软件就会根据任务的优先级和到期日期自动更新。然后就可以每天查看、处理并调整任务——做完的事情及时打勾，有变更的事情及时移动，可以遵循这样的一些准则：</p>
                  <ul>
                    <li>优先执行重要且紧急的事件</li>
                    <li>尽量提前规划重要不紧急事件，在它们变得紧急前就完成</li>
                    <li>如果可以的话，试着将不重要但紧急的事情交由他人处理，或者学会对别人的请求说 Sorry</li>
                    <li>需要控制去做不重要不紧急事件的时间，不要过度放松</li>
                  </ul>
                  <p>有了这几条原则，我们就可以很好的分配我们的时间了，如果大家觉得有用的话也可以试一下。 以上就是我的成长历程以及我所想到的一些需要调整和坚持的一些做法，如果能为大家带来一些帮助，那就再好不过了。</p>
                  </p>
                </div>
              </div>
              <div class="post-meta">
                <span class="post-meta-item">
                  <span class="post-meta-item-icon">
                    <i class="far fa-user"></i>
                  </span>
                  <span class="post-meta-item-text">作者</span>
                  <span><a href="/authors/崔庆才" class="author" itemprop="url" rel="index">崔庆才</a></span>
                </span>
                <span class="post-meta-item">
                  <span class="post-meta-item-icon">
                    <i class="far fa-calendar"></i>
                  </span>
                  <span class="post-meta-item-text">发表于</span>
                  <time title="创建时间：2019-03-25 02:35:33" itemprop="dateCreated datePublished" datetime="2019-03-25T02:35:33+08:00">2019-03-25</time>
                </span>
                <span id="/6511.html" class="post-meta-item leancloud_visitors" data-flag-title="从学校迈入职场" title="阅读次数">
                  <span class="post-meta-item-icon">
                    <i class="fa fa-eye"></i>
                  </span>
                  <span class="post-meta-item-text">阅读次数：</span>
                  <span class="leancloud-visitors-count"></span>
                </span>
                <span class="post-meta-item" title="本文字数">
                  <span class="post-meta-item-icon">
                    <i class="far fa-file-word"></i>
                  </span>
                  <span class="post-meta-item-text">本文字数：</span>
                  <span>7.6k</span>
                </span>
                <span class="post-meta-item" title="阅读时长">
                  <span class="post-meta-item-icon">
                    <i class="far fa-clock"></i>
                  </span>
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                  <span>7 分钟</span>
                </span>
              </div>
            </article>
            <article itemscope itemtype="http://schema.org/Article" class="post-block index" lang="zh-CN">
              <link itemprop="mainEntityOfPage" href="https://cuiqingcai.com/6509.html">
              <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
                <meta itemprop="image" content="/images/avatar.png">
                <meta itemprop="name" content="崔庆才">
                <meta itemprop="description" content="崔庆才的个人站点，记录生活的瞬间，分享学习的心得。">
              </span>
              <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
                <meta itemprop="name" content="静觅">
              </span>
              <header class="post-header">
                <h2 class="post-title" itemprop="name headline">
                  <a class="label"> 技术杂谈 <i class="label-arrow"></i>
                  </a>
                  <a href="/6509.html" class="post-title-link" itemprop="url">如何使用 SSH 控制连接 Windows 服务器</a>
                </h2>
              </header>
              <div class="post-body" itemprop="articleBody">
                <div class="thumb">
                  <img itemprop="contentUrl" class="random">
                </div>
                <div class="excerpt">
                  <p>
                  <p>入职微软之后，这边大多数是使用 Windows 进行开发的，比如我的台式机是 Windows 的，还有一部分服务器是 Windows 的，当然 Linux 是也非常多。 很多情况下我是使用自己的 Mac 笔记本来远程连接我的 Windows 机器来开发的。比如如果我在工位上，我会用我的 Mac 连接两块显示屏，然后一种一块用来远程桌面连接我的 Windows 开发机，这样另外一块屏幕和 Mac 自带的屏幕就用来看文档或者使用 Teams 通讯等等。如果我回家了，我家里也是有两块屏，开上 VPN，照样用一块屏使用远程桌面，另外一块屏幕和 Mac 自带屏幕就可以做其他事情了。 这样就解决了一个问题：我的 Windows 基本上都是仅用作开发的，一块屏幕就开着一个 Visual Studio，其他的操作都会在 Mac 进行，比如查文档，发消息等等。这样我下班之后照样使用远程连接的方式来操作，和在公司就是一样的。这样就避免了一些软件的来回登录，比如如果我上班只用公司机器，下班了之后换了 Mac 还得切 Teams、切微信、切浏览器等等，还是很麻烦的，而且上班期间 Mac 就闲置了也不好。所以我就采取了这样的开发方案。</p>
                  <h2 id="需求分析"><a href="#需求分析" class="headerlink" title="需求分析"></a>需求分析</h2>
                  <p>有了这个情景，就引入了一个问题。开了一个远程桌面之后，我几乎一个屏幕都是被 Visual Studio 占据的，而远程桌面貌似只能开一个屏幕？如果我要再开一个终端窗口的话，那可能屏幕就不太够用了，或者它就得覆盖我的全屏 Visual Stuido。 另外我平时 Mac 终端软件都是使用 SSH 的，基本都是用来连 Linux 的，Windows 一般都是开远程桌面。但命令行这个情形的确让我头疼，让我感到不够爽，因为毕竟远程桌面之后，Windows 里面的操作都得挤在一个桌面里面操作了。当然可能能设置多个桌面，如果可以的话，麻烦大家告知一下谢谢。 所以解决的痛点在于：我要把一些操作尽量从 Windows 里面分离出来，例如终端软件，我能否在远程桌面外面操作，能否使用 SSH 来控制我的 Windows 机器。 好，有需求才有动力，说干就干。</p>
                  <h2 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h2>
                  <p>查了一下，Windows 上其实也是有 SSH 服务器的，只不过默认是没有装的，这里只需要安装一个 OpenSSH 服务器就好了。 Win10 的话，就在设置里面可以安装，从开始菜单打开“设置”，然后选择应用和功能，这里就有一个“管理可选功能”的选项。 <img src="https://ws1.sinaimg.cn/large/006tKfTcgy1g17uv5tf19j30xb0puwm9.jpg" alt="image-20190319093941643"> 点击之后便可以看到一个可选功能，选择 OpenSSH 服务器即可，一般情况下是没有安装的。如果没有安装的话它会提示一个安装按钮，这里我已经安装好了，就提示了一个卸载按钮。 <img src="https://ws3.sinaimg.cn/large/006tKfTcgy1g17uwoakpij30x70pv0u6.jpg" alt="image-20190319094113033"> OK，有了它，直接点击安装即可完成 OpenSSH 服务器的安装。 当然如果你是想批量部署 Windows 服务器的话，当然是推荐使用 PowerShell 来自动化部署了。 首先需要用管理员身份启动 PowerShell，使用如下命令看一下，要确保 OpenSSH 可用于安装：</p>
                  <figure class="highlight pgsql">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">Get</span>-WindowsCapability -Online | ? <span class="type">Name</span> -<span class="keyword">like</span> <span class="string">'OpenSSH*'</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>输出应该是类似的结果：</p>
                  <figure class="highlight css">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="selector-tag">Name</span>  : <span class="selector-tag">OpenSSH</span><span class="selector-class">.Client</span>~~~~0<span class="selector-class">.0</span><span class="selector-class">.1</span><span class="selector-class">.0</span></span><br><span class="line"><span class="selector-tag">State</span> : <span class="selector-tag">NotPresent</span></span><br><span class="line"><span class="selector-tag">Name</span>  : <span class="selector-tag">OpenSSH</span><span class="selector-class">.Server</span>~~~~0<span class="selector-class">.0</span><span class="selector-class">.1</span><span class="selector-class">.0</span></span><br><span class="line"><span class="selector-tag">State</span> : <span class="selector-tag">NotPresent</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>然后使用 PowerShell 安装服务器即可：</p>
                  <figure class="highlight css">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="selector-tag">Add-WindowsCapability</span> <span class="selector-tag">-Online</span> <span class="selector-tag">-Name</span> <span class="selector-tag">OpenSSH</span><span class="selector-class">.Server</span>~~~~0<span class="selector-class">.0</span><span class="selector-class">.1</span><span class="selector-class">.0</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>输出结果类似：</p>
                  <figure class="highlight yaml">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="attr">Path          :</span></span><br><span class="line"><span class="attr">Online        :</span> <span class="literal">True</span></span><br><span class="line"><span class="attr">RestartNeeded :</span> <span class="literal">False</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>这样也可以完成 OpenSSH 的安装。 安装完成之后，就需要进行一些初始化配置了，还是以管理员身份，使用 PowerShell 执行即可。 首先需要开启 SSHD 服务：</p>
                  <figure class="highlight crmsh">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="literal">Start</span>-Service sshd</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>然后设置服务的自动启动：</p>
                  <figure class="highlight delphi">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">Set</span>-Service -<span class="keyword">Name</span> sshd -StartupType <span class="string">'Automatic'</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>最后确认一下防火墙是否是放开的：</p>
                  <figure class="highlight pgsql">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line"><span class="keyword">Get</span>-NetFirewallRule -<span class="type">Name</span> *ssh*</span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>如果是放开的，那么结果会提示 <code>OpenSSH-Server-In-TCP</code>这个状态是 enabled。 好了，完成如上操作之后我们就可以使用 SSH 来连接我们的 Windows 服务器了。</p>
                  <h2 id="连接"><a href="#连接" class="headerlink" title="连接"></a>连接</h2>
                  <p>连接非常简单了，用户名密码就是 Windows 的用户名和密码，使用 IP 地址链接即可。 比如我的 Windows 开发机的局域网 IP 为：10.172.134.88，那么就可以使用如下命令完成链接：</p>
                  <figure class="highlight angelscript">
                    <table>
                      <tr>
                        <td class="gutter">
                          <pre><span class="line">1</span><br></pre>
                        </td>
                        <td class="code">
                          <pre><span class="line">ssh <span class="symbol">user@</span><span class="number">10.172</span><span class="number">.134</span><span class="number">.88</span></span><br></pre>
                        </td>
                      </tr>
                    </table>
                  </figure>
                  <p>然后输入密码，就连接成功了，和 Linux 的是一样的。 另外我自己现在 Mac 常用的 SSH 客户端工具有 Termius，可以多终端同步使用，非常方便，这里我只需要添加我的 Windows 机器就好了，如图所示： <img src="https://ws1.sinaimg.cn/large/006tKfTcgy1g17vz64duxj30zk0m8gn6.jpg" alt="image-20190319101812208"> OK，以后就可以非常轻松地用 SSH 连接我的 Windows 服务器了，爽歪歪，上面的需求也成功解决。 以上便是使用 SSH 来连接 Windows 服务器的方法，如果大家有需求可以试试。</p>
                  </p>
                </div>
              </div>
              <div class="post-meta">
                <span class="post-meta-item">
                  <span class="post-meta-item-icon">
                    <i class="far fa-user"></i>
                  </span>
                  <span class="post-meta-item-text">作者</span>
                  <span><a href="/authors/崔庆才" class="author" itemprop="url" rel="index">崔庆才</a></span>
                </span>
                <span class="post-meta-item">
                  <span class="post-meta-item-icon">
                    <i class="far fa-calendar"></i>
                  </span>
                  <span class="post-meta-item-text">发表于</span>
                  <time title="创建时间：2019-03-25 02:33:31" itemprop="dateCreated datePublished" datetime="2019-03-25T02:33:31+08:00">2019-03-25</time>
                </span>
                <span id="/6509.html" class="post-meta-item leancloud_visitors" data-flag-title="如何使用 SSH 控制连接 Windows 服务器" title="阅读次数">
                  <span class="post-meta-item-icon">
                    <i class="fa fa-eye"></i>
                  </span>
                  <span class="post-meta-item-text">阅读次数：</span>
                  <span class="leancloud-visitors-count"></span>
                </span>
                <span class="post-meta-item" title="本文字数">
                  <span class="post-meta-item-icon">
                    <i class="far fa-file-word"></i>
                  </span>
                  <span class="post-meta-item-text">本文字数：</span>
                  <span>2k</span>
                </span>
                <span class="post-meta-item" title="阅读时长">
                  <span class="post-meta-item-icon">
                    <i class="far fa-clock"></i>
                  </span>
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                  <span>2 分钟</span>
                </span>
              </div>
            </article>
            <script>
              document.querySelectorAll('.random').forEach(item => item.src = "https://picsum.photos/id/" + Math.floor(Math.random() * Math.floor(300)) + "/200/133")

            </script>
            <nav class="pagination">
              <a class="extend prev" rel="prev" href="/page/8/"><i class="fa fa-angle-left" aria-label="上一页"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/8/">8</a><span class="page-number current">9</span><a class="page-number" href="/page/10/">10</a><span class="space">&hellip;</span><a class="page-number" href="/page/26/">26</a><a class="extend next" rel="next" href="/page/10/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
            </nav>
          </div>
          <script>
            window.addEventListener('tabs:register', () =>
            {
              let
              {
                activeClass
              } = CONFIG.comments;
              if (CONFIG.comments.storage)
              {
                activeClass = localStorage.getItem('comments_active') || activeClass;
              }
              if (activeClass)
              {
                let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
                if (activeTab)
                {
                  activeTab.click();
                }
              }
            });
            if (CONFIG.comments.storage)
            {
              window.addEventListener('tabs:click', event =>
              {
                if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
                let commentClass = event.target.classList[1];
                localStorage.setItem('comments_active', commentClass);
              });
            }

          </script>
        </div>
        <div class="toggle sidebar-toggle">
          <span class="toggle-line toggle-line-first"></span>
          <span class="toggle-line toggle-line-middle"></span>
          <span class="toggle-line toggle-line-last"></span>
        </div>
        <aside class="sidebar">
          <div class="sidebar-inner">
            <ul class="sidebar-nav motion-element">
              <li class="sidebar-nav-toc"> 文章目录 </li>
              <li class="sidebar-nav-overview"> 站点概览 </li>
            </ul>
            <!--noindex-->
            <div class="post-toc-wrap sidebar-panel">
            </div>
            <!--/noindex-->
            <div class="site-overview-wrap sidebar-panel">
              <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
                <img class="site-author-image" itemprop="image" alt="崔庆才" src="/images/avatar.png">
                <p class="site-author-name" itemprop="name">崔庆才</p>
                <div class="site-description" itemprop="description">崔庆才的个人站点，记录生活的瞬间，分享学习的心得。</div>
              </div>
              <div class="site-state-wrap motion-element">
                <nav class="site-state">
                  <div class="site-state-item site-state-posts">
                    <a href="/archives/">
                      <span class="site-state-item-count">518</span>
                      <span class="site-state-item-name">日志</span>
                    </a>
                  </div>
                  <div class="site-state-item site-state-categories">
                    <a href="/categories/">
                      <span class="site-state-item-count">21</span>
                      <span class="site-state-item-name">分类</span></a>
                  </div>
                  <div class="site-state-item site-state-tags">
                    <a href="/tags/">
                      <span class="site-state-item-count">121</span>
                      <span class="site-state-item-name">标签</span></a>
                  </div>
                </nav>
              </div>
              <div class="links-of-author motion-element">
                <span class="links-of-author-item">
                  <a href="https://github.com/Germey" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;Germey" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
                </span>
                <span class="links-of-author-item">
                  <a href="mailto:cqc@cuiqingcai.com.com" title="邮件 → mailto:cqc@cuiqingcai.com.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>邮件</a>
                </span>
                <span class="links-of-author-item">
                  <a href="https://weibo.com/cuiqingcai" title="微博 → https:&#x2F;&#x2F;weibo.com&#x2F;cuiqingcai" rel="noopener" target="_blank"><i class="fab fa-weibo fa-fw"></i>微博</a>
                </span>
                <span class="links-of-author-item">
                  <a href="https://www.zhihu.com/people/Germey" title="知乎 → https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;Germey" rel="noopener" target="_blank"><i class="fa fa-magic fa-fw"></i>知乎</a>
                </span>
              </div>
            </div>
            <div style=" width: 100%;" class="sidebar-panel sidebar-panel-image sidebar-panel-active">
              <a href="https://www.abuyun.com/http-proxy/introduce.html" target="_blank" rel="noopener">
                <img src="https://qiniu.cuiqingcai.com/88au8.jpg" style=" width: 100%;">
              </a>
            </div>
            <div style=" width: 100%;" class="sidebar-panel sidebar-panel-image sidebar-panel-active">
              <a href="https://tutorial.lengyue.video/?coupon=12ef4b1a-a3db-11ea-bb37-0242ac130002_cqx_850" target="_blank" rel="noopener">
                <img src="https://qiniu.cuiqingcai.com/bco2a.png" style=" width: 100%;">
              </a>
            </div>
            <div style=" width: 100%;" class="sidebar-panel sidebar-panel-image sidebar-panel-active">
              <a href="https://luminati-china.io/?affiliate=ref_5fbbaaa9647883f5c6f77095" target="_blank" rel="noopener">
                <img src="https://qiniu.cuiqingcai.com/ikkq9.jpg" style=" width: 100%;">
              </a>
            </div>
            <div class="sidebar-panel sidebar-panel-tags sidebar-panel-active">
              <h4 class="name"> 标签云 </h4>
              <div class="content">
                <a href="/tags/2048/" style="font-size: 10px;">2048</a> <a href="/tags/599/" style="font-size: 10px;">599</a> <a href="/tags/Bootstrap/" style="font-size: 11.25px;">Bootstrap</a> <a href="/tags/CDN/" style="font-size: 10px;">CDN</a> <a href="/tags/CQC/" style="font-size: 10px;">CQC</a> <a href="/tags/CSS/" style="font-size: 10px;">CSS</a> <a href="/tags/CSS-%E5%8F%8D%E7%88%AC%E8%99%AB/" style="font-size: 10px;">CSS 反爬虫</a> <a href="/tags/CV/" style="font-size: 10px;">CV</a> <a href="/tags/Django/" style="font-size: 10px;">Django</a> <a href="/tags/Eclipse/" style="font-size: 11.25px;">Eclipse</a> <a href="/tags/FTP/" style="font-size: 10px;">FTP</a> <a href="/tags/GitHub/" style="font-size: 11.25px;">GitHub</a> <a href="/tags/HTML5/" style="font-size: 10px;">HTML5</a> <a href="/tags/Hexo/" style="font-size: 10px;">Hexo</a> <a href="/tags/IT/" style="font-size: 10px;">IT</a> <a href="/tags/JSP/" style="font-size: 10px;">JSP</a> <a href="/tags/JavaScript/" style="font-size: 10px;">JavaScript</a> <a href="/tags/K8s/" style="font-size: 10px;">K8s</a> <a href="/tags/LOGO/" style="font-size: 10px;">LOGO</a> <a href="/tags/Linux/" style="font-size: 10px;">Linux</a> <a href="/tags/MIUI/" style="font-size: 10px;">MIUI</a> <a href="/tags/MongoDB/" style="font-size: 10px;">MongoDB</a> <a href="/tags/Mysql/" style="font-size: 10px;">Mysql</a> <a href="/tags/PHP/" style="font-size: 11.25px;">PHP</a> <a href="/tags/PS/" style="font-size: 10px;">PS</a> <a href="/tags/Pathlib/" style="font-size: 10px;">Pathlib</a> <a href="/tags/PhantomJS/" style="font-size: 10px;">PhantomJS</a> <a href="/tags/PySpider/" style="font-size: 10px;">PySpider</a> <a href="/tags/Python/" style="font-size: 16.25px;">Python</a> <a href="/tags/Python3/" style="font-size: 12.5px;">Python3</a> <a href="/tags/Pythonic/" style="font-size: 10px;">Pythonic</a> <a href="/tags/QQ/" style="font-size: 10px;">QQ</a> <a href="/tags/Redis/" style="font-size: 10px;">Redis</a> <a href="/tags/SAE/" style="font-size: 10px;">SAE</a> <a href="/tags/SSH/" style="font-size: 10px;">SSH</a> <a href="/tags/SVG/" style="font-size: 10px;">SVG</a> <a href="/tags/Scrapy/" style="font-size: 10px;">Scrapy</a> <a href="/tags/Scrapy-redis/" style="font-size: 10px;">Scrapy-redis</a> <a href="/tags/Scrapy%E5%88%86%E5%B8%83%E5%BC%8F/" style="font-size: 10px;">Scrapy分布式</a> <a href="/tags/Selenium/" style="font-size: 10px;">Selenium</a> <a href="/tags/TKE/" style="font-size: 10px;">TKE</a> <a href="/tags/Ubuntu/" style="font-size: 11.25px;">Ubuntu</a> <a href="/tags/Vue/" style="font-size: 11.25px;">Vue</a> <a href="/tags/Webpack/" style="font-size: 10px;">Webpack</a> <a href="/tags/Windows/" style="font-size: 10px;">Windows</a> <a href="/tags/Winpcap/" style="font-size: 10px;">Winpcap</a> <a href="/tags/WordPress/" style="font-size: 13.75px;">WordPress</a> <a href="/tags/object-Object/" style="font-size: 10px;">[object Object]</a> <a href="/tags/android/" style="font-size: 10px;">android</a> <a href="/tags/ansible/" style="font-size: 10px;">ansible</a> <a href="/tags/cocos2d-x/" style="font-size: 10px;">cocos2d-x</a> <a href="/tags/e6/" style="font-size: 10px;">e6</a> <a href="/tags/fitvids/" style="font-size: 10px;">fitvids</a> <a href="/tags/git/" style="font-size: 11.25px;">git</a> <a href="/tags/json/" style="font-size: 10px;">json</a> <a href="/tags/js%E9%80%86%E5%90%91/" style="font-size: 10px;">js逆向</a> <a href="/tags/kubernetes/" style="font-size: 10px;">kubernetes</a> <a href="/tags/log/" style="font-size: 10px;">log</a> <a href="/tags/logging/" style="font-size: 10px;">logging</a> <a href="/tags/matlab/" style="font-size: 11.25px;">matlab</a> <a href="/tags/python/" style="font-size: 20px;">python</a> <a href="/tags/pywin32/" style="font-size: 10px;">pywin32</a> <a href="/tags/style/" style="font-size: 10px;">style</a> <a href="/tags/tomcat/" style="font-size: 10px;">tomcat</a> <a href="/tags/ubuntu/" style="font-size: 10px;">ubuntu</a> <a href="/tags/uwsgi/" style="font-size: 10px;">uwsgi</a> <a href="/tags/validate-cert/" style="font-size: 10px;">validate_cert</a> <a href="/tags/vsftpd/" style="font-size: 10px;">vsftpd</a> <a href="/tags/wamp/" style="font-size: 10px;">wamp</a> <a href="/tags/wineQQ/" style="font-size: 10px;">wineQQ</a> <a href="/tags/%E4%B8%83%E7%89%9B/" style="font-size: 11.25px;">七牛</a> <a href="/tags/%E4%B8%8A%E6%B5%B7/" style="font-size: 10px;">上海</a> <a href="/tags/%E4%B8%AA%E4%BA%BA%E7%BD%91%E7%AB%99/" style="font-size: 10px;">个人网站</a> <a href="/tags/%E4%B8%BB%E9%A2%98/" style="font-size: 10px;">主题</a> <a href="/tags/%E4%BA%91%E5%AD%98%E5%82%A8/" style="font-size: 10px;">云存储</a> <a href="/tags/%E4%BA%AC%E4%B8%9C%E4%BA%91/" style="font-size: 10px;">京东云</a> <a href="/tags/%E4%BA%BA%E5%B7%A5%E6%99%BA%E8%83%BD/" style="font-size: 10px;">人工智能</a> <a href="/tags/%E4%BB%A3%E7%90%86/" style="font-size: 10px;">代理</a> <a href="/tags/%E4%BB%A3%E7%A0%81/" style="font-size: 10px;">代码</a> <a href="/tags/%E4%BC%98%E5%8C%96/" style="font-size: 10px;">优化</a> <a href="/tags/%E4%BD%8D%E8%BF%90%E7%AE%97/" style="font-size: 10px;">位运算</a> <a href="/tags/%E5%88%86%E4%BA%AB/" style="font-size: 10px;">分享</a> <a href="/tags/%E5%88%86%E5%B8%83%E5%BC%8F/" style="font-size: 10px;">分布式</a> <a href="/tags/%E5%88%9B%E4%B8%9A/" style="font-size: 10px;">创业</a> <a href="/tags/%E5%89%8D%E7%AB%AF/" style="font-size: 11.25px;">前端</a> <a href="/tags/%E5%8E%9F%E7%94%9FAPP/" style="font-size: 10px;">原生APP</a> <a href="/tags/%E5%8F%8D%E7%88%AC%E8%99%AB/" style="font-size: 12.5px;">反爬虫</a> <a href="/tags/%E5%91%BD%E4%BB%A4/" style="font-size: 10px;">命令</a> <a href="/tags/%E5%93%8D%E5%BA%94%E5%BC%8F%E5%B8%83%E5%B1%80/" style="font-size: 10px;">响应式布局</a> <a href="/tags/%E5%9F%9F%E5%90%8D%E7%BB%91%E5%AE%9A/" style="font-size: 10px;">域名绑定</a> <a href="/tags/%E5%A4%A7%E4%BC%97%E7%82%B9%E8%AF%84/" style="font-size: 10px;">大众点评</a> <a href="/tags/%E5%AD%97%E4%BD%93%E5%8F%8D%E7%88%AC%E8%99%AB/" style="font-size: 10px;">字体反爬虫</a> <a href="/tags/%E5%AE%9E%E7%94%A8/" style="font-size: 10px;">实用</a> <a href="/tags/%E5%B4%94%E5%BA%86%E6%89%8D/" style="font-size: 18.75px;">崔庆才</a> <a href="/tags/%E5%B7%A5%E5%85%B7/" style="font-size: 10px;">工具</a> <a href="/tags/%E6%89%8B%E6%9C%BA%E8%AE%BF%E9%97%AE/" style="font-size: 10px;">手机访问</a> <a href="/tags/%E6%95%99%E7%A8%8B/" style="font-size: 10px;">教程</a> <a href="/tags/%E6%97%85%E6%B8%B8/" style="font-size: 10px;">旅游</a> <a href="/tags/%E6%97%A5%E5%BF%97/" style="font-size: 10px;">日志</a> <a href="/tags/%E6%9D%9C%E5%85%B0%E7%89%B9/" style="font-size: 10px;">杜兰特</a> <a href="/tags/%E6%A1%8C%E9%9D%A2/" style="font-size: 10px;">桌面</a> <a href="/tags/%E6%B1%9F%E5%8D%97/" style="font-size: 10px;">江南</a> <a href="/tags/%E6%B8%B8%E6%88%8F/" style="font-size: 10px;">游戏</a> <a href="/tags/%E7%88%AC%E8%99%AB/" style="font-size: 15px;">爬虫</a> <a href="/tags/%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F/" style="font-size: 10px;">环境变量</a> <a href="/tags/%E7%94%9F%E6%B4%BB%E7%AC%94%E8%AE%B0/" style="font-size: 10px;">生活笔记</a> <a href="/tags/%E7%99%BB%E5%BD%95/" style="font-size: 10px;">登录</a> <a href="/tags/%E7%9F%A5%E4%B9%8E/" style="font-size: 10px;">知乎</a> <a href="/tags/%E7%9F%AD%E4%BF%A1/" style="font-size: 10px;">短信</a> <a href="/tags/%E7%BA%B8%E5%BC%A0/" style="font-size: 10px;">纸张</a> <a href="/tags/%E7%BD%91%E7%AB%99/" style="font-size: 10px;">网站</a> <a href="/tags/%E8%82%89%E5%A4%B9%E9%A6%8D/" style="font-size: 10px;">肉夹馍</a> <a href="/tags/%E8%A5%BF%E5%B0%91%E7%88%B7/" style="font-size: 10px;">西少爷</a> <a href="/tags/%E8%A7%86%E9%A2%91/" style="font-size: 10px;">视频</a> <a href="/tags/%E8%BF%9C%E7%A8%8B/" style="font-size: 10px;">远程</a> <a href="/tags/%E9%80%86%E5%90%91/" style="font-size: 10px;">逆向</a> <a href="/tags/%E9%85%8D%E7%BD%AE/" style="font-size: 10px;">配置</a> <a href="/tags/%E9%87%8D%E8%A3%85/" style="font-size: 10px;">重装</a> <a href="/tags/%E9%9D%99%E8%A7%85/" style="font-size: 17.5px;">静觅</a> <a href="/tags/%E9%A2%A0%E8%A6%86/" style="font-size: 10px;">颠覆</a> <a href="/tags/%E9%A3%9E%E4%BF%A1/" style="font-size: 10px;">飞信</a>
              </div>
              <script>
                const tagsColors = ['#00a67c', '#5cb85c', '#d9534f', '#567e95', '#b37333', '#f4843d', '#15a287']
                const tagsElements = document.querySelectorAll('.sidebar-panel-tags .content a')
                tagsElements.forEach((item) =>
                {
                  item.style.backgroundColor = tagsColors[Math.floor(Math.random() * tagsColors.length)]
                })

              </script>
            </div>
            <div class="sidebar-panel sidebar-panel-categories sidebar-panel-active">
              <h4 class="name"> 分类 </h4>
              <div class="content">
                <ul class="category-list">
                  <li class="category-list-item"><a class="category-list-link" href="/categories/C-C/">C/C++</a><span class="category-list-count">23</span></li>
                  <li class="category-list-item"><a class="category-list-link" href="/categories/HTML/">HTML</a><span class="category-list-count">13</span></li>
                  <li class="category-list-item"><a class="category-list-link" href="/categories/Java/">Java</a><span class="category-list-count">5</span></li>
                  <li class="category-list-item"><a class="category-list-link" href="/categories/JavaScript/">JavaScript</a><span class="category-list-count">26</span></li>
                  <li class="category-list-item"><a class="category-list-link" href="/categories/Linux/">Linux</a><span class="category-list-count">15</span></li>
                  <li class="category-list-item"><a class="category-list-link" href="/categories/Markdown/">Markdown</a><span class="category-list-count">1</span></li>
                  <li class="category-list-item"><a class="category-list-link" href="/categories/Net/">Net</a><span class="category-list-count">4</span></li>
                  <li class="category-list-item"><a class="category-list-link" href="/categories/Other/">Other</a><span class="category-list-count">38</span></li>
                  <li class="category-list-item"><a class="category-list-link" href="/categories/PHP/">PHP</a><span class="category-list-count">27</span></li>
                  <li class="category-list-item"><a class="category-list-link" href="/categories/Paper/">Paper</a><span class="category-list-count">2</span></li>
                  <li class="category-list-item"><a class="category-list-link" href="/categories/Python/">Python</a><span class="category-list-count">256</span></li>
                  <li class="category-list-item"><a class="category-list-link" href="/categories/TypeScript/">TypeScript</a><span class="category-list-count">2</span></li>
                  <li class="category-list-item"><a class="category-list-link" href="/categories/%E4%B8%AA%E4%BA%BA%E5%B1%95%E7%A4%BA/">个人展示</a><span class="category-list-count">1</span></li>
                  <li class="category-list-item"><a class="category-list-link" href="/categories/%E4%B8%AA%E4%BA%BA%E6%97%A5%E8%AE%B0/">个人日记</a><span class="category-list-count">6</span></li>
                  <li class="category-list-item"><a class="category-list-link" href="/categories/%E4%B8%AA%E4%BA%BA%E9%9A%8F%E7%AC%94/">个人随笔</a><span class="category-list-count">10</span></li>
                  <li class="category-list-item"><a class="category-list-link" href="/categories/%E6%8A%80%E6%9C%AF%E6%9D%82%E8%B0%88/">技术杂谈</a><span class="category-list-count">74</span></li>
                  <li class="category-list-item"><a class="category-list-link" href="/categories/%E6%9C%AA%E5%88%86%E7%B1%BB/">未分类</a><span class="category-list-count">1</span></li>
                  <li class="category-list-item"><a class="category-list-link" href="/categories/%E7%94%9F%E6%B4%BB%E7%AC%94%E8%AE%B0/">生活笔记</a><span class="category-list-count">1</span></li>
                  <li class="category-list-item"><a class="category-list-link" href="/categories/%E7%A6%8F%E5%88%A9%E4%B8%93%E5%8C%BA/">福利专区</a><span class="category-list-count">6</span></li>
                  <li class="category-list-item"><a class="category-list-link" href="/categories/%E8%81%8C%E4%BD%8D%E6%8E%A8%E8%8D%90/">职位推荐</a><span class="category-list-count">2</span></li>
                </ul>
              </div>
            </div>
            <div class="sidebar-panel sidebar-panel-friends sidebar-panel-active">
              <h4 class="name"> 友情链接 </h4>
              <ul class="friends">
                <li class="friend">
                  <span class="logo">
                    <img src="https://qiniu.cuiqingcai.com/j2dub.jpg">
                  </span>
                  <span class="link">
                    <a href="https://www.findhao.net/" target="_blank" rel="noopener">FindHao</a>
                  </span>
                </li>
                <li class="friend">
                  <span class="logo">
                    <img src="https://qiniu.cuiqingcai.com/ou6mm.jpg">
                  </span>
                  <span class="link">
                    <a href="https://diygod.me/" target="_blank" rel="noopener">DIYgod</a>
                  </span>
                </li>
                <li class="friend">
                  <span class="logo">
                    <img src="https://qiniu.cuiqingcai.com/6apxu.jpg">
                  </span>
                  <span class="link">
                    <a href="https://www.51dev.com/" target="_blank" rel="noopener">IT技术社区</a>
                  </span>
                </li>
                <li class="friend">
                  <span class="logo">
                    <img src="https://www.jankl.com/img/titleshu.jpg">
                  </span>
                  <span class="link">
                    <a href="https://www.jankl.com/" target="_blank" rel="noopener">liberalist</a>
                  </span>
                </li>
                <li class="friend">
                  <span class="logo">
                    <img src="https://qiniu.cuiqingcai.com/bqlbs.png">
                  </span>
                  <span class="link">
                    <a href="http://www.urselect.com/" target="_blank" rel="noopener">优社电商</a>
                  </span>
                </li>
                <li class="friend">
                  <span class="logo">
                    <img src="https://qiniu.cuiqingcai.com/8s88c.jpg">
                  </span>
                  <span class="link">
                    <a href="https://www.yuanrenxue.com/" target="_blank" rel="noopener">猿人学</a>
                  </span>
                </li>
                <li class="friend">
                  <span class="logo">
                    <img src="https://qiniu.cuiqingcai.com/4i7yf.jpg">
                  </span>
                  <span class="link">
                    <a href="https://www.lizenghai.com/" target="_blank" rel="noopener">Python量化投资</a>
                  </span>
                </li>
                <li class="friend">
                  <span class="logo">
                    <img src="https://qiniu.cuiqingcai.com/2wgg5.jpg">
                  </span>
                  <span class="link">
                    <a href="https://www.yunlifang.cn/" target="_blank" rel="noopener">云立方</a>
                  </span>
                </li>
                <li class="friend">
                  <span class="logo">
                    <img src="https://qiniu.cuiqingcai.com/shwr6.png">
                  </span>
                  <span class="link">
                    <a href="http://lanbing510.info/" target="_blank" rel="noopener">冰蓝</a>
                  </span>
                </li>
                <li class="friend">
                  <span class="logo">
                    <img src="https://qiniu.cuiqingcai.com/blvoh.jpg">
                  </span>
                  <span class="link">
                    <a href="https://lengyue.me/" target="_blank" rel="noopener">冷月</a>
                  </span>
                </li>
                <li class="friend">
                  <span class="logo">
                    <img src="http://qianxunclub.com/favicon.png">
                  </span>
                  <span class="link">
                    <a href="http://qianxunclub.com/" target="_blank" rel="noopener">千寻啊千寻</a>
                  </span>
                </li>
                <li class="friend">
                  <span class="logo">
                    <img src="https://qiniu.cuiqingcai.com/0044u.jpg">
                  </span>
                  <span class="link">
                    <a href="http://kodcloud.com/" target="_blank" rel="noopener">可道云</a>
                  </span>
                </li>
                <li class="friend">
                  <span class="logo">
                    <img src="https://qiniu.cuiqingcai.com/ygnpn.jpg">
                  </span>
                  <span class="link">
                    <a href="http://www.kunkundashen.cn/" target="_blank" rel="noopener">坤坤大神</a>
                  </span>
                </li>
                <li class="friend">
                  <span class="logo">
                    <img src="https://qiniu.cuiqingcai.com/22uv1.png">
                  </span>
                  <span class="link">
                    <a href="http://www.cenchong.com/" target="_blank" rel="noopener">岑冲博客</a>
                  </span>
                </li>
                <li class="friend">
                  <span class="logo">
                    <img src="https://qiniu.cuiqingcai.com/ev9kl.png">
                  </span>
                  <span class="link">
                    <a href="http://www.zxiaoji.com/" target="_blank" rel="noopener">张小鸡</a>
                  </span>
                </li>
                <li class="friend">
                  <span class="logo">
                    <img src="https://www.chrafz.com/favicon.ico">
                  </span>
                  <span class="link">
                    <a href="https://www.chrafz.com/" target="_blank" rel="noopener">张弦先生</a>
                  </span>
                </li>
                <li class="friend">
                  <span class="logo">
                    <img src="https://www.503error.com/favicon.ico">
                  </span>
                  <span class="link">
                    <a href="https://www.503error.com/" target="_blank" rel="noopener">张志明个人博客</a>
                  </span>
                </li>
                <li class="friend">
                  <span class="logo">
                    <img src="https://seofangfa.com/favicon.ico">
                  </span>
                  <span class="link">
                    <a href="https://seofangfa.com/" target="_blank" rel="noopener">方法SEO</a>
                  </span>
                </li>
                <li class="friend">
                  <span class="logo">
                    <img src="https://qiniu.cuiqingcai.com/x714o.jpg">
                  </span>
                  <span class="link">
                    <a href="http://www.hubwiz.com/" target="_blank" rel="noopener">汇智网</a>
                  </span>
                </li>
                <li class="friend">
                  <span class="logo">
                    <img src="https://qiniu.cuiqingcai.com/lfmj3.png">
                  </span>
                  <span class="link">
                    <a href="http://frankchen.xyz/" target="_blank" rel="noopener">不正经数据科学家</a>
                  </span>
                </li>
                <li class="friend">
                  <span class="logo">
                    <img src="https://qiniu.cuiqingcai.com/129d8.png">
                  </span>
                  <span class="link">
                    <a href="https://www.bysocket.com/" target="_blank" rel="noopener">泥瓦匠BYSocket</a>
                  </span>
                </li>
                <li class="friend">
                  <span class="logo">
                    <img src="https://www.xiongge.club/favicon.ico">
                  </span>
                  <span class="link">
                    <a href="https://www.xiongge.club/" target="_blank" rel="noopener">熊哥club</a>
                  </span>
                </li>
                <li class="friend">
                  <span class="logo">
                    <img src="https://qiniu.cuiqingcai.com/3w4fe.png">
                  </span>
                  <span class="link">
                    <a href="https://zerlong.com/" target="_blank" rel="noopener">知语</a>
                  </span>
                </li>
                <li class="friend">
                  <span class="logo">
                    <img src="https://qiniu.cuiqingcai.com/262r1.jpg">
                  </span>
                  <span class="link">
                    <a href="http://www.ysir308.com/" target="_blank" rel="noopener">程序员虾说</a>
                  </span>
                </li>
                <li class="friend">
                  <span class="logo">
                    <img src="https://qiniu.cuiqingcai.com/44hxf.png">
                  </span>
                  <span class="link">
                    <a href="http://redstonewill.com/" target="_blank" rel="noopener">红色石头</a>
                  </span>
                </li>
                <li class="friend">
                  <span class="logo">
                    <img src="https://qiniu.cuiqingcai.com/8g1fk.jpg">
                  </span>
                  <span class="link">
                    <a href="http://www.laodong.me/" target="_blank" rel="noopener">老董博客</a>
                  </span>
                </li>
                <li class="friend">
                  <span class="logo">
                    <img src="https://qiniu.cuiqingcai.com/wkaus.jpg">
                  </span>
                  <span class="link">
                    <a href="https://zhaoshuai.me/" target="_blank" rel="noopener">碎念</a>
                  </span>
                </li>
                <li class="friend">
                  <span class="logo">
                    <img src="https://qiniu.cuiqingcai.com/pgo0r.jpg">
                  </span>
                  <span class="link">
                    <a href="https://www.chenwenguan.com/" target="_blank" rel="noopener">陈文管的博客</a>
                  </span>
                </li>
                <li class="friend">
                  <span class="logo">
                    <img src="https://qiniu.cuiqingcai.com/kk82a.jpg">
                  </span>
                  <span class="link">
                    <a href="https://www.lxlinux.net/" target="_blank" rel="noopener">良许Linux教程网</a>
                  </span>
                </li>
                <li class="friend">
                  <span class="logo">
                    <img src="https://qiniu.cuiqingcai.com/lj0t2.jpg">
                  </span>
                  <span class="link">
                    <a href="https://tanqingbo.cn/" target="_blank" rel="noopener">IT码农</a>
                  </span>
                </li>
                <li class="friend">
                  <span class="logo">
                    <img src="https://qiniu.cuiqingcai.com/i8cdr.png">
                  </span>
                  <span class="link">
                    <a href="https://junyiseo.com/" target="_blank" rel="noopener">均益个人博客</a>
                  </span>
                </li>
                <li class="friend">
                  <span class="logo">
                    <img src="https://qiniu.cuiqingcai.com/chwv2.png">
                  </span>
                  <span class="link">
                    <a href="https://brucedone.com/" target="_blank" rel="noopener">大鱼的鱼塘</a>
                  </span>
                </li>
                <li class="friend">
                  <span class="logo">
                    <img src="https://qiniu.cuiqingcai.com/2y43o.png">
                  </span>
                  <span class="link">
                    <a href="http://bbs.nightteam.cn/" target="_blank" rel="noopener">夜幕爬虫安全论坛</a>
                  </span>
                </li>
              </ul>
            </div>
          </div>
        </aside>
        <div id="sidebar-dimmer"></div>
      </div>
    </main>
    <footer class="footer">
      <div class="footer-inner">
        <div class="copyright"> &copy; <span itemprop="copyrightYear">2021</span>
          <span class="with-love">
            <i class="fa fa-heart"></i>
          </span>
          <span class="author" itemprop="copyrightHolder">崔庆才丨静觅</span>
          <span class="post-meta-divider">|</span>
          <span class="post-meta-item-icon">
            <i class="fa fa-chart-area"></i>
          </span>
          <span title="站点总字数">2.5m</span>
          <span class="post-meta-divider">|</span>
          <span class="post-meta-item-icon">
            <i class="fa fa-coffee"></i>
          </span>
          <span title="站点阅读时长">37:31</span>
        </div>
        <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动 </div>
        <div class="beian"><a href="https://beian.miit.gov.cn/" rel="noopener" target="_blank">京ICP备18015597号-1 </a>
        </div>
        <script>
          (function ()
          {
            function leancloudSelector(url)
            {
              url = encodeURI(url);
              return document.getElementById(url).querySelector('.leancloud-visitors-count');
            }

            function addCount(Counter)
            {
              var visitors = document.querySelector('.leancloud_visitors');
              var url = decodeURI(visitors.id);
              var title = visitors.dataset.flagTitle;
              Counter('get', '/classes/Counter?where=' + encodeURIComponent(JSON.stringify(
              {
                url
              }))).then(response => response.json()).then((
              {
                results
              }) =>
              {
                if (results.length > 0)
                {
                  var counter = results[0];
                  leancloudSelector(url).innerText = counter.time + 1;
                  Counter('put', '/classes/Counter/' + counter.objectId,
                  {
                    time:
                    {
                      '__op': 'Increment',
                      'amount': 1
                    }
                  }).catch(error =>
                  {
                    console.error('Failed to save visitor count', error);
                  });
                }
                else
                {
                  Counter('post', '/classes/Counter',
                  {
                    title,
                    url,
                    time: 1
                  }).then(response => response.json()).then(() =>
                  {
                    leancloudSelector(url).innerText = 1;
                  }).catch(error =>
                  {
                    console.error('Failed to create', error);
                  });
                }
              }).catch(error =>
              {
                console.error('LeanCloud Counter Error', error);
              });
            }

            function showTime(Counter)
            {
              var visitors = document.querySelectorAll('.leancloud_visitors');
              var entries = [...visitors].map(element =>
              {
                return decodeURI(element.id);
              });
              Counter('get', '/classes/Counter?where=' + encodeURIComponent(JSON.stringify(
              {
                url:
                {
                  '$in': entries
                }
              }))).then(response => response.json()).then((
              {
                results
              }) =>
              {
                for (let url of entries)
                {
                  let target = results.find(item => item.url === url);
                  leancloudSelector(url).innerText = target ? target.time : 0;
                }
              }).catch(error =>
              {
                console.error('LeanCloud Counter Error', error);
              });
            }
            let
            {
              app_id,
              app_key,
              server_url
            } = {
              "enable": true,
              "app_id": "6X5dRQ0pnPWJgYy8SXOg0uID-gzGzoHsz",
              "app_key": "ziLDVEy73ne5HtFTiGstzHMS",
              "server_url": null,
              "security": false
            };

            function fetchData(api_server)
            {
              var Counter = (method, url, data) =>
              {
                return fetch(`${api_server}/1.1${url}`,
                {
                  method,
                  headers:
                  {
                    'X-LC-Id': app_id,
                    'X-LC-Key': app_key,
                    'Content-Type': 'application/json',
                  },
                  body: JSON.stringify(data)
                });
              };
              if (CONFIG.page.isPost)
              {
                if (CONFIG.hostname !== location.hostname) return;
                addCount(Counter);
              }
              else if (document.querySelectorAll('.post-title-link').length >= 1)
              {
                showTime(Counter);
              }
            }
            let api_server = app_id.slice(-9) !== '-MdYXbMMI' ? server_url : `https://${app_id.slice(0, 8).toLowerCase()}.api.lncldglobal.com`;
            if (api_server)
            {
              fetchData(api_server);
            }
            else
            {
              fetch('https://app-router.leancloud.cn/2/route?appId=' + app_id).then(response => response.json()).then((
              {
                api_server
              }) =>
              {
                fetchData('https://' + api_server);
              });
            }
          })();

        </script>
      </div>
      <div class="footer-stat">
        <span id="cnzz_stat_icon_1279355174"></span>
        <script type="text/javascript">
          document.write(unescape("%3Cspan id='cnzz_stat_icon_1279355174'%3E%3C/span%3E%3Cscript src='https://v1.cnzz.com/z_stat.php%3Fid%3D1279355174%26online%3D1%26show%3Dline' type='text/javascript'%3E%3C/script%3E"));

        </script>
      </div>
    </footer>
  </div>
  <script src="//cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/pangu@4/dist/browser/pangu.min.js"></script>
  <script src="/js/utils.js"></script>
  <script src="/.js"></script>
  <script src="/js/schemes/pisces.js"></script>
  <script src="/.js"></script>
  <script src="/js/next-boot.js"></script>
  <script src="/.js"></script>
  <script>
    (function ()
    {
      var canonicalURL, curProtocol;
      //Get the <link> tag
      var x = document.getElementsByTagName("link");
      //Find the last canonical URL
      if (x.length > 0)
      {
        for (i = 0; i < x.length; i++)
        {
          if (x[i].rel.toLowerCase() == 'canonical' && x[i].href)
          {
            canonicalURL = x[i].href;
          }
        }
      }
      //Get protocol
      if (!canonicalURL)
      {
        curProtocol = window.location.protocol.split(':')[0];
      }
      else
      {
        curProtocol = canonicalURL.split(':')[0];
      }
      //Get current URL if the canonical URL does not exist
      if (!canonicalURL) canonicalURL = window.location.href;
      //Assign script content. Replace current URL with the canonical URL
      ! function ()
      {
        var e = /([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi,
          r = canonicalURL,
          t = document.referrer;
        if (!e.test(r))
        {
          var n = (String(curProtocol).toLowerCase() === 'https') ? "https://sp0.baidu.com/9_Q4simg2RQJ8t7jm9iCKT-xh_/s.gif" : "//api.share.baidu.com/s.gif";
          t ? (n += "?r=" + encodeURIComponent(document.referrer), r && (n += "&l=" + r)) : r && (n += "?l=" + r);
          var i = new Image;
          i.src = n
        }
      }(window);
    })();

  </script>
  <script src="/js/local-search.js"></script>
  <script src="/.js"></script>
</body>

</html>
